<html class="no-js" lang=""><head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">

        <title>Zephyrus Ai Art Studio ― Perchance Generator</title> 
        <meta name="description" content="This generator has useful features for quickly AI.">
        <meta id="viewportMetaEl" name="viewport" content="width=device-width, initial-scale=1, interactive-widget=resizes-content">

        <link rel="apple-touch-icon" href="apple-touch-icon.png">
        <link rel="icon" type="image/png" href="apple-touch-icon.png" sizes="180x180">
        <link rel="icon" type="image/png" href="/favicon-32x32-white-bg.png" sizes="32x32">
        <link rel="icon" type="image/png" href="/favicon-16x16-white-bg.png" sizes="16x16"> 
        
        
        <meta property="og:type" content="website">
        <!-- <meta property="og:url" content="https://perchance.org/..." />  -->
        <meta property="og:image" content="https://perchance.org/api/getGeneratorScreenshot?generatorName=zahid-aistudio">
        <!-- <meta property="og:description" content="..." /> -->

        <meta name="color-scheme" content="dark light">

        <link rel="preconnect" href="https://908f97c38727bb4c12a5ef1d46671625.perchance.org">

        
        

        <style>
          :root {
            --menu-bar-height: 26px;
          }
        </style>

        <script>
          if(!Array.prototype.at) {
            window.addEventListener("error", function(message, url, linenumber) {
              console.warn(`JavaScript error:  on line  for `, message, url, linenumber);
            });
          }
        </script>

        <script>
          window.TEST_NEW_EDITOR_1 = true; // localStorage.TEST_NEW_EDITOR_1; 

          // preload the editor bundle if we're going to need it
          if(window.TEST_NEW_EDITOR_1 && /^#edit($|:)/.test(window.location.hash)) {
            window.editorBundleImportPromise = import("/lib/editors.bundle.min.js?v=75");
          }
          
          setTimeout(() => {
            if(window.TEST_NEW_EDITOR_1 && !window.editorBundleImportPromise) window.editorBundleImportPromise = import("/lib/editors.bundle.min.js?v=75");
          }, 20*1000);
        </script>

        <script>
          {
            // attempt at solving virtual keyboard causing top-level scroll in mobile:
            // let viewport = document.querySelector("meta[name=viewport]");
            // viewport.setAttribute("content", viewport.content + `, height=`);

            // window.visualViewport.addEventListener('resize', function (event) {
            // });

            // doesn't work properly - causes momentary screen jumping/flashing on keyboard close
            // if("virtualKeyboard" in navigator) {
            //   navigator.virtualKeyboard.overlaysContent = true;
            // }
          }
        </script>  

        <script>
          window.name = window.location.pathname; // for Notification.onclick to not open a new window if that generator is open already
        </script> 

        <script>
          {
            // let idbKeyval = await import("https://cdn.jsdelivr.net/npm/idb-keyval@6/+esm");
            let idbKeyval = (function() { // This is v6.2.1
              function e(e){return new Promise(((t,n)=>{e.oncomplete=e.onsuccess=()=>t(e.result),e.onabort=e.onerror=()=>n(e.error)}))}function t(t,n){const r=indexedDB.open(t);r.onupgradeneeded=()=>r.result.createObjectStore(n);const o=e(r);return(e,t)=>o.then((r=>t(r.transaction(n,e).objectStore(n))))}let n;function r(){return n||(n=t("keyval-store","keyval")),n}function o(t,n=r()){return n("readonly",(n=>e(n.get(t))))}function u(t,n,o=r()){return o("readwrite",(r=>(r.put(n,t),e(r.transaction))))}function c(t,n=r()){return n("readwrite",(n=>(t.forEach((e=>n.put(e[1],e[0]))),e(n.transaction))))}function s(t,n=r()){return n("readonly",(n=>Promise.all(t.map((t=>e(n.get(t)))))))}function a(t,n,o=r()){return o("readwrite",(r=>new Promise(((o,u)=>{r.get(t).onsuccess=function(){try{r.put(n(this.result),t),o(e(r.transaction))}catch(e){u(e)}}}))))}function i(t,n=r()){return n("readwrite",(n=>(n.delete(t),e(n.transaction))))}function l(t,n=r()){return n("readwrite",(n=>(t.forEach((e=>n.delete(e))),e(n.transaction))))}function f(t=r()){return t("readwrite",(t=>(t.clear(),e(t.transaction))))}function d(t,n){return t.openCursor().onsuccess=function(){this.result&&(n(this.result),this.result.continue())},e(t.transaction)}function h(t=r()){return t("readonly",(t=>{if(t.getAllKeys)return e(t.getAllKeys());const n=[];return d(t,(e=>n.push(e.key))).then((()=>n))}))}function y(t=r()){return t("readonly",(t=>{if(t.getAll)return e(t.getAll());const n=[];return d(t,(e=>n.push(e.value))).then((()=>n))}))}function p(t=r()){return t("readonly",(n=>{if(n.getAll&&n.getAllKeys)return Promise.all([e(n.getAllKeys()),e(n.getAll())]).then((([e,t])=>e.map(((e,n)=>[e,t[n]]))));const r=[];return t("readonly",(e=>d(e,(e=>r.push([e.key,e.value]))).then((()=>r))))}))}
              return {clear:f,createStore:t,del:i,delMany:l,entries:p,get:o,getMany:s,keys:h,set:u,setMany:c,update:a,values:y};
            })();
            const storeCache = {};
            window.kv = new Proxy(idbKeyval, { // so api is like: kv.myStoreName.get(...)
              get(target, prop, receiver) {
                if(!storeCache[prop]) storeCache[prop] = idbKeyval.createStore(`-db`, `-store`); // <-- creates only if it doesn't already exist
                const store = storeCache[prop];
                return {
                  get: (key) => idbKeyval.get(key, store),
                  set: (key, value) => idbKeyval.set(key, value, store),
                  delete: (key) => idbKeyval.del(key, store),
                  entries: () => idbKeyval.entries(store),
                  clear: () => idbKeyval.clear(store),
                };
              },
            });
          }
        </script>

        <script>
          window.hasDynamicMetaData = "false" === "true";
          window.metaDataIsLoadedPromise = new Promise(r => window.metaDataIsLoadedResolver=r);
          if(!window.hasDynamicMetaData) window.metaDataIsLoadedResolver();
          (async function() { 
            if(window.hasDynamicMetaData) {
              let urlQueryStringPart = new URLSearchParams(window.location.search).toString();
              if(urlQueryStringPart) urlQueryStringPart = "&" + urlQueryStringPart;
              let data = await fetch(`/api/getDynamicMetaData?__generatorName=`).then(r => r.json()).catch(console.error);
              if(data && data.success) {
                window.forceDisableAds = !!data.forceDisableAds;
                // NOTE: Be wary of script injection when editing.
                document.querySelector("meta[name='description']").content = data.description;
                document.title = data.title;
                document.querySelector("meta[property='og:image']").content = data.image;
              }
              window.metaDataIsLoadedResolver();
            }
          })(); 
        </script>
        
        

    </head>  
    <body style="overscroll-behavior:none;">
      
        <!-- <div id="controlHeightEl" style="height:100vh; width:0px; position: absolute;"></div> -->
        <script>
          // document.documentElement.style.height = controlHeightEl.clientHeight+"px";
          
          window.advertHeight = window.innerWidth > 700 ? 90 : 50; 

          // document.documentElement.style.height = `height:calc(100lvh + var(--menu-bar-height) + 1px)`;
          // function updateMainElHeight() {
          //   document.querySelector("#editorEl #main").style.height = `calc(100dvh - px - px)`;
          //   console.debug(document.querySelector("#editorEl #main").style.height)
          // }
          // window.addEventListener("scroll", updateMainElHeight);

          {
            const viewportMetaEl = document.querySelector('#viewportMetaEl');
            const originalViewportMetaContent = viewportMetaEl.getAttribute("content");
            let lastChangeTime = Date.now();
            const observer = new MutationObserver(mutations => {
              mutations.forEach(m => {
                if(m.type === 'attributes' && Date.now() - lastChangeTime > 2000) {
                  lastChangeTime = Date.now();
                  console.log("🚩🚩🚩 viewport meta tag content attribute was changed.");
                  viewportMetaEl.setAttribute("content", originalViewportMetaContent);
                  window.queuedStatCountKeys.add("viewport-mtc");
                }
              })
            });
            observer.observe(viewportMetaEl, { attributes: true, attributeFilter: ['content'] });
          }
        </script>
        
        <script>
          // 'polyfill' Safari's lack of support for interactive-widget=resizes-content on
          // EDIT: disabled because causes weird scroll jank issues
          // {
          //   let isTouchScreen = window.matchMedia("(pointer: coarse)").matches;
          //   if(isTouchScreen) {
          //     let shouldTriggerResizeBarrage = true;
          //     function handler() {
          //       if(!shouldTriggerResizeBarrage) return;
          //       shouldTriggerResizeBarrage = false;
          //       async function doResize() {
          //         // console.debug("doResize1", window.visualViewport.pageTop, window.visualViewport.height, document.documentElement.offsetHeight)
          //         shouldTriggerResizeBarrage = false; // just to be safe
          //         if(window.visualViewport.pageTop <= 1 && Math.abs(window.visualViewport.height - document.documentElement.offsetHeight) <= 2) return;
          //         console.debug("scrolling/resizing", window.visualViewport.pageTop, window.visualViewport.height, document.documentElement.offsetHeight);
          //         // for whatever reason, this is needed, since otherwise the scrollTo(0,0) doesn't work. Safari sucks.
          //         window.scrollTo(0,1);
          //         document.documentElement.style.height = window.visualViewport.height+"px";
          //         window.scrollTo(0,1);
          //       }
          //       let interval = setInterval(doResize, 100);
          //       doResize();
          //       setTimeout(() => {
          //         clearInterval(interval);
          //         doResize();
          //         setTimeout(() => shouldTriggerResizeBarrage=true, 50);
          //       }, 600);
          //     }
          //     window.addEventListener('scroll', handler);
          //     visualViewport.addEventListener('scroll', handler);
          //     visualViewport.addEventListener('resize', handler);
          //   }
          // }
        </script>

        <script>window.queuedStatCountKeys = new Set();</script>
        <script>window.mdded4sfef4dsedddse1d34344 = `Error: Ad blocker preventing proper page load?`;</script>
        <script>
          window.js0nparse = JSON.parse;
        </script>

        <script>
        // COMPATABILITY TESTING:
        window.canExecuteModernJavascript = true;
        try {

          var str = "";
          str += "\n(async () => { await new Promise(resolve => setTimeout(resolve, 500)); console.debug('async/await is supported'); })();";
          str += "\nlet arr = [1,2,3]; for(let a of arr) { arr[0]+=a; }; console.debug('let a of arr supported');";
          str += "\nvar m = [1,2,3].map(n => n+1);";
          str += "\nvar k = [...[1,2,3]];";
          str += "\nvar a = (function(a=3) { return a+1; })();";

          window.eval(str);

        } catch(e) {
          window.canExecuteModernJavascript = false;
          // var message = "<div style='overflow:hidden;height:0px;'><h1>Create a Random Generator</h1><p>Perhance is a platform that allows you to create your own custom random generators. You could use it to create your own random text generator for a tabletop RPG, or to make your own random name generator, or to simply create a generator which selects a random item from your list with different weights. You can also save your generator so it has a permalink that you can share with your friends.</p><p>Perchance is based around creating lists which reference other lists. You can adjust the odds of items in each list so that when you randomly select an item from that list, they all have the likelihoods that you've specified. If you'd like to learn how to make a random text generator with Perchance, you should check out the tutorial. It explains all the basic features of the Perchance engine and should get you up and running in only 10 or 20 minutes. Perchance has many powerful features that you don't need to learn from the start, but can learn later if you want to create particularly complex generators.</p><p>I created Perchance because most people are still creating random generators in excel. Those work all right, but excel and other spreadsheets aren't really made for that purpose, so there's a lot to be desired in terms of functionality and ease of use. Whatever you're using it for, I hope you find Perchance useful! You might like to check out our <a href='http://reddit.com/r/perchance'>community forum</a> where you can ask questions and share your random generator creations.</p></div>(」ﾟﾛﾟ)｣ Sorry! Perchance uses cutting edge browser features that are only available in the latest versions of Chrome and Firefox. All modern browsers will eventually be supported, but for now you'll need to use one of those two. Sorry again for the inconvenience!";
          // //window.alert(message);
          // document.body.innerHTML = message; 
        }
        </script>


        <div id="generator-description" style="display:none; height:20px; width:20px; z-index:-10; overflow:hidden; position:fixed; bottom:-100px;"><div>
    <div>
      <div>Zephyrus Ai Art Studio</div>
    </div>
    

<h1><div>Make your imagination live with Zephyrus AI Art Generator</div></h1>

<div> 
<div>

<div data-fold-toggle-state="hidden">
<div>
<div>
<i></i> Notepad
 ⓘ
<button></button>
</div>
<div>
<div>
💭

</div>

</div>
<div></div>
</div>
</div>

<div data-fold-toggle-state="undefined">
<div>
<div>
<i></i> Description
 ⓘ

</div>
<div>
<div>
💭

</div>
<div data-input-name="description"><button>🎲</button><button>🧠</button></div>
</div>
<div></div>
</div>
</div>

<div data-fold-toggle-state="shown">
<div>
<div>
<i></i> Negatives (optional)
 ⓘ
<button></button>
</div>
<div>
<div>
💭

</div>

</div>
<div></div>
</div>
</div>
<div>
<div>
<div>
<i></i> NG
 ⓘ
</div>
<div>


⭕FF
🟢N


</div>
</div>
</div>
<div>
<div>
<div>
<i></i> <b>CFG</b>
 ⓘ
</div>
<div>


DF(7)
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30


</div>
</div>
</div>

<div data-fold-toggle-state="hidden">
<div>
<div>
<i></i> ExtraDescription
 ⓘ
<button></button>
</div>
<div>
<div>
💭

</div>

</div>
<div></div>
</div>
</div>

<div data-fold-toggle-state="shown">
<div>
<div>
<i></i> <b>Image Seed</b>
 ⓘ
<button></button>
</div>
<div>
<div>
💭

</div>

</div>
</div>
</div>
<div>
<div>
<div>
<i></i> Main Art Style

</div>
<div>


Painted Anime
Casual Photo
Cinematic
Digital Painting
Concept Art
𝗡𝗼 𝘀𝘁𝘆𝗹𝗲
➛ 3D (EXPERIMENTAL)
3D Disney Character
2D Disney Character
Disney Sketch
Concept Sketch
Painterly
Oil Painting
Oil Painting - Realism
Oil Painting - Old
Oil Painting - 70s Pulp
Professional Photo
Anime
Drawn Anime
Anime Screencap
Cute Anime
Soft Anime
Fantasy Painting
Fantasy Landscape
Fantasy Portrait
Studio Ghibli
50s Enamel Sign
Vintage Comic
Franco-Belgian Comic
Tintin Comic
Medieval
Pixel Art
Furry - Oil
Furry - Cinematic
Furry - Painted
Furry - Drawn
Cute Figurine
3D Emoji
Illustration
Cute Illustration
Flat Illustration
Watercolor
1990s Photo
1980s Photo
1970s Photo
1960s Photo
1950s Photo
1940s Photo
1930s Photo
1920s Photo
Vintage Pulp Art
50s Infomercial Anime
3D Pokemon
Painted Pokemon
2D Pokemon
Vintage Anime
Neon Vintage Anime
Manga
Fantasy World Map
Fantasy City Map
Old World Map
3D Isometric Icon
Flat Style Icon
Flat Style Logo
Game Art Icon
Digital Painting Icon
Concept Art Icon
Cute 3D Icon
Cute 3D Icon 𝗦𝗲𝘁
Crayon Drawing
Pencil
Tattoo Design
Waifu
YuGiOh Art
Traditional Japanese
Nihonga Painting
Claymation
Cartoon
Cursed Photo
MTG Card
》Anti-NSFW
》Manga
》Classic anime
》Modern anime
》Realistic anime
》Abstract art
》Borderlands art
》Cinematic
》Concept art
》Pixel art
》Planet art
》Casual photo
》Realistic images
》Realistic humans
🔻 Vionet20 Styles Below ↓
No Style
Fineline Illustration
Flat Vector Illustration
Polygonal Illustration
Detailed Cartoony Illustrations
Cute Cartoon Illustrations
Comic/Manga Illustration
Grim Dark Fantasy Illustration
General High Quality Anime
Old Style Anime A
Old Style Anime B
Color Pop Anime Illustration
Colored Patterns Anime
Atmospheric Painting
Brushy Paintings
Brushy Paintings 2
Drip/Palette Knife Paintings
Anime-Realism Paintings
Anime-Impressionism Paintings
Vintage Anime-Realistic Render
Wetplate Photo Look
B&amp;W Photo
*Realistic* Portraits
*Realistic* Anime
Sims/Runescape Graphics
Noisy/Grainy Effect
Stained Glass
Marble Sculpture


</div>
</div>
</div>

<div data-fold-toggle-state="undefined">
<div>
<div>
 © 
 ⓘ

</div>
<div>
<div>
💭

</div>

</div>
</div>
</div>
<div>
<div>
<div>
<i></i> Extra Art Style 2
 ⓘ
</div>
<div>


-----
Painted Anime
Casual Photo
Cinematic
Digital Painting
Concept Art
3D Disney Character
2D Disney Character
Disney Sketch
Concept Sketch
Painterly
Oil Painting
Oil Painting - Realism
Oil Painting - Old
Oil Painting - 70s Pulp
Professional Photo
Anime
Drawn Anime
Anime Screencap
Cute Anime
Soft Anime
Fantasy Painting
Fantasy Landscape
Fantasy Portrait
Studio Ghibli
50s Enamel Sign
Vintage Comic
Franco-Belgian Comic
Tintin Comic
Medieval
Pixel Art
Furry - Oil
Furry - Cinematic
Furry - Painted
Furry - Drawn
Cute Figurine
3D Emoji
Illustration
Cute Illustration
Flat Illustration
Watercolor
1990s Photo
1980s Photo
1970s Photo
1960s Photo
1950s Photo
1940s Photo
1930s Photo
1920s Photo
Vintage Pulp Art
50s Infomercial Anime
3D Pokemon
Painted Pokemon
2D Pokemon
Vintage Anime
Neon Vintage Anime
Manga
Fantasy World Map
Fantasy City Map
Old World Map
3D Isometric Icon
Flat Style Icon
Flat Style Logo
Game Art Icon
Digital Painting Icon
Concept Art Icon
Cute 3D Icon
Cute 3D Icon 𝗦𝗲𝘁
Crayon Drawing
Pencil
Tattoo Design
Waifu
YuGiOh Art
Traditional Japanese
Nihonga Painting
Claymation
Cartoon
Cursed Photo
》Anti-NSFW
》Manga
》Classic anime
》Modern anime
》Realistic anime
》Abstract art
》Borderlands art
》Cinematic
》Concept art
》Pixel art
》Planet art
》Casual photo
》Realistic images
》Realistic humans
🔻 Vionet20 Styles Below ↓
No Style
Fineline Illustration
Flat Vector Illustration
Polygonal Illustration
Detailed Cartoony Illustrations
Cute Cartoon Illustrations
Comic/Manga Illustration
Grim Dark Fantasy Illustration
General High Quality Anime
Old Style Anime A
Old Style Anime B
Color Pop Anime Illustration
Colored Patterns Anime
Atmospheric Painting
Brushy Paintings
Brushy Paintings 2
Drip/Palette Knife Paintings
Anime-Realism Paintings
Anime-Impressionism Paintings
Vintage Anime-Realistic Render
Wetplate Photo Look
B&amp;W Photo
*Realistic* Portraits
*Realistic* Anime
Sims/Runescape Graphics
Noisy/Grainy Effect
Stained Glass
Marble Sculpture


</div>
</div>
</div>
<div>
<div>
<div>
<i></i> How many?

</div>
<div>


1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
20
25
30
40
50
75
100


</div>
</div>
</div>
<div>
<div>
<div>
<i></i> Shape

</div>
<div>


Portrait (512x768)
Square (768x768)
Landscape (768x512)


</div>
</div>
</div>
<div>
<div>
<div>
👁️‍🗨️
 ⓘ
</div>
<div>


DF
s
M
L
XL
s%
M%
L%
X%


</div>
</div>
</div>

<div data-fold-toggle-state="shown">
<div>
<div>
<i></i> Title or Signature <i></i>
 ⓘ
<button></button>
</div>
<div>
<div>
💭

</div>

</div>
</div>
</div>

<div data-fold-toggle-state="hidden">
<div>
<div>
<i></i> Image Description <i></i>
 ⓘ
<button></button>
</div>
<div>
<div>
💭

</div>

</div>
</div>
</div>

<div data-fold-toggle-state="undefined">
<div>
<div>
❖


</div>
<div>
<div>
💭

</div>

</div>
</div>
</div>
</div>




<div>
<button>🔗 share these settings</button>
<div>
 <button>copy link</button>
<div>(this link contains a snapshot of the above settings)</div>
</div>
</div>

<div>
<div>click ➡&nbsp;<button>✨ generate</button>&nbsp;⬅ click</div>
<div><div>⬆</div><div>click</div></div>
</div>

<div>
<div>Zephyrus is a next-gen AI art generator built for dreamers, designers, and storytellers.<br>With cosmic-inspired themes and clean futuristic design, it turns imagination into stunning visuals &amp; fast, smooth, and free.</div>
</div>

<div>
<div></div>
<button>🗨️ feedback</button>
</div>

<div>
<button><div>💬 show comments &amp; gallery 🖼️</div></button>
<div>
auto-show next time
</div>
</div>

<div>
<button data-hidden="">hide comments</button>
<button data-hidden="">hide gallery</button>
</div>

<div>
<button>🌄</button>
<div><button data-exit-text="⇲" data-text="⇱">&nbsp;&nbsp;&nbsp;⇱&nbsp;&nbsp;&nbsp;</button></div>
</div>
</div>

<div>
<button>🛡️ private gallery</button>
</div>

<div><div></div></div>


<div>
<div><b>Note:</b> The comments and gallery only appear after generating several batches of images. If you visit this page again later and don't see the gallery/comments, it's because your cookies/storage for this site got cleared for some reason, so you'd need to generate some more images. <button>✅ got it</button></div>
</div>

<div>

</div>
<br><br><br><br>

  </div>
  
  
    <div>
      <div>
        Powered by Stability.ai &amp; Volnet 2
      </div>
      <div>
        2025 all rights reserved - Zahid
      </div>
    </div>
  
  
  


<div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div>

        <style>
          .cm-syntax-style1 { color: #f18c16; }
          .cm-syntax-style2 { color: #2795EE; }
          .cm-syntax-style3-comment { color: #A0A1A7; }
        </style>

        <!-- PRELOADED DATA --> 
        <script id="preloaded-generator-data" type="notjs">%7B%22name%22:%22zahid-aistudio%22,%22modelText%22:%22generateHTML%20=%20%7Bimport:t2i-framework-plugin-v2%7D%20%20//%20%3C--%20this%20is%20a%20little%20DIY%20'framework'%20plugin%20that%20itself%20imports%20the%20text-to-image%20plugin%20and%20generates%20the%20user%20interface%20using%20the%20settings%20below%5Cnicon%20=%20%7Bimport:rpg-icon-plugin%7D%5Cn%5Cn%20%20title%20=%20Zephyrus%20Ai%20Art%20Studio%5Cn%20%20description%20=%20This%20generator%20has%20useful%20features%20for%20quickly%20AI.%5Cn%20%20image%20=%20https://files.catbox.moe/0bthgm.jpeg%20//https://files.catbox.moe/%5Cn%5Cnsettings%20%5Cn%20%20pageTitle%20=%20%3Cdiv%20style=%5C%22text-align:center;%20font-family:Orbitron,%20sans-serif;%20font-size:1.8em;%20font-weight:600;%20color:#ffffff;%20text-shadow:0%200%208px%20#66ccff,%200%200%2012px%20#66ccff;%5C%22%3EMake%20your%20imagination%20live%20with%20Zephyrus%20AI%20Art%20Generator%3C/div%3E%5Cn%20%20introMessage%20=%20%3Cdiv%20style=%5C%22text-align:center;%5C%22%3E%3Cspan%20style=%5C%22font-size:120%25;%20font-weight:500;%20font-family:'Open%20Sans',%20sans-serif;%20color:#ccc;%5C%22%3EZephyrus%20is%20a%20next-gen%20AI%20art%20generator%20built%20for%20dreamers,%20designers,%20and%20storytellers.%3Cbr%3EWith%20cosmic-inspired%20themes%20and%20clean%20futuristic%20design,%20it%20turns%20imagination%20into%20stunning%20visuals%20&%20fast,%20smooth,%20and%20free.%3C/span%3E%3C/div%3E%20//%20%3C--%20you%20can%20delete%20this%20line%20if%20you%20don't%20want%20an%20intro%20message%5Cn%20%20showIntroMessage%20=%20true%20//%20%3C--%20set%20to%20'false'%20if%20you%20don't%20want%20the%20intro%20message%20to%20show%20up%5Cn%20%20%5Cn%20%20numImages%20=%20%5BNumber(input.numImages)%5D%5Cn%5Cn%20%20%5Cn%20%20%5Cn%20%20imageOptions%20//%20%3C--%20options%20for%20the%20text-to-image%20plugin%20that%20generates%20the%20images:%20https://perchance.org/text-to-image-plugin%5Cn%20%20%20%20saveTitle%20=%20%5Binput.titleImage%5D%20//%5Binput.description%5D%20//%20.getName%20is%20a%20built-in%20Perchance%20property%20that%20gets%20the%20name%20of%20a%20given%20list/sublist/node%5Cn%20%20%20%20saveDescription%20=%20%5Binput.descImage%5D%5Cn%20%20%20%20prompt%20=%20%5Binput.artStyle.prompt%5D%5Binput.case%5D%5Binput.artStyle2.prompt%5D%5Binput.case2%5D%5Binput.artStyle3.prompt%5D%5Binput.artStyle4.prompt%5D%5Cn%20%20%20%20//prompt%20=%20%5Binput.artStyle.prompt%5D%5Binput.artStyle2.prompt%5D%5Cn%20%20%20%20negativePrompt%20=%20%5Binput.artStyle.negative%5D%5Binput.case%5D%5Binput.artStyle2.negative%5D%5Cn%20%20%20%20resolution%20=%20%5Binput.shape%5D%5Cn%20%20%20%20guidanceScale%20=%20%5Binput.Gscale%5D%5Cn%20%20%20%20seed%20=%20%5Binput.seed%5D%20%20%20%20%5Cn%20%20%20%20width%20=%20%5Binput.size%5D%5Cn%20%20%20%20//height%20=%20%5Binput.widd%20*%201.5%5D%5Cn%20%20userInputs%20//%20you%20can%20add%20more%20user%20inputs%20to%20this%20list,%20and%20then%20use%20them%20like%20%5Binput.nameOfInput%5D%20in%20the%20%60prompt%60,%20%60negativePrompt%60,%20%60artStyle.prompt%60,%20etc.%5Cn%5Cn%20%20%20%20scratchpad%20//%20Note:%20the%20'remember'%20option%20storage%20is%20'based%20on'%20this%20'scratchpad'%20name,%20so%20if%20you%20change%20that%20name%20to%20something%20else%20like%20'notepad',%20people%20will%20lose%20all%20their%20saved%20scratchpad%20text.%20But%20it's%20safe%20to%20change%20the%20'label',%20below.%5Cn%20%20%20%20%20%20label%20=%20%5Bicon(%5C%22book%5C%22)%5D%20Notepad%5Cn%20%20%20%20%20%20tip%20=%20NOTES%20here%20will%20NOT%20be%20SHARED%20(if%20you%20want%20to%20share%20notes,%20use%20the%20others%20notepads%20bellow).%5C%5Cn%20%5Bt2i.defaultText.scratchpadTip%5D%20//%20this%20loads%20the%20default%20text,%20but%20you%20can%20delete%20it%20and%20add%20your%20own%20tip.%20Just%20change%20this%20line%20to%20%5C%22tip%20=%20You%20own%20cool%20tips.%5C%22%5Cn%20%20%20%20%20%20type%20=%20paragraph%5Cn%20%20%20%20%20%20remember%20=%20true%20//%20%3C--%20the%20text%20that%20the%20user%20inputs%20will%20be%20remembered%20so%20it's%20still%20there%20even%20if%20they%20close/refresh%20the%20page%5Cn%20%20%20%20%20%20parseVariables%20=%20true%20//%20%3C--%20allows%20people%20to%20write%20%5C%22ANIMAL%20=%20%7Bdog%7Ccat%7Cfrog%7D%5C%22%20in%20the%20scratchpad,%20and%20then%20use%20%5C%22%5BANIMAL%5D%5C%22%20in%20their%20prompt%20to%20get%20a%20random%20one%20of%20those%20animals%5Cn%20%20%20%20%20%20width%20=%20min(750px,%20100%25)%5Cn%20%20%20%20%20%20height%20=%2030vh%5Cn%20%20%20%20%20%20takesUpFullRow%20=%20true%5Cn%20%20%20%20%20%20foldToggleState%20=%20hidden%20//%20or%20'shown'%20if%20you%20want%20it%20to%20start%20shown,%20or%20delete%20this%20line%20if%20you%20don't%20want%20it%20to%20be%20show-able/hide-able%5Cn%20%20%20%20%20%20excludeFromShareLink%20=%20true%5Cn%20%20%20%20%20%20//visible()%20=%3E%5Cn%20%20%20%20%20%20%20%20//return%20Number(localStorage.generateClickCount)%20%3E%201;%20//%20so%20the%20scratchpad%20only%20shows%20up%20after%20they've%20clicked%20generate%20a%20couple%20of%20times%20(to%20reduce%20confusion/clutter%20for%20newbies)%5Cn%20%20%20%20%20%20examples%5Cn%20%20%20%20%20%20%20%20%5Bt2i.defaultText.scratchpadPlaceholder%5D%5Cn%5Cn%20%20%20%20description%5Cn%20%20%20%20%20%20label%20=%20%5Bicon(%5C%22book%5C%22,%20%5C%22color:orange%5C%22)%5D%20Description%20%5Cn%20%20%20%20%20%20tip%20=%20%5Bt2i.defaultText.promptTip%5D.%5C%5Cn%5C%5CnYou%20can%20also%20use%20No%20Style%20in%20Main%20Art%20Style%20to%20store%20your%20own%20prompts%20in%20notebooks%20and%20easily%20call%20them%20with%20STYLE_%20shortcuts.%5C%5CnNote:%20If%20you%20are%20already%20in%20No%20Style,%20you%20may%20need%20to%20change%20the%20option%20in%20Main%20Art%20Style%20to%20something%20else%20and%20re-select%20%5C%22No%20Style%5C%22%20again%20just%20to%20trigger%20the%20option%20in%20the%20window...%5C%5CnNote%202:%20If%20you%20forget%20to%20close%20the%20brackets,%20the%20site%20will%20display%20an%20error%20message.%5Cn%20%20%20%20%20%20type%20=%20paragraph%5Cn%20%20%20%20%20%20remember%20=%20true%20//%20%3C--%20the%20text%20that%20the%20user%20inputs%20will%20be%20remembered%20so%20it's%20still%20there%20even%20if%20they%20close/refresh%20the%20page%5Cn%20%20%20%20%20%20width%20=%20min(750px,%20100%25)%5Cn%20%20%20%20%20%20takesUpFullRow%20=%20true%5Cn%20%20%20%20%20%20useVariables%20=%20true%20//%20See%20comment%20on%20the%20%60parseVariables%20=%20true%60%20line%20on%20the%20%60scratchpad%60%20user%20input,%20above.%20This%20line%20makes%20it%20so%20those%20variables%20can%20be%20used%20in%20this%20text%20box.%5Cn%20%20%20%20%20%20modifiers%20=%20%5Binput.artStyle?.modifiers%20%7C%7C%20null%5D%5Cn%20%20%20%20%20%20modifierUpdates%20=%20event:description.input,%20event:artStyle.change%5Cn%20%20%20%20%20%20enterKeyTriggersGeneration%20=%20true%20//%20%3C--%20can%20still%20use%20shift+enter%20to%20create%20a%20new%20line%5Cn%20%20%20%20%20%20//%20we%20use%20artstyle-specific%20random%20prompts%20if%20available,%20otherwise%20fall%20back%20to%20randomDescriptions%20list:%5Cn%20%20%20%20%20%20examples%20=%20%5Binput.artStyle?.randomPrompt%20%7C%7C%20randomDescription%5D%20//%20%3C--%20the%20placeholder%20examples%20that%20rotate%20in%20the%20text%20box%5Cn%20%20%20%20%20%20random%20=%20%5Binput.artStyle?.randomPrompt%20%7C%7C%20randomDescription%5D%20//%20%3C--%20added%20to%20the%20text%20box%20when%20the%20'random'%20button%20gets%20clicked%5Cn%5Cn%20%20%20%20negative%5Cn%20%20%20%20%20%20label%20=%20%5Bicon(%5C%22cancel%5C%22,%20%5C%22color:red%5C%22)%5D%20Negatives%20(optional)%5Cn%20%20%20%20%20%20tip%20=%20%5Bt2i.defaultText.negativePromptTip%5D%5Cn%20%20%20%20%20%20type%20=%20paragraph%5Cn%20%20%20%20%20%20remember%20=%20true%20//%20%3C--%20the%20text%20that%20the%20user%20inputs%20will%20be%20remembered%20so%20it's%20still%20there%20even%20if%20they%20close/refresh%20the%20page%5Cn%20%20%20%20%20%20width%20=%20min(750px,%20100%25)%5Cn%20%20%20%20%20%20takesUpFullRow%20=%20true%5Cn%20%20%20%20%20%20useVariables%20=%20true%20//%20See%20comment%20on%20%60useVariables%60%20line%20on%20the%20%60description%60%20user%20input,%20above.%5Cn%20%20%20%20%20%20foldToggleState%20=%20shown%5Cn%20%20%20%20%20%20examples%5Cn%20%20%20%20%20%20%20%20Things%20you%20%F0%9D%97%B1%F0%9D%97%BC%F0%9D%97%BB'%F0%9D%98%81%20want%20in%20the%20image.%20For%20example:%20ugly,%20bad%20eyes,%20naked,%20pink%20hair%5Cn%20%20%20%20%20%20%20%20The%20Art%20Style%20already%20have%20some%20negatives,%20so%20don't%20worry%20about%20it%20if%20you%20don't%20know%20how%20AI%20works.%5Cn%20%20%20%20%20%20modifiers%20=%20%5Binput.negselect?.modifiers%20%7C%7C%20null%5D%5Cn%20%20%20%20%20%20modifierUpdates%20=%20event:negative.input,%20event:negselect.change%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20negselect%5Cn%20%20%20%20%20%20label%20=%20%5Bicon(%5C%22key-basic%5C%22,%20%5C%22color:red%5C%22)%5D%20NG%5Cn%20%20%20%20%20%20tip%20=%20Turn%20on%20to%20be%20able%20to%20select%20Negatives%20Pack%20in%20the%20window%20above.%5C%5CnYou%20can%20also%20customize%20a%20list%20and%20save%20it%20in%20Notepad.%20The%20name%20must%20be%20the%20same%20as%20the%20selectable%20options.%20For%20example:%20NEG_LIST1%20=%20a,%20b,%20c.%5C%5CnDon't%20forget%20to%20remove%20the%20comma%20that%20is%20automatically%20added%20at%20the%20end%20of%20the%20last%20prompt.%5Cn%20%20%20%20%20%20type%20=%20select%5Cn%20%20%20%20%20%20remember%20=%20false%5Cn%20%20%20%20%20%20options%5Cn%20%20%20%20%20%20%20%20meta:import%5Cn%20%20%20%20%20%20%20%20%20%20from%20=%20%7Bimport:neg-pack-t%7D%5Cn%20%20%20%20%20%20%20%20%20%20%5Cn%20%20%20%20Gscale%5Cn%20%20%20%20%20%20label%20=%20%5Bicon(%5C%22wrench%5C%22)%5D%20%3Cb%3ECFG%3C/b%3E%5Cn%20%20%20%20%20%20type%20=%20select%5Cn%20%20%20//%20%20%20takesUpFullRow%20=%20true%5Cn%20%20%20%20%20%20tip%20=%20The%20Guidance%20Scale,%20also%20known%20as%20the%20Classifier-Free%20Guidance%20(CFG)%20scale,%20CONTROLS%20HOW%20CLOSELY%20STABLE%20DIFFUSION%20(that%20this%20Perchance%20uses)%20ADHERES%20TO%20THE%20PROVIDED%20TEXT%20PROMPT%20during%20the%20image%20generation%20process.%20IN%20OTHER%20WORDS,%20IT%20DETERMINES%20THE%20EXTENT%20TO%20WHICH%20THE%20GENERATED%20IMAGE%20REFLECTS%20THE%20INPUT%20TEXT.%5C%5CnA%20HIGHER%20VALUE%20of%20the%20Guidance%20Scale%20MEANS%20THAT%20THE%20AI%20WILL%20FOLLOW%20THE%20TEXT%20PROMPT%20MORE%20STRICTLY.%5C%5CnThis%20can%20be%20useful%20when%20you%20want%20the%20generated%20art%20to%20closely%20match%20a%20specific%20description.%20However,%20a%20higher%20Guidance%20Scale%20also%20restricts%20the%20AI%E2%80%99s%20creative%20freedom,%20which%20might%20result%20in%20less%20diverse%20and%20potentially%20lower-quality%20images.%5C%5CnOn%20the%20other%20hand,%20A%20LOWER%20VALUE%20of%20the%20Guidance%20Scale%20GIVES%20THE%20AI%20MORE%20FREEDOM%20TO%20INTERPRET%20THE%20TEXT%20PROMPT%20CREATIVELY.%20This%20can%20lead%20to%20more%20diverse%20and%20unexpected%20results,%20which%20might%20be%20desirable%20in%20certain%20contexts.%5C%5Cn%5C%5CnIn%20this%20Perchance,%20The%20BEST%20RESULTS%20ARE%20BETWEEN%20VALUES%205%20AND%207,%20however%20you%20can%20try%20other%20as%20this%20depends%20on%20your%20prompt%20and%20the%20results%20can%20be%20interesting.%5Cn%20%20%20%20%20%20remember%20=%20true%5Cn%20%20%20%20%20%20options%5Cn%20%20%20%20%20%20%20%20DF(7)%20=%207%5Cn%20%20%20%20%20%20%20%201%5Cn%20%20%20%20%20%20%20%202%5Cn%20%20%20%20%20%20%20%203%5Cn%20%20%20%20%20%20%20%204%5Cn%20%20%20%20%20%20%20%205%5Cn%20%20%20%20%20%20%20%206%5Cn%20%20%20%20%20%20%20%207%5Cn%20%20%20%20%20%20%20%208%5Cn%20%20%20%20%20%20%20%209%5Cn%20%20%20%20%20%20%20%2010%5Cn%20%20%20%20%20%20%20%2011%5Cn%20%20%20%20%20%20%20%2012%5Cn%20%20%20%20%20%20%20%2013%5Cn%20%20%20%20%20%20%20%2014%5Cn%20%20%20%20%20%20%20%2015%5Cn%20%20%20%20%20%20%20%2016%5Cn%20%20%20%20%20%20%20%2017%5Cn%20%20%20%20%20%20%20%2018%5Cn%20%20%20%20%20%20%20%2019%5Cn%20%20%20%20%20%20%20%2020%5Cn%20%20%20%20%20%20%20%2021%5Cn%20%20%20%20%20%20%20%2022%5Cn%20%20%20%20%20%20%20%2023%5Cn%20%20%20%20%20%20%20%2024%5Cn%20%20%20%20%20%20%20%2025%5Cn%20%20%20%20%20%20%20%2026%5Cn%20%20%20%20%20%20%20%2027%5Cn%20%20%20%20%20%20%20%2028%5Cn%20%20%20%20%20%20%20%2029%5Cn%20%20%20%20%20%20%20%2030%5Cn%5Cn%20%20%20%20description2%5Cn%20%20%20%20%20%20label%20=%20%5Bicon(%5C%22level-three-advanced%5C%22,%20%5C%22color:blue%5C%22)%5D%20ExtraDescription%5Cn%20%20%20%20%20%20tip%20=%20To%20use%20this%20you%20may%20need%20to%20put%20a%20comma%20in%20the%20blue%20%C2%A9%20box.%5C%5CnThis%20is%20only%20affected%20by%20EXTRA%20ART%20STYLE%203%20Styles%20if%20one%20is%20enabled.%5C%5Cn%5C%5CnThe%20order%20in%20which%20Perchance%20executes%20the%20prompts%20is%20as%20follows:%20%3CDescription%20and%20Main%20Art%20Style%3E%20+%20%3CDescription%20and%20Extra%20Art%20Style%202%3E%20+%20%3CTHIS%20EXTRA%20DESCRIPTION%3E.%5C%5CnSo%20use%20this%20Extra%20Description%20if%20you%20need%20to%20put%20something%20at%20the%20end%20of%20all%20this,%20or,%20if%20you%20want%20to%20use%20Extra%20Art%20Style%203.%20You%20can%20use%20this%20to%20randomize%20GuidanceScale.%5C%5CnAlso,%20you%20can%20just%20put%20a%20comma%20at%20the%20begining%20instead%20of%20%C2%A9%20box%20if%20you%20are%20not%20using%20Extra%20Art%20Style%203.%20//,%20but%20if%20you%20do%20this,%20don't%20put%20a%20comma%20in%20%C2%A9%20box,%20and%20use%20a%20space%20before%20typing%20the%20guidance.%20%5Cn%20%20%20%20%20%20type%20=%20paragraph%5Cn%20%20%20%20%20%20remember%20=%20true%5Cn%20%20%20%20%20%20width%20=%20min(750px,%20100%25)%5Cn%20%20%20%20%20//%20takesUpFullRow%20=%20true%5Cn%20%20%20%20%20%20useVariables%20=%20true%5Cn%20%20%20%20%20%20foldToggleState%20=%20hidden%5Cn%20%20%20%20%20%20examples%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20realistic,%203d,%20perfil%5Cn%20%20%20%20%20%20%20%20surreal,%20close%20up%5Cn%20%20%20%20%20%20%20%20Click%20on%20%E2%93%98%20above%20to%20details%20%5Cn%5Cn%20%20%20%20%5Cn%20%20%20%20seed%5Cn%20%20%20%20%20%20label%20=%20%5Bicon(%5C%22sprout-emblem%5C%22,%20%5C%22color:#0bb063%5C%22)%5D%20%3Cb%3EImage%20Seed%3C/b%3E%5Cn%20%20%20%20%20%20type%20=%20text%5Cn%20%20%20%20%20%20remember%20=%20true%5Cn%20%20%20%20%20%20foldToggleState%20=%20shown%5Cn%20%20%20%20%20%20takesUpFullRow%20=%20true%20%20%20%20%20%20%5Cn%20%20%20%20%20%20tip%20=%20LEAVE%20BLANK%20TO%20RANDOM%20SEEDS.%5C%5Cn%5C%5CnWhat%20is%20this?%20SEED%20is%20the%20code%20of%20the%20generated%20image%20(see%20the%20image%20information%20and%20check%20the%20%5C%22include%20seed%5C%22%20option.%20You%20can%20generate%20the%20same%20image%20(or%20almost)%20if%20you%20use%20THE%20SAME%20PROMPTs%20(Description%20and%20Negatives)%20+%20Seed%20Number.%5C%5Cn%5C%5CnSEED%20ALSO%20ALLOWS%20YOU%20TO%20%5C%22LOCK%5C%22%20AN%20IMAGE%20INSTEAD%20OF%20GENERATING%20SEVERAL%20RANDOM%20ones.%5C%5CnTRY%20IT%20YOURSELF,%20enter%20some%20number%20in%20the%20Seed%20box%20(any%20number,%20it%20can%20be%201,%204%20or%208523,%20it%20doesn't%20matter),%20and%20set%20it%20to%20generate%2010%20images.%5C%5CnAll%20will%20be%20the%20same%20or%20nearly%20the%20same,%20depending%20on%20the%20prompts.%5C%5CnYou%20can%20also%20make%20small%20changes%20on%20your%20prompts%20to%20see%20how%20it%20can%20sometimes%20be%20useful%20to%20%5C%22fix%5C%22%20small%20things.%20%20%20%20%5Cn%20%20%20%20%20%20examples%5Cn%20%20%20%20%20%20%20%20&lcub;1%7C2%7C3%7C4%7C5&rcub;%5Cn%20%20%20%20%20%20%20%202134753%5Cn%20%20%20%20%20%20%20%20Leave%20it%20blank%20to%20random%20seed/images%5Cn%20%20%20%20%20%20%20%208%5Cn%5Cn%20%20%20%20artStyle%5Cn%20%20%20%20%20%20label%20=%20%5Bicon(%5C%22kaleidoscope%5C%22,%20%5C%22color:orange%5C%22)%5D%20Main%20Art%20Style%5Cn%20%20%20%20%20%20type%20=%20select%5Cn%20%20%20%20%20%20remember%20=%20true%20//%20%3C--%20makes%20it%20so%20the%20selected%20option%20will%20be%20remembered%20even%20if%20the%20user%20refreshes/closes%20the%20page%5Cn%20%20%20%20%20%20options%5Cn%20%20%20%20%20%20%20%20%E2%9E%9B%203D%20(EXPERIMENTAL)%5Cn%20%20%20%20%20%20%20%20%20%20prompt%20=%20(3d%20render:1.2),%203D%20character,%20%5Binput.description%5D,%203d%20cgi%20style,%20detailed%20stylization,%20subtle%20details,%20amazing%20depth,%20non-photorealistic,%20crispy%20render,%20hdr,%20uhd%5Cn%20%20%20%20%20%20%20%20%20%20negative%20=%20worst%20quality,%20low%20resolutions,%20low%20DPI,%20low%20PPI,%20outdated%20graphics,%20blur,%20blurry,%20pixelization,%20bad%20render,%20glitch,%20absurd%20anatomy,%20multilated,%20deformed,%20distorted,%20disfigured,%20(real%20person:1.3,%20actress,%20singer,%20actor,%20real%20woman,%20real%20girl,%20child,%20tinylittlebody),%20realistic%20face,%20photorealistic,%20horrible%20lighting,%20multi-view,%20multiple%20views,%20figure,%20figurine,%20miniature,%20clay,%20bad%20eye,%20lack%20of%20depth,%20low-quality,%20%5Binput.negative%5D%5Cn%20%20%20%20%20%20%20%20%20%20meta:position%20=%205%5Cn%20%20%20%20%20%20%20%20%20%20modifiers%5Cn%20%20%20%20%20%20%20%20%20%20%20%20renders%20and%20styles%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%203D%20Zbrush%20=%20,%20zbrush%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20Blender3D%20=%20,%203d-blender%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20CGI%20Animagion%20=%20,%20(cel-shading%20style),%20incredible%20composition,%20(CGI%20animation%20style)%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20Octane%20Render%20=%20,%20octane%20render%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20Pixar%20Render%20(weak)%20=%20,%20Pixar%20render,%20CGI%20Animation,%20dof,%20(cinematic%20film),%20breathtaking%20Pixar%20short,%20fine%20details%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20Unreal%20Engine%20=%20,%20unreal%20engine%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20meta:import%5Cn%20%20%20%20%20%20%20%20%20%20from%20=%20%7Bimport:t2i-styles%7D%20//%20%3C--%20imports%20a%20bunch%20of%20'default'%20styles%20(you%20can%20delete%20this,%20or%20put%20it%20at%20the%20end,%20below%20'No%20style'%20if%20you%20want)%5Cn%20%20%20%20%20%20%20%20MTG%20Card%20//%20%3C--%20example%20of%20a%20custom%20%5C%22Magic%20The%20Gathering%5C%22%20card%20style%20-%20just%20follow%20this%20format%20and%20add%20as%20many%20of%20them%20as%20you%20want%20to%20this%20'options'%20list%5Cn%20%20%20%20%20%20%20%20%20%20prompt%20=%20%5Binput.description%5D,%20magic%20the%20gathering%20card%5Cn%20%20%20%20%20%20%20%20%20%20negative%20=%20%5Binput.negative%5D,%20low-quality,%20deformed,%20blurry,%20bad%20art%5Cn%20%20%20%20%20%20%20%20%F0%9D%97%A1%F0%9D%97%BC%20%F0%9D%98%80%F0%9D%98%81%F0%9D%98%86%F0%9D%97%B9%F0%9D%97%B2%5Cn%20%20%20%20%20%20%20%20%20%20prompt%20=%20%5Binput.description%5D%5Cn%20%20%20%20%20%20%20%20%20%20negative%20=%20%5Binput.negative%5D%5Cn%20%20%20%20%20%20%20%20%20%20meta:position%20=%205%5Cn%20%20%20%20%20%20%20%20%20%20modifiers%5Cn%20%20%20%20%20%20%20%20%20%20%20%20your%20custom%20styles%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20&lsqb;STYLE_1&rsqb;,%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20&lsqb;STYLE_2&rsqb;,%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20&lsqb;STYLE_3&rsqb;,%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20&lsqb;STYLE_4&rsqb;,%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20&lsqb;STYLE_5&rsqb;,%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20&lsqb;STYLE_6&rsqb;,%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20&lsqb;STYLE_7&rsqb;,%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20&lsqb;STYLE_8&rsqb;,%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20&lsqb;STYLE_9&rsqb;,%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20&lsqb;STYLE_10&rsqb;,%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20meta:import%5Cn%20%20%20%20%20%20%20%20%20%20from%20=%20%7Bimport:x-xx-styles-andothersv1%7D%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20%F0%9F%94%BB%20Vionet20%20Styles%20Below%20%E2%86%93%5Cn%20%20%20%20%20%20%20%20%20%20prompt%20=%20%5Binput.description%5D%5Cn%20%20%20%20%20%20%20%20%20%20negative%20=%20%5Binput.negative%5D%5Cn%20%20%20%20%20%20%20%20meta:import%5Cn%20%20%20%20%20%20%20%20%20%20from%20=%20%7Bimport:vionet20-t2i-styles-importable%7D%5Cn%20%20%20%20%20%20%20%20%5Cn%20%20%20%20case%5Cn%20%20%20%20%20%20label%20=%20%3Cspan%20style%5C%5C=%20color:orange%3E%20%C2%A9%20%3C/span%3E%5Cn%20%20%20%20%20%20type%20=%20text%5Cn%20%20%20%20%20%20tip%20=%20Put%20a%20comma%20here%20to%20use%20the%20Main%20Art%20Style%20together%20with%20Extra%20Art%20Style%202.%5Cn%20%20%20%20%20%20remember%20=%20true%5Cn%20%20%20%20%20%20width%20=%20100%25%5Cn%20%20%20%20%20%20examples%5Cn%20%20%20%20%20%20%20%20%E2%86%91%5Cn%20%20%20%20%20%20%20%20%E2%86%91%E2%86%91%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cn%20%20%20%20artStyle2%5Cn%20%20%20%20%20%20label%20=%20%5Bicon(%5C%22level-four%5C%22,%20%5C%22color:orange%5C%22)%5D%20Extra%20Art%20Style%202%5Cn%20%20%20%20%20%20type%20=%20select%5Cn%20%20%20%20%20%20tip%20=%20It%20does%20the%20same%20thing%20as%20the%20MAIN%20ART%20STYLE,%20it%20repeats%20your%20prompts%20on%20Description%20and%20Negatives,%20but%20to%20use%20it%20you%20need%20to%20put%20a%20comma%20(%20,%20)%20in%20the%20yellow%20%C2%A9%20box%20next%20to%20it.%5C%5Cn%5C%5CnThe%20sequence%20in%20which%20Perchance%20executes%20this%20is%20as%20follows:%20%3CDescription%20and%20Main%20Art%20Style%20with%20negatives%3E%20+%20%3CDescription(again)%20and%20this%20Extra%20Art%20Style%202%20with%20Negatives(again)%3E.%5C%5Cn%5C%5CnLeave%20it%20disabled%20if%20you%20don't%20need%20to%20use%20it.%20%20%20%20%20%20%5Cn%20%20%20%20%20%20remember%20=%20true%20//%20%3C--%20makes%20it%20so%20the%20selected%20option%20will%20be%20remembered%20even%20if%20the%20user%20refreshes/closes%20the%20page%5Cn%20%20%20%20%20%20options%5Cn%20%20%20%20%20%20%20%20-----%5Cn%20%20%20%20%20%20%20%20%20%20prompt%20=%20%5Binput.blanKo%5D%5Cn%20%20%20%20%20%20%20%20%20%20negative%20=%20%5Binput.blanKo%5D%5Cn%20%20%20%20%20%20%20%20meta:import%5Cn%20%20%20%20%20%20%20%20%20%20from%20=%20%7Bimport:t2i-styles%7D%5Cn%20%20%20%20%20%20%20%20meta:import%5Cn%20%20%20%20%20%20%20%20%20%20from%20=%20%7Bimport:x-xx-styles-andothersv1%7D%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20%F0%9F%94%BB%20Vionet20%20Styles%20Below%20%E2%86%93%5Cn%20%20%20%20%20%20%20%20%20%20prompt%20=%20%5Binput.blanKo%5D%5Cn%20%20%20%20%20%20%20%20%20%20negative%20=%20%5Binput.blanKo%5D%5Cn%20%20%20%20%20%20%20%20meta:import%5Cn%20%20%20%20%20%20%20%20%20%20from%20=%20%7Bimport:vionet20-t2i-styles-importable%7D%20%20%20%20%20%20%20%20%20%20%5Cn%5Cn%20%20%20%5Cn%20%20%20%20numImages%5Cn%20%20%20%20%20%20label%20=%20%5Bicon(%5C%22hand%5C%22)%5D%20How%20many?%5Cn%20%20%20%20%20%20type%20=%20select%5Cn%20%20%20%20%20%20remember%20=%20true%20//%20%3C--%20the%20selected%20option%20will%20be%20remembered%20even%20if%20the%20user%20refreshes/closes%20the%20page%5Cn%20%20%20%20%20%20options%5Cn%20%20%20%20%20%20%20%201%20=%201%5Cn%20%20%20%20%20%20%20%202%20=%202%5Cn%20%20%20%20%20%20%20%203%20=%203%5Cn%20%20%20%20%20%20%20%204%20=%204%5Cn%20%20%20%20%20%20%20%205%20=%205%5Cn%20%20%20%20%20%20%20%206%20=%206%5Cn%20%20%20%20%20%20%20%207%20=%207%5Cn%20%20%20%20%20%20%20%208%20=%208%5Cn%20%20%20%20%20%20%20%209%20=%209%5Cn%20%20%20%20%20%20%20%2010%20=%2010%5Cn%20%20%20%20%20%20%20%2011%20=%2011%5Cn%20%20%20%20%20%20%20%2012%20=%2012%5Cn%20%20%20%20%20%20%20%2013%20=%2013%5Cn%20%20%20%20%20%20%20%2014%20=%2014%5Cn%20%20%20%20%20%20%20%2015%20=%2015%5Cn%20%20%20%20%20%20%20%2020%20=%2020%5Cn%20%20%20%20%20%20%20%2025%20=%2025%5Cn%20%20%20%20%20%20%20%2030%20=%2030%5Cn%20%20%20%20%20%20%20%2040%20=%2040%5Cn%20%20%20%20%20%20%20%2050%20=%2050%5Cn%20%20%20%20%20%20%20%2075%20=%2075%5Cn%20%20%20%20%20%20%20%20100%20=%20100%5Cn%20%20%20%20%20%20//visible()%20=%3E%5Cn%20%20%20%20%20//%20%20%20return%20Number(localStorage.generateClickCount)%20%3E%201;%20//%20so%20this%20input%20only%20shows%20up%20after%20they've%20clicked%20generate%20a%20couple%20of%20times%20(to%20reduce%20confusion/clutter%20for%20newbies)%5Cn%5Cn%20%20%20%20shape%5Cn%20%20%20%20%20%20label%20=%20%5Bicon(%5C%22muscle-up%5C%22)%5D%20Shape%5Cn%20%20%20%20%20%20type%20=%20select%5Cn%20%20%20%20%20%20remember%20=%20true%20//%20%3C--%20the%20selected%20option%20will%20be%20remembered%20even%20if%20the%20user%20refreshes/closes%20the%20page%5Cn%20%20%20%20%20%20options%5Cn%20%20%20%20%20%20%20%20Portrait%20(512x768)=%20512x768%5Cn%20%20%20%20%20%20%20%20Square%20(768x768)%20=%20768x768%5Cn%20%20%20%20%20%20%20%20Landscape%20(768x512)%20=%20768x512%5Cn%5Cn%20%20%20%20size%20%5Cn%20%20%20%20%20%20label%20=%20%F0%9F%91%81%EF%B8%8F%E2%80%8D%F0%9F%97%A8%EF%B8%8F%5Cn%20%20%20%20%20%20tip%20=%20Size%20that%20images%20are%20displayed%20on%20your%20device.%5C%5Cn%5C%5CnL%20and%20XL%20are%20only%20for%20computer%20or%20devices%20with%20largue%20screen.%20Sizes%20with%20%25%20have%20errors%20and%20shows%20up%20from%20center%20to%20left.%5Cn%20%20%20%20%20%20type%20=%20select%5Cn%20%20%20%20%20%20remember%20=%20true%5Cn%20%20%20%20%20%20options%5Cn%20%20%20%20%20%20%20%20DF%20=%20100%25%5Cn%20%20%20%20%20%20%20%20s%20=%20170%5Cn%20%20%20%20%20%20%20%20M%20=%20340%5Cn%20%20%20%20%20%20%20%20L%20=%20680%5Cn%20%20%20%20%20%20%20%20XL%20=%201360%5Cn%20%20%20%20%20%20%20%20s%25%20=%2050%25%5Cn%20%20%20%20%20%20%20%20M%25%20=%20125%25%5Cn%20%20%20%20%20%20%20%20L%25%20=%20200%25%5Cn%20%20%20%20%20%20%20%20X%25%20=%20500%25%5Cn%5Cn%20%20%20%20titleImage%5Cn%20%20%20%20%20%20label%20=%20%5Bicon(%5C%22gear-hammer%5C%22,%20%5C%22color:grey%5C%22)%5D%20Title%20or%20Signature%20%5Bicon(%5C%22gear-hammer%5C%22,%20%5C%22color:grey%5C%22)%5D%5Cn%20%20%20%20%20%20tip%20=%20The%20name%20is%20saved%20in%20the%20generated%20images%20AFTER%20you%20press%20the%20GENERATE%20button.%20The%20name%20will%20be%20the%20same%20for%20all%20images%20generated%20in%20the%20same%20batch.%20This%20will%20only%20be%20shown%20in%20the%20gallery%20images%20and%20has%20no%20influence%20on%20the%20prompts.%5Cn%20%20%20%20%20%20type%20=%20text%5Cn%20%20%20%20%20%20remember%20=%20false%5Cn%20%20%20%20%20%20foldToggleState%20=%20shown%5Cn%20%20%20%20%20%20excludeFromShareLink%20=%20true%5Cn%20%20%20%20%20%20examples%5Cn%20%20%20%20%20%20%20%20Type%20a%20name%20for%20your%20image%20here.%5Cn%20%20%20%20%20%20%20%20Name%20is%20saved%20AFTER%20you%20generate.%5Cn%5Cn%20%20%20%20descImage%5Cn%20%20%20%20%20%20label%20=%20%5Bicon(%5C%22gear-hammer%5C%22,%20%5C%22color:#939F9F%5C%22)%5D%20Image%20Description%20%5Bicon(%5C%22gear-hammer%5C%22,%20%5C%22color:#939F9F%5C%22)%5D%20%5Cn%20%20%20%20%20%20tip%20=%20this%20will%20be%20shown%20below%20the%20title.%5Cn%20%20%20%20%20%20type%20=%20text%5Cn%20%20%20%20%20%20remember%20=%20false%5Cn%20%20%20%20%20%20foldToggleState%20=%20hidden%5Cn%20%20%20%20%20%20excludeFromShareLink%20=%20true%5Cn%20%20%20%20%20%20examples%5Cn%20%20%20%20%20%20%20%20Type%20just%20a%20few%20words%20or%20leave%20blank%5Cn%20%20%20%20%5Cn%20%20%20%20blanKo%20//%20%3C--%20I%20made%20this%20to%20disable%20%E2%80%9Cimpurities%E2%80%9C%20from%20the%20-----%20option%20on%20ArtStyle3,%20so%20the%20prompt%20will%20not%20have%20any%20caractere%5Cn%20%20%20%20%20%20label%20=%20%E2%9D%96%5Cn%20%20%20%20%20%20type%20=%20text%5Cn%20%20%20%20%20%20visible()%20=%3E%20false%20//%20%3C--%20false%20so%20the%20description%20window%20dont%20shows%20up%5Cn%5Cn%20%20%20%20//none%20//%20%3C--%20I%20made%20this%20to%20disable%20%E2%80%9Cimpurities%E2%80%9C%20from%20the%20-----%20option%20on%20ArtStyle4,%20so%20the%20prompt%20will%20not%20have%20any%20caractere%5Cn%20%20%20%20%20%20//label%20=%20Neg3%5Cn%20%20%20%20%20%20//type%20=%20text%5Cn%20%20%20%20%20%20//visible()%20=%3E%20false%20//%20%3C--%20false%20so%20the%20description%20window%20dont%20shows%20up%20%20%20%20%20%20%5Cn%5Cn%20%20%5Cn%20%20%20%20%20%20%20%20%5Cn%20%20%5Cn%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20%5Cnroyalty%5Cn%20%20queen%5Cn%20%20king%5Cn%20%20prince%5Cn%20%20princess%5Cn%20%20emperor%5Cn%5Cn%5CnrandomDescription%5Cn%20%20%7Benigmatic%7Cmysterious%7D%20%7Bdemon%7Cangel%7Cghost%7D%20%5Broyalty%5D%20%7Bsitting%20on%7Cstanding%20beside%7D%20%7Btheir%20throne%7Ca%20cosmic%20altar%7D,%20%7Ba%20horde%20of%20minions%7Can%20array%20of%20celestial%20servants%7Ca%20legion%20of%20spectral%20beings%7D%20%7Bbehind%7Cin%20front%20of%7D%20then,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Bwhimsical%7Cserene%7D%20%7Bmermaid%7Cnaiad%7Csiren%7D%20%7Bplaying%20a%20harp%7Csinging%20a%20haunting%20melody%7D%20in%20%7Ban%20underwater%20cave%7Ca%20sunken%20shipwreck%7Ca%20mystical%20sea%20garden%7D%20filled%20with%20%7Bglowing%20plants%7Cbioluminescent%20fish%7Ccolorful%20coral%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Bagile%7Cferocious%7D%20%7Bwolf%7Ctiger%7Cpanther%7D%20%7Bwarrior%7Chunter%7D%20in%20%7Btribal%7Cceremonial%7Cancient%7D%20%7Battire%7Carmor%7D,%20%7Blunging%20with%7Cbrandishing%7Cpreparing%20to%20throw%7D%20%7Ba%20spear%7Ca%20set%20of%20throwing%20knives%7Can%20enchanted%20bow%7D%20in%20%7Ba%20moonlit%20clearing%7Ca%20dense%20forest%7Ca%20misty%20swamp%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Bmysterious%7Cshadowy%7D%20%7Bhooded%7Cmasked%7D%20%7Bnecromancer%7Csummoner%7D%20%7Bsummoning%7Ccontrolling%7D%20%7Bthe%20dead%7Cspirits%7Cphantoms%7D%20in%20%7Ba%20foggy%20graveyard%7Ca%20crypt%20of%20bones%7Ca%20haunted%20cathedral%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Bgraceful%7Celegant%7D%20%7Bswan-girl%7Cpeacock-girl%7Ccrane-girl%7D%20%7Bdancer%7Cacrobat%7D%20in%20%7Ba%20tutu%7Ca%20flowing%20gown%7Ca%20delicate%20kimono%7D,%20%7Bperforming%7Ctwirling%7Cgliding%7D%20%7Bon%20the%20edge%20of%7Cbeside%7Cin%20the%20center%20of%7D%20%7Ba%20serene%20lake%7Ca%20moonlit%20pond%7Ca%20sunlit%20meadow%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Bferocious%7Cintimidating%7D%20%7Bbear-like%7Crhino-like%7Ctiger-like%7D%20%7Bcreature%7Cbeast%7D%20with%20%7Bintricate%20tattoos%7Celaborate%20markings%7Cancient%20runes%7D%20in%20%7Ba%20dense,%20snowy%20forest%7Ca%20rocky%20mountain%20pass%7Ca%20windswept%20tundra%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Bwise%7Cenlightened%7D%20%7Bowl-creature%7Craven-creature%7Ceagle-creature%7D%20%7Bperched%20on%7Cstanding%20beside%7D%20%7Ba%20branch%7Ca%20rune-etched%20stone%7Can%20ancient%20tome%7D,%20%7Bsurrounded%20by%7Caccompanied%20by%7D%20%7Bancient,%20magical%20scrolls%7Cglowing%20crystals%7Cwhispers%20of%20wisdom%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Btiny%7Csmall%7D%20%7Bcurious%7Cinquisitive%7D%20%7Binsect-humanoid%7Cbug-creature%7Carachnid-being%7D%20%7Bexplorer%7Carchaeologist%7D%20%7Bstudying%7Cexamining%7Cdeciphering%7D%20%7Ba%20large,%20mystical%20artifact%7Can%20ancient%20relic%7Ca%20mysterious%20object%7D%20%7Bin%20a%20cavern%7Cin%20a%20forgotten%20temple%7Cin%20a%20hidden%20chamber%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Bcharming%7Cambitious%7Ceccentric%7Cmeticulous%7D%20%7Bsteampunk%7Ccyberpunk%7Cfantasy%7Cmodern-day%7D%20%7Binventor%7Cengineer%7Cmechanic%7Ccraftsman%7D%20%7Btinkering%20with%7Cassembling%7Crepairing%7Cconstructing%7D%20%7Ba%20clockwork%20contraption%7Ca%20futuristic%20gadget%7Ca%20magic-infused%20device%7Can%20ancient%20relic%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Bethereal%7Cfiery%7Cmysterious%7Cferocious%7D%20%7Bphoenix%7Craven%7Ceagle%7Cfalcon%7D%20%7Bsorceress%7Cmage%7Cenchantress%7Cconjurer%7D%20%7Bcasting%7Cweaving%7Cunleashing%7D%20%7Ba%20fiery%7Can%20icy%7Can%20electric%7Ca%20shadowy%7D%20%7Bspell%7Cstorm%7Caura%7Cbarrier%7D%20%7Bfloating%20above%20a%20volcano%7Cstanding%20on%20a%20frozen%20lake%7Chovering%20near%20a%20swirling%20vortex%7Cperched%20on%20a%20mountaintop%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Bregal%7Cstoic%7Cfierce%7Cnoble%7D%20%7Belephant%7Crhinoceros%7Chippopotamus%7Cgiraffe%7D-armor%20%7Bwarrior%7Cguard%7Cknight%7Cpaladin%7D%20%7Bstanding%20guard%20in%7Cpatrolling%20the%20halls%20of%7Cprotecting%20the%20entrance%20to%7Csurveying%20the%20grounds%20of%7D%20%7Ba%20lavish%20palace%7Ca%20grand%20fortress%7Ca%20sacred%20temple%7Can%20ancient%20tomb%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Bbattle-hardened%7Cexperienced%7Ccold-blooded%7Cskilled%7D%20%7Bcyborg%7Candroid%7Cbiomechanical%7Ctechnologically-enhanced%7D%20%7Bbounty%20hunter%7Cassassin%7Cmercenary%7Ctracker%7D%20%7Bscanning%7Csearching%7Cinterrogating%7Cinvestigating%7D%20%7Ba%20crowded%20spaceport%7Can%20alien%20marketplace%7Ca%20desolate%20wasteland%7Ca%20hidden%20outpost%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Bgentle%7Cnurturing%7Ccompassionate%7Ccaring%7D%20%7Btree%7Cflower%7Cvine%7Cwater%7D-druid%20%7Bcradling%7Ctending%20to%7Cnursing%7Cprotecting%7D%20%7Ba%20newborn%20animal%7Ca%20wounded%20creature%7Ca%20lost%20child%7Ca%20fragile%20lifeform%7D%20%7Bin%20her%20arms%7Cin%20a%20nest%7Cin%20a%20cocoon%7Cin%20a%20protective%20shell%7D%20%7Bin%20a%20lush%20forest%7Cby%20a%20serene%20pond%7Cat%20a%20hidden%20glade%7Cwithin%20a%20mystical%20grove%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Bfierce%7Cunyielding%7Cmighty%7Cdauntless%7D%20%7Bgargoyle%7Ctroll%7Cogre%7Cstone%20elemental%7D%20%7Bwarrior%7Cguardian%7Cdefender%7Cberserker%7D%20%7Bperched%20on%7Cguarding%7Cscaling%7Cclinging%20to%7D%20%7Ba%20gothic%20cathedral%7Ca%20crumbling%20fortress%7Ca%20towering%20cliff%7Can%20ancient%20monument%7D%20%7Bready%20to%20pounce%7Csurveying%20its%20territory%7Cpreparing%20to%20strike%7Cwatching%20for%20intruders%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Bseductive%7Cbloodthirsty%7Cmesmerizing%7Calluring%7D%20%7Bvampire%7Csuccubus%7Cdemon%7Csorceress%7D%20%7Bcountess%7Cqueen%7Cmistress%7Cenchantress%7D%20%7Bsipping%7Cdrinking%7Crelishing%7Cindulging%20in%7D%20%7Ba%20goblet%20of%20blood%7Ca%20chalice%20of%20souls%7Ca%20flask%20of%20shadows%7Ca%20cup%20of%20life%20essence%7D%20%7Bin%20her%20candlelit%20lair%7Catop%20a%20throne%20of%20bones%7Cwithin%20a%20hidden%20alcove%7Cbeside%20a%20pool%20of%20crimson%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Badorable%7Cmischievous%7Cspirited%7Cenchanting%7D%20%7Bwoodland%7Csnowy%7Cdesert%7Ccoastal%7D%20%7Belf%7Csprite%7Cdruid%7Cfairy%7D%20%7Bplaying%7Cdancing%20with%7Cconducting%7Cserenading%7D%20%7Ba%20magical%20flute%7Ca%20mystical%20harp%7Ca%20celestial%20violin%7Ca%20whimsical%20cello%7D%20%7Bin%20an%20enchanted%20grove%7Con%20a%20sun-dappled%20glade%7Cby%20a%20crystal-clear%20lake%7Cunder%20a%20moonlit%20waterfall%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Bcybernetic%7Cmechanical%7Cbiomechanical%7Ctechnologically-enhanced%7D%20%7Bdragon%7Cgriffin%7Cwyvern%7Cbasilisk%7D%20%7Brider%7Cpilot%7Cnavigator%7Cwarrior%7D%20%7Bsoaring%20high%20above%7Czipping%20through%7Cgliding%20over%7Cweaving%20between%7D%20%7Ba%20futuristic%20cityscape%7Ca%20neon-lit%20metropolis%7Ca%20post-apocalyptic%20wasteland%7Ca%20sprawling%20urban%20jungle%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Bfierce%7Ccunning%7Cagile%7Cstealthy%7D%20%7Bvixen%7Chuman%7Celven%7Corc%7D%20%7Barcher%7Cassassin%7Cwarrior%7Cmage%7D%20%7Btaking%20aim%20from%7Cgracefully%20leaping%20behind%20cover%20in%7Crunning%20in%7Csurveying%7D%20%7Ba%20forest%7Can%20ancient%20temple%7Ca%20snow-covered%20battleground%7Ca%20rooftop%20in%20a%20bustling%20city%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Bwistful%7Cbrooding%7Csorrowful%7Cmysterious%7D%20%7Bghost%7Cundead%7Cspectral%7Cliving%7D%20%7Bpirate%7Csailor%7Ccaptain%7Cnavigator%7D%20%7Bgazing%20out%20over%7Cexploring%7Chaunting%7Csearching%7D%20%7Ba%20moonlit%20ship%20graveyard%7Ca%20foggy%20harbor%7Can%20abandoned%20lighthouse%7Ca%20rocky%20shoreline%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Bstoic%7Cgrizzled%7Cancient%7Cunyielding%7D%20%7Bice%7Cfire%7Cearth%7Cair%7D-%7Bgiant%7Ctitan%7Cgolem%7Cwraith%7D%20%7Bblacksmith%7Carmorer%7Cweaponsmith%7Cenchanter%7D%20%7Bforging%7Cshaping%7Ccreating%7Cimbuing%7D%20%7Ba%20mighty%20weapon%7Can%20intricate%20armor%7Ca%20powerful%20artifact%7Ca%20magical%20talisman%7D%20%7Bin%20a%20frozen%20forge%7Camidst%20a%20volcanic%20crater%7Cwithin%20an%20enchanted%20cave%7Catop%20a%20floating%20island%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Bspirited%7Ceager%7Cstealthy%7Cdetermined%7D%20%7Bninja%7Csamurai%7Cwarrior%7Cassassin%7D%20%7Bfox-girl%7Cwolf-girl%7Ccat-girl%7Cbear-girl%7D%20%7Bpoised%20to%20strike%7Cready%20for%20action%7Cwaiting%20in%20ambush%7Cperforming%20a%20ritual%7D%20%7Bin%20a%20shadowy%20bamboo%20grove%7Cin%20a%20moonlit%20glade%7Cat%20the%20edge%20of%20a%20cliff%7Cwithin%20a%20hidden%20dojo%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Bbattle-scarred%7Cseasoned%7Clegendary%7Cconfident%7D%20%7Borc%7Cgoblin%7Ctroll%7Chuman%7D%20%7Bchieftain%7Cwarlord%7Ccommander%7Ctactician%7D%20%7Brallying%7Cleading%7Cinspiring%7Cdirecting%7D%20%7Bhis%7Cher%7D%20troops%20%7Bbeneath%20a%20war-torn%20sky%7Cin%20a%20grim%20battlefield%7Cupon%20a%20desolate%20wasteland%7Cin%20the%20heart%20of%20a%20besieged%20fortress%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Bmystical%7Cenigmatic%7Cdisciplined%7Cpowerful%7D%20%7Btime-traveling%7Cdimension-hopping%7Creality-warping%7Cteleporting%7D%20%7Bmonk%7Cpriest%7Cmage%7Cprophet%7D%20%7Bmeditating%7Ccontemplating%7Cchanting%7Cperforming%20a%20ritual%7D%20%7Bat%20the%20edge%20of%7Cwithin%20the%20halls%20of%7Con%20the%20crumbling%20steps%20of%7D%20%7Ban%20ancient%20ruin%7Ca%20forgotten%20tomb%7Ca%20sacred%20shrine%7Ca%20mysterious%20temple%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Bdashing%7Ccharismatic%7Cdaring%7Cintrepid%7D%20%7Bairship%7Csky%7Cstar%7Csteam%7D-pilot%20%7Bcaptain%7Cnavigator%7Cengineer%7Cadventurer%7D%20%7Bnavigating%7Cflying%7Csoaring%7Cdodging%7D%20%7Ba%20treacherous%20sky%7Ca%20perilous%20storm%7Ca%20chaotic%20airspace%7Can%20otherworldly%20realm%7D%20%7Bwith%20a%20telescopic%20lens%7Cthrough%20a%20complex%20instrument%7Cusing%20a%20magical%20compass%7Cguided%20by%20celestial%20bodies%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Botherworldly%7Ceerie%7Cstrange%7Cethereal%7D%20%7Bmoth%7Cbutterfly%7Cfirefly%7Cdragonfly%7D-%7Blike%7Cinspired%7D%20%7Boracle%7Cseer%7Cprophet%7Cdiviner%7D%20%7Bfloating%7Chovering%7Cdrifting%7Cdancing%7D%20%7Bin%7Cthroughout%7Camong%7D%20%7Ba%20cavern%20filled%20with%20glowing%20crystals%7Ca%20grove%20of%20luminescent%20trees%7Ca%20haunted%20marsh%7Ca%20mystical%20waterfall%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Bcunning%7Csly%7Cplayful%7Cmysterious%7D%20%7Btrickster%7Cdeceiver%7Cillusionist%7Cshapeshifter%7D%20%7Bgod%7Cgoddess%7Cspirit%7Centity%7D%20%7Bdisguised%20as%7Cimpersonating%7Cmasquerading%20as%7Cmimicking%7D%20%7Ba%20humble%20merchant%7Ca%20weary%20traveler%7Ca%20royal%20emissary%7Can%20eccentric%20scholar%7D%20%7Bin%20a%20bustling%20marketplace%7Cat%20a%20lively%20festival%7Cwithin%20a%20grand%20palace%7Cin%20a%20shadowy%20tavern%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Bdaring%7Cfearless%7Cbold%7Cadventurous%7D%20%7Bdesert%7Cjungle%7Ctundra%7Cmountain%7D%20%7Bexplorer%7Carchaeologist%7Ctreasure%20hunter%7Cadventurer%7D%20%7Bunearthing%7Cdiscovering%7Cexamining%7Crevealing%7D%20%7Ban%20ancient%20relic%7Ca%20forgotten%20artifact%7Ca%20hidden%20treasure%7Ca%20priceless%20gem%7D%20%7Bin%20a%20long-lost%20tomb%7Cwithin%20a%20crumbling%20ruin%7Cat%20the%20heart%20of%20a%20mysterious%20labyrinth%7Camongst%20a%20forgotten%20civilization%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Bresourceful%7Csurvivor%7Cbrave%7Cexpert%7D%20%7Bpost-apocalyptic%7Cdystopian%7Cfuturistic%7Cruined%7D%20%7Bscavenger%7Chunter%7Cgatherer%7Crunner%7D%20%7Bforaging%20for%7Csearching%20for%7Ccollecting%7Csalvaging%7D%20%7Bsupplies%7Cresources%7Ctechnology%7Csurvivor%7D%20%7Bin%20an%20abandoned%20city%7Camidst%20a%20twisted%20wasteland%7Cthrough%20a%20radioactive%20jungle%7Cwithin%20a%20crumbling%20metropolis%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Brebellious%7Ccourageous%7Cdefiant%7Cstrong-willed%7D%20%7Balien%7Cinterstellar%7Cextraterrestrial%7Cspacefaring%7D%20%7B%5Broyalty%5D%7Cwarrior%7Cdiplomat%7Csorceress%7D%20leading%20%7Ba%20daring%20escape%7Ca%20covert%20mission%7Ca%20fierce%20battle%7Ca%20desperate%20charge%7D%20%7Bon%7Cin%7Caboard%7Cthrough%7D%20%7Ban%20enemy%20spaceship%7Ca%20cosmic%20prison%7Ca%20heavily%20fortified%20starbase%7Ca%20massive%20interstellar%20cruiser%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Bnightmare%7Cdream%7Cillusion%7Cphantasm%7D-wielding%20%7Bsorcerer%7Cenchanter%7Cwitch%7Cwarlock%7D%20%7Bcasting%7Csummoning%7Cweaving%7Cconjuring%7D%20%7Bdark%7Chaunting%7Cbewitching%7Centrancing%7D%20%7Billusions%7Cspells%7Cvisions%7Cfantasies%7D%20%7Bin%7Cthroughout%7Cwithin%7Camong%7D%20%7Ba%20dream-like%20landscape%7Ca%20surreal%20realm%7Ca%20twisted%20mindscape%7Can%20enchanted%20forest%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Bcharismatic%7Croguish%7Crugged%7Ccunning%7D%20%7Bspace%7Cstellar%7Cinterstellar%7Cintergalactic%7D%20%7Bpirate%7Csmuggler%7Cbounty%20hunter%7Ccriminal%7D%20%7Bcaptain%7Cfirst%20mate%7Cgunslinger%7Csaboteur%7D%20%7Bplotting%7Cplanning%7Cscheming%7Corchestrating%7D%20%7Ba%20daring%20heist%7Ca%20brazen%20theft%7Ca%20cunning%20deception%7Ca%20reckless%20gamble%7D%20%7Bin%20a%20neon-lit%20cantina%7Cat%20a%20shadowy%20auction%7Cwithin%20a%20high-security%20vault%7Caboard%20a%20luxury%20space%20liner%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Bwarrior%7Cbard%7Cscholar%7Cphilosopher%7D-%7Bpoet%7Cauthor%7Cscribe%7Cstoryteller%7D%20%7Bcomposing%7Creciting%7Cwriting%7Ccrafting%7D%20%7Ba%20battle%20hymn%7Ca%20war%20story%7Ca%20heroic%20ballad%7Ca%20heartfelt%20elegy%7D%20%7Bin%20the%20aftermath%20of%7Camong%20the%20ruins%20of%7Cbeside%20the%20fallen%20of%7Cin%20the%20shadows%20of%7D%20%7Ba%20great%20victory%7Ca%20devastating%20defeat%7Ca%20legendary%20siege%7Can%20epic%20struggle%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Bblind%7Cvision-impaired%7Csightless%7Cclairvoyant%7D%20%7Bseeress%7Coracle%7Cprophetess%7Cdiviner%7D%20%7Bguarded%20by%7Cprotected%20by%7Caccompanied%20by%7Caided%20by%7D%20%7Ba%20loyal%7Ca%20devoted%7Can%20otherworldly%7Ca%20magical%7D%20%7Bcreature%7Ccompanion%7Cfamiliar%7Cguardian%7D%20%7Bin%7Cwithin%7Camong%7Cat%7D%20%7Ba%20mystic%20temple%7Ca%20hidden%20sanctuary%7Ca%20sacred%20grove%7Ca%20secluded%20shrine%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Benigmatic%7Cdeep-sea%7Caquatic%7Cmarine%7D%20%7Bmermaid%7Csiren%7Cdruid%7Csprite%7D%20%7Bluring%7Ctempting%7Ccalling%20to%7Centhralling%7D%20%7Bsailors%7Cexplorers%7Cwanderers%7Cadventurers%7D%20%7Bwith%7Cthrough%7Cby%7Cusing%7D%20%7Bher%20haunting%20siren%20song%7Cher%20mesmerizing%20voice%7Cher%20bewitching%20melodies%7Cher%20captivating%20harmonies%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Bfearless%7Cdauntless%7Crelentless%7Cintrepid%7D%20%7Bgladiator%7Cfighter%7Ccombatant%7Cchampion%7D%20%7Bfacing%20off%20against%7Cbattling%7Cconfronting%7Cchallenging%7D%20%7Ba%20monstrous%20beast%7Ca%20fearsome%20opponent%7Ca%20terrifying%20creature%7Can%20unstoppable%20enemy%7D%20%7Bin%7Cwithin%7Camong%7Cat%7D%20%7Ba%20roaring%20arena%7Ca%20blood-soaked%20colosseum%7Ca%20thundering%20amphitheater%7Ca%20frenzied%20battlefield%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Barachnid%7Cinsect%7Creptile%7Cavian%7D-%7Blike%7Cinspired%7D%20%7Bhumanoid%7Ccreature%7Cbeing%7Cmorph%7D%20%7Bassassin%7Chunter%7Cwarrior%7Cpredator%7D%20%7Bstalking%7Ctracking%7Cpursuing%7Cambushing%7D%20%7Bprey%7Cenemies%7Ctargets%7Cadversaries%7D%20%7Bin%20the%20depths%20of%7Camong%7Cthroughout%7Cwithin%7D%20%7Ba%20web-filled%20lair%7Ca%20dense%20jungle%7Ca%20twisted%20maze%7Ca%20subterranean%20cavern%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Bheroic%7Cbrave%7Cdetermined%7Cselfless%7D%20%7Bfirefighter%7Crescuer%7Cguardian%7Csavior%7D%20%7Bcarrying%7Cguiding%7Cleading%7Cprotecting%7D%20%7Ba%20child%7Can%20elderly%20person%7Can%20injured%20person%7Ca%20lost%20soul%7D%20%7Bto%20safety%7Cfrom%20danger%7Cthrough%20the%20chaos%7Cout%20of%20the%20inferno%7D%20%7Bin%7Cwithin%7Camong%7Cat%7D%20%7Ba%20blazing%20inferno%7Ca%20collapsing%20building%7Ca%20fiery%20explosion%7Ca%20smoky%20haze%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Broguish%7Crisk-taking%7Cdaring%7Cskilled%7D%20%7Bspace%7Cinterstellar%7Ccosmic%7Cstellar%7D%20%7Bsmuggler%7Cpilot%7Cnavigator%7Cengineer%7D%20%7Bdodging%7Cmaneuvering%7Cavoiding%7Cescaping%7D%20%7Ban%20asteroid%20belt%7Ca%20black%20hole%7Ca%20supernova%7Ca%20cosmic%20storm%7D%20%7Bin%20an%20agile%20starship%7Caboard%20a%20nimble%20vessel%7Cusing%20a%20high-speed%20craft%7Cthrough%20a%20high-performance%20shuttle%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Bfierce%7Ccunning%7D%20%7Bvixen%7Chuman%7Celven%7Corc%7D%20%7Barcher%7Cassassin%7D%20%7Btaking%20aim%20from%7Cgracefully%20leaping%20behind%20cover%20in%7Crunning%20in%7D%20%7Ba%20forest%7Can%20ancient%20temple%7Ca%20snow-covered%20battleground%7Ca%20rooftop%20in%20a%20bustling%20city%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Bsultry%7Cplayful%7D%20%7Bcatgirl%7Cwolf-girl%7Cfox-girl%7D%20in%20a%20%7Btight%20jumpsuit%7Cbattle%20armor%7Cflowing%20dress%7D,%20%7Bperched%20on%7Ccrouching%20on%7Cstanding%20on%7D%20%7Ba%20rooftop%7Ca%20tree%20branch%7Ca%20cliff%7D%20%7Bat%20night%7Cduring%20a%20storm%7Cin%20the%20moonlight%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Bpowerful%7Cimpressive%7Cmagnificent%7Cawe-inspiring%7D%20%7Bstorm%7Cwind%7Cthunder%7Clightning%7D%20%7Bgoddess%7Cdemigoddess%7Cavatar%7Cpriestess%7D%20%7Bsummoning%7Crallying%7Ccalling%20forth%7Cgathering%7D%20%7Bher%20fury%7Cher%20wrath%7Cher%20might%7Cher%20power%7D%20%7Bin%7Camong%7Cwithin%7Cat%7D%20%7Bthe%20heart%20of%7Cthe%20center%20of%7Cthe%20eye%20of%7D%20%7Ba%20tempest%7Ca%20hurricane%7Ca%20cyclone%7Ca%20maelstrom%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Bgentle%7Ccompassionate%7Ckind%7Cnurturing%7D%20%7Bhealer%7Ccleric%7Cpriestess%7Cshaman%7D%20%7Btending%20to%7Ccaring%20for%7Chealing%7Ccomforting%7D%20%7Bthe%20injured%7Cthe%20wounded%7Cthe%20sick%7Cthe%20weary%7D%20%7Bin%7Cwithin%7Camong%7Cat%7D%20%7Ba%20serene%7Ca%20peaceful%7Ca%20tranquil%7Ca%20sacred%7D%20%7Bgrove%7Cclearing%7Coasis%7Csanctuary%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Bmystical%7Cpowerful%7Cancient%7Cmasterful%7D%20%7Bsand%7Cearth%7Cstone%7Cnature%7D-%7Bsorcerer%7Cwizard%7Cwarlock%7Cmage%7D%20%7Bsummoning%7Cconjuring%7Ccreating%7Cforming%7D%20%7Ba%20whirlwind%7Can%20avalanche%7Ca%20dust%20storm%7Ca%20landslide%7D%20%7Bin%7Camong%7Cwithin%7Cat%7D%20%7Ba%20harsh%20desert%20landscape%7Ca%20rocky%20canyon%7Ca%20barren%20wasteland%7Ca%20towering%20mountain%20range%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Beerie%7Cghostlike%7Chaunting%7Cmysterious%7D%20%7Bdancer%7Cperformer%7Cartiste%7Cacrobat%7D%20%7Bgliding%7Cspinning%7Cfloating%7Cdrifting%7D%20%7Bacross%7Con%7Caround%7Cupon%7D%20%7Ba%20dark%7Ca%20misty%7Ca%20shadowy%7Ca%20foggy%7D%20%7Bstage%7Cplatform%7Carena%7Cperformance%20space%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Benigmatic%7Cshadowy%7Csinister%7Cinvisible%7D%20%7Bshadow%7Cspirits%7Cghosts%7Cecho%7D%20%7Bpuppeteer%7Cstoryteller%7Cweaver%7Cartist%7D%20%7Bcasting%7Ccreating%7Cmanipulating%7Ccontrolling%7D%20%7Bintricate%7Cmagical%7Cmysterious%7Ccomplex%7D%20%7Bsilhouettes%7Cshadows%7Cpatterns%7Cfigures%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Bcybernetic%7Cmechanized%7Cbionic%7Chi-tech%7D%20%7Bsamurai%7Cninja%7Cwarrior%7Cfighter%7D%20%7Bclashing%7Cdueling%7Clocking%7Cengaging%7D%20%7Bswords%7Cblades%7Cweapons%7Carms%7D%20%7Bwith%7Cagainst%7Cin%20combat%20with%7D%20%7Ba%20rival%7Can%20enemy%7Ca%20challenger%7Can%20opponent%7D%20%7Bin%7Cwithin%7Camong%7Cat%7D%20%7Ba%20neon-soaked%20Tokyo%7Ca%20futuristic%20cityscape%7Ca%20hi-tech%20metropolis%7Ca%20cyberpunk%20dystopia%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Bwizened%7Cseasoned%7Cknowledgeable%7Cgenius%7D%20%7Balchemist%7Cchemist%7Ctinkerer%7Cinventor%7D%20%7Bbrewing%7Cmixing%7Ccrafting%7Ccombining%7D%20%7Ba%20mysterious%20potion%7Can%20unpredictable%20elixir%7Ca%20powerful%20solution%7Can%20unstable%20concoction%7D%20%7Bin%7Cwithin%7Camong%7Cat%7D%20%7Ba%20cluttered%20laboratory%7Ca%20hidden%20workshop%7Ca%20secret%20alchemy%20den%7Can%20arcane%20study%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Bvisionary%7Cinspired%7Cimaginative%7Cambitious%7D%20%7Barchitect%7Cdesigner%7Cplanner%7Cbuilder%7D%20%7Bstudying%7Cexamining%7Cpondering%7Cconsidering%7D%20%7Bher%7Chis%7D%20plans%20%7Bfor%7Cof%7Cto%20create%7D%20%7Ban%20awe-inspiring%20city%7Ca%20futuristic%20metropolis%7Ca%20utopian%20society%7Ca%20dreamlike%20landscape%7D%20%7Bof%20the%20future%7Cin%20a%20distant%20world%7Cbeyond%20imagination%7Con%20a%20far-off%20planet%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Bancient%7Cageless%7Csentinel%7Ctimeless%7D%20%7Bstone%7Crock%7Ccrystal%7Cobsidian%7D%20%7Bguardian%7Cprotector%7Cwatcher%7Cwarden%7D%20%7Bawakening%7Crising%7Cemerging%7Cintervening%7D%20%7Bto%20protect%7Cto%20defend%7Cto%20safeguard%7Cto%20preserve%7D%20%7Ba%20crumbling%20temple%7Can%20ancient%20ruin%7Ca%20sacred%20shrine%7Ca%20forgotten%20fortress%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Bcosmic%7Cstellar%7Ccelestial%7Cinterstellar%7D%20%7Bjellyfish-like%7Csquid-like%7Coctopus-like%7Canemone-like%7D%20%7Bcreature%7Cbeing%7Centity%7Clifeform%7D%20%7Bdrifting%7Cfloating%7Cgliding%7Cswimming%7D%20%7Bamongst%7Cthrough%7Cwithin%7Cbetween%7D%20%7Bthe%20stars%7Cthe%20cosmos%7Cthe%20galaxies%7Cthe%20nebulas%7D%20%7Bin%20deep%20space%7Cin%20the%20void%7Cbeyond%20the%20known%20universe%7Cin%20uncharted%20realms%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Bskilled%7Cmaster%7Cnovice%7D%20%7Bmartial%20artist%7Cwarrior%7D%20%7Bpracticing%20her%20kata%7Cperforming%20a%20high%20kick%7Cmeditating%7D%20on%20%7Ba%20peaceful%20mountaintop%7Ca%20windswept%20cliff%7Ca%20tranquil%20beach%7Ca%20serene%20meadow%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Bbrooding%7Cconfident%7Cstoic%7Cpensive%7D%20%7Bhorned%20warrior%7Cdemon%7Chalf-dragon%7D%20%7Bking%7Cqueen%7D%20%7Bsurveying%7Cscanning%7Cobserving%7D%20%7Bhis%7Cher%7D%20%7Bconquered%20lands%7Ckingdom%7Cterritory%7D%20from%20%7Ba%20cliffside%7Ca%20tall%20tower%7Ca%20castle%20balcony%7Ca%20hilltop%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Btriumphant%7Cdetermined%7Centhusiastic%7Cbold%7D%20%7Bexplorer%7Cadventurer%7Cpioneer%7D%20%7Bplanting%20her%20flag%7Cstaking%20her%20claim%7D%20on%20%7Bthe%20peak%7Cthe%20summit%7Cthe%20top%7D%20of%20a%20%7Bnewly%20discovered%20world%7Cmountain%7Cuncharted%20territory%7Cremote%20island%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Bmechanical%7Cclockwork%7Crobotic%7D%20%7Bbird-craftswoman%7Cengineer%7Ccreator%7D%20%7Bmeticulously%7Ccarefully%7Cexpertly%7D%20%7Bassembling%7Ccrafting%7Cbuilding%7D%20%7Bher%7Chis%7D%20%7Bavian%7Cmechanical%7Cflying%7D%20%7Bcreations%7Ccontraptions%7Cinventions%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Bexiled%7Cwandering%7Clost%7D%20%7Bandroid%7Crobot%7Ccyborg%7D%20%7Bwanderer%7Cexplorer%7D%20%7Bgazing%20upon%7Ccontemplating%7Cobserving%7D%20the%20%7Bruins%7Cremains%7Cwreckage%7D%20of%20%7Bhis%7Cher%7D%20%7Blost%20civilization%7Cforgotten%20city%7Cdesolate%20world%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Bjovial%7Canimated%7Ccharming%7Cspirited%7D%20%7Btavern%20bard%7Cminstrel%7Crhapsodist%7Cstoryteller%7D%20%7Bcaptivating%7Centertaining%7Cenchanting%7D%20%7Ban%20audience%7Ca%20crowd%7Conlookers%7D%20with%20%7Ba%20rousing%20tale%7Can%20epic%20ballad%7Ca%20heartfelt%20story%7D%20of%20%7Badventure%7Clove%7Ctriumph%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Bsolemn%7Cwatchful%7Cprotective%7Cdevoted%7D%20%7Bguardian%7Cangel%7Cspirit%7D%20%7Bwatching%20over%7Cobserving%7Ckeeping%20an%20eye%20on%7D%20%7Bher%7Chis%7D%20%7Bcharge%7Cward%7D%20from%20%7Ba%20hidden%20vantage%20point%7Cthe%20shadows%7Cafar%7Cabove%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Bplayful%7Ccurious%7Cmischievous%7Clively%7D%20%7Baquatic%20shapeshifter%7Cmermaid%7Cselkie%7D%20%7Bfrolicking%7Cswimming%7Cdarting%7D%20%7Bamidst%7Cthrough%7Camong%7D%20%7Bshipwrecks%7Ccoral%20reefs%7Csunken%20treasures%7Ckelp%20forests%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Bbold%7Cfearless%7Cdetermined%7Cbrave%7D%20%7Bknight%7Cpaladin%7Cwarrior%7D%20%7Berrant%7Con%20horseback%7D%20%7Bfacing%20down%7Cconfronting%7Cchallenging%7D%20%7Ba%20ferocious%7Ca%20terrifying%7Can%20enormous%7D%20%7Bdragon%7Cbeast%7Cmonster%7Cchimera%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Benchanting%7Cmystical%7D%20%7Bsiren%7Cmermaid%7Csea%20creature%7D%20%7Blounging%7Csitting%7Creclining%7D%20on%20%7Ba%20rocky%20shore%7Ca%20beach%7Can%20ocean%20cliff%7D%20%7Bentrancing%7Ccalling%20to%7Cluring%7D%20%7Bsailors%7Ctravelers%7Cpassersby%7D%20%7Bwith%20her%7Cthrough%20her%7D%20%7Bcrooning%7Csong%7Cvoice%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Benigmatic%7Cshadowy%7Cmysterious%7D%20%7Bwanderer%7Cfigure%7Cstranger%7D%20in%20%7Ba%20hooded%20cloak%7Ca%20long%20coat%7Ca%20shrouded%20mantle%7D%20%7Bbearing%7Cholding%7Cguarding%7D%20an%20%7Bancient%7Cmagical%7Cmysterious%7D%20%7Brelic%7Cartifact%7Cweapon%7Ctalisman%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Bskilled%7Cexperienced%7Cstealthy%7Cdeadly%7D%20%7Bassassin%7Csniper%7Chunter%7D%20%7Bperched%7Chidden%7Ccrouching%7D%20on%20%7Ba%20rooftop%7Ca%20balcony%7Ca%20high%20tower%7D%20%7Bpreparing%20to%20strike%7Ctaking%20aim%7Cwaiting%20patiently%7D%20in%20%7Bthe%20city%7Ca%20bustling%20metropolis%7Ca%20crowded%20town%7D%20below,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Bwhimsical%7Ccloud-shepherd%7Csky%20shepherd%7Cairborne%7D%20%7Bherding%7Cguiding%7Ccorralling%7D%20%7Bsky%7Ccloud%7Cairborne%7D%20%7Bcreatures%7Cbeasts%7D%20in%20a%20%7Bdream-like%7Cfantastical%7Cimaginary%7D%20%7Blandscape%7Csky%7Cworld%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Bvivid%7Cbold%7Ctalented%7D%20%7Bgraffiti%20artist%7Cpainter%7Cstreet%20artist%7D%20%7Badding%20color%7Ccreating%20art%7Cpainting%7D%20on%20%7Ba%20drab%7Ca%20stark%7Ca%20colorless%7D%20%7Bdystopian%7Curban%7Cindustrial%7D%20%7Bcityscape%7Cwall%7Cbuilding%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Brestless%7Ctormented%7Cforlorn%7D%20%7Bspirit%7Cghost%7Cphantom%7D%20%7Bhaunting%7Cwandering%7Croaming%7D%20the%20%7Bhalls%7Ccorridors%7Crooms%7D%20of%20a%20%7Bderelict%7Cabandoned%7Cruined%7D%20%7Bmansion%7Cmanor%7Ccastle%7D%20%7Bcovered%20in%7Covergrown%20with%7Centwined%20with%7D%20%7Bivy%7Cmoss%7Cvines%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Bwistful%7Csomber%7Chopeful%7D%20%7Brain-witch%7Cstorm%20caller%7Cweather%20mage%7D%20%7Bsummoning%7Ccalling%20forth%7D%20a%20%7Bgentle%7Cnourishing%7Csoothing%7D%20%7Bshower%7Crain%7Cdownpour%7D%20in%20a%20%7Bparched%7Csun-scorched%7Cdrought-ridden%7D%20%7Bvillage%7Ctown%7Csettlement%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Bdaring%7Cskilled%7Cfearless%7D%20%7Brope-walker%7Ctightrope%20artist%7Cacrobat%7D%20%7Bperforming%20a%20death-defying%20act%7Cbalancing%20precariously%7D%20%7Bhigh%20above%20a%20bustling%20circus%7Cover%20a%20shark-infested%20pool%7Cat%20the%20edge%20of%20a%20cliff%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Bvenerated%7Crevered%7Ctalented%7D%20%7Btattoo%20artist%7Cink%20master%7D%20%7Betching%20a%20sacred%20design%7Cdrawing%20an%20intricate%20pattern%7D%20%7Bon%20a%20willing%20devotee%7Con%20a%20canvas%20of%20human%20skin%7D%20%7Bin%20a%20crowded%20parlor%7Cin%20a%20dimly-lit%20room%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Bferocious%7Ccommanding%7D%20%7Blion-tamer%7Cbeast-master%7D%20%7Bdisplaying%20her%20mastery%20over%7Cwrestling%20with%7D%20%7Bpowerful%20beasts%7Cfierce%20lions%7D%20%7Bin%20a%20crowded%20arena%7Con%20a%20makeshift%20stage%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Benigmatic%7Cmysterious%7D%20%7Bstranger%7Cwanderer%7D%20in%20a%20%7Bgas-mask%7Chazmat%20suit%7D%20%7Bwandering%7Cexploring%7D%20%7Ba%20toxic%20wasteland%7Ca%20post-apocalyptic%20city%7Ca%20barren%20landscape%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Bserene%7Cdiligent%7D%20%7Bscribe%7Cscholar%7D%20%7Btranscribing%7Ccopying%7D%20%7Ban%20ancient,%20mystical%20tome%7Ca%20sacred%20manuscript%7D%20%7Bin%20a%20shadowy%20library%7Cby%20candlelight%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Bmischievous%7Cplayful%7D%20%7Bcandy-mage%7Csweet%20sorcerer%7D%20%7Bconjuring%7Ccreating%7D%20%7Bsweet%20treats%7Cdelicious%20confections%7D%20%7Bin%20a%20whimsical%20workshop%7Cinside%20a%20magical%20gingerbread%20house%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Bdaring%7Cadventurous%7D%20%7Btreasure%20hunter%7Carchaeologist%7D%20%7Bleaping%20across%7Cnavigating%7D%20%7Bperilous%20chasms%7Ctrap-laden%20tunnels%7D%20%7Bin%20a%20trap-laden%20temple%7Cinside%20an%20ancient%20pyramid%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Bcelestial%7Cnoble%7D%20%7Bsky-knight%7Cairborne%20warrior%7D%20%7Bsoaring%20through%7Cgliding%20among%7D%20%7Bthe%20clouds%7Cthe%20skies%7D%20%7Bon%20the%20back%20of%20a%20great%20eagle%7Cracing%20atop%20an%20enormous%20falcon%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Bmelancholy%7Cheartbroken%7D%20%7Bghost%20dancer%7Cphantom%20ballerina%7D%20%7Bperforming%20a%20haunting%20ballet%7Cdancing%20gracefully%7D%20%7Bin%20an%20abandoned%20theater%7Con%20a%20moonlit%20stage%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Bcosmic%7Cintrepid%7D%20%7Bexplorer%7Castronaut%7D%20%7Bgazing%20upon%7Cadmiring%7D%20%7Bthe%20wonders%20of%20the%20universe%7Ca%20supernova%20up%20close%7D%20%7Bfrom%20her%20star-bound%20ship%7Cthrough%20the%20viewport%20of%20a%20space%20station%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Bregal%7Cradiant%7D%20%7Bsun-empress%7Csolstice%20queen%7D%20%7Breigning%20over%7Ccommanding%7D%20%7Bher%20dominion%7Cher%20solar%20kingdom%7D%20%7Bbasking%20in%7Cabsorbing%7D%20%7Bthe%20light%20of%20her%20star%7Cthe%20power%20of%20the%20sun%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Bspirited%7Ccharismatic%7D%20%7Bstreet%20magician%7Cillusionist%7D%20%7Bcaptivating%7Centrancing%7D%20%7Bhis%20audience%7Ca%20curious%20crowd%7D%20%7Bwith%20impossible%20feats%7Cwith%20mind-bending%20tricks%7D%20%7Bon%20a%20busy%20boardwalk%7Cin%20a%20lively%20marketplace%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Bstoic%7Cbrooding%7D%20%7Blava-giant%7Cigneous%20titan%7D%20%7Blumbering%7Ctrudging%7D%20%7Bthrough%20a%20desolate%20volcanic%20landscape%7Cacross%20a%20blackened,%20lava-strewn%20plain%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Bdaring%7Cgraceful%7D%20%7Bacrobat%7Caerialist%7D%20%7Bswinging%7Claunching%20herself%7D%20%7Bhigh%20above%7Ctowards%7D%20%7Ba%20cheering,%20gasping%20crowd%7Crapt%20onlookers%7D%20%7Bin%20a%20grand%20circus%20tent%7Camidst%20festival%20decorations%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Bnocturnal%7Cmoonlit%7D%20%7Bwanderer%7Cexplorer%7D%20%7Bcautiously%20navigating%7Cmaking%20her%20way%7D%20%7Bthrough%20a%20shadowy%20forest%7Cpast%20eerie,%20twisted%20trees%7D%20%7Bby%20moonlight%7Cunder%20a%20starry%20sky%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Bcunning%7Cdeceptive%7D%20%7Bshape-shifter%7Cmorpher%7D%20%7Bflickering%20between%7Cshifting%20through%7D%20%7Bforms%7Cshapes%7D%20%7Bin%20a%20dimly%20lit%20alley%7Cbehind%20a%20veil%20of%20shadows%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Bseasoned%7Cbattle-hardened%7D%20%7Bgladiator%7Cwarrior%7D%20%7Bfacing%20down%7Cchallenging%7D%20%7Bher%20opponents%7Cfierce%20adversaries%7D%20%7Bin%20a%20blood-stained%20arena%7Con%20the%20sands%20of%20a%20coliseum%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Bsecretive%7Ccommuning%7D%20%7Bdruid%7Cforest%20witch%7D%20%7Bcommuning%20with%7Cspeaking%20to%7D%20%7Bthe%20spirits%20of%20the%20forest%7Cancient%20guardians%7D%20%7Baround%20her%7Cin%20a%20clearing%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Bcelestial%7Csky-bound%7D%20%7Bcartographer%7Cmapmaker%7D%20%7Bmapping%20the%20heavens%7Ccharting%20the%20stars%7D%20%7Bfrom%20a%20floating%20tower%7Cin%20a%20high-altitude%20observatory%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Bclockwork%7Cmechanical%7D%20%7Bknight%7Cguardian%7D%20%7Bdefending%20the%20realm%7Cstanding%20guard%7D%20%7Bwith%20his%20intricate%20mechanical%20armor%7Cclad%20in%20his%20gear-powered%20suit%7D%20%7Bat%20the%20gates%20of%20a%20fortified%20city%7Cin%20the%20halls%20of%20a%20castle%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Bworld-weary%7Ctime-torn%7D%20%7Btime%20traveler%7Cchrononaut%7D%20%7Bcontemplating%7Cpondering%7D%20%7Bthe%20consequences%20of%20his%20actions%7Cthe%20impact%20of%20his%20journey%7D%20%7Bat%20the%20edge%20of%20time%7Cin%20the%20vortex%20of%20a%20cosmic%20storm%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Bethereal%7Cenchanting%7D%20%7Bforest%20spirit%7Cwoodland%20druid%7D%20%7Btending%20to%7Ccaring%20for%7D%20%7Bthe%20plants%20and%20creatures%7Cthe%20flora%20and%20fauna%7D%20%7Bwithin%20her%20care%7Cin%20her%20magical%20glade%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Bcourageous%7Cbold%7D%20%7Bastronaut%7Ccosmonaut%7D%20%7Bplanting%20a%20flag%7Cstaking%20their%20claim%7D%20%7Bon%20a%20distant,%20alien%20world%7Con%20the%20surface%20of%20an%20uncharted%20moon%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Bcelestial%7Cbrilliant%7D%20%7Binventor%7Cengineer%7D%20%7Bcrafting%7Cconstructing%7D%20%7Bintricate%20orreries%20and%20astrolabes%7Ccomplex%20celestial%20devices%7D%20%7Bin%20his%20workshop%7Cin%20a%20starlit%20observatory%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Benigmatic%7Ccryptic%7D%20%7Bfog-weaver%7Cmist-mancer%7D%20%7Bweaving%20the%20mists%7Cspinning%20the%20fogs%7D%20%7Binto%20intricate,%20swirling%20patterns%7Cthrough%20a%20graceful%20dance%7D%20%7Bon%20a%20moonlit%20lake%7Cin%20a%20haunted%20marsh%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Bavian%7Cbird-like%7D%20%7Bfortune%20teller%7Cseer%7D%20%7Binterpreting%20the%20flight%7Cdecoding%20the%20patterns%7D%20%7Bof%20her%20flock%7Cin%20the%20skies%20above%7D%20%7Bin%20a%20mystic%20divination%7Cthrough%20ancient%20prophecy%7D%20%7Bon%20a%20windswept%20cliff%7Cin%20a%20hidden%20valley%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Bwind-whisperer%7Cbreeze-bender%7D%20%7Bsummoning%7Ccalling%20forth%7D%20%7Ba%20gentle%20breeze%7Ca%20gust%20of%20wind%7D%20%7Bwith%20a%20wave%20of%20her%20hand%7Cthrough%20an%20elegant%20dance%7D%20%7Bin%20a%20field%20of%20swaying%20grass%7Camongst%20rustling%20leaves%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Burchin-like%7Cspiny%7D%20%7Bcreature%7Ccritter%7D%20%7Bscavenging%20for%7Csearching%20for%7D%20%7Bprecious%20trinkets%7Clost%20treasures%7D%20%7Bin%20a%20murky%20undersea%20cavern%7Cin%20a%20sunken%20shipwreck%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Bmythical%7Clegendary%7D%20%7Bbeast-master%7Ccreature-tamer%7D%20%7Bharnessing%7Ccontrolling%7D%20%7Bthe%20raw%20power%7Cthe%20wild%20spirit%7D%20%7Bof%20his%20untamed%20charges%7Cof%20his%20ferocious%20animals%7D%20%7Bin%20a%20rugged%20wilderness%7Con%20a%20desolate%20plain%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Baquatic%7Cmerfolk%7D%20%7Bwarrior%7Cguardian%7D%20%7Bdefending%7Cprotecting%7D%20%7Bher%20watery%20domain%7Can%20underwater%20city%7D%20%7Bfrom%20invading%20marauders%7Cagainst%20dark%20forces%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Bcyber-punk%7Cfuturistic%7D%20%7Bhacker%7Ctechnomancer%7D%20%7Binfiltrating%7Cbreaching%7D%20%7Ba%20heavily-guarded%20virtual%20fortress%7Ca%20fortified%20digital%20stronghold%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20%7Bmystical%7Cotherworldly%7D%20%7Bsand-walker%7Cdune-navigator%7D%20%7Btraversing%20the%20dunes%7Cjourneying%20across%20the%20sands%7D%20%7Bwith%20her%20loyal,%20camel-like%20steed%7Con%20the%20back%20of%20a%20giant%20sandworm%7D%20%7Bin%20the%20heart%20of%20a%20vast%20desert%7Cwithin%20a%20windswept%20expanse%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait,%20close%20up%5Cn%20%20%7Bspirited%7Cdetermined%7D%20%7Blocomotive%20engineer%7Ctrain%20conductor%7D%20%7Bguiding%7Cdriving%7D%20%7Bher%20steam-powered%20train%7Ca%20futuristic%20monorail%7D%20%7Bacross%20the%20frontier%7Cover%20a%20breathtaking%20chasm%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait,%20close%20up%5Cn%20%20%7Bprophetic%7Cvisionary%7D%20%7Bstargazer%7Castronomer%7D%20%7Binterpreting%7Cdeciphering%7D%20%7Bthe%20stories%20written%7Cthe%20messages%20hidden%7D%20%7Bin%20the%20constellations%7Camong%20the%20stars%7D%20%7Bin%20a%20celestial%20observatory%7Cunder%20a%20star-filled%20sky%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait,%20close%20up%5Cn%20%20%7Benigmatic%7Cmysterious%7D%20%7Bflame-weaver%7Cfire-dancer%7D%20%7Bbending%20the%20fire%7Cmanipulating%20the%20flames%7D%20%7Bto%20her%20will%7Cthrough%20her%20movements%7D%20%7Bin%20a%20mesmerizing%20dance%7Cin%20a%20breathtaking%20performance%7D%20%7Bat%20a%20moonlit%20festival%7Cinside%20a%20darkened%20chamber%7D,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait,%20close%20up%5Cn%20%20%7Bandrogynous%7Cunorthodox%7D%20individual%20of%20%7Bindeterminate%7Cmixed%7Cambiguous%7D%20ethnicity,%20%7Bshaved%20head%7Cbuzz%20cut%7D,%20%7Bicy%20blue%7Cstormy%20grey%7Cpiercing%20green%7D%20eyes,%20%7Bseptum%7Clip%7Ceyebrow%7D%20piercing,%20wearing%20a%20%7Bbrightly%20colored%7Cvividly%20patterned%7Ceclectic%7D%20scarf%20and%20oversized%20glasses,%20reading%20a%20book%20in%20a%20%7Bcozy%7Cquiet%7Crustic%7D%20library,%20close%20up%5Cn%20%20%7Bteenage%7Cyoung%20adult%7D%20%7Bafrican%7Ccaribbean%7Cafro-american%7D%20girl,%20natural%20%7Bafro%7Ccoiled%7Ccurly%7D%20hair,%20%7Balmond%7Cround%7D%20shaped%20brown%20eyes,%20dimpled%20smile,%20wearing%20a%20%7Bvibrant%7Cbold%7Ccolorful%7D%20%7Bkitenge%7Cankara%7Ckanga%7D%20head%20wrap,%20%7Bnose%7Cear%7Clip%7D%20ring,%20natural%20sunlight%20filtering%20through,%20close%20up%5Cn%20%20%7Bindian%7Cpakistani%7Cbangladeshi%7D%20woman,%20late%20thirties,%20long%20%7Bauburn%7Cblack%7Cchestnut%7D%20hair,%20%7Bhenna%7Cbangles%7D%20on%20hands,%20%7Bhazel%7Cbrown%7Cgreen%7D%20eyes,%20wearing%20a%20traditional%20%7Bsaree%7Clehenga%7D,%20%7Bgold%7Csilver%7D%20hoop%20earrings,%20profile%20shot,%20illuminated%20by%20%7Bcandlelight%7Csoft%20glow%20of%20lanterns%7Cmoonlight%7D,%20close%20up%5Cn%20%20%7Belder%7Cancient%7Cvenerable%7D%20elven%20male,%20long%20%7Bsilver%7Cwhite%7Cplatinum%7D%20hair,%20deep-set%20%7Bgreen%7Cblue%7Camber%7D%20eyes,%20sharp%20features,%20donning%20an%20%7Bornate%7Cintricate%7Cembroidered%7D%20mantle,%20ear%20cuff%20on%20pointed%20ear,%20%7Bcontemplating%7Cmeditating%7D%20under%20%7Bancient%7Cgiant%7Cwhispering%7D%20tree,%20close%20up%5Cn%20%20%7Beast-asian%7Ckorean%7Cjapanese%7D%20girl,%20late%20teens,%20short%20%7Bpixie%20cut%7Cbob%7D,%20monolid%20%7Bbrown%7Cblack%7D%20eyes,%20%7Bfreckles%7Cclear%20skin%7D,%20wearing%20a%20%7Bbaseball%20cap%20backwards%7Cbeanie%7D,%20oversized%20headphones%20around%20neck,%20%7Bchewing%20bubblegum%7Csipping%20on%20a%20soft%20drink%7D,%20%7Bgraffiti%7Ccityscape%7Cmusic%20club%7D%20background,%20close%20up%5Cn%20%20%7Bmiddle%20eastern%7Carabian%7Cpersian%7D%20man,%20early%2030s,%20%7Bcurly%7Cwavy%7Cmessy%7D%20dark%20hair,%20intense%20%7Bbrown%7Chazel%7Cblack%7D%20eyes,%20wearing%20a%20%7Bkeffiyeh%7Cthobe%7D,%20%7Bgold%7Csilver%7D%20chain%20around%20neck,%20enjoying%20%7Bcoffee%7Ctea%7D%20in%20a%20bustling%20%7Bcaf%C3%A9%7Cbazaar%7Cteahouse%7D,%20close%20up%5Cn%20%20%7Bnative%20american%7Cindigenous%7Cfirst%20nation%7D%20woman,%20mid%2020s,%20long%20straight%20black%20hair,%20%7Bhigh%7Cprominent%7D%20cheekbones,%20wearing%20a%20%7Bturquoise%7Cabalone%7Csilver%7D%20beaded%20necklace,%20%7Bbeaded%7Cfeathered%7D%20headband,%20gazing%20into%20the%20%7Bhorizon%7Cdistance%7D,%20%7Bsunset%7Csunrise%7D%20glow,%20close%20up%5Cn%20%20%7Bcaucasian/east-asian%7Ceurasian%7Chapa%7D%20mixed-race%20male,%20%7Bspiky%7Cmessy%7Cslicked-back%7D%20red%20hair,%20%7Bgrey%7Cgreen%7Chazel%7D%20eyes,%20wearing%20a%20%7Bbeanie%7Ccap%7D%20and%20%7Bflannel%7Cdenim%7D%20shirt,%20earphones%20in,%20%7Bsmirking%7Cgrinning%7D,%20%7Bcity%7Cpark%7Cstreet%7D%20background,%20twilight,%20close%20up%5Cn%20%20%7Bafrican-american%7Cafro-caribbean%7Cafro-latin%7D%20female,%20early%2040s,%20%7Btight%20curls%7Cbraids%7D,%20glasses,%20wearing%20a%20%7Bcolorful%7Cpatterned%7D%20headscarf%20and%20%7Bchunky%7Cbold%7D%20statement%20necklace,%20looking%20through%20a%20%7Bwindow%7Cbookstore%20window%7D,%20%7Brainy%7Cstormy%7D%20weather,%20close%20up%5Cn%20%20%7Bitalian%7Cfrench%7Cspanish%7D%20man,%20late%2050s,%20%7Bgreying%7Csalt%20and%20pepper%7D%20hair,%20warm%20%7Bbrown%7Chazel%7D%20eyes,%20wearing%20a%20%7Bfedora%7Ctrilby%7D%20and%20a%20%7Bwell-tailored%7Cclassic%7D%20suit,%20%7Bgold%7Csilver%7D%20cufflinks,%20watching%20the%20world%20go%20by%20from%20a%20%7Bcaf%C3%A9%20terrace%7Csidewalk%20bench%7Cpark%20seat%7D,%20close%20up%5Cn%20%20%7Baboriginal%20australian%7Coceanian%7Cpolynesian%7D%20woman,%20early%2030s,%20deep-set%20%7Bbrown%7Cblack%7D%20eyes,%20wearing%20a%20%7Bfloral%7Cvibrant%7Ctraditional%7D%20dress,%20%7Bfeather%7Cshell%7D%20earrings,%20%7Blaughing%20heartily%7Csmiling%20warmly%7D,%20under%20a%20%7Beucalyptus%7Cbanyan%7Csacred%20fig%7D%20tree,%20%7Bsunny%7Cbright%7D%20day,%20close%20up%5Cn%20%20%7Bdwarven%7Cgnomish%7Chalfling%7D%20male,%20%7Bstocky%7Cstout%7D%20build,%20%7Bfiery%20red%7Cdirty%20blonde%7Cdark%20brown%7D%20beard,%20deep-set%20%7Bblue%7Cgreen%7Chazel%7D%20eyes,%20wearing%20a%20%7Bcopper%7Csilver%7Cbronze%7D%20armband,%20%7Bfur%7Cleather%7D%20cloak,%20in%20a%20%7Bcavernous%7Ccosy%7Clively%7D%20beer%20hall,%20engaged%20in%20a%20hearty%20conversation%5Cn%20%20%7Bkorean%7Cjapanese%7Cchinese%7D%20woman,%20mid%2020s,%20long%20straight%20%7Bblonde%7Cbrunette%7Cblack%7D%20hair,%20%7Bdoe-eyed%7Cmesmerizing%20gaze%7D,%20wearing%20a%20%7Bberet%7Cbeanie%7D%20and%20a%20%7Bpeekaboo%20cutout%7Ca-line%7D%20dress,%20lost%20in%20thought,%20in%20a%20%7Bvintage%7Ccozy%7Cchic%7D%20caf%C3%A9,%20%7Bsoft%7Cambient%7Cnatural%7D%20lighting,%20close%20up%5Cn%20%20%7Bmaori%7Cpolynesian%7Cnative%20hawaiian%7D%20man,%20early%2040s,%20%7Bmoko%7Ctraditional%7D%20facial%20tattoo,%20%7Bintense%7Cpenetrating%7D%20gaze,%20wearing%20%7Bbone%7Cshell%7D%20pendant,%20%7Bwoven%7Ctraditional%7D%20cloak,%20leaning%20against%20a%20%7Bcarved%20meeting%20house%7Ctotem%20pole%7Csacred%20tree%7D,%20%7Bearly%20morning%7Clate%20evening%7D%20mist,%20close%20up%5Cn%20%20%7Beastern-european%7Crussian%7Cukrainian%7D%20woman,%20late%2020s,%20short%20%7Bwavy%7Ccurly%7D%20brunette%20hair,%20%7Bglassy%7Cstormy%7D%20grey%20eyes,%20wearing%20a%20%7Bfur-lined%7Cdown%7D%20coat,%20%7Bwoolen%7Cleather%7D%20mittens,%20catching%20%7Bsnowflakes%7Cdrifts%20of%20snow%7D,%20in%20a%20%7Bsnow-covered%20square%7Cwinter%20wonderland%7Cicy%20park%7D,%20close%20up%5Cn%20%20%7Bandrogynous%7Cmasculine%7D%20orc,%20%7Bmuscular%7Cburly%7D%20build,%20%7Btusked%7Cfanged%7D,%20wearing%20a%20%7Bnose%7Clip%7D%20ring,%20%7Bleather%7Cchainmail%7D%20harness,%20under%20the%20%7Bmoonlight%7Cstarry%20sky%7D,%20in%20a%20%7Bfantasy%7Clegendary%7D%20battlefield,%20%7Banticipating%7Cpreparing%20for%7D%20the%20battle,%20close%20up%5Cn%20%20%7Bcaribbean%7Cafro-caribbean%7Cwest%20indian%7D%20woman,%20mid%2030s,%20%7Bbraided%7Ccurly%7D%20hair%20adorned%20with%20%7Bcolorful%7Cshiny%7D%20beads,%20wearing%20a%20%7Bhalter%7Ccrop%7D%20top,%20%7Bnose%7Clip%7D%20stud,%20enjoying%20a%20%7Bstreet%20carnival%7Cbeach%20party%7D,%20%7Bmusic%7Claughter%7D%20in%20the%20air,%20close%20up%5Cn%20%20%7Bcaucasian%7Cirish%7Cscottish%7D%20woman,%20early%2020s,%20%7Bcurly%7Cwavy%7D%20red%20hair,%20%7Bfreckles%7Crosy%20cheeks%7D,%20%7Bsea-green%7Cemerald%7D%20eyes,%20wearing%20a%20%7Bfloral%7Cpaisley%7D%20bandana,%20%7Blounging%7Crelaxing%7D%20in%20a%20%7Bsunlit%20meadow%7Cblossoming%20orchard%7D,%20%7Bdaisy%20chain%7Cwildflower%20bouquet%7D%20around%20her%20wrist,%20close%20up%5Cn%20%20%7Bethiopian%7Ceritrean%7Csomalian%7D%20man,%20late%20teens,%20%7Btight%20curls%7Cshort%20afro%7D,%20wearing%20a%20%7Btraditional%7Cethnic%7D%20outfit,%20%7Bpendant%7Cbeaded%7D%20necklace,%20in%20a%20bustling%20%7Bmarketplace%7Cbazaar%7D,%20%7Bhaggling%20with%7Cconversing%20with%7D%20vendors,%20%7Bvibrant%7Cexotic%7D%20colors,%20close%20up%5Cn%20%20%7Bbrazilian%7Cvenezuelan%7Cargentinian%7D%20woman,%20early%20%7B30s%7C40s%7D,%20%7Bwavy%7Ccurly%7Cstraight%7D%20caramel%20hair,%20tan%20skin,%20wearing%20a%20%7Bvibrant%7Ccolorful%7Cfloral%7D%20maxi%20dress,%20%7Bchunky%7Cbeaded%7Cmetal%7D%20bracelets,%20cheerful,%20in%20a%20%7Bbeachside%7Coceanside%7Cseaside%7D%20shack,%20smell%20of%20sea%20salt,%20close%20up%5Cn%20%20%7Bmerman%7Cmermaid%7D,%20%7Bshimmering%7Cglistening%7Cgleaming%7D%20green%20hair,%20%7Bemerald%7Cjade%7Caquamarine%7D%20eyes,%20%7Bturquoise%7Caquamarine%7Csea-green%7D%20tail,%20wearing%20%7Bseashell%7Ccoral%7Cpearl%7D%20necklace,%20under%20the%20sea,%20surrounded%20by%20%7Bcolorful%7Cvibrant%7Cexotic%7D%20coral%5Cn%20%20%7Bfilipino%7Cthai%7Cvietnamese%7D%20man,%20late%20%7Bteens%7C20s%7D,%20%7Btousled%7Cmessy%7Cstyled%7D%20black%20hair,%20wearing%20a%20%7Bbasketball%7Cfootball%7Csports%7D%20jersey,%20laughing,%20%7Burban%7Csuburban%7Cstreet%7D%20basketball%20court,%20%7Btwilight%7Cdusk%7Cevening%7D,%20close%20up%5Cn%20%20%7Birish%7Cscottish%7Cwelsh%7D%20woman,%20early%20%7B30s%7C40s%7D,%20%7Bfiery%7Cauburn%7Cbright%7D%20red%20curls,%20freckles,%20wearing%20a%20%7Btweed%7Cwool%7Cleather%7D%20cap,%20in%20a%20%7Brustic%7Ctraditional%7Cold-fashioned%7D%20pub,%20fire%20crackling,%20close%20up%5Cn%20%20%7Bandrogynous%7Cgender-fluid%7Cnon-binary%7D%20neko,%20white%20cat%20ears,%20%7Bmulti-colored%7Ctwo-toned%7Cheterochromic%7D%20eyes,%20wearing%20a%20%7Bbell%7Cjingle%7Ccharm%7D%20collar,%20in%20a%20%7Bcolorful%7Cneon-lit%7Cfuturistic%7D%20cityscape,%20neon%20lights%5Cn%20%20%7Belderly%7Cmature%7Cold%7D%20chinese%20woman,%20%7Bsilver%7Cgray%7Cwhite%7D%20bun,%20%7Bwise%7Cknowing%7Cpenetrating%7D%20eyes,%20wearing%20a%20%7Bcheongsam%7Cqipao%7D,%20%7Bjade%7Ccoral%7Civory%7D%20bangle,%20in%20a%20%7Bserene%7Ctranquil%7Cpeaceful%7D%20tea%20garden,%20%7Bcherry%20blossoms%7Clotus%20flowers%7Cmagnolia%7D,%20close%20up%5Cn%20%20%7Bafrican-american%7Ccaribbean%7Cafrican%7D%20woman,%20mid%20%7B20s%7C30s%7D,%20%7Bdreadlocks%7Cbraids%7Cafro%7D,%20wearing%20a%20%7Bgraffiti%20print%7Cstreet%20art%20inspired%7Curban%7D%20bomber%20jacket,%20on%20a%20%7Bskateboard%7Croller%20blades%7Cbike%7D,%20%7Bgraffiti%7Cstreet%20art%7Cmural%7D%20wall%20backdrop,%20close%20up%5Cn%20%20%7Belven%7Cfairy%7Cpixie%7D%20princess,%20%7Bgolden%7Cplatinum%7Csunny%7D%20hair,%20%7Bamethyst%7Cviolet%7Clavender%7D%20eyes,%20wearing%20a%20%7Bflower%7Cbutterfly%7Cfairy%7D%20crown,%20in%20an%20%7Benchanted%7Cmagic%7Cfairy%7D%20forest,%20%7Bmagical%7Cethereal%7Csparkling%7D%20glow%5Cn%20%20%7Bmiddle%20eastern%7Carab%7Cpersian%7D%20man,%20early%20%7B20s%7C30s%7D,%20%7Bcurly%7Cwavy%7Cunruly%7D%20hair,%20%7Bintense%7Cpenetrating%7Cdeep-set%7D%20eyes,%20wearing%20a%20%7Bkeffiyeh%7Cshemagh%7D,%20in%20a%20%7Bdesert%7Csand%20dune%7Coasis%7D,%20setting%20sun,%20close%20up%5Cn%20%20%7Bfrench%7Cbelgian%7Cswiss%7D%20woman,%20late%20%7B30s%7C40s%7D,%20%7Bpixie%20cut%7Cshort%20bob%7Cblunt%20cut%7D,%20wearing%20a%20%7Bberet%7Ccap%7Cscarf%7D,%20%7Blace%7Csilk%7Cwool%7D%20scarf,%20in%20a%20%7Bcaf%C3%A9%7Cbistro%7Cpatisserie%7D,%20%7Bcobblestone%7Cold%20town%7Chistoric%7D%20street,%20evening,%20close%20up%5Cn%20%20%7Borc%7Ctroll%7Cgoblin%7D%20woman,%20%7Bgreen%7Cturquoise%7Caquamarine%7D%20skin,%20%7Btusks%7Cfangs%7D,%20wearing%20a%20%7Btribal%7Cceremonial%7Cwarrior%7D%20headdress,%20in%20a%20%7Bwooden%7Cstraw%7Cbamboo%7D%20hut,%20%7Btribal%7Cancient%7Csacred%7D%20paintings%5Cn%20%20%7Bjamaican%7Cbahamian%7Cbarbadian%7D%20man,%20early%20%7B30s%7C40s%7D,%20%7Bdreadlocks%7Ccornrows%7Cafro%7D,%20wearing%20a%20%7Brastacap%7Cbandana%7Cbeanie%7D,%20on%20a%20%7Bhammock%7Cbeach%20chair%7Csun%20lounger%7D,%20%7Bbeach%7Cocean%7Cpalm%7D%20sunset,%20reggae%20music%20in%20the%20air,%20close%20up%5Cn%20%20%7Bnordic%7Cscandinavian%7Cviking%7D%20man,%20late%20%7B20s%7C30s%7D,%20%7Blong%7Cflowing%7Cstraight%7D%20blonde%20hair,%20%7Bpiercing%7Cice-blue%7Cpale%7D%20blue%20eyes,%20wearing%20a%20%7Bfur%7Cleather%7Cwolf%7D%20cape,%20in%20a%20%7Bboat%7Cship%7Clongboat%7D,%20%7Bicy%7Cfrozen%7Cfrigid%7D%20fjord,%20%7Bnorthern%20lights%7Caurora%20borealis%7Cstar-filled%7D%20sky,%20close%20up%5Cn%20%20%7Bjapanese%7Ckorean%7Cmongolian%7D%20foxgirl,%20%7Bauburn%7Cchestnut%7Cmahogany%7D%20hair,%20fox%20ears,%20%7Bamber%7Cgolden%7Cyellow%7D%20eyes,%20wearing%20a%20%7Bkimono%7Cyukata%7D,%20in%20a%20%7Bshrine%7Ctemple%7Cpagoda%7D,%20%7Blantern%7Cmoon%7Cstar%7D%20glow,%20%7Bmischievous%7Cplayful%7Ccheeky%7D%20smile,%20close%20up%5Cn%20%20%7Bgreek%7Croman%7Citalian%7D%20woman,%20early%20%7B50s%7C60s%7D,%20%7Bbrunet%7Cbrown%7Cdark%7D%20hair,%20olive%20skin,%20wearing%20a%20%7Btoga%7Cstola%7Cpeplos%7D,%20in%20an%20%7Bancient%7Cold%7Chistoric%7D%20amphitheater,%20%7BMediterranean%7CAegean%7CAdriatic%7D%20sunset,%20close%20up%5Cn%20%20%7Brussian%7Cukrainian%7Cbelarusian%7D%20man,%20late%20%7B60s%7C70s%7D,%20%7Bbalding%7Cgraying%7Cwhite-haired%7D,%20wearing%20a%20%7Bushanka%7Cfur%20hat%7D,%20playing%20%7Bchess%7Ccheckers%7Cdominoes%7D,%20in%20a%20%7Bpark%7Cpublic%20square%7Cgarden%7D,%20%7Bsnow%20flurries%7Csnowfall%7Cblizzard%7D,%20close%20up%5Cn%20%20%7Bthai%7Ccambodian%7Claotian%7D%20woman,%20mid%20%7B20s%7C30s%7D,%20%7Bsleek%7Cstraight%7Cglossy%7D%20black%20hair,%20wearing%20a%20%7Btraditional%7Csilk%7Chand-woven%7D%20dress,%20%7Bgold%7Csilver%7Cbronze%7D%20armlet,%20in%20a%20%7Btemple%7Cstupa%7Cwat%7D,%20%7Bsaffron-robed%7Cmaroon-robed%7D%20monks,%20close%20up%5Cn%20%20%7Bnative%20american%7Cfirst%20nations%7Cindigenous%7D%20%7Bperson%7Cyouth%7D,%20late%20%7Bteens%7C20s%7D,%20%7Blong%7Cflowing%7Cstraight%7D%20hair,%20wearing%20%7Bfeathered%7Cbeaded%7Cnative%7D%20headdress,%20in%20a%20%7Bmeadow%7Cfield%7Cprairie%7D,%20%7Bdistant%20teepees%7Cmountain%20range%7Cforest%20line%7D,%20%7Bblue%7Cclear%7Csunlit%7D%20skies,%20close%20up%5Cn%20%20%7Bdwarf%7Cgnome%7Chalfling%7D%20woman,%20%7Breddish-brown%7Cauburn%7Crusty%7D%20hair,%20%7Bbraided%7Cknotted%7Ccoiled%7D%20beard,%20wearing%20%7Bleather%7Ciron%7Csteel%7D%20armor,%20in%20a%20%7Bmine%7Ccavern%7Ctunnel%7D,%20%7Bglowing%7Csparkling%7Cradiant%7D%20gems%20around,%20close%20up%5Cn%20%20%7Bethiopian%7Ceritrean%7Csomalian%7D%20girl,%20early%20%7B20s%7C30s%7D,%20%7Bcurly%7Ckinky%7Ccoily%7D%20hair,%20wearing%20%7Bhabesha%20kemis%7Ccotton%20dress%7Ctraditional%20attire%7D,%20in%20a%20%7Bcoffee%20ceremony%7Ctea%20ceremony%7Ctraditional%20ceremony%7D,%20%7Bincense%7Cmyrrh%7Cfrankincense%7D%20smoke,%20close%20up%5Cn%20%20%7Bhispanic%7Ccuban%7Cmexican%7D%20male,%20mid%20%7B20s%7C30s%7D,%20%7Btousled%7Cwavy%7Ccurly%7D%20dark%20hair,%20olive%20skin,%20%7Bbrown%7Cblack%7Cdark%7D%20eyes,%20%7Bunshaven%7Clightly%20stubbled%7D,%20wearing%20a%20%7Bworn%20out%7Cvintage%7Cdistressed%7D%20leather%20jacket,%20%7Bsilver%7Cgold%7D%20hoop%20earring%20in%20%7Bleft%7Cright%7D%20ear,%20laughing%20at%20a%20joke,%20%7Burban%7Cgraffiti-filled%7Cnight-lit%7D%20backdrop,%20close%20up%5Cn%20%20%7Bitalian%7Csicilian%7Cvenetian%7D%20man,%20mid%20%7B40s%7C50s%7D,%20%7Bsalt%20and%20pepper%7Csilvered%7Cgraying%7D%20hair,%20wearing%20a%20%7Btailored%7Cbespoke%7Cfitted%7D%20suit,%20in%20a%20%7Bvineyard%7Cwine%20cellar%7D,%20%7Bwine%20tasting%7Csampling%20cheese%7D,%20close%20up%5Cn%20%20%7Bmaasai%7Czulu%7Csamburu%7D%20warrior,%20early%20%7B30s%7C20s%7D,%20%7Bcornrow%7Cbeaded%7D%20hair,%20wearing%20%7Btraditional%20attire%7Cwarrior%20garb%7D,%20in%20%7Bthe%20savannah%7Copen%20plains%7D,%20%7Bacacia%7Cbaobab%7D%20trees,%20close%20up%5Cn%20%20%7Bfairy%7Cpixie%7Csprite%7D,%20%7Biridescent%7Cshimmering%7Cglistening%7D%20wings,%20%7Bpastel%7Crose-hued%7Cbutterfly-kissed%7D%20hair,%20wearing%20a%20dress%20of%20%7Bpetals%7Cdew-kissed%20cobwebs%7D,%20in%20a%20%7Bmushroom%7Cfairy%7Cpixie%7D%20ring,%20%7Bfireflies%7Cmoonlight%7Cstarlight%7D%20around%5Cn%20%20%7Bcatgirl%7Ckitsune%20girl%7Cnekomimi%20girl%7D,%20%7Blate%20teens%7Cearly%2020s%7D,%20%7Bblonde%7Cstrawberry%20blonde%7Cplatinum%7D%20hair,%20cat%20ears,%20%7Bgolden%7Camber%7Chazel%7D%20eyes,%20wearing%20%7Bschool%7Cacademy%7D%20uniform,%20on%20%7Bschool%20grounds%7Cacademy%20courtyard%7D,%20%7Bsakura%7Ccherry%20blossom%7Cflower-filled%7D%20trees,%20close%20up%5Cn%20%20%7Bmalaysian%7Cindonesian%7Cbruneian%7D%20woman,%20late%20%7B20s%7Cearly%2030s%7D,%20wearing%20a%20%7Bhijab%7Cscarf%7D,%20in%20a%20%7Bbatik%7Cembroidered%7Ctraditional%7D%20dress,%20in%20a%20%7Bbustling%7Clively%7Cbusy%7D%20street,%20%7Bnight%20market%7Cstreet%20food%20stalls%7D,%20close%20up%5Cn%20%20%7Bspanish%7Candalusian%7Cbasque%7D%20man,%20early%20%7B40s%7C50s%7D,%20%7Bslicked-back%7Csmooth%7Ctidy%7D%20hair,%20wearing%20a%20%7Bmatador%7Ctorero%7D%20outfit,%20in%20a%20%7Bbullring%7Ccorrida%7D,%20anticipation%20in%20the%20air,%20close%20up%5Cn%20%20%7Bpolynesian%7Chawaiian%7Ctahitian%7D%20woman,%20early%20%7B30s%7C20s%7D,%20%7Blong%7Cflowing%7Cwavy%7D%20hair,%20wearing%20a%20%7Bhibiscus%7Corchid%7Cplumeria%7D%20lei,%20on%20a%20%7Bbeach%7Cseashore%7D,%20%7Bpacific%7Ctropical%7Cisland%7D%20sunset,%20close%20up%5Cn%20%20%7Bindian%7Cpakistani%7Cnepalese%7D%20woman,%20late%20%7Bteens%7Cearly%2020s%7D,%20%7Blong%7Csilky%7Csmooth%7D%20black%20hair,%20wearing%20%7Bsalwar%20kameez%7Cchuridar%7Cghagra%7D,%20on%20a%20%7Brooftop%7Cterrace%7D,%20flying%20kites,%20%7Bfestival%20of%20kites%7Ccelebration%7D,%20close%20up%5Cn%20%20%7Bcentaur%7Cfaun%7Csatyr%7D,%20%7Bmuscled%7Cstrong%7Csturdy%7D%20torso,%20horse%20body,%20wearing%20a%20%7Bleaf%7Cvine%7Colive%7D%20crown,%20in%20a%20%7Bgrassy%20knoll%7Cmeadow%7Cforest%20glade%7D,%20%7Bwildflowers%7Cbutterflies%7Csunbeams%7D%20around%5Cn%20%20%7Bmongolian%7Ckazakhstani%7Csiberian%7D%20man,%20late%20%7B40s%7C50s%7D,%20wearing%20a%20%7Bdeel%7Ctraditional%20robe%7Cfur-lined%20coat%7D,%20%7Bin%20the%20steppe%7Con%20the%20grassland%7D,%20%7Byurts%7Cnomadic%20tents%7D%20in%20the%20distance,%20%7Beagle%7Chawk%7D%20soaring,%20close%20up%5Cn%20%20%7Bgerman%7Cbavarian%7Caustrian%7D%20woman,%20early%20%7B20s%7C30s%7D,%20%7Bbraided%7Cplaited%7Ctwisted%7D%20blonde%20hair,%20wearing%20%7Bdirndl%7Ctraditional%20dress%7D,%20in%20a%20%7Bbeer%20garden%7Cbrewery%7D,%20%7BOktoberfest%7Cbeer%20festival%7D,%20close%20up%5Cn%20%20%7Bkorean%7Cseoulite%7Cbusanite%7D%20man,%20mid%20%7B20s%7Cearly%2030s%7D,%20%7Bpastel-colored%7Crainbow-hued%7Ccandy-colored%7D%20hair,%20wearing%20a%20%7Bhanbok%7Ctraditional%20robe%7D,%20in%20a%20%7Bpalace%7Croyal%20garden%7D,%20%7Bautumn%20leaves%7Ccherry%20blossoms%7D,%20close%20up%5Cn%20%20%7Bghanaian%7Cnigerian%7Csenegalese%7D%20woman,%20early%20%7B30s%7Clate%2020s%7D,%20%7Bshort%7Ctightly%20curled%7Cnaturally%7D%20curls,%20wearing%20a%20%7Bkente%7Cbatik%7Cankara%7D%20dress,%20in%20a%20%7Blively%7Cvibrant%7Ccolorful%7D%20market,%20vibrant%20colors,%20close%20up%5Cn%20%20%7Bvampire%7Cnosferatu%7Cimmortal%7D,%20%7Bcenturies%7Cdecades%7Cmillennia%7D%20old,%20%7Bslick%7Cshiny%7Cneat%7D%20hair,%20%7Bcrimson%7Cruby%7Cblood%7D%20eyes,%20wearing%20a%20%7Bvelvet%7Csilk%7Cbrocade%7D%20cape,%20in%20a%20%7Bgothic%7Cmajestic%7Cancient%7D%20mansion,%20%7Bfull%20moon%7Cnightfall%7Ctwilight%7D,%20close%20up%5Cn%20%20%7Bfinnish%7Cswedish%7Cnorwegian%7D%20man,%20late%20%7B30s%7C40s%7D,%20%7Bscruffy%7Cwild%7Cbearded%7D,%20wearing%20a%20%7Breindeer%20skin%7Cfur-lined%7Cwool%7D%20coat,%20in%20a%20%7Bsnowy%7Cfrosty%7Cwintry%7D%20forest,%20%7Bnorthern%20lights%7Caurora%20borealis%7Cstarry%20night%7D,%20close%20up%5Cn%20%20%7Bzulu%7Cxhosa%7Cswazi%7D%20woman,%20mid%20%7B20s%7Cearly%2030s%7D,%20wearing%20%7Btraditional%7Chandmade%7Cbeaded%7D%20beads,%20in%20a%20%7Bkraal%7Cvillage%7D,%20%7Bherd%20of%20cattle%7Clivestock%7D,%20close%20up%5Cn%20%20%7Bpersian%7Ciranian%7Cafghan%7D%20woman,%20early%20%7B20s%7C30s%7D,%20%7Bbrown%7Cblack%7Cdark%7D%20hair,%20wearing%20a%20%7Bturquoise%7Cemerald%7Cblue%7D%20hijab,%20in%20a%20%7Bcarpet%7Csilk%7Cspice%7D%20bazaar,%20%7Bexotic%7Centicing%7Cintoxicating%7D%20smells,%20close%20up%5Cn%20%20%7Bceltic%7Cscottish%7Cirish%7D%20man,%20early%20%7B30s%7C40s%7D,%20%7Bred%7Cauburn%7Cginger%7D%20hair,%20wearing%20a%20%7Btartan%7Cwoolen%7Cclan%7D%20kilt,%20on%20a%20%7Bwindy%7Cgrass-covered%7Crolling%7D%20hill,%20%7Bbagpipes%7Cflute%7D%20in%20the%20background,%20close%20up%5Cn%20%20%7Bhawaiian%7Cpolynesian%7Ctahitian%7D%20woman,%20late%20%7Bteens%7Cearly%2020s%7D,%20%7Blong%7Ccurly%7Cflowing%7D%20hair,%20wearing%20a%20%7Bgrass%7Cleaf%7Cfloral%7D%20skirt,%20on%20the%20%7Bbeach%7Cseashore%7D,%20%7Bhula%7Ctraditional%7D%20dance,%20close%20up%5Cn%20%20%7Bmexican%7Ctexan%7Cnew%20mexican%7D%20man,%20mid%20%7B40s%7C50s%7D,%20%7Bmustache%7Cbeard%7D,%20wearing%20a%20%7Bsombrero%7Cwide-brimmed%20hat%7D,%20%7Bzarape%7Cponcho%7D,%20in%20a%20%7Bsleepy%7Chumble%7Cquiet%7D%20village,%20%7Bsiesta%20time%7Cafternoon%20nap%7D,%20close%20up%5Cn%20%20%7Bindonesian%7Cjavanesian%7Cbalinese%7D%20woman,%20early%20%7B30s%7C40s%7D,%20%7Bbatik%7Cfloral%7Ctraditional%7D%20headscarf,%20in%20a%20%7Brice%20paddy%7Cgreen%20field%7D,%20%7Bdistant%20volcano%7Cmountain%20range%7D,%20%7Bsunset%7Cdusk%7D,%20close%20up%5Cn%20%20%7Baustralian%7Caussie%7Coutback%7D%20man,%20late%20%7B20s%7C30s%7D,%20%7Bsun-bleached%7Clight%20brown%7Csandy%7D%20hair,%20wearing%20a%20%7Bbush%7Cleather%7Coutback%7D%20hat,%20in%20a%20%7Bdusty%20outback%7Crugged%20wilderness%7D,%20%7Bkangaroo%7Chopping%20kangaroo%7Cwildlife%7D%20hopping%20by,%20close%20up%5Cn%20%20%7Bcambodian%7Ckhmer%7Csouth%20asian%7D%20woman,%20mid%20%7B20s%7C30s%7D,%20%7Bsleek%7Cdark%7Clong%7D%20hair,%20wearing%20a%20%7Bsampot%7Ctraditional%20dress%7D,%20in%20a%20%7Btemple%7Cancient%20ruin%7D,%20%7Bincense%7Ccandle%7D%20smoke,%20close%20up%5Cn%20%20%7Bargentinian%7Cchilean%7Csouth%20american%7D%20man,%20early%20%7B30s%7C40s%7D,%20%7Bslicked-back%7Cneat%7Ctidy%7D%20hair,%20wearing%20a%20%7Bgaucho%7Ccowboy%7D%20outfit,%20on%20a%20%7Branch%7Cfarm%7D,%20%7Bhorses%7Clivestock%7D%20grazing,%20close%20up%5Cn%20%20%7Becuadorian%7Cperuvian%7Candes%7D%20woman,%20late%20%7Bteens%7Cearly%2020s%7D,%20wearing%20a%20%7Bcolorful%7Cvibrant%7Cwoolen%7D%20poncho,%20in%20a%20%7Bflower%7Coutdoor%7D%20market,%20%7BAndean%7Cmountainous%7D%20mountains,%20close%20up%5Cn%20%20%7Bromanian%7Ctransylvanian%7Ceast%20european%7D%20woman,%20early%20%7B40s%7C30s%7D,%20%7Bbraided%7Cwoven%7Clong%7D%20hair,%20wearing%20a%20%7Bpeasant%20blouse%7Ctraditional%20top%7D,%20in%20a%20%7Bfortified%20church%7Cancient%20chapel%7D,%20%7Bmedieval%7Crustic%7D%20atmosphere,%20close%20up%5Cn%20%20%7Bsamoan%7Cpolynesian%7Cpacific%7D%20man,%20early%20%7B30s%7C40s%7D,%20%7Bmuscular%7Cstrong%7Cwell-built%7D,%20wearing%20a%20%7Blava-lava%7Ctraditional%20cloth%7D,%20on%20a%20%7Bbeach%7Cshore%7D,%20%7BPacific%20Ocean%7Clagoon%7D,%20%7Bsunset%7Cdusk%7D,%20close%20up%5Cn%20%20%7Bscottish%7Chighland%7Cceltic%7D%20woman,%20late%20%7B20s%7Cearly%2030s%7D,%20%7Bred%7Cstrawberry%20blonde%7Cauburn%7D%20curls,%20wearing%20a%20%7Btartan%7Cwoolen%7Cplaid%7D%20shawl,%20on%20a%20%7Bwindy%7Clonely%7Cbare%7D%20moor,%20%7Bbagpipes%7Clonely%20music%7D%20in%20the%20distance,%20close%20up%5Cn%20%20%7Bperuvian%7Candes%7Csouth%20american%7D%20man,%20late%20%7B40s%7C50s%7D,%20wearing%20a%20%7Bchullo%7Cwoolen%20cap%7D,%20in%20a%20%7Bmarket%7Cbazaar%7D,%20%7Bllamas%7Calpacas%7D%20grazing,%20close%20up%5Cn%20%20%7Bvietnamese%7Csoutheast%20asian%7Casiatic%7D%20woman,%20%7B20s%7Clate%20teens%7D,%20%7Blong%7Cflowing%7Cblack%7D%20hair,%20wearing%20an%20%7Bao%20dai%7Ctraditional%20dress%7D,%20in%20a%20%7Blantern-lit%7Cmoonlit%7D%20street,%20%7BTet%20celebration%7CNew%20Year%20celebration%7D,%20close%20up%5Cn%20%20%7Bcyberpunk%7Cfuturistic%7Cpunk%7D%20girl,%20%7Bneon%7Cflaming%7Cluminous%7D%20hair,%20%7Baugmented%20reality%20glasses%7Cholographic%20visor%7Claser%20monocle%7D,%20in%20a%20%7Btechnopolis%7Cmegacity%7Celectron%20city%7D,%20%7Bneon%20lights%7Claser%20beams%7Cholographic%20billboards%7D,%20%7Bgraffiti%7Cposter-covered%7CLED%7D%20walls,%20close%20up%5Cn%20%20%7Bninja%7Csamurai%7Cassassin%7D,%20%7Bmasked%7Chooded%7Chooded%20and%20masked%7D,%20%7Bdarting%7Cpiercing%7Calert%7D%20eyes,%20%7Bshuriken%7Ckunai%7Cninja%20stars%7D%20on%20belt,%20lurking%20in%20the%20%7Bshadows%7Cdarkness%7Cunderbrush%7D,%20%7Bbamboo%7Cpine%7Csakura%7D%20forest,%20%7Bfull%7Ccrescent%7Cnew%7D%20moon,%20close%20up%5Cn%20%20%7Bsuccubus%7Cdemoness%7Cfiend%7D,%20%7Bcrimson%7Cobsidian%7Craven%7D%20hair,%20%7Bblack%7Cdark%7Cshadowy%7D%20wings,%20%7Brevealing%7Csculpted%7Cintricate%7D%20black%20dress,%20in%20a%20%7Bgothic%7Cancient%7Cforbidding%7D%20castle,%20%7Bflickering%7Cdim%7Csputtering%7D%20candles%5Cn%20%20%7Bgreek%7Croman%7Cmythical%7D%20goddess,%20%7Bflowing%7Cdraping%7Cbillowing%7D%20white%20robes,%20%7Bgolden%7Csilver%7Cbronze%7D%20laurel%20crown,%20in%20an%20%7Bancient%7Cmarble%7Cstone%7D%20temple,%20%7Bolive%7Ccypress%7Cpalm%7D%20trees,%20%7Bsetting%7Crising%7Cmidday%7D%20sun,%20close%20up%5Cn%20%20%7Bsteampunk%7Cvintage%7Cretro%7D%20woman,%20%7Bgoggles%7Cmonocle%7Cspectacles%7D,%20%7Bcorset%7Cbodice%7Cvest%7D,%20in%20a%20%7BVictorian%7Cindustrial-era%7Cold-world%7D%20cityscape,%20%7Bsteam-powered%7Cgear-driven%7Cclockwork%7D%20machines,%20%7Bcobblestone%7Cbrick-paved%7Cgravel%7D%20streets,%20close%20up%5Cn%20%20%7Bmuscular%7Ctowering%7Cburly%7D%20tauren,%20%7Btribal%7Cancient%7Cspiritual%7D%20tattoos,%20wearing%20a%20%7Bfur%20kilt%7Cleather%20loincloth%7Chide%20pants%7D,%20in%20a%20%7Bgrassy%20knoll%7Csacred%20site%7Cprairie%7D,%20%7Btowering%7Ccarved%7Cancient%7D%20totem%20poles,%20%7Bsunset%7Cdawn%7Ctwilight%7D%5Cn%20%20%7Battractive%7Cmysterious%7Calluring%7D%20vampire,%20%7Bpale%7Cmoonlit%7Ctranslucent%7D%20skin,%20%7Bslicked%20back%7Cmessy%7Ccurly%7D%20hair,%20%7Bpiercing%7Cglowing%7Cshimmering%7D%20red%20eyes,%20in%20a%20%7BEuropean%7Cmedieval%7Cancient%7D%20castle,%20%7Bfull%7Ccrescent%7Ccloud-covered%7D%20moon,%20close%20up%5Cn%20%20%7Bviking%7Cnorse%7Cwarrior%7D%20warrior,%20%7Bburly%7Cmuscular%7Cbattle-hardened%7D,%20%7Bspear%7Caxe%7Csword%7D,%20wearing%20a%20%7Bfur%20cloak%7Cleather%20armor%7Cwolf%20pelt%7D,%20in%20a%20%7Blongboat%7Cdrakkar%7Cship%7D,%20%7Bicy%20fjord%7Cchurning%20sea%7Ccalm%20lake%7D,%20%7Bnorthern%20lights%7Cstarry%20sky%7Cmisty%20skies%7D,%20close%20up%5Cn%20%20%7Btiefling%7Cdemonic%7Chellborn%7D%20priestess,%20%7Bdark%20purple%7Cburgundy%7Cdeep%20blue%7D%20skin,%20%7Blong%7Ccurved%7Ctwisted%7D%20horns,%20wearing%20a%20%7Bceremonial%7Csacred%7Cornate%7D%20robe,%20in%20a%20%7Bdarkened%7Cshadowy%7Csilent%7D%20chapel,%20%7Bstained%20glass%7Cmosaic%7Cetched%7D%20windows%5Cn%20%20%7Bogre%7Cgiant%7Cbrute%7D,%20%7Blarge%7Cimposing%7Ctowering%7D,%20wearing%20%7Brough%20hide%7Cpatchwork%20leather%7Cthick%20fur%7D%20armor,%20in%20a%20%7Bdank%7Cmurky%7Cfetid%7D%20swamp,%20%7Bbuzzing%7Cswarming%7D%20mosquitoes%5Cn%20%20%7Bfairy%7Cfae%7Cpixie%7D,%20%7Biridescent%7Cshimmering%7Ctranslucent%7D%20wings,%20%7Blong%20wavy%7Ccurly%7Cpixie%20cut%7D%20hair,%20in%20a%20%7Bmushroom%7Cfairy%7Cflower%7D%20ring,%20%7Bforest%7Cglen%7Cmeadow%7D%20glade,%20%7Bfireflies%7Cglow%20worms%7Cmoonbeams%7D%20around,%20close%20up%5Cn%20%20%7Bmermaid%7Csiren%7D,%20%7Bshimmering%7Csparkling%7Cradiant%7D%20tail,%20%7Bflowing%7Ccurly%7Cwavy%7D%20red%20hair,%20%7Bsunning%7Clounging%7Cresting%7D%20on%20a%20rock,%20%7Bazure%7Ccrystal-clear%7Cturquoise%7D%20sea,%20%7Bseagulls%7Calbatrosses%7Cpelicans%7D%20soaring,%20close%20up%5Cn%20%20%7Bdragonborn%7Cdraconian%7Cdrake-blooded%7D,%20%7Bscales%7Cspines%7Cridged%20armor%7D,%20wearing%20a%20%7Bplate%7Cchainmail%7Cscale%7D%20armor,%20in%20a%20%7Bcavern%7Cmountain%20lair%7Chidden%20den%7D,%20hoard%20of%20%7Btreasure%7Cgold%7Cjewels%7D,%20%7Bflickering%7Cblazing%7Cguttering%7D%20torchlight,%20close%20up%5Cn%20%20%7Belven%7Csylvan%7Cwoodland%7D%20ranger,%20%7Blongbow%7Cshortbow%7Ccrossbow%7D,%20%7Bgreen%7Cbrown%7Cforest%7D%20cloak,%20in%20a%20%7Bdense%7Clush%7Cdeep%7D%20forest,%20%7Bancient%7Cmajestic%7Ctowering%7D%20trees,%20%7Brustling%7Cwhispering%7Cswaying%7D%20leaves,%20close%20up%5Cn%20%20%7Bgnome%7Cdwarf%7Chalfling%7D%20tinkerer,%20%7Bgoggles%7Cspectacles%7Cmonocle%7D,%20%7Boveralls%7Cworkwear%7Capron%7D,%20in%20a%20%7Bcluttered%7Cchaotic%7Cbustling%7D%20workshop,%20%7Bgears%20and%20springs%7Ccogs%20and%20wheels%7Cparts%20and%20pieces%7D,%20%7Bsparks%7Cflames%7Cembers%7D%20flying,%20close%20up%5Cn%20%20%7Bamazonian%7Cwarrior%7Cjungle%7D%20warrior,%20%7Btall%7Cstatuesque%7Cmighty%7D%20and%20muscular,%20wearing%20a%20%7Bleather%20cuirass%7Cscale%20armor%7Ccloth%20wrap%7D,%20in%20a%20%7Bjungle%7Crainforest%7Ccanopy%7D%20clearing,%20%7Bparrots%7Cmacaws%7Ctoucans%7D%20squawking,%20close%20up%5Cn%20%20%7Bcybernetic%7Cfuturistic%7Ctechno%7D%20samurai,%20%7Bkatana%7Claser%20sword%7Cmonomolecular%20blade%7D,%20in%20a%20%7Bneo-Tokyo%7Cdystopian%7Cfuturistic%7D%20cityscape,%20%7Bneon%20signs%7Cholo%20ads%7CLED%20billboards%7D,%20%7Brain-soaked%7Cneon-lit%7Cfoggy%7D%20streets,%20close%20up%5Cn%20%20%7Bsorceress%7Cmage%7Cwitch%7D,%20%7Bstaff%7Cwand%7Corb%7D,%20in%20a%20%7Bspellbound%7Cenchanted%7Carcane%7D%20tower,%20%7Bfloating%7Clevitating%7Chovering%7D%20books,%20%7Barcane%7Cmystic%7Cancient%7D%20symbols,%20close%20up%5Cn%20%20%7Btroll%7Corc%7Cgoblin%7D%20shaman,%20%7Btusks%7Cfangs%7Cbone%20piercings%7D,%20wearing%20a%20%7Bbone%7Cclaw%7Ctooth%7D%20necklace,%20in%20a%20%7Bmossy%7Cverdant%7Clush%7D%20grove,%20%7Bspirit%20totems%7Canimal%20spirits%7Cnature%20spirits%7D,%20%7Bglowing%7Cdancing%7Cwhirling%7D%20fireflies%5Cn%20%20%7Bnight%20elf%7Cmoon%20elf%7Cshadow%20elf%7D%20druid,%20%7Bantler%7Cfeather%7Cleaf%7D%20headdress,%20in%20a%20%7Bmoonlit%7Cstarlit%7Cluminescent%7D%20grove,%20%7Bancient%7Csacred%7Cenchanted%7D%20trees,%20%7Bnocturnal%7Cfey%7Cmoon-touched%7D%20creatures%5Cn%20%20%7Bgoblin%7Cimp%7Cgremlin%7D%20rogue,%20%7Bsneaky%7Cwicked%7Csly%7D%20grin,%20in%20a%20%7Bshadowy%7Cnarrow%7Cwinding%7D%20alley,%20%7Bcobblestone%7Cbrick%7Cpaved%7D%20streets,%20%7Bflickering%7Cdim%7Cguttering%7D%20lamps%5Cn%20%20%7Bdwarven%7Cmountain%20dwarf%7Chill%20dwarf%7D%20blacksmith,%20%7Bmuscular%7Cstocky%7Cburly%7D,%20wearing%20an%20%7Bapron%7Cleather%20vest%7Cforge%20guard%7D,%20in%20a%20%7Bforge%7Cfoundry%7Cmetalworks%7D,%20%7Bmolten%20metal%7Chot%20iron%7Cburning%20coal%7D,%20%7Bsparks%7Cflames%7Cembers%7D%20flying,%20close%20up%5Cn%20%20%7Bhalfling%7Chobbit%7Cgnome%7D%20bard,%20%7Blute%7Cflute%7Cviolin%7D,%20in%20a%20%7Bbustling%7Ccrowded%7Clively%7D%20tavern,%20%7Bfrothy%20ales%7Cmugs%20of%20mead%7Ctankards%20of%20beer%7D,%20%7Blively%7Cjaunty%7Cfoot-stomping%7D%20music%5Cn%20%20%7Borc%7Cgoblin%7Ctroll%7D%20warrior,%20%7Bbattle%20axe%7Cwar%20hammer%7Cgreatsword%7D,%20in%20a%20%7Brugged%7Cbarren%7Crocky%7D%20terrain,%20%7Bdistant%7Csnow-capped%7Cjagged%7D%20mountains,%20%7Bdwindling%7Ccrackling%7Cslow-burning%7D%20campfire%5Cn%20%20%7Btiefling%7Cdemonkind%7Chell%20spawn%7D%20rogue,%20%7Bdagger%7Cdirk%7Cstiletto%7D,%20in%20a%20%7Bdimly%20lit%7Cfoggy%7Crain-soaked%7D%20city,%20%7Bnarrow%7Cwinding%7Ccobbled%7D%20streets,%20distant%20%7Bbell%20tolling%7Cclock%20chime%7Cgong%7D%5Cn%20%20%7Btabaxi%7Cfeline%7Ccatfolk%7D%20monk,%20%7Bfeline%7Cbeastial%7Ccat-like%7D%20features,%20in%20a%20%7Bserene%7Cpeaceful%7Cremote%7D%20monastery,%20%7Bdistant%7Csnow-capped%7Cverdant%7D%20mountains,%20%7Bchirping%7Csinging%7Ccalling%7D%20crickets%5Cn%20%20%7Baasimar%7Ccelestial%7Cangelic%7D%20paladin,%20%7Bshining%7Cpolished%7Cradiant%7D%20armor,%20in%20a%20%7Bcathedral%7Cbasilica%7Csanctuary%7D,%20%7Bstained%20glass%7Cmosaic%7Cfrescoed%7D%20windows,%20%7Bcelestial%7Cdivine%7Cheavenly%7D%20light,%20close%20up%5Cn%20%20%7Bkenku%7Cravenfolk%7Ctengu%7D%20ranger,%20%7Bfeathered%7Cplumed%7Cwinged%7D,%20in%20a%20%7Bwooded%7Cleafy%7Cforest%7D%20area,%20%7Brustling%7Cfluttering%7Cwhispering%7D%20leaves,%20%7Bchirping%7Csinging%7Ccalling%7D%20birds%5Cn%20%20%5Cn%5Cn%5Cn%20%22,%22outputTemplate%22:%22%5Cn%3C!DOCTYPE%20html%3E%5Cn%3Chtml%20lang=%5C%22en%5C%22%3E%5Cn%3Chead%3E%5Cn%20%20%3Cmeta%20charset=%5C%22UTF-8%5C%22%3E%5Cn%20%20%3Cmeta%20name=%5C%22viewport%5C%22%20content=%5C%22width=device-width,%20initial-scale=1.0%5C%22%3E%5Cn%20%20%3Ctitle%3EStylish%20Page%3C/title%3E%5Cn%20%20%3Clink%20rel=%5C%22stylesheet%5C%22%20href=%5C%22https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap%5C%22%3E%5Cn%20%20%3Cstyle%3E%5Cn%20%20%20%20:root%20%7B%5Cn%20%20%20%20%20%20--primary-color:%20#00eeff;%5Cn%20%20%20%20%20%20--primary-dark:%20#00a2ff;%5Cn%20%20%20%20%20%20--secondary-color:%20#0088ff;%5Cn%20%20%20%20%20%20--dark-color:%20#0a0a20;%5Cn%20%20%20%20%20%20--light-color:%20#f8f9fa;%5Cn%20%20%20%20%20%20--success-color:%20#00ffdd;%5Cn%20%20%20%20%20%20--info-color:%20#00c3ff;%5Cn%20%20%20%20%20%20--warning-color:%20#00b7ff;%5Cn%20%20%20%20%20%20--danger-color:%20#0070ff;%5Cn%20%20%20%20%20%20--border-radius:%208px;%5Cn%20%20%20%20%20%20--box-shadow:%200%202px%2010px%20rgba(0,%20238,%20255,%200.3);%5Cn%20%20%20%20%20%20--transition:%20all%200.2s%20ease;%5Cn%20%20%20%20%20%20--glow-color-1:%20#00eeff;%5Cn%20%20%20%20%20%20--glow-color-2:%20#0088ff;%5Cn%20%20%20%20%20%20--glow-color-3:%20#0055ff;%5Cn%20%20%20%20%20%20--glow-color-4:%20#00d2ff;%5Cn%20%20%20%20%20%20--bg-dark:%20#0a0a20;%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20/*%20Simplified%20glass%20theme%20variables%20*/%5Cn%20%20%20%20%20%20--glass-opacity:%200.15;%5Cn%20%20%20%20%20%20--glass-border-opacity:%200.25;%5Cn%20%20%20%20%20%20--glass-blur:%2010px;%5Cn%20%20%20%20%20%20--glass-border-width:%201px;%5Cn%20%20%20%20%20%20--glass-background:%20rgba(255,%20255,%20255,%200.05);%5Cn%20%20%20%20%20%20--glass-shadow:%200%204px%2015px%20rgba(0,%20238,%20255,%200.2);%5Cn%20%20%20%20%20%20--glass-border-color:%20rgba(255,%20255,%20255,%200.12);%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20/*%20Responsive%20spacing%20variables%20*/%5Cn%20%20%20%20%20%20--space-xs:%200.25rem;%5Cn%20%20%20%20%20%20--space-sm:%200.5rem;%5Cn%20%20%20%20%20%20--space-md:%201rem;%5Cn%20%20%20%20%20%20--space-lg:%201.5rem;%5Cn%20%20%20%20%20%20--space-xl:%202rem;%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20/*%20Space%20theme%20variables%20-%20simplified%20*/%5Cn%20%20%20%20%20%20--space-dark:%20#030318;%5Cn%20%20%20%20%20%20--space-blue:%20#0a1045;%5Cn%20%20%20%20%20%20--space-purple:%20#0e1a50;%5Cn%20%20%20%20%20%20--star-color-1:%20#ffffff;%5Cn%20%20%20%20%20%20--star-color-2:%20#b0e0ff;%5Cn%20%20%20%20%20%20--star-color-3:%20#c4eeff;%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20/*%20Simplified%20input%20variables%20*/%5Cn%20%20%20%20%20%20--glass-input-bg:%20rgba(255,%20255,%20255,%200.07);%5Cn%20%20%20%20%20%20--glass-input-border:%20rgba(0,%20238,%20255,%200.2);%5Cn%20%20%20%20%20%20--glass-input-shadow:%200%202px%2015px%20rgba(0,%20238,%20255,%200.15);%5Cn%20%20%20%20%20%20--glass-input-highlight:%20rgba(255,%20255,%20255,%200.1);%5Cn%20%20%20%20%20%20--glass-input-glow:%20rgba(0,%20238,%20255,%200.4);%5Cn%20%20%20%20%20%20--glass-btn-bg:%20linear-gradient(135deg,%20rgba(255,%20255,%20255,%200.1),%20rgba(0,%20238,%20255,%200.05)%2050%25,%20rgba(0,%20136,%20255,%200.1));%5Cn%20%20%20%20%20%20--glass-btn-border:%20rgba(0,%20238,%20255,%200.2);%5Cn%20%20%20%20%20%20--glass-btn-shadow:%200%204px%2015px%20rgba(0,%20238,%20255,%200.2);%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20*%20%7B%5Cn%20%20%20%20%20%20margin:%200;%5Cn%20%20%20%20%20%20padding:%200;%5Cn%20%20%20%20%20%20box-sizing:%20border-box;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20body%20%7B%5Cn%20%20%20%20%20%20font-family:%20'Poppins',%20sans-serif;%5Cn%20%20%20%20%20%20line-height:%201.6;%5Cn%20%20%20%20%20%20color:%20var(--light-color);%5Cn%20%20%20%20%20%20background-color:%20var(--space-dark);%5Cn%20%20%20%20%20%20padding:%2020px;%5Cn%20%20%20%20%20%20position:%20relative;%5Cn%20%20%20%20%20%20overflow-x:%20hidden;%5Cn%20%20%20%20%20%20font-size:%20clamp(14px,%202.5vw,%2016px);%5Cn%20%20%20%20%20%20min-height:%20100vh;%5Cn%20%20%20%20%20%20display:%20flex;%5Cn%20%20%20%20%20%20flex-direction:%20column;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20/*%20Simplified%20space%20background%20*/%5Cn%20%20%20%20body::before%20%7B%5Cn%20%20%20%20%20%20content:%20%5C%22%5C%22;%5Cn%20%20%20%20%20%20position:%20fixed;%5Cn%20%20%20%20%20%20top:%200;%5Cn%20%20%20%20%20%20left:%200;%5Cn%20%20%20%20%20%20width:%20100%25;%5Cn%20%20%20%20%20%20height:%20100%25;%5Cn%20%20%20%20%20%20background:%20%5Cn%20%20%20%20%20%20%20%20radial-gradient(circle%20at%2020%25%2030%25,%20rgba(0,%20119,%20255,%200.15)%200%25,%20transparent%2040%25),%5Cn%20%20%20%20%20%20%20%20radial-gradient(circle%20at%2080%25%2070%25,%20rgba(0,%20102,%20255,%200.15)%200%25,%20transparent%2035%25),%5Cn%20%20%20%20%20%20%20%20linear-gradient(%5Cn%20%20%20%20%20%20%20%20%20%20125deg,%5Cn%20%20%20%20%20%20%20%20%20%20var(--space-dark),%5Cn%20%20%20%20%20%20%20%20%20%20var(--space-blue),%5Cn%20%20%20%20%20%20%20%20%20%20var(--space-purple),%5Cn%20%20%20%20%20%20%20%20%20%20var(--space-dark)%5Cn%20%20%20%20%20%20%20%20);%5Cn%20%20%20%20%20%20z-index:%20-3;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20/*%20Simplified%20star%20field%20effect%20*/%5Cn%20%20%20%20body::after%20%7B%5Cn%20%20%20%20%20%20content:%20%5C%22%5C%22;%5Cn%20%20%20%20%20%20position:%20fixed;%5Cn%20%20%20%20%20%20top:%200;%5Cn%20%20%20%20%20%20left:%200;%5Cn%20%20%20%20%20%20width:%20100%25;%5Cn%20%20%20%20%20%20height:%20100%25;%5Cn%20%20%20%20%20%20background-image:%20%5Cn%20%20%20%20%20%20%20%20radial-gradient(1.2px%201.2px%20at%2025%25%2015%25,%20var(--star-color-1)%20100%25,%20transparent),%5Cn%20%20%20%20%20%20%20%20radial-gradient(1.1px%201.1px%20at%2050%25%2040%25,%20var(--star-color-2)%20100%25,%20transparent),%5Cn%20%20%20%20%20%20%20%20radial-gradient(1.8px%201.8px%20at%2075%25%2075%25,%20var(--star-color-3)%20100%25,%20transparent),%5Cn%20%20%20%20%20%20%20%20radial-gradient(1.4px%201.4px%20at%2015%25%2085%25,%20var(--star-color-1)%20100%25,%20transparent);%5Cn%20%20%20%20%20%20background-size:%20550px%20550px,%20350px%20350px,%20250px%20250px,%20150px%20150px;%5Cn%20%20%20%20%20%20background-position:%200%200,%2040px%2060px,%20130px%20270px,%2080px%20370px;%5Cn%20%20%20%20%20%20z-index:%20-2;%5Cn%20%20%20%20%20%20opacity:%200.7;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20h1,%20h2,%20h3,%20h4,%20h5,%20h6%20%7B%5Cn%20%20%20%20%20%20font-weight:%20600;%5Cn%20%20%20%20%20%20margin-bottom:%201rem;%5Cn%20%20%20%20%20%20color:%20var(--light-color);%5Cn%20%20%20%20%20%20text-shadow:%200%200%208px%20rgba(0,%20238,%20255,%200.5);%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20h1%20%7B%20font-size:%20clamp(1.75rem,%205vw,%202.5rem);%20%7D%5Cn%20%20%20%20h2%20%7B%20font-size:%20clamp(1.5rem,%204vw,%202rem);%20%7D%5Cn%20%20%20%20h3%20%7B%20font-size:%20clamp(1.25rem,%203.5vw,%201.75rem);%20%7D%5Cn%20%20%20%20h4%20%7B%20font-size:%20clamp(1.1rem,%203vw,%201.5rem);%20%7D%5Cn%20%20%20%20h5%20%7B%20font-size:%20clamp(1rem,%202.5vw,%201.25rem);%20%7D%5Cn%20%20%20%20h6%20%7B%20font-size:%20clamp(0.9rem,%202vw,%201rem);%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20p%20%7B%5Cn%20%20%20%20%20%20margin-bottom:%201rem;%5Cn%20%20%20%20%20%20text-shadow:%200%200%202px%20rgba(0,%20238,%20255,%200.3);%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20.container%20%7B%5Cn%20%20%20%20%20%20max-width:%201200px;%5Cn%20%20%20%20%20%20margin:%200%20auto;%5Cn%20%20%20%20%20%20padding:%200%2015px;%5Cn%20%20%20%20%20%20position:%20relative;%5Cn%20%20%20%20%20%20z-index:%201;%5Cn%20%20%20%20%20%20width:%20100%25;%5Cn%20%20%20%20%20%20backdrop-filter:%20blur(5px);%5Cn%20%20%20%20%20%20-webkit-backdrop-filter:%20blur(5px);%5Cn%20%20%20%20%20%20flex:%201;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20/*%20Simplified%20title%20container%20*/%5Cn%20%20%20%20.title-container%20%7B%5Cn%20%20%20%20%20%20width:%20100%25;%5Cn%20%20%20%20%20%20display:%20flex;%5Cn%20%20%20%20%20%20justify-content:%20center;%5Cn%20%20%20%20%20%20align-items:%20center;%5Cn%20%20%20%20%20%20padding:%201.5rem%200;%5Cn%20%20%20%20%20%20margin-bottom:%202.5rem;%5Cn%20%20%20%20%20%20position:%20relative;%5Cn%20%20%20%20%20%20z-index:%202;%5Cn%20%20%20%20%20%20background:%20rgba(0,%2014,%2051,%200.15);%5Cn%20%20%20%20%20%20backdrop-filter:%20blur(var(--glass-blur));%5Cn%20%20%20%20%20%20-webkit-backdrop-filter:%20blur(var(--glass-blur));%5Cn%20%20%20%20%20%20border-radius:%20var(--border-radius);%5Cn%20%20%20%20%20%20border:%20var(--glass-border-width)%20solid%20rgba(0,%20238,%20255,%200.2);%5Cn%20%20%20%20%20%20box-shadow:%20var(--glass-shadow);%5Cn%20%20%20%20%20%20overflow:%20hidden;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20/*%20Simplified%20title%20styling%20*/%5Cn%20%20%20%20.futuristic-title%20%7B%5Cn%20%20%20%20%20%20font-size:%20clamp(2rem,%206vw,%203.5rem);%5Cn%20%20%20%20%20%20font-weight:%20700;%5Cn%20%20%20%20%20%20text-align:%20center;%5Cn%20%20%20%20%20%20padding:%201.2rem%202.5rem;%5Cn%20%20%20%20%20%20background:%20rgba(10,%2010,%2032,%200.3);%5Cn%20%20%20%20%20%20backdrop-filter:%20blur(10px);%5Cn%20%20%20%20%20%20-webkit-backdrop-filter:%20blur(10px);%5Cn%20%20%20%20%20%20border-radius:%20var(--border-radius);%5Cn%20%20%20%20%20%20border:%201px%20solid%20rgba(0,%20238,%20255,%200.3);%5Cn%20%20%20%20%20%20box-shadow:%200%200%2015px%20rgba(0,%20238,%20255,%200.4);%5Cn%20%20%20%20%20%20position:%20relative;%5Cn%20%20%20%20%20%20overflow:%20hidden;%5Cn%20%20%20%20%20%20color:%20rgba(255,%20255,%20255,%200.95);%5Cn%20%20%20%20%20%20text-shadow:%200%200%2010px%20var(--glow-color-1);%5Cn%20%20%20%20%20%20letter-spacing:%202px;%5Cn%20%20%20%20%20%20max-width:%2090%25;%5Cn%20%20%20%20%20%20z-index:%201;%5Cn%20%20%20%20%20%20background:%20linear-gradient(%5Cn%20%20%20%20%20%20%20%20135deg,%5Cn%20%20%20%20%20%20%20%20rgba(0,%20238,%20255,%200.1),%5Cn%20%20%20%20%20%20%20%20rgba(0,%20136,%20255,%200.05)%2030%25,%5Cn%20%20%20%20%20%20%20%20rgba(0,%200,%200,%200.1)%2070%25,%5Cn%20%20%20%20%20%20%20%20rgba(0,%200,%200,%200.15)%5Cn%20%20%20%20%20%20);%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20.card%20%7B%5Cn%20%20%20%20%20%20background-color:%20rgba(0,%2014,%2051,%200.15);%5Cn%20%20%20%20%20%20backdrop-filter:%20blur(var(--glass-blur));%5Cn%20%20%20%20%20%20-webkit-backdrop-filter:%20blur(var(--glass-blur));%5Cn%20%20%20%20%20%20border-radius:%20var(--border-radius);%5Cn%20%20%20%20%20%20box-shadow:%20var(--glass-shadow);%5Cn%20%20%20%20%20%20padding:%2025px;%5Cn%20%20%20%20%20%20margin-bottom:%2025px;%5Cn%20%20%20%20%20%20transition:%20var(--transition);%5Cn%20%20%20%20%20%20border:%20var(--glass-border-width)%20solid%20rgba(0,%20238,%20255,%200.2);%5Cn%20%20%20%20%20%20position:%20relative;%5Cn%20%20%20%20%20%20overflow:%20hidden;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20.card:hover%20%7B%5Cn%20%20%20%20%20%20transform:%20translateY(-2px);%5Cn%20%20%20%20%20%20box-shadow:%200%206px%2020px%20rgba(0,%200,%200,%200.2),%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%200%200%2015px%20rgba(0,%20238,%20255,%200.3);%5Cn%20%20%20%20%20%20border-color:%20rgba(0,%20238,%20255,%200.3);%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20/*%20Simplified%20button%20styling%20*/%5Cn%20%20%20%20.btn%20%7B%5Cn%20%20%20%20%20%20display:%20inline-block;%5Cn%20%20%20%20%20%20font-weight:%20500;%5Cn%20%20%20%20%20%20color:%20white;%5Cn%20%20%20%20%20%20text-align:%20center;%5Cn%20%20%20%20%20%20vertical-align:%20middle;%5Cn%20%20%20%20%20%20cursor:%20pointer;%5Cn%20%20%20%20%20%20background:%20var(--glass-btn-bg);%5Cn%20%20%20%20%20%20backdrop-filter:%20blur(calc(var(--glass-blur)%20*%201.2));%5Cn%20%20%20%20%20%20-webkit-backdrop-filter:%20blur(calc(var(--glass-blur)%20*%201.2));%5Cn%20%20%20%20%20%20border:%20var(--glass-border-width)%20solid%20var(--glass-btn-border);%5Cn%20%20%20%20%20%20padding:%200.6rem%201.8rem;%5Cn%20%20%20%20%20%20font-size:%201rem;%5Cn%20%20%20%20%20%20line-height:%201.5;%5Cn%20%20%20%20%20%20border-radius:%20var(--border-radius);%5Cn%20%20%20%20%20%20transition:%20var(--transition);%5Cn%20%20%20%20%20%20text-decoration:%20none;%5Cn%20%20%20%20%20%20box-shadow:%200%204px%2012px%20rgba(0,%20238,%20255,%200.2);%5Cn%20%20%20%20%20%20position:%20relative;%5Cn%20%20%20%20%20%20overflow:%20hidden;%5Cn%20%20%20%20%20%20letter-spacing:%200.8px;%5Cn%20%20%20%20%20%20text-shadow:%200%200%204px%20rgba(0,%20238,%20255,%200.4);%5Cn%20%20%20%20%20%20z-index:%201;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20.btn:hover%20%7B%5Cn%20%20%20%20%20%20background:%20linear-gradient(%5Cn%20%20%20%20%20%20%20%20135deg,%5Cn%20%20%20%20%20%20%20%20rgba(0,%20238,%20255,%200.15),%5Cn%20%20%20%20%20%20%20%20rgba(0,%20136,%20255,%200.05)%2050%25,%5Cn%20%20%20%20%20%20%20%20rgba(0,%200,%200,%200.1)%5Cn%20%20%20%20%20%20);%5Cn%20%20%20%20%20%20transform:%20translateY(-2px);%5Cn%20%20%20%20%20%20box-shadow:%200%205px%2015px%20rgba(0,%20238,%20255,%200.3);%5Cn%20%20%20%20%20%20border-color:%20rgba(0,%20238,%20255,%200.4);%5Cn%20%20%20%20%20%20text-shadow:%200%200%206px%20rgba(0,%20238,%20255,%200.6);%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20.btn:active%20%7B%5Cn%20%20%20%20%20%20transform:%20translateY(0)%20scale(0.98);%5Cn%20%20%20%20%20%20box-shadow:%200%202px%208px%20rgba(0,%20238,%20255,%200.3);%5Cn%20%20%20%20%20%20transition:%20all%200.1s;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20.btn-secondary%20%7B%5Cn%20%20%20%20%20%20background:%20linear-gradient(%5Cn%20%20%20%20%20%20%20%20135deg,%5Cn%20%20%20%20%20%20%20%20rgba(0,%20136,%20255,%200.1),%5Cn%20%20%20%20%20%20%20%20rgba(0,%20136,%20255,%200.05)%2050%25,%5Cn%20%20%20%20%20%20%20%20rgba(0,%200,%200,%200.1)%5Cn%20%20%20%20%20%20);%5Cn%20%20%20%20%20%20box-shadow:%200%204px%2012px%20rgba(0,%20136,%20255,%200.2);%5Cn%20%20%20%20%20%20text-shadow:%200%200%204px%20rgba(0,%20136,%20255,%200.4);%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20.btn-secondary:hover%20%7B%5Cn%20%20%20%20%20%20box-shadow:%200%205px%2015px%20rgba(0,%20136,%20255,%200.3);%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20.btn-success%20%7B%5Cn%20%20%20%20%20%20background:%20linear-gradient(%5Cn%20%20%20%20%20%20%20%20135deg,%5Cn%20%20%20%20%20%20%20%20rgba(0,%20255,%20221,%200.1),%5Cn%20%20%20%20%20%20%20%20rgba(0,%20255,%20221,%200.05)%2050%25,%5Cn%20%20%20%20%20%20%20%20rgba(0,%200,%200,%200.1)%5Cn%20%20%20%20%20%20);%5Cn%20%20%20%20%20%20box-shadow:%200%204px%2012px%20rgba(0,%20255,%20221,%200.2);%5Cn%20%20%20%20%20%20text-shadow:%200%200%204px%20rgba(0,%20255,%20221,%200.4);%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20.btn-success:hover%20%7B%5Cn%20%20%20%20%20%20box-shadow:%200%205px%2015px%20rgba(0,%20255,%20221,%200.3);%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20.btn-danger%20%7B%5Cn%20%20%20%20%20%20background:%20linear-gradient(%5Cn%20%20%20%20%20%20%20%20135deg,%5Cn%20%20%20%20%20%20%20%20rgba(0,%20112,%20255,%200.1),%5Cn%20%20%20%20%20%20%20%20rgba(0,%20112,%20255,%200.05)%2050%25,%5Cn%20%20%20%20%20%20%20%20rgba(0,%200,%200,%200.1)%5Cn%20%20%20%20%20%20);%5Cn%20%20%20%20%20%20box-shadow:%200%204px%2012px%20rgba(0,%20112,%20255,%200.2);%5Cn%20%20%20%20%20%20text-shadow:%200%200%204px%20rgba(0,%20112,%20255,%200.4);%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20.btn-danger:hover%20%7B%5Cn%20%20%20%20%20%20box-shadow:%200%205px%2015px%20rgba(0,%20112,%20255,%200.3);%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20/*%20Enhanced%20beautiful%20text%20box%20styling%20*/%5Cn%20%20%20%20input%5Btype=%5C%22text%5C%22%5D,%5Cn%20%20%20%20input%5Btype=%5C%22email%5C%22%5D,%5Cn%20%20%20%20input%5Btype=%5C%22password%5C%22%5D,%5Cn%20%20%20%20textarea,%5Cn%20%20%20%20select%20%7B%5Cn%20%20%20%20%20%20width:%20100%25;%5Cn%20%20%20%20%20%20padding:%2014px%2018px;%5Cn%20%20%20%20%20%20margin-bottom:%2018px;%5Cn%20%20%20%20%20%20font-family:%20inherit;%5Cn%20%20%20%20%20%20font-size:%2016px;%5Cn%20%20%20%20%20%20color:%20var(--light-color);%5Cn%20%20%20%20%20%20background:%20rgba(0,%2014,%2051,%200.12);%5Cn%20%20%20%20%20%20border-radius:%20var(--border-radius);%5Cn%20%20%20%20%20%20border:%201px%20solid%20var(--glass-input-border);%5Cn%20%20%20%20%20%20backdrop-filter:%20blur(var(--glass-blur));%5Cn%20%20%20%20%20%20-webkit-backdrop-filter:%20blur(var(--glass-blur));%5Cn%20%20%20%20%20%20box-shadow:%200%204px%2012px%20rgba(0,%200,%200,%200.1);%5Cn%20%20%20%20%20%20transition:%20all%200.3s%20ease;%5Cn%20%20%20%20%20%20position:%20relative;%5Cn%20%20%20%20%20%20letter-spacing:%200.5px;%5Cn%20%20%20%20%20%20caret-color:%20var(--primary-color);%5Cn%20%20%20%20%20%20text-shadow:%200%200%202px%20rgba(0,%20238,%20255,%200.3);%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20input%5Btype=%5C%22text%5C%22%5D:focus,%5Cn%20%20%20%20input%5Btype=%5C%22email%5C%22%5D:focus,%5Cn%20%20%20%20input%5Btype=%5C%22password%5C%22%5D:focus,%5Cn%20%20%20%20textarea:focus,%5Cn%20%20%20%20select:focus%20%7B%5Cn%20%20%20%20%20%20outline:%20none;%5Cn%20%20%20%20%20%20border-color:%20rgba(0,%20238,%20255,%200.5);%5Cn%20%20%20%20%20%20background:%20rgba(0,%2014,%2051,%200.15);%5Cn%20%20%20%20%20%20box-shadow:%200%200%200%202px%20rgba(0,%20238,%20255,%200.15),%20%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%200%204px%2012px%20rgba(0,%20238,%20255,%200.2);%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20/*%20Add%20subtle%20placeholder%20text%20*/%5Cn%20%20%20%20input::placeholder,%5Cn%20%20%20%20textarea::placeholder%20%7B%5Cn%20%20%20%20%20%20color:%20rgba(255,%20255,%20255,%200.4);%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20/*%20Remove%20default%20appearance%20for%20select%20dropdowns%20*/%5Cn%20%20%20%20select%20%7B%5Cn%20%20%20%20%20%20appearance:%20none;%5Cn%20%20%20%20%20%20background-image:%20linear-gradient(45deg,%20transparent%2050%25,%20rgba(0,%20238,%20255,%200.6)%2050%25),%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20linear-gradient(135deg,%20rgba(0,%20238,%20255,%200.6)%2050%25,%20transparent%2050%25);%5Cn%20%20%20%20%20%20background-position:%20calc(100%25%20-%2020px)%20center,%20calc(100%25%20-%2015px)%20center;%5Cn%20%20%20%20%20%20background-size:%205px%205px,%205px%205px;%5Cn%20%20%20%20%20%20background-repeat:%20no-repeat;%5Cn%20%20%20%20%20%20padding-right:%2030px;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20/*%20Styled%20option%20elements%20for%20select%20*/%5Cn%20%20%20%20select%20option%20%7B%5Cn%20%20%20%20%20%20background-color:%20rgba(0,%2014,%2051,%200.95);%5Cn%20%20%20%20%20%20color:%20var(--light-color);%5Cn%20%20%20%20%20%20border:%20none;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20/*%20Beautiful%20textarea%20*/%5Cn%20%20%20%20textarea%20%7B%5Cn%20%20%20%20%20%20min-height:%20120px;%5Cn%20%20%20%20%20%20resize:%20vertical;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20.alert%20%7B%5Cn%20%20%20%20%20%20padding:%2018px;%5Cn%20%20%20%20%20%20margin-bottom:%2025px;%5Cn%20%20%20%20%20%20border-radius:%20var(--border-radius);%5Cn%20%20%20%20%20%20border-left:%203px%20solid%20var(--primary-color);%5Cn%20%20%20%20%20%20background-color:%20rgba(0,%20238,%20255,%200.1);%5Cn%20%20%20%20%20%20backdrop-filter:%20blur(var(--glass-blur));%5Cn%20%20%20%20%20%20-webkit-backdrop-filter:%20blur(var(--glass-blur));%5Cn%20%20%20%20%20%20box-shadow:%20var(--glass-shadow);%5Cn%20%20%20%20%20%20border-top:%201px%20solid%20var(--glass-border-color);%5Cn%20%20%20%20%20%20border-right:%201px%20solid%20rgba(0,%20238,%20255,%200.15);%5Cn%20%20%20%20%20%20border-bottom:%201px%20solid%20rgba(0,%20238,%20255,%200.15);%5Cn%20%20%20%20%20%20position:%20relative;%5Cn%20%20%20%20%20%20overflow:%20hidden;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20.alert-success%20%7B%5Cn%20%20%20%20%20%20border-left-color:%20var(--success-color);%5Cn%20%20%20%20%20%20background-color:%20rgba(0,%20255,%20221,%200.1);%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20.alert-danger%20%7B%5Cn%20%20%20%20%20%20border-left-color:%20var(--danger-color);%5Cn%20%20%20%20%20%20background-color:%20rgba(0,%20112,%20255,%200.1);%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20.alert-warning%20%7B%5Cn%20%20%20%20%20%20border-left-color:%20var(--warning-color);%5Cn%20%20%20%20%20%20background-color:%20rgba(0,%20183,%20255,%200.1);%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20.flex%20%7B%5Cn%20%20%20%20%20%20display:%20flex;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20.flex-wrap%20%7B%5Cn%20%20%20%20%20%20flex-wrap:%20wrap;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20.justify-between%20%7B%5Cn%20%20%20%20%20%20justify-content:%20space-between;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20.items-center%20%7B%5Cn%20%20%20%20%20%20align-items:%20center;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20.gap-10%20%7B%5Cn%20%20%20%20%20%20gap:%2010px;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20.gap-20%20%7B%5Cn%20%20%20%20%20%20gap:%2020px;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20.text-center%20%7B%5Cn%20%20%20%20%20%20text-align:%20center;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20.text-right%20%7B%5Cn%20%20%20%20%20%20text-align:%20right;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20.w-full%20%7B%5Cn%20%20%20%20%20%20width:%20100%25;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20.my-20%20%7B%5Cn%20%20%20%20%20%20margin-top:%2020px;%5Cn%20%20%20%20%20%20margin-bottom:%2020px;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20.mt-20%20%7B%5Cn%20%20%20%20%20%20margin-top:%2020px;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20.mb-20%20%7B%5Cn%20%20%20%20%20%20margin-bottom:%2020px;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20/*%20Simplified%20footer%20styles%20*/%5Cn%20%20%20%20.footer%20%7B%5Cn%20%20%20%20%20%20width:%20100%25;%5Cn%20%20%20%20%20%20padding:%2020px%200;%5Cn%20%20%20%20%20%20margin-top:%2040px;%5Cn%20%20%20%20%20%20text-align:%20center;%5Cn%20%20%20%20%20%20position:%20relative;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20.footer-content%20%7B%5Cn%20%20%20%20%20%20background:%20rgba(0,%2014,%2051,%200.15);%5Cn%20%20%20%20%20%20backdrop-filter:%20blur(var(--glass-blur));%5Cn%20%20%20%20%20%20-webkit-backdrop-filter:%20blur(var(--glass-blur));%5Cn%20%20%20%20%20%20border-radius:%20var(--border-radius);%5Cn%20%20%20%20%20%20border:%20var(--glass-border-width)%20solid%20rgba(0,%20238,%20255,%200.15);%5Cn%20%20%20%20%20%20box-shadow:%200%204px%2015px%20rgba(0,%20238,%20255,%200.15);%5Cn%20%20%20%20%20%20padding:%2020px;%5Cn%20%20%20%20%20%20position:%20relative;%5Cn%20%20%20%20%20%20overflow:%20hidden;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20.footer-text%20%7B%5Cn%20%20%20%20%20%20font-size:%200.95rem;%5Cn%20%20%20%20%20%20color:%20rgba(255,%20255,%20255,%200.8);%5Cn%20%20%20%20%20%20margin:%207px%200;%5Cn%20%20%20%20%20%20position:%20relative;%5Cn%20%20%20%20%20%20text-shadow:%200%200%205px%20rgba(0,%20238,%20255,%200.4);%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20.footer-brand%20%7B%5Cn%20%20%20%20%20%20font-weight:%20600;%5Cn%20%20%20%20%20%20color:%20var(--glow-color-1);%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20.footer-copyright%20%7B%5Cn%20%20%20%20%20%20font-size:%200.85rem;%5Cn%20%20%20%20%20%20opacity:%200.85;%5Cn%20%20%20%20%20%20margin-top:%207px;%5Cn%20%20%20%20%20%20letter-spacing:%201px;%5Cn%20%20%20%20%20%20text-shadow:%200%200%203px%20rgba(0,%20238,%20255,%200.3);%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20/*%20Enhanced%20responsive%20styles%20*/%5Cn%20%20%20%20@media%20(max-width:%20992px)%20%7B%5Cn%20%20%20%20%20%20.container%20%7B%5Cn%20%20%20%20%20%20%20%20padding:%200%2010px;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20.card%20%7B%5Cn%20%20%20%20%20%20%20%20padding:%2020px;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20.flex%20%7B%5Cn%20%20%20%20%20%20%20%20gap:%2015px;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20@media%20(max-width:%20768px)%20%7B%5Cn%20%20%20%20%20%20body%20%7B%5Cn%20%20%20%20%20%20%20%20padding:%2015px%2010px;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20.card%20%7B%5Cn%20%20%20%20%20%20%20%20padding:%2018px;%5Cn%20%20%20%20%20%20%20%20margin-bottom:%2018px;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20.btn%20%7B%5Cn%20%20%20%20%20%20%20%20padding:%200.6rem%201.5rem;%5Cn%20%20%20%20%20%20%20%20font-size:%200.95rem;%5Cn%20%20%20%20%20%20%20%20min-height:%2044px;%20/*%20Better%20touch%20target%20*/%5Cn%20%20%20%20%20%20%20%20display:%20flex;%5Cn%20%20%20%20%20%20%20%20align-items:%20center;%5Cn%20%20%20%20%20%20%20%20justify-content:%20center;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20.flex%20%7B%5Cn%20%20%20%20%20%20%20%20flex-direction:%20column;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20.flex.responsive-row%20%7B%5Cn%20%20%20%20%20%20%20%20flex-direction:%20row;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20.gap-20%20%7B%5Cn%20%20%20%20%20%20%20%20gap:%2015px;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20.gap-10%20%7B%5Cn%20%20%20%20%20%20%20%20gap:%208px;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20input%5Btype=%5C%22text%5C%22%5D,%5Cn%20%20%20%20%20%20input%5Btype=%5C%22email%5C%22%5D,%5Cn%20%20%20%20%20%20input%5Btype=%5C%22password%5C%22%5D,%5Cn%20%20%20%20%20%20textarea,%5Cn%20%20%20%20%20%20select%20%7B%5Cn%20%20%20%20%20%20%20%20padding:%2012px;%20/*%20Larger%20touch%20targets%20*/%5Cn%20%20%20%20%20%20%20%20font-size:%2016px;%20/*%20Prevent%20zoom%20on%20focus%20in%20iOS%20*/%5Cn%20%20%20%20%20%20%20%20margin-bottom:%2015px;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20.alert%20%7B%5Cn%20%20%20%20%20%20%20%20padding:%2015px;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20.futuristic-title%20%7B%5Cn%20%20%20%20%20%20%20%20font-size:%20clamp(1.75rem,%205vw,%202.5rem);%5Cn%20%20%20%20%20%20%20%20padding:%200.75rem%201.5rem;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20.footer-text%20%7B%5Cn%20%20%20%20%20%20%20%20font-size:%200.85rem;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20@media%20(max-width:%20480px)%20%7B%5Cn%20%20%20%20%20%20body%20%7B%5Cn%20%20%20%20%20%20%20%20padding:%2010px%205px;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20.card%20%7B%5Cn%20%20%20%20%20%20%20%20padding:%2015px;%5Cn%20%20%20%20%20%20%20%20margin-bottom:%2015px;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20.btn%20%7B%5Cn%20%20%20%20%20%20%20%20width:%20100%25;%20/*%20Full%20width%20buttons%20on%20very%20small%20screens%20*/%5Cn%20%20%20%20%20%20%20%20padding:%200.5rem%201rem;%5Cn%20%20%20%20%20%20%20%20margin-bottom:%2010px;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20.flex.responsive-wrap%20%7B%5Cn%20%20%20%20%20%20%20%20flex-wrap:%20wrap;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20h1,%20h2,%20h3,%20h4,%20h5,%20h6%20%7B%5Cn%20%20%20%20%20%20%20%20margin-bottom:%200.75rem;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20p%20%7B%5Cn%20%20%20%20%20%20%20%20margin-bottom:%200.75rem;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20.gap-20%20%7B%5Cn%20%20%20%20%20%20%20%20gap:%2010px;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20.gap-10%20%7B%5Cn%20%20%20%20%20%20%20%20gap:%205px;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20.my-20%20%7B%5Cn%20%20%20%20%20%20%20%20margin-top:%2015px;%5Cn%20%20%20%20%20%20%20%20margin-bottom:%2015px;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20.mt-20%20%7B%5Cn%20%20%20%20%20%20%20%20margin-top:%2015px;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20.mb-20%20%7B%5Cn%20%20%20%20%20%20%20%20margin-bottom:%2015px;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20.futuristic-title%20%7B%5Cn%20%20%20%20%20%20%20%20font-size:%20clamp(1.5rem,%204vw,%202rem);%5Cn%20%20%20%20%20%20%20%20padding:%200.5rem%201rem;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20.footer-content%20%7B%5Cn%20%20%20%20%20%20%20%20padding:%2015px;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20.footer-text%20%7B%5Cn%20%20%20%20%20%20%20%20font-size:%200.8rem;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20.footer-copyright%20%7B%5Cn%20%20%20%20%20%20%20%20font-size:%200.75rem;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%7D%5Cn%20%20%3C/style%3E%5Cn%3C/head%3E%5Cn%3Cbody%3E%5Cn%20%20%3Cdiv%20class=%5C%22container%5C%22%3E%5Cn%20%20%20%20%3Cdiv%20class=%5C%22title-container%5C%22%3E%5Cn%20%20%20%20%20%20%3Cdiv%20class=%5C%22futuristic-title%5C%22%3EZephyrus%20Ai%20Art%20Studio%3C/div%3E%5Cn%20%20%20%20%3C/div%3E%5Cn%20%20%20%20%5BgenerateHTML(settings)%5D%5Cn%20%20%3C/div%3E%5Cn%20%20%5Cn%20%20%3Cfooter%20class=%5C%22footer%5C%22%3E%5Cn%20%20%20%20%3Cdiv%20class=%5C%22footer-content%5C%22%3E%5Cn%20%20%20%20%20%20%3Cdiv%20class=%5C%22footer-text%5C%22%3E%5Cn%20%20%20%20%20%20%20%20%3Cspan%20class=%5C%22footer-brand%5C%22%3EPowered%20by%20Stability.ai%20&%20Volnet%202%3C/span%3E%5Cn%20%20%20%20%20%20%3C/div%3E%5Cn%20%20%20%20%20%20%3Cdiv%20class=%5C%22footer-text%20footer-copyright%5C%22%3E%5Cn%20%20%20%20%20%20%20%202025%20all%20rights%20reserved%20-%20Zahid%5Cn%20%20%20%20%20%20%3C/div%3E%5Cn%20%20%20%20%3C/div%3E%5Cn%20%20%3C/footer%3E%5Cn%20%20%5Cn%20%20%3Cscript%3E%5Cn%20%20%20%20//%20Add%20some%20simple%20animations%20to%20elements%20when%20they%20appear%20in%20view%5Cn%20%20%20%20document.addEventListener('DOMContentLoaded',%20function()%20%7B%5Cn%20%20%20%20%20%20//%20Create%20minimalistic%20space%20environment%5Cn%20%20%20%20%20%20createSpaceEnvironment();%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20//%20Handle%20responsive%20layout%20changes%5Cn%20%20%20%20%20%20function%20handleResponsiveLayout()%20%7B%5Cn%20%20%20%20%20%20%20%20//%20Convert%20flex%20containers%20to%20column%20layout%20on%20mobile%20if%20needed%5Cn%20%20%20%20%20%20%20%20if%20(window.innerWidth%20%3C=%20768)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20document.querySelectorAll('.flex:not(.responsive-row)').forEach(flex%20=%3E%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20flex.style.flexDirection%20=%20'column';%5Cn%20%20%20%20%20%20%20%20%20%20%7D);%5Cn%20%20%20%20%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20document.querySelectorAll('.flex:not(.responsive-row)').forEach(flex%20=%3E%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20flex.style.flexDirection%20=%20'';%5Cn%20%20%20%20%20%20%20%20%20%20%7D);%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20//%20Initialize%20responsive%20layout%5Cn%20%20%20%20%20%20handleResponsiveLayout();%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20//%20Update%20layout%20on%20resize%5Cn%20%20%20%20%20%20window.addEventListener('resize',%20handleResponsiveLayout);%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20//%20Add%20subtle%20fade-in%20for%20cards%5Cn%20%20%20%20%20%20const%20cards%20=%20document.querySelectorAll('.card');%5Cn%20%20%20%20%20%20cards.forEach((card,%20index)%20=%3E%20%7B%5Cn%20%20%20%20%20%20%20%20setTimeout(()%20=%3E%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20card.style.opacity%20=%20'1';%5Cn%20%20%20%20%20%20%20%20%20%20card.style.transform%20=%20'translateY(0)';%5Cn%20%20%20%20%20%20%20%20%20%20card.style.transition%20=%20'opacity%200.5s%20ease,%20transform%200.5s%20ease';%5Cn%20%20%20%20%20%20%20%20%7D,%20100%20*%20index);%5Cn%20%20%20%20%20%20%7D);%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20//%20Create%20space%20environment%20with%20minimal%20stars%5Cn%20%20%20%20%20%20function%20createSpaceEnvironment()%20%7B%5Cn%20%20%20%20%20%20%20%20//%20Create%20static%20background%5Cn%20%20%20%20%20%20%20%20const%20starCount%20=%20window.innerWidth%20%3C%20768%20?%2020%20:%2040;%5Cn%20%20%20%20%20%20%20%20for%20(let%20i%20=%200;%20i%20%3C%20starCount;%20i++)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20createStar();%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20function%20createStar()%20%7B%5Cn%20%20%20%20%20%20%20%20const%20particle%20=%20document.createElement('div');%5Cn%20%20%20%20%20%20%20%20particle.className%20=%20'particle';%5Cn%20%20%20%20%20%20%20%20document.body.appendChild(particle);%5Cn%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20//%20Random%20position%5Cn%20%20%20%20%20%20%20%20const%20x%20=%20Math.random()%20*%20window.innerWidth;%5Cn%20%20%20%20%20%20%20%20const%20y%20=%20Math.random()%20*%20window.innerHeight;%5Cn%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20//%20Simple%20size%5Cn%20%20%20%20%20%20%20%20const%20size%20=%20Math.random()%20*%201.5%20+%200.5;%5Cn%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20//%20Simple%20star%20color%5Cn%20%20%20%20%20%20%20%20const%20starColors%20=%20%5B%5Cn%20%20%20%20%20%20%20%20%20%20'rgba(255,%20255,%20255,%200.7)',%5Cn%20%20%20%20%20%20%20%20%20%20'rgba(173,%20216,%20230,%200.7)',%5Cn%20%20%20%20%20%20%20%20%20%20'rgba(0,%20238,%20255,%200.6)'%5Cn%20%20%20%20%20%20%20%20%5D;%5Cn%20%20%20%20%20%20%20%20const%20color%20=%20starColors%5BMath.floor(Math.random()%20*%20starColors.length)%5D;%5Cn%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20//%20Apply%20styles%5Cn%20%20%20%20%20%20%20%20particle.style.width%20=%20%60$%7Bsize%7Dpx%60;%5Cn%20%20%20%20%20%20%20%20particle.style.height%20=%20%60$%7Bsize%7Dpx%60;%5Cn%20%20%20%20%20%20%20%20particle.style.left%20=%20%60$%7Bx%7Dpx%60;%5Cn%20%20%20%20%20%20%20%20particle.style.top%20=%20%60$%7By%7Dpx%60;%5Cn%20%20%20%20%20%20%20%20particle.style.position%20=%20'fixed';%5Cn%20%20%20%20%20%20%20%20particle.style.borderRadius%20=%20'50%25';%5Cn%20%20%20%20%20%20%20%20particle.style.backgroundColor%20=%20color;%5Cn%20%20%20%20%20%20%20%20particle.style.boxShadow%20=%20%600%200%20$%7Bsize%20*%202%7Dpx%20$%7Bcolor%7D%60;%5Cn%20%20%20%20%20%20%20%20particle.style.opacity%20=%20Math.random()%20*%200.5%20+%200.3;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%7D);%5Cn%20%20%3C/script%3E%5Cn%3C/body%3E%5Cn%3C/html%3E%5Cn%22,%22imports%22:%5B%22neg-pack-t%22,%22rpg-icon-plugin%22,%22t2i-framework-plugin-v2%22,%22t2i-styles%22,%22vionet20-t2i-styles-importable%22,%22x-xx-styles-andothersv1%22%5D,%22canLink%22:false,%22isPrivate%22:true,%22collabEditModeIsEnabled%22:false%7D</script>
        <script id="imported-generators" type="notjs">%5B%7B%22name%22:%22neg-pack-t%22,%22modelText%22:%22//%20note%20that%20%60input%60%20is%20a%20global%20variable%20(i.e.%20%60input%60%20is%20%60window.input%60),%20which%20is%20created%20by%20t2i-framework-plugin%5Cn//%20see%20here%20for%20an%20example%20generator%20that%20imports%20these%20styles:%20https://perchance.org/ai-character-generator#edit%5Cn//%20style%20tester:%20https://perchance.org/prompt-style-tester%5Cn%5Cn//%20Last%20edit%20by%20BlackYT%20in%2007/23/24%20(mmddaa).%5Cn//++%20This%20is%20a%20%5C%22cheat%5C%22%20to%20allow%20modifiers%20on%20my%20generator%20without%20the%20need%20to%20do%20complicated%20stuff:%20https://perchance.org/ai-art-generator-advanced%5Cn%5Cn%5Cn%20%20%E2%AD%95FF%5Cn%20%20%F0%9F%9F%A2N%5Cn%20%20%20%20modifiers%5Cn%20%20%20%20%20%20Negative%20Pack%20=%20%5BnegPack%5D%5Cn%20%20%20%20%20%20Your%20List%20=%20%5BuList%5D%5Cn%5Cn%20%5Cn%5CnnegPack%5Cn%20%20%F0%9F%94%B8%20Basic%20for%20Quality%20(any%20style)%20=%20,%20low-resolution,%20low%20resolutions,%20low%20res,%20poor%20quality,%20low-quality,%20low%20quality,%20worst%20quality,%20bad%20art,%20bad%20photo,%20bad%203d%20render,%20pixelization,%20blurry,%20jpeg%20artifacts,%20text,%20watermark,%20logo,%20trademark,%20signature,%20bad%20anatomy,%20bad%20hand,%20bad%20eyes,%20extra%20digits,%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cn%20%20%F0%9F%94%B8%20Anime%20Basic%20=%20,%20worst%20quality,%20low%20quality,%20low%20res,%20low%20ppi,%20pixelization,%20bad%20art,%20poorly%20drawn,%20jpeg%20artifacts%20%5Cn%20%20Basic%20Body%20Parts%20=%20,%20long%20neck,%20big%20head,%20large%20head,%20unnatural%20anatomy,%20awkward%20pose,%20missing%20limbs,%20extra%20limbs,%20amputee,%20multilated,%20distorted,%20disconnected%20limbs,%20bad%20foot,%20extra%20arms,%20extra%20legs,%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cn%20%20%F0%9F%91%8B%20Hands%20and%20Fingers%20=%20,%20bad%20hands,%20giant%20hands,%20deformed%20hands,%20ugly%20hands,%20creepy%20hands,%20wrong%20hand,%20badly%20drawn%20hand,%20horrible%20hands,%20extra%20hand,%20missing%20hand,%20fused%20hand,%20more%20than%205%20fingers,%20extra%20fingers,%20polidactyl,%20too%20many%20fingers,%20deformed%20fingers,%20fewer%20digits,%20fewer%20fingers,%20less%20than%205%20fingers,%20missing%20fingers,%20fingers%20cutout,%20crossed%20fingers,%20fused%20fingers,%20badly%20drawn%20fingers,%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cn%20%20%F0%9F%91%81%EF%B8%8F%E2%80%8D%F0%9F%97%A8%EF%B8%8F%20Eyes,%20Eyelid,%20Eyebrows%20=%20,%20blurred%20eyelid,%20glitched%20eyelid,%20overshaped%20eyelid,%20fused%20eyelid,%20multiple%20eyebrows,%20blurred%20eyebrows,%20glitched%20eyebrows,%20fused%20eyebrows,%20badly%20drawn%20eyes,%20dead%20eyes,%20strabismus,%20misaligned%20eyes,%20asymmetric%20eyes,%20deformed%20eyes,%20collapsed%20sclera,%20deformed%20iris,%20noisy%20eyes,%20glitched%20eyes,%20blurred%20eyes,%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cn%20%20%F0%9F%8F%9E%EF%B8%8F%20Background,%20Scenery,%20Composition%20=%20,%20boring%20background,%20overexposed%20background,%20underexposed%20background,%20character%20fused%20with%20background,%20incomprehensible%20background,%20incomprehensible%20scenery,%20overly%20simplistic%20scenery,%20lack%20of%20depth,%20oversized%20objects,%20undersized%20objects,%20random%20objects,%20random%20elements,%20unwanted%20elements,%20unwanted%20objects,%20mutating%20objects,%20mutating%20structures,%20stacked%20elements,%20stacked%20objects,%20cloned%20objects,%20cloned%20elements,%20white%20sky,%20bad%20composition,%20improper%20perspective,%20wrong%20scale,%20lack%20of%20sharpness,%20messy,%20complex,%20complicated,%20lack%20of%20realism,%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cn%20%20%F0%9F%94%A6%20Light,%20Shadows,%20Colors%20=%20,%20bad%20lighting,%20unrealistic%20lighting,%20inconsistent%20lighting,%20flat%20lighting,%20overexposed,%20unwanted%20reflections,%20burnt%20highlights,%20unrealistic%20shadows,%20inconsistent%20shadows,%20washed%20out%20colors,%20monochrome,%20B&W,%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cn%20%20%F0%9F%8D%91%20Sexual%20problems%20=%20,%20unrealistic%20penis,%20deformed%20penis,%20stacked%20penis,%20detached%20penis,%20penis%20cutout,%20disconnected%20penis,%20random%20penis,%20malformed%20penis,%20fused%20penis,%20mutating%20penis,%20deformed%20glande,%20stacked%20glande,%20unnatural%20tongue,%20unrealistic%20tongue,%20fused%20tongue,%20tongue%20cutout,%20unrealistic%20blowjob,%20penis%20out%20of%20mouth,%20fused%20mouth,%20condom,%20toys,%20unwanted%20cum,%20unwanted%20drool,%20unrealistic%20cum,%20unnatural%20sex,%20penis%20out%20of%20pussy,%20ugly%20pussy,%20stacked%20pussy,%20stacked%20clitoris,%20blurred%20pussy,%20fused%20pussy,%20pussypenis,%20penispussy,%20pussydick,%20dickpussy,%20futa,%20futanari,%20shemale,%20androgynous,%20femboy,%20shota,%20man%20cutout,%20unrealistic%20anus,%20double%20anus,%20multiple%20anus,%20penis%20out%20of%20anus,%20anuspussy,%20pussyanus,%20absurd%20anatomy,%20absurd%20position,%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cn%20%20Extra%20RANDOM%20=%20,%20badly%20drawn%20characters,%20awkward%20positioning,%20awkward%20pose,%20head%20turned%20incorrectly,%20ANTHRO,%20furry,%20beast,%20animal,%20unfinished,%20unfinished%20clothes,%20mutating%20clothes,%20fused%20clothes,%20clothes%20cutout,%20lack%20of%20dynamism,%20lack%20of%20expressions,%20emotionless,%20clone,%20duplicate,%20similar%20characteristics,%20similar%20appearance,%20simple%20background,%20cropped,%20out%20of%20frame,%20multiple%20views,%20multi-view,%204koma,%20chibi,%20figurine,%20miniature,%20boring,%20morbid,%20ugly%20face,%20oversized%20body%20features,%20clonned%20nipples,%20multiple%20nipples,%20extra%20thigh,%20missing%20thigh,%20thigh%20cutout,%20deformed%20ear,%20blurred%20hair,%20fused%20hair,%20incomprehensible%20hair,%20unrealistic%20hair,%20bizarre,%20mickey%20mouse,%20water,%20camera,%20screen,%20pencil,%20pen,%20glass%20of%20wine,%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cn%20%20Block%20Real%20Person%20=%20,%20(actress,%20pornstar,%20singer,%20celebrity,%20real%20person,%20real%20model,%20realgirl,%20realwoman,%20realman,%20realistic,%20realistic%20face,%20photorealistic,%20real%20photo):1.5,%20(real%20person%20for%20reference:1.4),%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cn%20%20Block%20Small%20Kids%20=%20,%20((infant,%20child,%20kid,%20tinylittlebody,%20smallbody,%20smallchildgirl)):1.4,%5CnuList%20%20%20%20%5Cn%20%20&lsqb;NEG_LIST1&rsqb;,%5Cn%20%20&lsqb;NEG_LIST2&rsqb;,%5Cn%20%20&lsqb;NEG_LIST3&rsqb;,%5Cn%20%20&lsqb;NEG_LIST4&rsqb;,%5Cn%20%20&lsqb;NEG_LIST5&rsqb;,%5Cn%20%20&lsqb;NEG_LIST6&rsqb;,%5Cn%20%20&lsqb;NEG_LIST7&rsqb;,%5Cn%20%20&lsqb;NEG_LIST8&rsqb;,%5Cn%20%20&lsqb;NEG_LIST9&rsqb;,%5Cn%20%20&lsqb;NEG_LIST10&rsqb;,%5Cn%20%22,%22imports%22:%5B%5D,%22lastEditTime%22:1723870153506,%22found%22:true%7D,%7B%22name%22:%22rpg-icon-plugin%22,%22modelText%22:%22//%20All%20credit%20for%20this%20plugin%20goes%20to:%5Cn//%20https://github.com/nagoshiashumari/Rpg-Awesome%5Cn//%20(license%20info%20available%20on%20that%20page)%5Cn%5Cn(iconName,%20style)%20=%3E%5Cn%5Ctif(!window.alreadyAddedRPGAwesomeCSS)%20%7B%5Cn%5Ct%5Ctlet%20style%20=%20document.createElement('style');%20%5Cn%5Ct%5Ctstyle.type%20=%20'text/css';%5Cn%5Ct%5Ctstyle.innerHTML%20=%20getRPGAwesomeCSSText();%5Cn%5Ct%5Ctdocument.head.appendChild(style);%5Cn%5Ct%5Ctwindow.alreadyAddedRPGAwesomeCSS%20=%20true;%5Cn%5Ct%7D%5Cn%5Ct%5Cn%5Ctreturn%20%60%3Ci%20style='$%7Bstyle%7D'%20class='ra%20ra-$%7BiconName.evaluateItem.split(%5C%22%20%5C%22).join(%5C%22%20ra-%5C%22)%7D'%3E%3C/i%3E%60;%5Cn%5Ct%5Cn%5CngetRPGAwesomeCSSText()%20=%3E%20return%20%60@charset%20%5C%22UTF-8%5C%22;.ra-fw,.ra-li%7Btext-align:center%7D@font-face%7Bfont-family:RPGAwesome;src:url(data:application/font-woff2;base64,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)%20format(%5C%22woff2%5C%22);font-weight:400;font-style:normal%7D.ra%7Bfont-family:RPGAwesome;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-style:normal;font-variant:normal;font-weight:400;line-height:1;speak:none;text-transform:none%7D.ra-lg%7Bfont-size:1.33333em;line-height:.75em;vertical-align:-15%25%7D.ra-2x%7Bfont-size:2em%7D.ra-3x%7Bfont-size:3em%7D.ra-4x%7Bfont-size:4em%7D.ra-5x%7Bfont-size:5em%7D.ra-fw%7Bwidth:1.28571em%7D.ra-ul%7Blist-style-type:none;margin-left:2.14286em;padding-left:0%7D.ra-ul%3Eli%7Bposition:relative%7D.ra-li%7Bleft:-2.14286em;position:absolute;top:.14286em;width:2.14286em%7D.ra-li.ra-lg%7Bleft:-1.85714em%7D.ra-border%7Bborder:.08em%20solid%20#eee;border-radius:.1em;padding:.2em%20.25em%20.15em%7D.pull-right%7Bfloat:right%7D.pull-left%7Bfloat:left%7D.ra.pull-left%7Bmargin-right:.3em%7D.ra.pull-right%7Bmargin-left:.3em%7D.ra-spin%7B-webkit-animation:ra-spin%202s%20infinite%20linear;animation:ra-spin%202s%20infinite%20linear%7D@-webkit-keyframes%20ra-spin%7B0%25%7B-webkit-transform:rotate(0);transform:rotate(0)%7D100%25%7B-webkit-transform:rotate(359deg);transform:rotate(359deg)%7D%7D@keyframes%20ra-spin%7B0%25%7B-webkit-transform:rotate(0);transform:rotate(0)%7D100%25%7B-webkit-transform:rotate(359deg);transform:rotate(359deg)%7D%7D.ra-rotate-90%7Bfilter:progid:DXImageTransform.Microsoft.BasicImage(rotation=1);-webkit-transform:rotate(90deg);-ms-transform:rotate(90deg);transform:rotate(90deg)%7D.ra-rotate-180%7Bfilter:progid:DXImageTransform.Microsoft.BasicImage(rotation=2);-webkit-transform:rotate(180deg);-ms-transform:rotate(180deg);transform:rotate(180deg)%7D.ra-rotate-270%7Bfilter:progid:DXImageTransform.Microsoft.BasicImage(rotation=3);-webkit-transform:rotate(270deg);-ms-transform:rotate(270deg);transform:rotate(270deg)%7D.ra-flip-horizontal%7Bfilter:progid:DXImageTransform.Microsoft.BasicImage(rotation=0);-webkit-transform:scale(-1,1);-ms-transform:scale(-1,1);transform:scale(-1,1)%7D.ra-flip-vertical%7Bfilter:progid:DXImageTransform.Microsoft.BasicImage(rotation=2);-webkit-transform:scale(1,-1);-ms-transform:scale(1,-1);transform:scale(1,-1)%7D:root%20.ra-flip-horizontal,:root%20.ra-flip-vertical,:root%20.ra-rotate-180,:root%20.ra-rotate-270,:root%20.ra-rotate-90%7Bfilter:none%7D.ra-stack%7Bdisplay:inline-block;height:2em;line-height:2em;position:relative;vertical-align:middle;width:2em%7D.ra-stack-1x,.ra-stack-2x%7Bleft:0;position:absolute;text-align:center;width:100%25%7D.ra-stack-1x%7Bline-height:inherit%7D.ra-stack-2x%7Bfont-size:2em%7D.ra-inverse%7Bcolor:#fff%7D.ra-acid:before%7Bcontent:%5C%22%EE%A4%80%5C%22%7D.ra-zigzag-leaf:before%7Bcontent:%5C%22%EE%AB%AE%5C%22%7D.ra-archer:before%7Bcontent:%5C%22%EE%A4%8D%5C%22%7D.ra-archery-target:before%7Bcontent:%5C%22%EE%A4%8E%5C%22%7D.ra-arena:before%7Bcontent:%5C%22%EE%A4%8F%5C%22%7D.ra-aries:before%7Bcontent:%5C%22%EE%A4%90%5C%22%7D.ra-arrow-cluster:before%7Bcontent:%5C%22%EE%A4%91%5C%22%7D.ra-arrow-flights:before%7Bcontent:%5C%22%EE%A4%92%5C%22%7D.ra-arson:before%7Bcontent:%5C%22%EE%A4%93%5C%22%7D.ra-aura:before%7Bcontent:%5C%22%EE%A4%94%5C%22%7D.ra-aware:before%7Bcontent:%5C%22%EE%A4%95%5C%22%7D.ra-axe:before%7Bcontent:%5C%22%EE%A4%97%5C%22%7D.ra-axe-swing:before%7Bcontent:%5C%22%EE%A4%96%5C%22%7D.ra-ball:before%7Bcontent:%5C%22%EE%A4%98%5C%22%7D.ra-barbed-arrow:before%7Bcontent:%5C%22%EE%A4%99%5C%22%7D.ra-barrier:before%7Bcontent:%5C%22%EE%A4%9A%5C%22%7D.ra-bat-sword:before%7Bcontent:%5C%22%EE%A4%9B%5C%22%7D.ra-battered-axe:before%7Bcontent:%5C%22%EE%A4%9C%5C%22%7D.ra-batteries:before%7Bcontent:%5C%22%EE%A4%9D%5C%22%7D.ra-battery-0:before%7Bcontent:%5C%22%EE%A4%9E%5C%22%7D.ra-battery-25:before%7Bcontent:%5C%22%EE%A4%9F%5C%22%7D.ra-battery-50:before%7Bcontent:%5C%22%EE%A4%A0%5C%22%7D.ra-battery-75:before%7Bcontent:%5C%22%EE%A4%A1%5C%22%7D.ra-battery-100:before%7Bcontent:%5C%22%EE%A4%A2%5C%22%7D.ra-battery-black:before%7Bcontent:%5C%22%EE%A4%A3%5C%22%7D.ra-battery-negative:before%7Bcontent:%5C%22%EE%A4%A4%5C%22%7D.ra-battery-positive:before%7Bcontent:%5C%22%EE%A4%A5%5C%22%7D.ra-battery-white:before%7Bcontent:%5C%22%EE%A4%A6%5C%22%7D.ra-batwings:before%7Bcontent:%5C%22%EE%A4%A7%5C%22%7D.ra-beam-wake:before%7Bcontent:%5C%22%EE%A4%A8%5C%22%7D.ra-bear-trap:before%7Bcontent:%5C%22%EE%A4%A9%5C%22%7D.ra-beer:before%7Bcontent:%5C%22%EE%A4%AA%5C%22%7D.ra-beetle:before%7Bcontent:%5C%22%EE%A4%AB%5C%22%7D.ra-bell:before%7Bcontent:%5C%22%EE%A4%AC%5C%22%7D.ra-biohazard:before%7Bcontent:%5C%22%EE%A4%AD%5C%22%7D.ra-bird-claw:before%7Bcontent:%5C%22%EE%A4%AE%5C%22%7D.ra-bird-mask:before%7Bcontent:%5C%22%EE%A4%AF%5C%22%7D.ra-blade-bite:before%7Bcontent:%5C%22%EE%A4%B0%5C%22%7D.ra-blast:before%7Bcontent:%5C%22%EE%A4%B1%5C%22%7D.ra-blaster:before%7Bcontent:%5C%22%EE%A4%B2%5C%22%7D.ra-bleeding-eye:before%7Bcontent:%5C%22%EE%A4%B3%5C%22%7D.ra-bleeding-hearts:before%7Bcontent:%5C%22%EE%A4%B4%5C%22%7D.ra-bolt-shield:before%7Bcontent:%5C%22%EE%A4%B5%5C%22%7D.ra-bomb-explosion:before%7Bcontent:%5C%22%EE%A4%B6%5C%22%7D.ra-bombs:before%7Bcontent:%5C%22%EE%A4%B7%5C%22%7D.ra-bone-bite:before%7Bcontent:%5C%22%EE%A4%B8%5C%22%7D.ra-bone-knife:before%7Bcontent:%5C%22%EE%A4%B9%5C%22%7D.ra-book:before%7Bcontent:%5C%22%EE%A4%BA%5C%22%7D.ra-boomerang:before%7Bcontent:%5C%22%EE%A4%BB%5C%22%7D.ra-boot-stomp:before%7Bcontent:%5C%22%EE%A4%BC%5C%22%7D.ra-bottle-vapors:before%7Bcontent:%5C%22%EE%A4%BD%5C%22%7D.ra-bottled-bolt:before%7Bcontent:%5C%22%EE%A4%BE%5C%22%7D.ra-bottom-right:before%7Bcontent:%5C%22%EE%A4%BF%5C%22%7D.ra-bowie-knife:before%7Bcontent:%5C%22%EE%A5%80%5C%22%7D.ra-bowling-pin:before%7Bcontent:%5C%22%EE%A5%81%5C%22%7D.ra-brain-freeze:before%7Bcontent:%5C%22%EE%A5%82%5C%22%7D.ra-brandy-bottle:before%7Bcontent:%5C%22%EE%A5%83%5C%22%7D.ra-bridge:before%7Bcontent:%5C%22%EE%A5%84%5C%22%7D.ra-broadhead-arrow:before%7Bcontent:%5C%22%EE%A5%85%5C%22%7D.ra-broadsword:before,.ra-sword:before%7Bcontent:%5C%22%EE%A5%86%5C%22%7D.ra-broken-bone:before%7Bcontent:%5C%22%EE%A5%87%5C%22%7D.ra-broken-bottle:before,.ra-broken-heart:before%7Bcontent:%5C%22%EE%A5%88%5C%22%7D.ra-broken-shield:before%7Bcontent:%5C%22%EE%A5%8A%5C%22%7D.ra-broken-skull:before%7Bcontent:%5C%22%EE%A5%8B%5C%22%7D.ra-bubbling-potion:before%7Bcontent:%5C%22%EE%A5%8C%5C%22%7D.ra-bullets:before%7Bcontent:%5C%22%EE%A5%8D%5C%22%7D.ra-burning-book:before%7Bcontent:%5C%22%EE%A5%8E%5C%22%7D.ra-burning-embers:before%7Bcontent:%5C%22%EE%A5%8F%5C%22%7D.ra-burning-eye:before%7Bcontent:%5C%22%EE%A5%90%5C%22%7D.ra-burning-meteor:before%7Bcontent:%5C%22%EE%A5%91%5C%22%7D.ra-burst-blob:before%7Bcontent:%5C%22%EE%A5%92%5C%22%7D.ra-butterfly:before%7Bcontent:%5C%22%EE%A5%93%5C%22%7D.ra-campfire:before%7Bcontent:%5C%22%EE%A5%94%5C%22%7D.ra-cancel:before%7Bcontent:%5C%22%EE%A5%95%5C%22%7D.ra-cancer:before%7Bcontent:%5C%22%EE%A5%96%5C%22%7D.ra-candle:before%7Bcontent:%5C%22%EE%A5%98%5C%22%7D.ra-candle-fire:before%7Bcontent:%5C%22%EE%A5%97%5C%22%7D.ra-cannon-shot:before%7Bcontent:%5C%22%EE%A5%99%5C%22%7D.ra-capitol:before%7Bcontent:%5C%22%EE%A5%9A%5C%22%7D.ra-capricorn:before%7Bcontent:%5C%22%EE%A5%9B%5C%22%7D.ra-carrot:before%7Bcontent:%5C%22%EE%A5%9C%5C%22%7D.ra-castle-emblem:before%7Bcontent:%5C%22%EE%A5%9D%5C%22%7D.ra-castle-flag:before%7Bcontent:%5C%22%EE%A5%9E%5C%22%7D.ra-cat:before%7Bcontent:%5C%22%EE%A5%9F%5C%22%7D.ra-chain:before%7Bcontent:%5C%22%EE%A5%A0%5C%22%7D.ra-cheese:before%7Bcontent:%5C%22%EE%A5%A1%5C%22%7D.ra-chemical-arrow:before%7Bcontent:%5C%22%EE%A5%A2%5C%22%7D.ra-chessboard:before%7Bcontent:%5C%22%EE%A5%A3%5C%22%7D.ra-chicken-leg:before%7Bcontent:%5C%22%EE%A5%A4%5C%22%7D.ra-circle-of-circles:before%7Bcontent:%5C%22%EE%A5%A5%5C%22%7D.ra-circular-saw:before%7Bcontent:%5C%22%EE%A5%A6%5C%22%7D.ra-circular-shield:before%7Bcontent:%5C%22%EE%A5%A7%5C%22%7D.ra-cloak-and-dagger:before%7Bcontent:%5C%22%EE%A5%A8%5C%22%7D.ra-clockwork:before%7Bcontent:%5C%22%EE%A5%A9%5C%22%7D.ra-clover:before%7Bcontent:%5C%22%EE%A5%AA%5C%22%7D.ra-clovers:before%7Bcontent:%5C%22%EE%A5%AC%5C%22%7D.ra-clovers-card:before%7Bcontent:%5C%22%EE%A5%AB%5C%22%7D.ra-cluster-bomb:before%7Bcontent:%5C%22%EE%A5%AD%5C%22%7D.ra-coffee-mug:before%7Bcontent:%5C%22%EE%A5%AE%5C%22%7D.ra-cog:before%7Bcontent:%5C%22%EE%A5%B0%5C%22%7D.ra-cog-wheel:before%7Bcontent:%5C%22%EE%A5%AF%5C%22%7D.ra-cold-heart:before%7Bcontent:%5C%22%EE%A5%B1%5C%22%7D.ra-compass:before%7Bcontent:%5C%22%EE%A5%B2%5C%22%7D.ra-corked-tube:before%7Bcontent:%5C%22%EE%A5%B3%5C%22%7D.ra-crab-claw:before%7Bcontent:%5C%22%EE%A5%B4%5C%22%7D.ra-cracked-helm:before%7Bcontent:%5C%22%EE%A5%B5%5C%22%7D.ra-cracked-shield:before%7Bcontent:%5C%22%EE%A5%B6%5C%22%7D.ra-croc-sword:before%7Bcontent:%5C%22%EE%A5%B7%5C%22%7D.ra-crossbow:before%7Bcontent:%5C%22%EE%A5%B8%5C%22%7D.ra-crossed-axes:before%7Bcontent:%5C%22%EE%A5%B9%5C%22%7D.ra-crossed-bones:before%7Bcontent:%5C%22%EE%A5%BA%5C%22%7D.ra-crossed-pistols:before%7Bcontent:%5C%22%EE%A5%BB%5C%22%7D.ra-crossed-sabres:before%7Bcontent:%5C%22%EE%A5%BC%5C%22%7D.ra-crossed-swords:before%7Bcontent:%5C%22%EE%A5%BD%5C%22%7D.ra-crown:before%7Bcontent:%5C%22%EE%A5%BF%5C%22%7D.ra-crown-of-thorns:before%7Bcontent:%5C%22%EE%A5%BE%5C%22%7D.ra-crowned-heart:before%7Bcontent:%5C%22%EE%A6%80%5C%22%7D.ra-crush:before%7Bcontent:%5C%22%EE%A6%81%5C%22%7D.ra-crystal-ball:before%7Bcontent:%5C%22%EE%A6%82%5C%22%7D.ra-crystal-cluster:before%7Bcontent:%5C%22%EE%A6%83%5C%22%7D.ra-crystal-wand:before%7Bcontent:%5C%22%EE%A6%84%5C%22%7D.ra-crystals:before%7Bcontent:%5C%22%EE%A6%85%5C%22%7D.ra-cubes:before%7Bcontent:%5C%22%EE%A6%86%5C%22%7D.ra-cut-palm:before%7Bcontent:%5C%22%EE%A6%87%5C%22%7D.ra-cycle:before%7Bcontent:%5C%22%EE%A6%88%5C%22%7D.ra-daggers:before%7Bcontent:%5C%22%EE%A6%89%5C%22%7D.ra-daisy:before%7Bcontent:%5C%22%EE%A6%8A%5C%22%7D.ra-dead-tree:before%7Bcontent:%5C%22%EE%A6%8B%5C%22%7D.ra-death-skull:before%7Bcontent:%5C%22%EE%A6%8C%5C%22%7D.ra-decapitation:before%7Bcontent:%5C%22%EE%A6%8D%5C%22%7D.ra-defibrilate:before%7Bcontent:%5C%22%EE%A6%8E%5C%22%7D.ra-demolish:before%7Bcontent:%5C%22%EE%A6%8F%5C%22%7D.ra-dervish-swords:before%7Bcontent:%5C%22%EE%A6%90%5C%22%7D.ra-desert-skull:before%7Bcontent:%5C%22%EE%A6%91%5C%22%7D.ra-diamond:before%7Bcontent:%5C%22%EE%A6%92%5C%22%7D.ra-diamonds:before%7Bcontent:%5C%22%EE%A6%94%5C%22%7D.ra-diamonds-card:before%7Bcontent:%5C%22%EE%A6%93%5C%22%7D.ra-dice-five:before%7Bcontent:%5C%22%EE%A6%95%5C%22%7D.ra-dice-four:before%7Bcontent:%5C%22%EE%A6%96%5C%22%7D.ra-dice-one:before%7Bcontent:%5C%22%EE%A6%97%5C%22%7D.ra-dice-six:before%7Bcontent:%5C%22%EE%A6%98%5C%22%7D.ra-dice-three:before%7Bcontent:%5C%22%EE%A6%99%5C%22%7D.ra-dice-two:before%7Bcontent:%5C%22%EE%A6%9A%5C%22%7D.ra-dinosaur:before%7Bcontent:%5C%22%EE%A6%9B%5C%22%7D.ra-divert:before%7Bcontent:%5C%22%EE%A6%9C%5C%22%7D.ra-diving-dagger:before%7Bcontent:%5C%22%EE%A6%9D%5C%22%7D.ra-double-team:before%7Bcontent:%5C%22%EE%A6%9E%5C%22%7D.ra-doubled:before%7Bcontent:%5C%22%EE%A6%9F%5C%22%7D.ra-dragon:before%7Bcontent:%5C%22%EE%A6%A2%5C%22%7D.ra-dragon-breath:before%7Bcontent:%5C%22%EE%A6%A0%5C%22%7D.ra-dragon-wing:before%7Bcontent:%5C%22%EE%A6%A1%5C%22%7D.ra-dragonfly:before%7Bcontent:%5C%22%EE%A6%A3%5C%22%7D.ra-drill:before%7Bcontent:%5C%22%EE%A6%A4%5C%22%7D.ra-dripping-blade:before%7Bcontent:%5C%22%EE%A6%A5%5C%22%7D.ra-dripping-knife:before%7Bcontent:%5C%22%EE%A6%A6%5C%22%7D.ra-dripping-sword:before%7Bcontent:%5C%22%EE%A6%A7%5C%22%7D.ra-droplet:before%7Bcontent:%5C%22%EE%A6%A9%5C%22%7D.ra-droplet-splash:before%7Bcontent:%5C%22%EE%A6%A8%5C%22%7D.ra-droplets:before%7Bcontent:%5C%22%EE%A6%AA%5C%22%7D.ra-duel:before%7Bcontent:%5C%22%EE%A6%AB%5C%22%7D.ra-egg:before%7Bcontent:%5C%22%EE%A6%AD%5C%22%7D.ra-egg-pod:before%7Bcontent:%5C%22%EE%A6%AC%5C%22%7D.ra-eggplant:before%7Bcontent:%5C%22%EE%A6%AE%5C%22%7D.ra-emerald:before%7Bcontent:%5C%22%EE%A6%AF%5C%22%7D.ra-energise:before%7Bcontent:%5C%22%EE%A6%B0%5C%22%7D.ra-explosion:before%7Bcontent:%5C%22%EE%A6%B1%5C%22%7D.ra-explosive-materials:before%7Bcontent:%5C%22%EE%A6%B2%5C%22%7D.ra-eye-monster:before%7Bcontent:%5C%22%EE%A6%B3%5C%22%7D.ra-eye-shield:before%7Bcontent:%5C%22%EE%A6%B4%5C%22%7D.ra-eyeball:before%7Bcontent:%5C%22%EE%A6%B5%5C%22%7D.ra-fairy:before%7Bcontent:%5C%22%EE%A6%B7%5C%22%7D.ra-fairy-wand:before%7Bcontent:%5C%22%EE%A6%B6%5C%22%7D.ra-fall-down:before%7Bcontent:%5C%22%EE%A6%B8%5C%22%7D.ra-falling:before%7Bcontent:%5C%22%EE%A6%B9%5C%22%7D.ra-fast-ship:before%7Bcontent:%5C%22%EE%A6%BA%5C%22%7D.ra-feather-wing:before%7Bcontent:%5C%22%EE%A6%BB%5C%22%7D.ra-feathered-wing:before%7Bcontent:%5C%22%EE%A6%BC%5C%22%7D.ra-fedora:before%7Bcontent:%5C%22%EE%A6%BD%5C%22%7D.ra-fire:before%7Bcontent:%5C%22%EE%A7%83%5C%22%7D.ra-fire-bomb:before%7Bcontent:%5C%22%EE%A6%BE%5C%22%7D.ra-fire-breath:before%7Bcontent:%5C%22%EE%A6%BF%5C%22%7D.ra-fire-ring:before%7Bcontent:%5C%22%EE%A7%80%5C%22%7D.ra-fire-shield:before%7Bcontent:%5C%22%EE%A7%81%5C%22%7D.ra-fire-symbol:before%7Bcontent:%5C%22%EE%A7%82%5C%22%7D.ra-fireball-sword:before%7Bcontent:%5C%22%EE%A7%84%5C%22%7D.ra-fish:before%7Bcontent:%5C%22%EE%A7%85%5C%22%7D.ra-fizzing-flask:before%7Bcontent:%5C%22%EE%A7%86%5C%22%7D.ra-flame-symbol:before%7Bcontent:%5C%22%EE%A7%87%5C%22%7D.ra-flaming-arrow:before%7Bcontent:%5C%22%EE%A7%88%5C%22%7D.ra-flaming-claw:before%7Bcontent:%5C%22%EE%A7%89%5C%22%7D.ra-flaming-trident:before%7Bcontent:%5C%22%EE%A7%8A%5C%22%7D.ra-flask:before%7Bcontent:%5C%22%EE%A7%8B%5C%22%7D.ra-flat-hammer:before%7Bcontent:%5C%22%EE%A7%8C%5C%22%7D.ra-flower:before%7Bcontent:%5C%22%EE%A7%8D%5C%22%7D.ra-flowers:before%7Bcontent:%5C%22%EE%A7%8E%5C%22%7D.ra-fluffy-swirl:before%7Bcontent:%5C%22%EE%A7%8F%5C%22%7D.ra-focused-lightning:before%7Bcontent:%5C%22%EE%A7%90%5C%22%7D.ra-food-chain:before%7Bcontent:%5C%22%EE%A7%91%5C%22%7D.ra-footprint:before%7Bcontent:%5C%22%EE%A7%92%5C%22%7D.ra-forging:before%7Bcontent:%5C%22%EE%A7%93%5C%22%7D.ra-forward:before%7Bcontent:%5C%22%EE%A7%94%5C%22%7D.ra-fox:before%7Bcontent:%5C%22%EE%A7%95%5C%22%7D.ra-frost-emblem:before%7Bcontent:%5C%22%EE%A7%96%5C%22%7D.ra-frostfire:before%7Bcontent:%5C%22%EE%A7%97%5C%22%7D.ra-frozen-arrow:before%7Bcontent:%5C%22%EE%A7%98%5C%22%7D.ra-gamepad-cross:before%7Bcontent:%5C%22%EE%A7%99%5C%22%7D.ra-gavel:before%7Bcontent:%5C%22%EE%A7%9A%5C%22%7D.ra-gear-hammer:before%7Bcontent:%5C%22%EE%A7%9B%5C%22%7D.ra-gear-heart:before%7Bcontent:%5C%22%EE%A7%9C%5C%22%7D.ra-gears:before%7Bcontent:%5C%22%EE%A7%9D%5C%22%7D.ra-gecko:before%7Bcontent:%5C%22%EE%A7%9E%5C%22%7D.ra-gem:before%7Bcontent:%5C%22%EE%A7%A0%5C%22%7D.ra-gem-pendant:before%7Bcontent:%5C%22%EE%A7%9F%5C%22%7D.ra-gemini:before%7Bcontent:%5C%22%EE%A7%A1%5C%22%7D.ra-glass-heart:before%7Bcontent:%5C%22%EE%A7%A2%5C%22%7D.ra-gloop:before%7Bcontent:%5C%22%EE%A7%A3%5C%22%7D.ra-gold-bar:before%7Bcontent:%5C%22%EE%A7%A4%5C%22%7D.ra-grappling-hook:before%7Bcontent:%5C%22%EE%A7%A5%5C%22%7D.ra-grass:before%7Bcontent:%5C%22%EE%A7%A7%5C%22%7D.ra-grass-patch:before%7Bcontent:%5C%22%EE%A7%A6%5C%22%7D.ra-grenade:before%7Bcontent:%5C%22%EE%A7%A8%5C%22%7D.ra-groundbreaker:before%7Bcontent:%5C%22%EE%A7%A9%5C%22%7D.ra-guarded-tower:before%7Bcontent:%5C%22%EE%A7%AA%5C%22%7D.ra-guillotine:before%7Bcontent:%5C%22%EE%A7%AB%5C%22%7D.ra-halberd:before%7Bcontent:%5C%22%EE%A7%AC%5C%22%7D.ra-hammer:before%7Bcontent:%5C%22%EE%A7%AE%5C%22%7D.ra-hammer-drop:before%7Bcontent:%5C%22%EE%A7%AD%5C%22%7D.ra-hand:before%7Bcontent:%5C%22%EE%A7%B1%5C%22%7D.ra-hand-emblem:before%7Bcontent:%5C%22%EE%A7%AF%5C%22%7D.ra-hand-saw:before%7Bcontent:%5C%22%EE%A7%B0%5C%22%7D.ra-harpoon-trident:before%7Bcontent:%5C%22%EE%A7%B2%5C%22%7D.ra-health:before%7Bcontent:%5C%22%EE%A7%B5%5C%22%7D.ra-health-decrease:before%7Bcontent:%5C%22%EE%A7%B3%5C%22%7D.ra-health-increase:before%7Bcontent:%5C%22%EE%A7%B4%5C%22%7D.ra-heart-bottle:before%7Bcontent:%5C%22%EE%A7%B6%5C%22%7D.ra-heart-tower:before%7Bcontent:%5C%22%EE%A7%B7%5C%22%7D.ra-heartburn:before%7Bcontent:%5C%22%EE%A7%B8%5C%22%7D.ra-hearts:before%7Bcontent:%5C%22%EE%A7%BA%5C%22%7D.ra-hearts-card:before%7Bcontent:%5C%22%EE%A7%B9%5C%22%7D.ra-heat-haze:before%7Bcontent:%5C%22%EE%A7%BB%5C%22%7D.ra-heavy-fall:before%7Bcontent:%5C%22%EE%A7%BC%5C%22%7D.ra-heavy-shield:before%7Bcontent:%5C%22%EE%A7%BD%5C%22%7D.ra-helmet:before%7Bcontent:%5C%22%EE%A7%BE%5C%22%7D.ra-help:before%7Bcontent:%5C%22%EE%A7%BF%5C%22%7D.ra-hive-emblem:before%7Bcontent:%5C%22%EE%A8%80%5C%22%7D.ra-hole-ladder:before%7Bcontent:%5C%22%EE%A8%81%5C%22%7D.ra-honeycomb:before%7Bcontent:%5C%22%EE%A8%82%5C%22%7D.ra-hood:before%7Bcontent:%5C%22%EE%A8%83%5C%22%7D.ra-horn-call:before%7Bcontent:%5C%22%EE%A8%84%5C%22%7D.ra-horns:before%7Bcontent:%5C%22%EE%A8%85%5C%22%7D.ra-horseshoe:before%7Bcontent:%5C%22%EE%A8%86%5C%22%7D.ra-hospital-cross:before%7Bcontent:%5C%22%EE%A8%87%5C%22%7D.ra-hot-surface:before%7Bcontent:%5C%22%EE%A8%88%5C%22%7D.ra-hourglass:before%7Bcontent:%5C%22%EE%A8%89%5C%22%7D.ra-hydra:before%7Bcontent:%5C%22%EE%A8%8B%5C%22%7D.ra-hydra-shot:before%7Bcontent:%5C%22%EE%A8%8A%5C%22%7D.ra-ice-cube:before%7Bcontent:%5C%22%EE%A8%8C%5C%22%7D.ra-implosion:before%7Bcontent:%5C%22%EE%A8%8D%5C%22%7D.ra-incense:before%7Bcontent:%5C%22%EE%A8%8E%5C%22%7D.ra-insect-jaws:before%7Bcontent:%5C%22%EE%A8%8F%5C%22%7D.ra-interdiction:before%7Bcontent:%5C%22%EE%A8%90%5C%22%7D.ra-jetpack:before%7Bcontent:%5C%22%EE%A8%91%5C%22%7D.ra-jigsaw-piece:before%7Bcontent:%5C%22%EE%A8%92%5C%22%7D.ra-kaleidoscope:before%7Bcontent:%5C%22%EE%A8%93%5C%22%7D.ra-kettlebell:before%7Bcontent:%5C%22%EE%A8%94%5C%22%7D.ra-key:before%7Bcontent:%5C%22%EE%A8%96%5C%22%7D.ra-key-basic:before%7Bcontent:%5C%22%EE%A8%95%5C%22%7D.ra-kitchen-knives:before%7Bcontent:%5C%22%EE%A8%97%5C%22%7D.ra-knife:before%7Bcontent:%5C%22%EE%A8%99%5C%22%7D.ra-knife-fork:before%7Bcontent:%5C%22%EE%A8%98%5C%22%7D.ra-knight-helmet:before%7Bcontent:%5C%22%EE%A8%9A%5C%22%7D.ra-kunai:before%7Bcontent:%5C%22%EE%A8%9B%5C%22%7D.ra-lantern-flame:before%7Bcontent:%5C%22%EE%A8%9C%5C%22%7D.ra-large-hammer:before%7Bcontent:%5C%22%EE%A8%9D%5C%22%7D.ra-laser-blast:before%7Bcontent:%5C%22%EE%A8%9E%5C%22%7D.ra-laser-site:before%7Bcontent:%5C%22%EE%A8%9F%5C%22%7D.ra-lava:before%7Bcontent:%5C%22%EE%A8%A0%5C%22%7D.ra-leaf:before%7Bcontent:%5C%22%EE%A8%A1%5C%22%7D.ra-leo:before%7Bcontent:%5C%22%EE%A8%A2%5C%22%7D.ra-level-four:before%7Bcontent:%5C%22%EE%A8%A4%5C%22%7D.ra-level-four-advanced:before%7Bcontent:%5C%22%EE%A8%A3%5C%22%7D.ra-level-three:before%7Bcontent:%5C%22%EE%A8%A6%5C%22%7D.ra-level-three-advanced:before%7Bcontent:%5C%22%EE%A8%A5%5C%22%7D.ra-level-two:before%7Bcontent:%5C%22%EE%A8%A8%5C%22%7D.ra-level-two-advanced:before%7Bcontent:%5C%22%EE%A8%A7%5C%22%7D.ra-lever:before%7Bcontent:%5C%22%EE%A8%A9%5C%22%7D.ra-libra:before%7Bcontent:%5C%22%EE%A8%AA%5C%22%7D.ra-light-bulb:before%7Bcontent:%5C%22%EE%A8%AB%5C%22%7D.ra-lighthouse:before%7Bcontent:%5C%22%EE%A8%AC%5C%22%7D.ra-lightning:before%7Bcontent:%5C%22%EE%A8%B1%5C%22%7D.ra-lightning-bolt:before%7Bcontent:%5C%22%EE%A8%AD%5C%22%7D.ra-lightning-storm:before%7Bcontent:%5C%22%EE%A8%AE%5C%22%7D.ra-lightning-sword:before%7Bcontent:%5C%22%EE%A8%AF%5C%22%7D.ra-lightning-trio:before%7Bcontent:%5C%22%EE%A8%B0%5C%22%7D.ra-lion:before%7Bcontent:%5C%22%EE%A8%B2%5C%22%7D.ra-lit-candelabra:before%7Bcontent:%5C%22%EE%A8%B3%5C%22%7D.ra-load:before%7Bcontent:%5C%22%EE%A8%B4%5C%22%7D.ra-locked-fortress:before%7Bcontent:%5C%22%EE%A8%B5%5C%22%7D.ra-love-howl:before%7Bcontent:%5C%22%EE%A8%B6%5C%22%7D.ra-maggot:before%7Bcontent:%5C%22%EE%A8%B7%5C%22%7D.ra-magnet:before%7Bcontent:%5C%22%EE%A8%B8%5C%22%7D.ra-mass-driver:before%7Bcontent:%5C%22%EE%A8%B9%5C%22%7D.ra-match:before%7Bcontent:%5C%22%EE%A8%BA%5C%22%7D.ra-meat:before%7Bcontent:%5C%22%EE%A8%BC%5C%22%7D.ra-meat-hook:before%7Bcontent:%5C%22%EE%A8%BB%5C%22%7D.ra-medical-pack:before%7Bcontent:%5C%22%EE%A8%BD%5C%22%7D.ra-metal-gate:before%7Bcontent:%5C%22%EE%A8%BE%5C%22%7D.ra-microphone:before%7Bcontent:%5C%22%EE%A8%BF%5C%22%7D.ra-mine-wagon:before%7Bcontent:%5C%22%EE%A9%80%5C%22%7D.ra-mining-diamonds:before%7Bcontent:%5C%22%EE%A9%81%5C%22%7D.ra-mirror:before%7Bcontent:%5C%22%EE%A9%82%5C%22%7D.ra-monster-skull:before%7Bcontent:%5C%22%EE%A9%83%5C%22%7D.ra-mountains:before%7Bcontent:%5C%22%EE%A9%84%5C%22%7D.ra-moon-sun:before%7Bcontent:%5C%22%EE%A9%85%5C%22%7D.ra-mp5:before%7Bcontent:%5C%22%EE%A9%86%5C%22%7D.ra-muscle-fat:before%7Bcontent:%5C%22%EE%A9%87%5C%22%7D.ra-muscle-up:before%7Bcontent:%5C%22%EE%A9%88%5C%22%7D.ra-musket:before%7Bcontent:%5C%22%EE%A9%89%5C%22%7D.ra-nails:before%7Bcontent:%5C%22%EE%A9%8A%5C%22%7D.ra-nodular:before%7Bcontent:%5C%22%EE%A9%8B%5C%22%7D.ra-noose:before%7Bcontent:%5C%22%EE%A9%8C%5C%22%7D.ra-nuclear:before%7Bcontent:%5C%22%EE%A9%8D%5C%22%7D.ra-ocarina:before%7Bcontent:%5C%22%EE%A9%8E%5C%22%7D.ra-ocean-emblem:before%7Bcontent:%5C%22%EE%A9%8F%5C%22%7D.ra-octopus:before%7Bcontent:%5C%22%EE%A9%90%5C%22%7D.ra-omega:before%7Bcontent:%5C%22%EE%A9%91%5C%22%7D.ra-on-target:before%7Bcontent:%5C%22%EE%A9%92%5C%22%7D.ra-ophiuchus:before%7Bcontent:%5C%22%EE%A9%93%5C%22%7D.ra-overhead:before%7Bcontent:%5C%22%EE%A9%94%5C%22%7D.ra-overmind:before%7Bcontent:%5C%22%EE%A9%95%5C%22%7D.ra-palm-tree:before%7Bcontent:%5C%22%EE%A9%96%5C%22%7D.ra-pawn:before%7Bcontent:%5C%22%EE%A9%97%5C%22%7D.ra-pawprint:before%7Bcontent:%5C%22%EE%A9%98%5C%22%7D.ra-perspective-dice-five:before%7Bcontent:%5C%22%EE%A9%99%5C%22%7D.ra-perspective-dice-four:before%7Bcontent:%5C%22%EE%A9%9A%5C%22%7D.ra-perspective-dice-one:before%7Bcontent:%5C%22%EE%A9%9B%5C%22%7D.ra-perspective-dice-random:before%7Bcontent:%5C%22%EE%A9%9C%5C%22%7D.ra-perspective-dice-six:before%7Bcontent:%5C%22%EE%A9%9E%5C%22%7D.ra-perspective-dice-two:before%7Bcontent:%5C%22%EE%A9%9D%5C%22%7D.ra-perspective-dice-three:before%7Bcontent:%5C%22%EE%A9%9F%5C%22%7D.ra-pill:before%7Bcontent:%5C%22%EE%A9%A0%5C%22%7D.ra-pills:before%7Bcontent:%5C%22%EE%A9%A1%5C%22%7D.ra-pine-tree:before%7Bcontent:%5C%22%EE%A9%A2%5C%22%7D.ra-ping-pong:before%7Bcontent:%5C%22%EE%A9%A3%5C%22%7D.ra-pisces:before%7Bcontent:%5C%22%EE%A9%A4%5C%22%7D.ra-plain-dagger:before%7Bcontent:%5C%22%EE%A9%A5%5C%22%7D.ra-player:before%7Bcontent:%5C%22%EE%A9%AF%5C%22%7D.ra-player-despair:before%7Bcontent:%5C%22%EE%A9%A6%5C%22%7D.ra-player-dodge:before%7Bcontent:%5C%22%EE%A9%A7%5C%22%7D.ra-player-king:before%7Bcontent:%5C%22%EE%A9%A8%5C%22%7D.ra-player-lift:before%7Bcontent:%5C%22%EE%A9%A9%5C%22%7D.ra-player-pain:before%7Bcontent:%5C%22%EE%A9%AA%5C%22%7D.ra-player-pyromaniac:before%7Bcontent:%5C%22%EE%A9%AB%5C%22%7D.ra-player-shot:before%7Bcontent:%5C%22%EE%A9%AC%5C%22%7D.ra-player-teleport:before%7Bcontent:%5C%22%EE%A9%AD%5C%22%7D.ra-player-thunder-struck:before%7Bcontent:%5C%22%EE%A9%AE%5C%22%7D.ra-podium:before%7Bcontent:%5C%22%EE%A9%B0%5C%22%7D.ra-poison-cloud:before%7Bcontent:%5C%22%EE%A9%B1%5C%22%7D.ra-potion:before%7Bcontent:%5C%22%EE%A9%B2%5C%22%7D.ra-pyramids:before%7Bcontent:%5C%22%EE%A9%B3%5C%22%7D.ra-queen-crown:before%7Bcontent:%5C%22%EE%A9%B4%5C%22%7D.ra-quill-ink:before%7Bcontent:%5C%22%EE%A9%B5%5C%22%7D.ra-rabbit:before%7Bcontent:%5C%22%EE%A9%B6%5C%22%7D.ra-radar-dish:before%7Bcontent:%5C%22%EE%A9%B7%5C%22%7D.ra-radial-balance:before%7Bcontent:%5C%22%EE%A9%B8%5C%22%7D.ra-radioactive:before%7Bcontent:%5C%22%EE%A9%B9%5C%22%7D.ra-raven:before%7Bcontent:%5C%22%EE%A9%BA%5C%22%7D.ra-reactor:before%7Bcontent:%5C%22%EE%A9%BB%5C%22%7D.ra-recycle:before%7Bcontent:%5C%22%EE%A9%BC%5C%22%7D.ra-regeneration:before%7Bcontent:%5C%22%EE%A9%BD%5C%22%7D.ra-relic-blade:before%7Bcontent:%5C%22%EE%A9%BE%5C%22%7D.ra-repair:before%7Bcontent:%5C%22%EE%A9%BF%5C%22%7D.ra-reverse:before%7Bcontent:%5C%22%EE%AA%80%5C%22%7D.ra-revolver:before%7Bcontent:%5C%22%EE%AA%81%5C%22%7D.ra-rifle:before%7Bcontent:%5C%22%EE%AA%82%5C%22%7D.ra-ringing-bell:before%7Bcontent:%5C%22%EE%AA%83%5C%22%7D.ra-roast-chicken:before%7Bcontent:%5C%22%EE%AA%84%5C%22%7D.ra-robot-arm:before%7Bcontent:%5C%22%EE%AA%85%5C%22%7D.ra-round-bottom-flask:before%7Bcontent:%5C%22%EE%AA%86%5C%22%7D.ra-round-shield:before%7Bcontent:%5C%22%EE%AA%87%5C%22%7D.ra-rss:before%7Bcontent:%5C%22%EE%AA%88%5C%22%7D.ra-rune-stone:before%7Bcontent:%5C%22%EE%AA%89%5C%22%7D.ra-sagittarius:before%7Bcontent:%5C%22%EE%AA%8A%5C%22%7D.ra-sapphire:before%7Bcontent:%5C%22%EE%AA%8B%5C%22%7D.ra-sattelite:before%7Bcontent:%5C%22%EE%AA%8C%5C%22%7D.ra-save:before%7Bcontent:%5C%22%EE%AA%8D%5C%22%7D.ra-scorpio:before%7Bcontent:%5C%22%EE%AA%8E%5C%22%7D.ra-scroll-unfurled:before%7Bcontent:%5C%22%EE%AA%8F%5C%22%7D.ra-scythe:before%7Bcontent:%5C%22%EE%AA%90%5C%22%7D.ra-sea-serpent:before%7Bcontent:%5C%22%EE%AA%91%5C%22%7D.ra-seagull:before%7Bcontent:%5C%22%EE%AA%92%5C%22%7D.ra-shark:before%7Bcontent:%5C%22%EE%AA%93%5C%22%7D.ra-sheep:before%7Bcontent:%5C%22%EE%AA%94%5C%22%7D.ra-sherif:before%7Bcontent:%5C%22%EE%AA%95%5C%22%7D.ra-shield:before%7Bcontent:%5C%22%EE%AA%96%5C%22%7D.ra-ship-emblem:before%7Bcontent:%5C%22%EE%AA%97%5C%22%7D.ra-shoe-prints:before%7Bcontent:%5C%22%EE%AA%98%5C%22%7D.ra-shot-through-the-heart:before%7Bcontent:%5C%22%EE%AA%99%5C%22%7D.ra-shotgun-shell:before%7Bcontent:%5C%22%EE%AA%9A%5C%22%7D.ra-shovel:before%7Bcontent:%5C%22%EE%AA%9B%5C%22%7D.ra-shuriken:before%7Bcontent:%5C%22%EE%AA%9C%5C%22%7D.ra-sickle:before%7Bcontent:%5C%22%EE%AA%9D%5C%22%7D.ra-sideswipe:before%7Bcontent:%5C%22%EE%AA%9E%5C%22%7D.ra-site:before%7Bcontent:%5C%22%EE%AA%9F%5C%22%7D.ra-skull:before%7Bcontent:%5C%22%EE%AA%A1%5C%22%7D.ra-skull-trophy:before%7Bcontent:%5C%22%EE%AA%A0%5C%22%7D.ra-slash-ring:before%7Bcontent:%5C%22%EE%AA%A2%5C%22%7D.ra-small-fire:before%7Bcontent:%5C%22%EE%AA%A3%5C%22%7D.ra-snail:before%7Bcontent:%5C%22%EE%AA%A4%5C%22%7D.ra-snake:before%7Bcontent:%5C%22%EE%AA%A5%5C%22%7D.ra-snorkel:before%7Bcontent:%5C%22%EE%AA%A6%5C%22%7D.ra-snowflake:before%7Bcontent:%5C%22%EE%AA%A7%5C%22%7D.ra-soccer-ball:before%7Bcontent:%5C%22%EE%AA%A8%5C%22%7D.ra-spades:before%7Bcontent:%5C%22%EE%AA%AA%5C%22%7D.ra-spades-card:before%7Bcontent:%5C%22%EE%AA%A9%5C%22%7D.ra-spawn-node:before%7Bcontent:%5C%22%EE%AA%AB%5C%22%7D.ra-spear-head:before%7Bcontent:%5C%22%EE%AA%AC%5C%22%7D.ra-speech-bubble:before%7Bcontent:%5C%22%EE%AA%AD%5C%22%7D.ra-speech-bubbles:before%7Bcontent:%5C%22%EE%AA%AE%5C%22%7D.ra-spider-face:before%7Bcontent:%5C%22%EE%AA%AF%5C%22%7D.ra-spikeball:before%7Bcontent:%5C%22%EE%AA%B0%5C%22%7D.ra-spiked-mace:before%7Bcontent:%5C%22%EE%AA%B1%5C%22%7D.ra-spiked-tentacle:before%7Bcontent:%5C%22%EE%AA%B2%5C%22%7D.ra-spinning-sword:before%7Bcontent:%5C%22%EE%AA%B3%5C%22%7D.ra-spiral-shell:before%7Bcontent:%5C%22%EE%AA%B4%5C%22%7D.ra-splash:before%7Bcontent:%5C%22%EE%AA%B5%5C%22%7D.ra-spray-can:before%7Bcontent:%5C%22%EE%AA%B6%5C%22%7D.ra-sprout:before%7Bcontent:%5C%22%EE%AA%B8%5C%22%7D.ra-sprout-emblem:before%7Bcontent:%5C%22%EE%AA%B7%5C%22%7D.ra-stopwatch:before%7Bcontent:%5C%22%EE%AA%B9%5C%22%7D.ra-suckered-tentacle:before%7Bcontent:%5C%22%EE%AA%BA%5C%22%7D.ra-suits:before%7Bcontent:%5C%22%EE%AA%BB%5C%22%7D.ra-sun:before%7Bcontent:%5C%22%EE%AA%BD%5C%22%7D.ra-sun-symbol:before%7Bcontent:%5C%22%EE%AA%BC%5C%22%7D.ra-sunbeams:before%7Bcontent:%5C%22%EE%AA%BE%5C%22%7D.ra-super-mushroom:before%7Bcontent:%5C%22%EE%AA%BF%5C%22%7D.ra-supersonic-arrow:before%7Bcontent:%5C%22%EE%AB%80%5C%22%7D.ra-surveillance-camera:before%7Bcontent:%5C%22%EE%AB%81%5C%22%7D.ra-syringe:before%7Bcontent:%5C%22%EE%AB%82%5C%22%7D.ra-target-arrows:before%7Bcontent:%5C%22%EE%AB%83%5C%22%7D.ra-target-laser:before%7Bcontent:%5C%22%EE%AB%84%5C%22%7D.ra-targeted:before%7Bcontent:%5C%22%EE%AB%85%5C%22%7D.ra-taurus:before%7Bcontent:%5C%22%EE%AB%86%5C%22%7D.ra-telescope:before%7Bcontent:%5C%22%EE%AB%87%5C%22%7D.ra-tentacle:before%7Bcontent:%5C%22%EE%AB%88%5C%22%7D.ra-tesla:before%7Bcontent:%5C%22%EE%AB%89%5C%22%7D.ra-thorn-arrow:before%7Bcontent:%5C%22%EE%AB%8A%5C%22%7D.ra-thorny-vine:before%7Bcontent:%5C%22%EE%AB%8B%5C%22%7D.ra-three-keys:before%7Bcontent:%5C%22%EE%AB%8C%5C%22%7D.ra-tic-tac-toe:before%7Bcontent:%5C%22%EE%AB%8D%5C%22%7D.ra-toast:before%7Bcontent:%5C%22%EE%AB%8E%5C%22%7D.ra-tombstone:before%7Bcontent:%5C%22%EE%AB%8F%5C%22%7D.ra-tooth:before%7Bcontent:%5C%22%EE%AB%90%5C%22%7D.ra-torch:before%7Bcontent:%5C%22%EE%AB%91%5C%22%7D.ra-tower:before%7Bcontent:%5C%22%EE%AB%92%5C%22%7D.ra-trail:before%7Bcontent:%5C%22%EE%AB%93%5C%22%7D.ra-trefoil-lily:before%7Bcontent:%5C%22%EE%AB%94%5C%22%7D.ra-trident:before%7Bcontent:%5C%22%EE%AB%95%5C%22%7D.ra-triforce:before%7Bcontent:%5C%22%EE%AB%96%5C%22%7D.ra-trophy:before%7Bcontent:%5C%22%EE%AB%97%5C%22%7D.ra-turd:before%7Bcontent:%5C%22%EE%AB%98%5C%22%7D.ra-two-dragons:before%7Bcontent:%5C%22%EE%AB%99%5C%22%7D.ra-two-hearts:before%7Bcontent:%5C%22%EE%AB%9A%5C%22%7D.ra-uncertainty:before%7Bcontent:%5C%22%EE%AB%9B%5C%22%7D.ra-underhand:before%7Bcontent:%5C%22%EE%AB%9C%5C%22%7D.ra-unplugged:before%7Bcontent:%5C%22%EE%AB%9D%5C%22%7D.ra-vase:before%7Bcontent:%5C%22%EE%AB%9E%5C%22%7D.ra-venomous-snake:before%7Bcontent:%5C%22%EE%AB%9F%5C%22%7D.ra-vest:before%7Bcontent:%5C%22%EE%AB%A0%5C%22%7D.ra-vial:before%7Bcontent:%5C%22%EE%AB%A1%5C%22%7D.ra-vine-whip:before%7Bcontent:%5C%22%EE%AB%A2%5C%22%7D.ra-virgo:before%7Bcontent:%5C%22%EE%AB%A3%5C%22%7D.ra-water-drop:before%7Bcontent:%5C%22%EE%AB%A4%5C%22%7D.ra-wifi:before%7Bcontent:%5C%22%EE%AB%A5%5C%22%7D.ra-wireless-signal:before%7Bcontent:%5C%22%EE%AB%A6%5C%22%7D.ra-wolf-head:before%7Bcontent:%5C%22%EE%AB%A7%5C%22%7D.ra-wolf-howl:before%7Bcontent:%5C%22%EE%AB%A8%5C%22%7D.ra-wooden-sign:before%7Bcontent:%5C%22%EE%AB%A9%5C%22%7D.ra-wrench:before%7Bcontent:%5C%22%EE%AB%AA%5C%22%7D.ra-wyvern:before%7Bcontent:%5C%22%EE%AB%AB%5C%22%7D.ra-x-mark:before%7Bcontent:%5C%22%EE%AB%AC%5C%22%7D.ra-zebra-shield:before%7Bcontent:%5C%22%EE%AB%AD%5C%22%7D.ra-arcane-mask:before%7Bcontent:%5C%22%EE%A4%8C%5C%22%7D.ra-aquarius:before%7Bcontent:%5C%22%EE%A4%8B%5C%22%7D.ra-apple:before%7Bcontent:%5C%22%EE%A4%8A%5C%22%7D.ra-anvil:before%7Bcontent:%5C%22%EE%A4%89%5C%22%7D.ra-ankh:before%7Bcontent:%5C%22%EE%A4%88%5C%22%7D.ra-angel-wings:before%7Bcontent:%5C%22%EE%A4%87%5C%22%7D.ra-anchor:before%7Bcontent:%5C%22%EE%A4%86%5C%22%7D.ra-ammo-bag:before%7Bcontent:%5C%22%EE%A4%85%5C%22%7D.ra-alligator-clip:before%7Bcontent:%5C%22%EE%A4%84%5C%22%7D.ra-all-for-one:before%7Bcontent:%5C%22%EE%A4%83%5C%22%7D.ra-alien-fire:before%7Bcontent:%5C%22%EE%A4%82%5C%22%7D.ra-acorn:before%7Bcontent:%5C%22%EE%A4%81%5C%22%7D%60;%5Cn%5Cn//%20Note%20to%20future%20self:%5Cn//%20generate%20icon%20html%20from%20RPG%20Awesome%20page%20using:%20%5B...document.querySelectorAll(%5C%22h2,%20i%5C%22)%5D.map(el%20=%3E%20el.outerHTML.replace(/%3Ci%20class=%5C%22ra%20ra-(%5B%5E%20%5D+?)%5C%22/g,%60%3Ci%20title=%5C%22%5C%22%20class=%5C%22ra%20ra-%20ra-2x%5C%22%60)).join(%5C%22%5C%5Cn%5C%22)%22,%22imports%22:%5B%5D,%22lastEditTime%22:1613507960457,%22found%22:true%7D,%7B%22name%22:%22t2i-framework-plugin-v2%22,%22modelText%22:%22//%20overall,%20this%20version%20(v2)%20moves%20toward%20the%20approach%20of%20constructing%20prompts%20within%20the%20artStyle%20list,%20such%20that%20you%20can%20e.g.%20place%20user%20inputs%20within%20a%20prompt%20multiple%20times,%20and%20have%20prompt%20construction%20completely%20depend%20on%20the%20art%20style%5Cn%5Cn//%20NOTE:%20the%20notes%20below%20are%20old/outdated.%20lots%20of%20other%20changes%20that%20aren't%20listed%20here.%5Cn%5Cn//%20changes%20(note%20that%20some%20of%20the%20non-breaking%20ones%20were%20back-ported%20to%20v1):%5Cn//%20%20-%20%5Bbreaking%5D%20all%20userInputs%20are%20now%20under%20a%20single%20%60input%60%20global%20variable%20-%20so%20%5Binput.description%5D%20instead%20of%20polluting%20global%20namespace%20with%20%5Bdescription%5D%5Cn//%20%20-%20%5Bbreaking%5D%20no%20more%20_optionName%20for%20%3Cselect%3E%20inputs%20-%20use%20%5Binput.artStyle.getName%5D%20instead%20of%20%5BartStyle_optionName%5D%5Cn//%20%20-%20%5Bbreaking%5D%20no%20more%20'append'/'prepend'%20options%20-%20not%20necessary%20now%20that%20we%20move%20to%20constructing%20prompts%20within%20the%20artStyle%20list%5Cn//%20%20-%20%60remember=true%60%20for%20user%20input%20specs,%20which%20remembers%20values%20even%20after%20page%20reload%5Cn//%20%20-%20multiple%20chat%20channels%5Cn//%20%20-%20html%20select/input%20element%20value%20is%20exposed%20on%20on%20the%20settings.userInputs.foo%20object%5Cn//%20%20-%20%60takesUpFullRow=true%60%20to%20make%20an%20input%20take%20up%20a%20full%20row%5Cn//%20%20-%20%60visible%60%20function%20property%20for%20each%20user%20input%20which%20is%20called%20after%20every%20input%20event%20and%20'generate'%20button%20click%20to%20determine%20whether%20that%20input%20should%20be%20visible%5Cn//%20%20-%20%60localStorage.generateClickCount%60%20tracks%20how%20many%20times%20the%20user%20has%20clicked%20the%20generate%20button%20%5Cn//%20%20-%20a%20lot%20of%20other%20stuff%5Cn%5Cn//%20todo,%20maybe:%5Cn//%20%20-%20%60autoSuggest=true%60%20for%20a%20text%20area%20input%20to%20get%20AI-generated%20completions%20a%20full%20prompt%20suggestions/ideas%20based%20on%20what%20the%20user%20has%20typed%20so%20far%5Cn//%20%20-%20new%20'visual'%20mode%20for%20select%20type%20-%20just%20add%20_image%20sub%20property%20(with%20url)%20to%20your%20options.%20for%20the%20artStyle%20list,%20each%20image%20could%20be%20a%20row%20of%20several%20images%20made%20with%20that%20style%5Cn//%20%20-%20add%20onChange,%20onInput,%20etc.%20to%20the%20user%20input%20objects/nodes%20-%20this%20allows%20e.g.%20changing%20a%20%3Cselect%3E%20option%20based%20on%20what%20the%20user%20types%20into%20an%20%3Cinput%3E%20option%5Cn%5Cn//%20notes:%5Cn//%20%20-%20default%20styles:%20https://perchance.org/t2i-styles#edit%5Cn//%20%20-%20image%20grid%20maker:%20https://perchance.org/image-grid-maker#edit%5Cn//%20%20%5Cn%5CntextToImagePlugin%20=%20%7Bimport:text-to-image-plugin%7D%5CncommentsPlugin%20=%20%7Bimport:comments-plugin%7D%5CnselectLeaf%20=%20%7Bimport:select-leaf-plugin%7D%5CnfullscreenButton%20=%20%7Bimport:fullscreen-button-plugin%7D%5CnaiText%20=%20%7Bimport:ai-text-plugin%7D%5Cnupload%20=%20%7Bimport:upload-plugin%7D%5Cnprompt2%20=%20%7Bimport:prompt2-plugin%7D%5Cnt2iStyles%20=%20%7Bimport:t2i-styles%7D%20//%20this%20wasn't%20originally%20an%20%5C%22official%5C%22%20part%20of%20this%20framework,%20but%20it%20is%20now%20because%20i'm%20using%20it%20for%20the%20character%20chat%20feature%20under%20the%20condition%20that%20there's%20an%20artStyle%20user%20input%20specified%5CntabbedCommentsPlugin%20=%20%7Bimport:tabbed-comments-plugin-v1%7D%5CncreateMediaGalleryPlugin%20=%20%7Bimport:create-media-gallery-plugin%7D%5Cn%5Cn//%20This%20%20function%20simply%20takes%20a%20%60settings%60%20list/hierarchy%20as%20an%20input,%20and%20returns%20the%20full%20HTML%20for%20the%20page%5Cn%5Cn(settings)%20=%3E%5Cn%20%20if(!window.input)%20window.input%20=%20%7B%7D;%5Cn%20%20if(!window.t2i)%20%7B%5Cn%20%20%20%20window.t2i%20=%20%7B%7D;%5Cn%20%20%20%20window.t2i.defaultText%20=%20%7B%5Cn%20%20%20%20%20%20promptTip:%20%60Tip:%20You%20can%20write%20text%20like%20&lcub;blue%7Cred%7Cgreen&rcub;%20and%20a%20random%20one%20will%20be%20chosen%20for%20each%20image.%5C%5Cn%5C%5CnClick%20the%20info%20icon%20on%20an%20image%20to%20see%20the%20prompt%20that%20was%20used.%5C%5Cn%5C%5CnAdd%20brackets%20around%20text%20(like%20this)%20or%20((even%20more))%20to%20get%20the%20AI%20to%20pay%20more%20attention%20to%20it.%60,%5Cn%20%20%20%20%20%20negativePromptTip:%20%60Important:%20If,%20for%20example,%20you%20don't%20want%20the%20image%20to%20have%20blue%20in%20it,%20just%20write%20%5C%22blue%5C%22%20in%20this%20box.%20Don't%20write%20%5C%22no%20blue%5C%22!%20In%20other%20words,%20you%20should%20write%20a%20description%20of%20a%20hypothetical%20%5C%22opposite%20image%5C%22%20of%20what%20you%20want.%60,%5Cn%20%20%20%20%20%20scratchpadTip:%20%60A%20little%20notepad%20for%20you%20to%20keep%20good%20prompts%20and%20stuff.%20It%20'remembers'%20the%20text%20that%20you%20put%20in%20it%20even%20after%20you%20refresh/close%20this%20page.%5C%5Cn%5C%5CnThe%20text%20will%20only%20be%20forgotten%20if%20you%20clear%20your%20browser's%20%5C%22site%20data%5C%22%20(cookies,%20localStorage,%20etc.)%20for%20perchance.org%60,%5Cn%20%20%20%20%20%20scratchpadPlaceholder:%20%60Use%20this%20box%20to%20store%20prompts%20and%20notes.%20They'll%20be%20remembered%20even%20if%20you%20refresh%20this%20page%20(unless%20you%20are%20in%20private%20browsing%20mode).%20Also,%20you%20can%20write:%5C%5Cn%5C%5CnANIMAL%20=%20&lcub;dog%7Cmouse%7Cfrog&rcub;%5C%5Cn%5C%5Cnin%20this%20box,%20and%20then%20write%20'&lsqb;ANIMAL&rsqb;'%20within%20your%20description%20(including%20the%20square%20brackets)%20to%20get%20a%20random%20one%20of%20those%20animals%20for%20each%20generated%20image.%20And%20you%20can%20replace%20the%20%F0%9F%8E%B2%20button's%20outputs%20by%20adding%20a%20DESCRIPTION%20line%20to%20this%20text%20box,%20like%20this:%5C%5Cn%5C%5CnDESCRIPTION%20=%20a%20very%20&lcub;silly%7Ccurious&rcub;%20&lsqb;ANIMAL&rsqb;%60,%5Cn%20%20%20%20%7D;%5Cn%20%20%20%20window.t2i.handyText%20=%20window.t2i.defaultText;%20//%20'handyText'%20was%20the%20old%20name%5Cn%20%20%7D%5Cn%5Cn%20%20//%20Add%20some%20default%20settings%20(it's%20okay%20to%20write%20directly%20to%20the%20input%20parameter,%20because%20it's%20only%20used%20once%20-%20i.e.%20this%20function%20is%20only%20called%20once)%5Cn%20%20if(!settings.imageOptions.style)%20%7B%5Cn%20%20%20%20settings.imageOptions.style%20=%20%5C%22border-radius:3px;%5C%22;%5Cn%20%20%7D%5Cn%5Cn%20%20//%20We%20need%20to%20make%20these%20global%20since%20we%20wnat%20to%20reference%20them%20from%20the%20HTML%20of%20the%20*importing*%20generator%20(e.g.%20in%20click%20handlers,%20etc.)%5Cn%20%20window.___textToImagePlugin746291937%20=%20textToImagePlugin;%5Cn%20%20window.___commentsPlugin746291937%20=%20commentsPlugin;%5Cn%20%20window.___userSettings746291937%20=%20settings;%5Cn%20%20window.___fullscreenButton893479%20=%20fullscreenButton;%5Cn%5Cn//%20%20%20let%20appState;%5Cn//%20%20%20try%20%7B%5Cn//%20%20%20%20%20appState%20=%20JSON.parse(localStorage.appState_nif983gh4tkshdf79834hi);%5Cn//%20%20%20%7D%20catch(e)%20%7B%5Cn//%20%20%20%20%20appState%20=%20%7B%7D;%5Cn//%20%20%20%7D%5Cn%20%20%5Cn//%20%20%20function%20saveAppState()%20%7B%5Cn//%20%20%20%20%20localStorage.appState_nif983gh4tkshdf79834hi%20=%20JSON.stringify(appState);%5Cn//%20%20%20%7D%5Cn%5Cn%5Cn%20%20if(!window.alreadyAddedT2IStuff83927492374)%20%7B%20//%20this%20%20function%20will%20only%20get%20called%20once,%20*except*%20when%20author%20is%20editing%20their%20generator,%20so%20this%20if%20statement/wrapper%20thing%20is%20just%20to%20prevent%20weird%20stuff%20for%20generator%20authors%5Cn%20%20%20%20//%20hide%20some%20clutter%20when%20in%20fullscreen:%5Cn%20%20%20%20document.addEventListener(%5C%22fullscreenchange%5C%22,%20function(e)%20%7B%5Cn%20%20%20%20%20%20let%20fbBtn%20=%20feedbackBtn893745ykfuhd;%5Cn%20%20%20%20%20%20let%20dmBtn%20=%20darkModeBtn_875979f948;%5Cn%20%20%20%20%20%20if(document.fullscreenElement)%20%7B%5Cn%20%20%20%20%20%20%20%20//%20we%20just%20entered%20fullscreen%5Cn%20%20%20%20%20%20%20%20dmBtn.dataset.preFullscreenDisplayValue%20=%20dmBtn.style.display;%5Cn%20%20%20%20%20%20%20%20dmBtn.dataset.duringFullscreenDisplayValue%20=%20%5C%22none%5C%22;%5Cn%20%20%20%20%20%20%20%20dmBtn.style.display%20=%20%5C%22none%5C%22;%5Cn%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20fbBtn.dataset.preFullscreenDisplayValue%20=%20fbBtn.style.display;%5Cn%20%20%20%20%20%20%20%20fbBtn.dataset.duringFullscreenDisplayValue%20=%20%5C%22none%5C%22;%5Cn%20%20%20%20%20%20%20%20fbBtn.style.display%20=%20%5C%22none%5C%22;%5Cn%20%20%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20%20%20//%20we%20just%20exited%20fullscreen,%20so%20we%20revert%20the%20display%20values%20*if*%20they're%20the%20same%20as%20what%20we%20set%20them%20to%20when%20we%20entered%20fullscreen%20(so%20we%20don't%20interfere%20with%20other%20code%20that%20may%20have%20since%20changed%20the%20display%20values)%5Cn%20%20%20%20%20%20%20%20if(dmBtn.style.display%20===%20dmBtn.dataset.duringFullscreenDisplayValue)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20dmBtn.style.display%20=%20dmBtn.dataset.preFullscreenDisplayValue;%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20delete%20dmBtn.dataset.preFullscreenDisplayValue;%5Cn%20%20%20%20%20%20%20%20delete%20dmBtn.dataset.duringFullscreenDisplayValue;%5Cn%20%20%20%20%20%20%20%20if(fbBtn.style.display%20===%20fbBtn.dataset.duringFullscreenDisplayValue)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20fbBtn.style.display%20=%20fbBtn.dataset.preFullscreenDisplayValue;%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20delete%20fbBtn.dataset.preFullscreenDisplayValue;%5Cn%20%20%20%20%20%20%20%20delete%20fbBtn.dataset.duringFullscreenDisplayValue;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%7D);%5Cn%20%20%20%20window.alreadyAddedT2IStuff83927492374%20=%20true;%5Cn%20%20%7D%5Cn%5Cn%20%20window.__createSelectorModal_56974639274%20=%20async%20function(options)%20%7B%20//%20use%20it%20like%20this:%20await%20createSelectorModal(%5B%7Bhtml:%5C%22foo%5C%22,%20value:%5C%22foo%5C%22%7D,%20%7Bhtml:%5C%22bar%5C%22,%20value:%5C%22bar%5C%22%7D%5D)%5Cn%20%20%20%20let%20resolve;%5Cn%20%20%20%20let%20promise%20=%20new%20Promise(r%20=%3E%20resolve%20=%20r);%5Cn%5Cn%20%20%20%20let%20ctn%20=%20document.createElement(%5C%22div%5C%22);%5Cn%20%20%20%20let%20modal%20=%20document.createElement(%5C%22div%5C%22);%5Cn%20%20%20%20ctn.style.cssText%20=%20%60position:fixed;%20top:0;%20left:0;%20width:100%25;%20height:100%25;%20background:rgba(0,0,0,0.3);%20backdrop-filter:%20blur(5px);%20display:flex;%20align-items:center;%20justify-content:center;%60;%5Cn%20%20%20%20modal.style.cssText%20=%20%60max-width:900px;%20width:95%25;%20max-height:95%25;%20background:var(--box-color);%20box-shadow:0%200%2010px%20rgba(0,0,0,0.5);%20overflow:auto;%60;%5Cn%5Cn%20%20%20%20options.forEach(opt%20=%3E%20%7B%5Cn%20%20%20%20%20%20let%20item%20=%20document.createElement(%5C%22div%5C%22);%5Cn%20%20%20%20%20%20item.innerHTML%20=%20opt.html;%5Cn%20%20%20%20%20%20item.style.cssText%20=%20%60margin:0.5rem;%20border:3px%20solid%20$%7Bopt.selected%20?%20%5C%22#565656%5C%22%20:%20%5C%22rgba(0,0,0,0)%5C%22%7D;%20cursor:pointer;%60;%5Cn%20%20%20%20%20%20if(!opt.disabled)%20%7B%5Cn%20%20%20%20%20%20%20%20item.onmouseover%20=%20()%20=%3E%20item.style.border%20=%20%5C%223px%20dashed%20#8a8a8a%5C%22;%5Cn%20%20%20%20%20%20%20%20item.onmouseout%20=%20()%20=%3E%20item.style.border%20=%20opt.selected%20?%20%5C%223px%20solid%20#565656%5C%22%20:%20%5C%223px%20solid%20rgba(0,0,0,0)%5C%22;%5Cn%20%20%20%20%20%20%20%20item.onclick%20=%20()%20=%3E%20resolve(opt.value);%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20modal.appendChild(item);%5Cn%20%20%20%20%7D);%5Cn%5Cn%20%20%20%20ctn.onclick%20=%20(e)%20=%3E%20%7B%5Cn%20%20%20%20%20%20if(e.target%20===%20ctn)%20resolve(null);%20//%20returns%20null%20if%20the%20user%20didn't%20select%20an%20option%20(i.e.%20they%20clicked%20somewhere%20outside%20the%20popup)%5Cn%20%20%20%20%7D;%5Cn%5Cn%20%20%20%20ctn.appendChild(modal);%5Cn%20%20%20%20document.body.append(ctn);%5Cn%5Cn%20%20%20%20let%20value%20=%20await%20promise;%5Cn%20%20%20%20ctn.remove();%5Cn%20%20%20%20return%20value;%5Cn%20%20%7D%5Cn%5Cn%20%20function%20saveRememberedInput(inputName,%20inputValue)%20%7B%5Cn%20%20%20%20localStorage%5B%60rememberedInput_P9hkcjnv92hfO2bf9hiu_$%7BinputName%7D%60%5D%20=%20inputValue;%5Cn%20%20%7D%5Cn%20%20function%20getRememberedInput(inputName)%20%7B%5Cn%20%20%20%20return%20localStorage%5B%60rememberedInput_P9hkcjnv92hfO2bf9hiu_$%7BinputName%7D%60%5D;%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20function%20updateInputVisibilities()%20%7B%5Cn%20%20%20%20let%20userInputs%20=%20window.___userSettings746291937.userInputs;%5Cn%20%20%20%20for(let%20name%20of%20userInputs.getChildNames)%20%7B%5Cn%20%20%20%20%20%20if(userInputs%5Bname%5D.visible%20!==%20undefined)%20%7B%5Cn%20%20%20%20%20%20%20%20userInputs%5Bname%5D._element.closest('.input-ctn').style.display%20=%20userInputs%5Bname%5D.visible()%20?%20%5C%22%5C%22%20:%20%5C%22none%5C%22;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%7D%5Cn%20%20%7D%5Cn%5Cn%20%20/////////////////////////////////////////////////%5Cn%20%20//%20%20%20%20%20handler%20for%20%3Cselect%3E%20element%20changes%20%20%20%20//%5Cn%20%20/////////////////////////////////////////////////%5Cn%20%20window.___selectElChangeEvent746291937%20=%20function(event)%20%7B%5Cn%20%20%20%20let%20userInputSpec%20=%20window.___userSettings746291937.userInputs%5Bthis.dataset.name%5D;%20%20%20%20%5Cn%20%20%20%20let%20optionsList%20=%20userInputSpec.compiledOptions;%5Cn%20%20%20%20%5Cn%20%20%20%20let%20displayName;%5Cn%20%20%20%20if(this.value.startsWith(%5C%22ref:optionKeyName:%5C%22))%20%7B%5Cn%20%20%20%20%20%20//%20this%20option%20wasn't%20just%20a%20simple%20key=value,%20it%20was%20a%20node%20with%20child%20properties,%20so%20we%20expose%20the%20whole%20option%20object/node%20as%20a%20global%20variable%20called%20%60this.dataset.name%60%20%5Cn%20%20%20%20%20%20let%20key%20=%20this.value.split(%5C%22:%5C%22)%5B2%5D;%5Cn%20%20%20%20%20%20window.input%5Bthis.dataset.name%5D%20=%20optionsList%5Bkey%5D;%5Cn%20%20%20%20%20%20userInputSpec.value%20=%20optionsList%5Bkey%5D;%5Cn%20%20%20%20%20%20displayName%20=%20key;%5Cn%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20window.input%5Bthis.dataset.name%5D%20=%20this.value;%5Cn%20%20%20%20%20%20userInputSpec.value%20=%20this.value;%5Cn%20%20%20%20%20%20displayName%20=%20this.value;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20let%20visualSelectBtn%20=%20this.parentElement.querySelector(%5C%22.visual-select-btn%5C%22);%5Cn%20%20%20%20if(visualSelectBtn)%20%7B%5Cn%20%20%20%20%20%20visualSelectBtn.textContent%20=%20displayName;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20if(!event._isInitCall)%20%7B%5Cn%20%20%20%20%20%20if(userInputSpec.remember)%20%7B%5Cn%20%20%20%20%20%20%20%20saveRememberedInput(this.dataset.name,%20this.value);%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20if(!event._isInitCall)%20%7B%5Cn%20%20%20%20%20%20updateInputVisibilities();%5Cn%20%20%20%20%7D%5Cn%20%20%7D;%5Cn%20%20%5Cn%20%20////////////////////////////////////////////////////////////%5Cn%20%20//%20%20%20%20%20handler%20for%20%3Cinput%3E/%3Ctextarea%3E%20element%20changes%20%20%20%20%20//%5Cn%20%20////////////////////////////////////////////////////////////%5Cn%20%20let%20parseVariablesRateLimitTimeout%20=%20null;%5Cn%20%20let%20allPreviouslyParsedVariableNames%20=%20new%20Set();%5Cn%20%20function%20parseAllVariables()%20%7B%5Cn%20%20%20%20let%20variableSourceTextareas%20=%20Object.values(window.___userSettings746291937.userInputs).filter(o%20=%3E%20o.parseVariables%20&&%20o._element.tagName.toLowerCase()%20===%20%5C%22textarea%5C%22).map(o%20=%3E%20o._element);%5Cn%20%20%20%20for(let%20name%20of%20allPreviouslyParsedVariableNames)%20%7B%5Cn%20%20%20%20%20%20delete%20window%5Bname%5D;%20//%20clear%20old%20variables%20first%20(if%20they%20e.g.%20delete%20their%20scratchpad%20text,%20the%20variables%20should%20go%20away)%5Cn%20%20%20%20%7D%5Cn%20%20%20%20allPreviouslyParsedVariableNames.clear();%5Cn%20%20%20%20for(let%20el%20of%20variableSourceTextareas)%20%7B%5Cn%20%20%20%20%20%20let%20varLines%20=%20el.value.split(%5C%22%5C%5Cn%5C%22).filter(line%20=%3E%20/%5E%5BA-Z0-9_%5D+?%20*=.+$/.test(line));%5Cn%20%20%20%20%20%20for(let%20line%20of%20varLines)%20%7B%5Cn%20%20%20%20%20%20%20%20let%20name%20=%20line.split(%5C%22=%5C%22)%5B0%5D.trim();%5Cn%20%20%20%20%20%20%20%20let%20value%20=%20line.split(%5C%22=%5C%22).slice(1).join(%5C%22=%5C%22);%5Cn%20%20%20%20%20%20%20%20window%5Bname%5D%20=%20value.trim();%5Cn%20%20%20%20%20%20%20%20allPreviouslyParsedVariableNames.add(name);%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%7D%5Cn%20%20%7D%5Cn%20%20window.___inputElInputEvent746291937%20=%20function(event)%20%7B%5Cn%20%20%20%20let%20userInputSpec%20=%20window.___userSettings746291937.userInputs%5Bthis.dataset.name%5D;%20%5Cn%20%20%20%20%5Cn%20%20%20%20let%20value%20=%20this.value;%5Cn%20%20%20%20%5Cn%20%20%20%20if(value%20===%20%5C%22%5C%22%20&&%20userInputSpec.defaultValue%20!==%20undefined)%20value%20=%20userInputSpec.defaultValue;%5Cn%20%20%20%20%20%20%20%20%5Cn%20%20%20%20if(userInputSpec.parseVariables)%20%7B%5Cn%20%20%20%20%20%20clearTimeout(parseVariablesRateLimitTimeout);%5Cn%20%20%20%20%20%20parseVariablesRateLimitTimeout%20=%20setTimeout(parseAllVariables,%201000);%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20window.input%5Bthis.dataset.name%5D%20=%20value;%5Cn%20%20%20%20userInputSpec.value%20=%20value;%5Cn%20%20%20%20%5Cn%20%20%20%20if(!event._isInitCall)%20%7B%5Cn%20%20%20%20%20%20if(userInputSpec.remember)%20%7B%5Cn%20%20%20%20%20%20%20%20saveRememberedInput(this.dataset.name,%20value);%5Cn%20%20%20%20%20%20%7D%20else%20if(this.tagName%20===%20%5C%22TEXTAREA%5C%22%20%7C%7C%20(this.tagName%20===%20%5C%22INPUT%5C%22%20&&%20this.type%20===%20%5C%22text%5C%22))%20%7B%20//%20%3C--%20just%20to%20be%20sure%5Cn%20%20%20%20%20%20%20%20//%20localStorage%5B%5C%22t2i_tempRememberedInput_fisuyr9hf_%5C%22+this.dataset.name%5D%20=%20value;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20if(!event._isInitCall)%20%7B%5Cn%20%20%20%20%20%20updateInputVisibilities();%5Cn%20%20%20%20%7D%5Cn%20%20%7D;%5Cn%20%20(async%20function()%20%7B%5Cn%20%20%20%20while(!Object.values(window.___userSettings746291937.userInputs)%5B0%5D._element)%20await%20new%20Promise(r%20=%3E%20setTimeout(r,%20500));%5Cn%20%20%20%20parseAllVariables();%5Cn%20%20%7D)();%5Cn%20%20%5Cn%20%20let%20socialFeatures%20=%20settings.socialFeatures;%5Cn%20%20if(socialFeatures%20===%20undefined)%20socialFeatures%20=%20%5C%22enabled%5C%22;%5Cn%20%20socialFeatures%20=%20socialFeatures.evaluateItem;%5Cn%20%20%5Cn%20%20let%20thisGeneratorIsUsingClickCountBasedSocialDisplay%20=%20false;%5Cn%20%20%7B%5Cn%20%20%20%20let%20n%20=%20(socialFeatures.match(/button%20after%20(%5B0-9%5D+)%20clicks/)%20%7C%7C%20%5B%5D)%5B1%5D;%5Cn%20%20%20%20if(n)%20%7B%5Cn%20%20%20%20%20%20thisGeneratorIsUsingClickCountBasedSocialDisplay%20=%20true;%5Cn%20%20%20%20%20%20n%20=%20Number(n);%5Cn%20%20%20%20%20%20if(Number(localStorage.generateClickCount%20%7C%7C%200)%20%3E=%20n)%20%7B%5Cn%20%20%20%20%20%20%20%20socialFeatures%20=%20%5C%22button%5C%22;%5Cn%20%20%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20%20%20socialFeatures%20=%20%5C%22disabled%5C%22;%5Cn%20%20%20%20%20%20%20%20window.showSocialFeaturesButtonAfterThisManyClicks%20=%20n;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%7D%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20%5Cn%20%20%5Cn%20%20%5Cn%20%20%5Cn%20%20////////////////////////////////////////////////////////////%5Cn%20%20//%20%20%20%20%20%20%20%20%20%20%20%20copy%20share%20link%20button%20handler%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%5Cn%20%20////////////////////////////////////////////////////////////%5Cn%20%20window.__generateSettingsShareLink084722%20=%20async%20function%20generateShareLink()%20%7B%20%5Cn%20%20%20%20%5Cn%20%20%20%20//%20EDIT:%20decided%20to%20show%20this%20on%20every%20click%20now,%20since%20it's%20obviously%20not%20super%20commonly%20clicked%20(so%20an%20extra%20tap%20is%20not%20a%20big%20burden),%20and%20i%20think%20it%20being%20close%20to%20the%20generate%20button%20means%20people%20were%20clicking%20it%20accidentally%20sometimes.%5Cn%20%20%20%20//%20if(!localStorage.knowsHowShareLinksWork)%20%7B%5Cn%20%20%20%20//%20heuristic%20to%20try%20to%20warn%20about%20their%20scratchpad%20being%20shared%20too:%5Cn%20%20%20%20let%20includingScratchpadWarning%20=%20%5C%22%5C%22;%5Cn%20%20%20%20let%20sharableScratchpadExists%20=%20Object.values(window.___userSettings746291937.userInputs).find(o%20=%3E%20(o.getName%20===%20%5C%22scratchpad%5C%22%20%7C%7C%20o.getName%20===%20%5C%22notes%5C%22%20%7C%7C%20o.getName%20===%20%5C%22notepad%5C%22)%20&&%20!o.excludeFromShareLink);%5Cn%20%20%20%20if(sharableScratchpadExists)%20includingScratchpadWarning%20=%20%60,%20%F0%9D%97%B6%F0%9D%97%BB%F0%9D%97%B0%F0%9D%97%B9%F0%9D%98%82%F0%9D%97%B1%F0%9D%97%B6%F0%9D%97%BB%F0%9D%97%B4%20the%20scratchpad/notepad%20text%60;%5Cn%5Cn%20%20%20%20let%20confirmed%20=%20confirm(%60This%20will%20create%20a%20sharable%20link%20to%20a%20snapshot%20of%20the%20settings%20you've%20specified%20above$%7BincludingScratchpadWarning%7D.%60);%5Cn%20%20%20%20if(!confirmed)%20%7B%5Cn%20%20%20%20%20%20return;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20localStorage.knowsHowShareLinksWork%20=%20%5C%221%5C%22;%5Cn%20%20%20%20//%20%7D%5Cn%20%20%5Cn%20%20%20%20if(!window.CompressionStream)%20%7B%5Cn%20%20%20%20%20%20alert(%5C%22Share%20links%20use%20a%20feature%20that's%20only%20available%20in%20modern%20browsers.%20Please%20upgrade%20your%20browser%20to%20the%20latest%20version%20to%20use%20this%20feature.%5C%22);%5Cn%20%20%20%20%20%20return;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20shareLinkCtn83927376.style.display%20=%20%5C%22none%5C%22;%5Cn%5Cn%20%20%20%20shareSettingsBtn758374.disabled%20=%20true;%5Cn%20%20%20%20shareSettingsBtn758374.innerHTML%20=%20%60%3Cspan%20style=%5C%22display:inline-block;%20animation:rotate%201.5s%20linear%20infinite;%5C%22%3E%E2%8F%B3%3C/span%3E%20uploading%20settings%20data...%60;%5Cn%5Cn%20%20%20%20let%20dataJsonStr%20=%20JSON.stringify(getAllUserInputValues());%5Cn%5Cn%20%20%20%20//%20convert%20json%20text%20to%20blob:%5Cn%20%20%20%20let%20blob%20=%20await%20fetch(%5C%22data:text/plain;charset=utf-8,%5C%22+dataJsonStr.replace(/#/g,%20%5C%22%2523%5C%22)).then(res%20=%3E%20res.blob());%5Cn%5Cn%20%20%20%20//%20compress%20blob:%5Cn%20%20%20%20let%20compressedBlob%20=%20await%20compressBlobWithGzip(blob);%5Cn%5Cn%20%20%20%20let%20%7B%20url,%20size,%20error%20%7D%20=%20await%20upload(compressedBlob);%5Cn%20%20%20%20if(error)%20%7B%5Cn%20%20%20%20%20%20shareSettingsLinkInputEl759307.value%20=%20%60error:%20$%7Berror%7D%60;%5Cn%20%20%20%20%20%20alert(%60Error:%20$%7Berror%7D$%7Berror%20===%20%5C%22disallowed_content%5C%22%20?%20%5C%22.%20If%20you%20believe%20this%20is%20incorrect,%20then%20you%20may%20need%20to%20explicitly%20state%20that%20relevant%20characters%20are%2018%20or%20older,%20since%20the%20moderation%20system%20can%20make%20mistakes%20if%20there%20is%20ambiguity.%5C%22%20:%20%5C%22%5C%22%7D%60);%5Cn%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20shareSettingsLinkInputEl759307.value%20=%20%60https://perchance.org/$%7Bwindow.generatorName%7D#data=%60+url.replace(%5C%22https://user.uploads.dev/file/%5C%22,%20%5C%22uup1:%5C%22);%5Cn%20%20%20%20%7D%5Cn%20%20%20%20shareLinkCtn83927376.style.display%20=%20%5C%22%5C%22;%5Cn%20%20%20%20shareSettingsBtn758374.textContent%20=%20%5C%22%F0%9F%94%97%20share%20these%20settings%5C%22;%5Cn%20%20%20%20shareSettingsBtn758374.disabled%20=%20false;%5Cn%20%20%20%20shareSettingsBtn758374.style.display%20=%20%5C%22none%5C%22;%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20async%20function%20compressBlobWithGzip(blob)%20%7B%5Cn%20%20%20%20const%20cs%20=%20new%20CompressionStream('gzip');%5Cn%20%20%20%20const%20compressedStream%20=%20blob.stream().pipeThrough(cs);%5Cn%20%20%20%20let%20outputBlob%20=%20await%20new%20Response(compressedStream).blob();%5Cn%20%20%20%20return%20new%20Blob(%5BoutputBlob%5D,%20%7B%20type:%20%5C%22application/gzip%5C%22%20%7D);%20//%20%3C--%20to%20add%20the%20correct%20mime%20type%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20async%20function%20loadDataFromUrlHash()%20%7B%20%5Cn%20%20%20%20let%20success%20=%20false;%5Cn%20%20%20%20if(!window.DecompressionStream)%20%7B%5Cn%20%20%20%20%20%20alert(%5C%22Share%20links%20use%20a%20browser%20feature%20that's%20only%20available%20in%20modern%20browsers.%20Please%20upgrade%20your%20browser%20to%20the%20latest%20version%20(ideally%20Chrome%20or%20Edge)%20to%20allow%20for%20loading%20data%20from%20character%20share%20links.%5C%22);%5Cn%20%20%20%20%20%20return%20%7Bsuccess,%20error:%5C%22browser_compat%5C%22%7D;%5Cn%20%20%20%20%7D%5Cn%5Cn%20%20%20%20let%20loadingModal%20=%20document.createElement('div');%5Cn%20%20%20%20loadingModal.innerHTML%20=%20%60%3Cdiv%20style=%5C%22position:%20fixed;%20top:%200;%20left:%200;%20width:%20100%25;%20height:%20100%25;%20background-color:%20rgba(0,%200,%200,%200.5);%20z-index:%209999;%20display:%20flex;%20justify-content:%20center;%20align-items:%20center;%5C%22%3E%5Cn%20%20%20%20%20%20%3Cdiv%20style=%5C%22padding:%2020px;%20background-color:%20var(--box-color);%20border-radius:%208px;%5C%22%3E%5Cn%20%20%20%20%20%20%20%20%3Cspan%20style=%5C%22display:inline-block;%20animation:rotate%201.5s%20linear%20infinite;%5C%22%3E%E2%8F%B3%3C/span%3E%20loading%20share%20link%20data...%5Cn%20%20%20%20%20%20%3C/div%3E%5Cn%20%20%20%20%3C/div%3E%60;%5Cn%20%20%20%20loadingModal%20=%20loadingModal.firstElementChild;%5Cn%20%20%20%20document.body.append(loadingModal);%5Cn%5Cn%20%20%20%20try%20%7B%5Cn%20%20%20%20%20%20let%20hashText%20=%20window.location.hash.slice(1);%5Cn%20%20%20%20%20%20if(!hashText.startsWith(%5C%22data=%5C%22))%20%7B%5Cn%20%20%20%20%20%20%20%20throw%20new%20Error(%5C%22Invalid%20share%20URL.%5C%22);%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20let%20fileUrl%20=%20hashText.replace(/%5Edata=/,%20%5C%22%5C%22);%5Cn%20%20%20%20%20%20if(fileUrl.startsWith(%5C%22uup1:%5C%22))%20%7B%5Cn%20%20%20%20%20%20%20%20fileUrl%20=%20fileUrl.replace(%5C%22uup1:%5C%22,%20%5C%22https://user.uploads.dev/file/%5C%22);%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20let%20fetchOptions%20=%20%7B%7D;%5Cn%20%20%20%20%20%20if(window.AbortSignal%20&&%20AbortSignal.timeout)%20fetchOptions.signal%20=%20AbortSignal.timeout(10000);%5Cn%20%20%20%20%20%20let%20blob%20=%20await%20fetch(fileUrl,%20fetchOptions).then(res%20=%3E%20res.ok%20?%20res.blob()%20:%20null).catch(console.error);%5Cn%20%20%20%20%20%20if(!blob)%20%7B%5Cn%20%20%20%20%20%20%20%20loadingModal.remove();%5Cn%20%20%20%20%20%20%20%20await%20confirmAsync(%60It%20seems%20you've%20tried%20to%20load%20a%20share%20URL,%20but%20the%20file%20specified%20by%20the%20URL%20does%20not%20exist.%20If%20you%20believe%20it%20should%20exist,%20you%20can%20ask%20for%20help%20on%20the%20community%20forum,%20or%20check%20if%20the%20file%20has%20been%20quarantined:%5C%5Cn%5C%5Cnperchance.org/quarantined-files%60,%20%7BhideCancel:true%7D);%5Cn%20%20%20%20%20%20%20%20return%20%7Bsuccess:false,%20error:%5C%22loading_cancelled_by_user%5C%22%7D;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20let%20text;%5Cn%20%20%20%20%20%20if(fileUrl.endsWith(%5C%22.gz%5C%22))%20%7B%5Cn%20%20%20%20%20%20%20%20let%20decompressedBlob%20=%20await%20decompressBlobWithGzip(blob);%5Cn%20%20%20%20%20%20%20%20text%20=%20await%20decompressedBlob.text();%5Cn%20%20%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20%20%20text%20=%20await%20blob.text();%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20let%20data%20=%20JSON.parse(text);%5Cn%20%20%20%20%20%20if(data.___format%20===%20%5C%22t2i-framework-format1%5C%22)%20%7B%5Cn%20%20%20%20%20%20%20%20let%20confirmed%20=%20await%20confirmAsync(%5C%22%F0%9D%97%9B%F0%9D%97%B2%F0%9D%97%AE%F0%9D%97%B1%F0%9D%98%80%20%F0%9D%98%82%F0%9D%97%BD:%20You're%20loading%20a%20share%20link.%20This%20will%20overwrite%20your%20existing%20saved%20settings/scratchpad,%20if%20any.%20%F0%9D%97%96%F0%9D%97%BC%F0%9D%97%BB%F0%9D%98%81%F0%9D%97%B6%F0%9D%97%BB%F0%9D%98%82%F0%9D%97%B2?%5C%5Cn%5C%5Cn(Note:%20You%20can%20click%20cancel%20and%20then%20load%20the%20share%20link%20in%20your%20browser's%20incognito/private%20mode%20to%20avoid%20overwriting%20any%20existing%20data,%20or%20just%20backup%20your%20existing%20data%20first.)%5C%22);%5Cn%20%20%20%20%20%20%20%20if(!confirmed)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20loadingModal.remove();%5Cn%20%20%20%20%20%20%20%20%20%20return%20%7Bsuccess,%20error:%5C%22loading_cancelled_by_user%5C%22%7D;%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20//%20let%20userHasSomeTextTheyAreTryingToRemember%20=%20Object.values(window.___userSettings746291937.userInputs).filter(o%20=%3E%20o.remember%20&&%20o._element.tagName.toLowerCase()%20===%20%5C%22textarea%5C%22).map(o%20=%3E%20o._element.value).join(%5C%22%5C%22).length%20%3E%20100;%5Cn%20%20%20%20%20%20%20%20//%20if(userHasSomeTextTheyAreTryingToRemember)%20%7B%7D%5Cn%20%20%20%20%20%20%20%20importUserInputValues(data);%5Cn%20%20%20%20%20%20%20%20success%20=%20true;%5Cn%20%20%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20%20%20alert(%5C%22Unknown%20share%20link%20data%20format.%5C%22);%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%7D%20catch(e)%20%7B%5Cn%20%20%20%20%20%20alert(%60Failed%20to%20load%20share%20link%20data:%20$%7Be.message%7D%60);%5Cn%20%20%20%20%20%20console.error(e);%5Cn%20%20%20%20%7D%5Cn%5Cn%20%20%20%20loadingModal.remove();%5Cn%20%20%20%20return%20%7Bsuccess%7D;%5Cn%20%20%7D%5Cn%5Cn%20%20async%20function%20decompressBlobWithGzip(blob)%20%7B%5Cn%20%20%20%20const%20ds%20=%20new%20DecompressionStream(%5C%22gzip%5C%22);%5Cn%20%20%20%20const%20decompressedStream%20=%20blob.stream().pipeThrough(ds);%5Cn%20%20%20%20return%20await%20new%20Response(decompressedStream).blob();%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20function%20getAllUserInputValues()%20%7B%5Cn%20%20%20%20let%20userInputs%20=%20%7B%7D;%5Cn%20%20%20%20for(let%20key%20in%20window.___userSettings746291937.userInputs)%20%7B%5Cn%20%20%20%20%20%20if(window.___userSettings746291937.userInputs%5Bkey%5D.excludeFromShareLink)%20continue;%5Cn%20%20%20%20%20%20let%20value%20=%20window.___userSettings746291937.userInputs%5Bkey%5D._element?.value;%5Cn%20%20%20%20%20%20if(value%20!==%20undefined)%20%7B%5Cn%20%20%20%20%20%20%20%20userInputs%5Bkey%5D%20=%20value;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%7D%5Cn%20%20%20%20userInputs.___format%20=%20%5C%22t2i-framework-format1%5C%22;%5Cn%20%20%20%20return%20userInputs;%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20function%20importUserInputValues(data)%20%7B%5Cn%20%20%20%20for(let%20key%20in%20window.___userSettings746291937.userInputs)%20%7B%5Cn%20%20%20%20%20%20if(window.___userSettings746291937.userInputs%5Bkey%5D.excludeFromShareLink)%20continue;%5Cn%20%20%20%20%20%20let%20value%20=%20window.___userSettings746291937.userInputs%5Bkey%5D._element?.value;%5Cn%20%20%20%20%20%20if(value%20!==%20undefined)%20%7B%5Cn%20%20%20%20%20%20%20%20if(data%5Bkey%5D%20!==%20undefined)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20let%20el%20=%20window.___userSettings746291937.userInputs%5Bkey%5D._element;%5Cn%20%20%20%20%20%20%20%20%20%20el.value%20=%20data%5Bkey%5D;%5Cn%20%20%20%20%20%20%20%20%20%20if(el.onchange)%20el.onchange(%7B_isInitCall:true%7D);%5Cn%20%20%20%20%20%20%20%20%20%20if(el.oninput)%20el.oninput(%7B_isInitCall:true%7D);%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%7D%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20%5Cn%20%20%5Cn%20%20%5Cn%20%20%5Cn%20%20%5Cn%20%20%5Cn%20%20%5Cn%20%20function%20animateImageIntoTarget(%7BimgEl,%20sourceEl,%20targetEl,%20durationMs,%20wiggle%7D=%7B%7D)%20%7B%5Cn%20%20%20%20const%20srcRect%20=%20sourceEl.getBoundingClientRect()%5Cn%20%20%20%20let%20tgtRect%20=%20targetEl.getBoundingClientRect();%5Cn%20%20%20%20imgEl.style.cssText%20=%20%60position:fixed;top:$%7BsrcRect.top%7Dpx;left:$%7BsrcRect.left%7Dpx;width:$%7BsrcRect.width%7Dpx;height:$%7BsrcRect.height%7Dpx;margin:0;pointer-events:none;z-index:9999;transition:top%20$%7BdurationMs%7Dms%20cubic-bezier(.4,0,.2,1),left%20$%7BdurationMs%7Dms%20cubic-bezier(.4,0,.2,1),width%20$%7BdurationMs%7Dms%20cubic-bezier(.4,0,.2,1),height%20$%7BdurationMs%7Dms%20cubic-bezier(.4,0,.2,1)%60;%5Cn%20%20%20%20if%20(!imgEl.parentNode)%20document.body.appendChild(imgEl);%5Cn%20%20%20%20imgEl.getBoundingClientRect();%20//%20force%20reflow%5Cn%20%20%20%20imgEl.style.top%20=%20tgtRect.top%20+%20tgtRect.height%20/%202%20+%20'px';%5Cn%20%20%20%20imgEl.style.left%20=%20tgtRect.left%20+%20tgtRect.width%20/%202%20+%20'px';%5Cn%20%20%20%20imgEl.style.width%20=%20imgEl.style.height%20=%20'0px';%5Cn%20%20%20%20%5Cn%20%20%20%20imgEl.addEventListener('transitionend',%20()%20=%3E%20%7B%5Cn%20%20%20%20%20%20imgEl.remove();%5Cn%20%20%20%20%20%20if%20(!wiggle)%20return;%5Cn%20%20%20%20%20%20const%20anim%20=%20'wiggle'%20+%20Math.random().toString(36).slice(2);%5Cn%20%20%20%20%20%20const%20styleEl%20=%20Object.assign(document.createElement('style'),%20%7B%5Cn%20%20%20%20%20%20%20%20id:%20anim,%5Cn%20%20%20%20%20%20%20%20textContent:%20%60@keyframes%20$%7Banim%7D%7B0%25,100%25%7Btransform:rotate(0deg)%7D20%25%7Btransform:rotate(-5deg)%7D40%25%7Btransform:rotate(5deg)%7D60%25%7Btransform:rotate(-3deg)%7D80%25%7Btransform:rotate(3deg)%7D%7D%60%5Cn%20%20%20%20%20%20%7D);%5Cn%20%20%20%20%20%20document.head.appendChild(styleEl);%5Cn%20%20%20%20%20%20targetEl.style.animation%20=%20%60$%7Banim%7D%20400ms%20ease-in-out%60;%5Cn%20%20%20%20%20%20targetEl.addEventListener('animationend',%20()%20=%3E%20%7B%20targetEl.style.animation%20=%20'';%20styleEl.remove();%20%7D,%20%7B%20once:%20true%20%7D);%5Cn%20%20%20%20%7D,%20%7B%20once:%20true%20%7D);%5Cn%20%20%7D%5Cn%5Cn%5Cn%20%20if(settings.imageButtons?.privateSave)%20%7B%5Cn%20%20%20%20window.t2i_privateGallery%20=%20createMediaGalleryPlugin();%5Cn%20%20%20%20document.addEventListener(%5C%22keydown%5C%22,%20e%20=%3E%20%7B%5Cn%20%20%20%20%20%20if%20(e.shiftKey%20&&%20(e.ctrlKey%20%7C%7C%20e.metaKey)%20&&%20e.key.toLowerCase()%20===%20%5C%22g%5C%22)%20%7B%5Cn%20%20%20%20%20%20%20%20e.preventDefault();%5Cn%20%20%20%20%20%20%20%20window.t2i_privateGallery.show();%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%7D);%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20window.t2i_privateGallerySave%20=%20async%20function(btn,%20imageCtn)%20%7B%5Cn%20%20%20%20try%20%7B%5Cn%20%20%20%20%20%20if(!imageCtn.querySelector(%5C%22iframe%5C%22).textToImagePluginOutput)%20return%20alert(%5C%22Please%20wait%20for%20the%20image%20to%20finish%20generating%20before%20using%20the%20'private%20save'%20feature.%5C%22);%5Cn%20%20%20%20%20%20btn.disabled%20=%20true;%5Cn%20%20%20%20%20%20let%20textToImagePluginOutput%20=%20imageCtn.querySelector(%5C%22iframe%5C%22).textToImagePluginOutput;%5Cn%20%20%20%20%20%20let%20%7B%20prompt,%20negativePrompt,%20seed,%20guidanceScale%20%7D%20=%20textToImagePluginOutput.inputs;%5Cn%20%20%20%20%20%20let%20imageBlob%20=%20await%20fetch(textToImagePluginOutput.dataUrl).then(r%20=%3E%20r.blob());%5Cn%20%20%20%20%20%20await%20window.t2i_privateGallery.add(imageBlob,%20%7Binfo:%7Bprompt,%20negativePrompt,%20seed,%20guidanceScale%7D%7D);%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20privateGalleryCtn97364827.hidden%20=%20false;%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20//%20Animate%20the%20image%20into%20gallery%20button:%5Cn%20%20%20%20%20%20let%20imgEl%20=%20document.createElement(%5C%22img%5C%22);%5Cn%20%20%20%20%20%20imgEl.src%20=%20textToImagePluginOutput.dataUrl;%5Cn%20%20%20%20%20%20animateImageIntoTarget(%7BimgEl,%20sourceEl:imageCtn.querySelector(%5C%22iframe%5C%22),%20targetEl:privateGalleryCtn97364827.querySelector(%5C%22button%5C%22),%20durationMs:700,%20wiggle:true%7D);%5Cn%20%20%20%20%7D%20catch(e)%20%7B%5Cn%20%20%20%20%20%20console.error(e);%5Cn%20%20%20%20%7D%5Cn%20%20%20%20setTimeout(()%20=%3E%20%7B%5Cn%20%20%20%20%20%20btn.disabled%20=%20false;%20//%20we%20re-enable%20since%20they%20can%20click%20the%20(within-iframe)%20'regenerate'%20button%20on%20this%20image%20and%20submit%20another%20image%5Cn%20%20%20%20%7D,%201000);%5Cn%20%20%7D;%5Cn%20%20window.t2i_openCharacterDescriptionEditor%20=%20function(imageCtn)%20%7B%5Cn%20%20%20%20imageCtn.querySelector('.personality-chat-button').style.visibility%20=%20'hidden';%5Cn%20%20%20%20if(imageCtn.querySelector('.char-description-editor-ctn'))%20%7B%5Cn%20%20%20%20%20%20//%20show%20it%20existing%20on%20if%20it%20exists:%5Cn%20%20%20%20%20%20imageCtn.querySelector('.char-description-editor-ctn').style.display%20=%20'flex';%5Cn%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20//%20otherwise%20create%20it:%5Cn%20%20%20%20%20%20let%20tmp%20=%20document.createElement(%5C%22div%5C%22);%5Cn%20%20%20%20%20%20tmp.innerHTML%20=%20%60%3Cdiv%20class=%5C%22char-description-editor-ctn%5C%22%20style=%5C%22color-scheme:dark;%20color:#dddddd;%20position:absolute;top:0;left:0;right:0;bottom:0;display:%20flex;flex-direction:column;%20gap:0.125rem;%20padding:0.125rem;%20padding-bottom:0;%20backdrop-filter:brightness(0.7);%5C%22%3E%5Cn%20%20%20%20%20%20%20%20%3C!--%3Cdiv%20style=%5C%22font-size:80%25;%20font-weight:bold;%20text-shadow:0px%200px%208px%20black,%200px%200px%208px%20black;%5C%22%3EInstructions:%3C/div%3E--%3E%5Cn%20%20%20%20%20%20%20%20%3Ctextarea%20class=%5C%22char-description-instruction%5C%22%20style=%5C%22backdrop-filter:blur(3px);%20background:rgba(0,%200,%200,%200.8);%20font-size:80%25;%20min-height:70px;%20border:1px%20solid%20grey;%20border-radius:2px;%20color-scheme:dark;%5C%22%20placeholder=%5C%22(Optional)%20Extra%20instructions%20for%20the%20personality,%20appearance,%20and%20backstory%20to%20be%20generated.%5C%22%3E%3C/textarea%3E%5Cn%20%20%20%20%20%20%20%20%3Cdiv%20style=%5C%22display:flex;%20gap:0.125rem;%20justify-content:center;%5C%22%3E%5Cn%20%20%20%20%20%20%20%20%20%20%3Cbutton%20class=%5C%22char-description-generate-button%5C%22%20style=%5C%22color-scheme:dark;%20flex-grow:1;%20font-weight:bold;%20max-width:max-content;%20box-shadow:0px%200px%2012px%202px%20black;%5C%22%20onclick=%5C%22window.t2i_generateCharacterDescription(this.closest('.t2i-image-ctn'))%5C%22%3E%E2%9C%A8%20generate%20persona%3C/button%3E%5Cn%20%20%20%20%20%20%20%20%20%20%3Cbutton%20class=%5C%22char-description-stop-button%5C%22%20style=%5C%22color-scheme:dark;%20min-width:4rem;%20display:none;%20box-shadow:0px%200px%2012px%202px%20black;%5C%22%20onclick=%5C%22this.closest('.t2i-image-ctn').__generateObj.stop()%5C%22%3E%F0%9F%9B%91%20stop%3C/button%3E%5Cn%20%20%20%20%20%20%20%20%3C/div%3E%5Cn%20%20%20%20%20%20%20%20%3C!--%3Cdiv%20style=%5C%22font-size:80%25;%20font-weight:bold;%20text-shadow:0px%200px%208px%20black,%200px%200px%208px%20black;%5C%22%3EOutput:%3C/div%3E--%3E%5Cn%20%20%20%20%20%20%20%20%3C!--%3Cdiv%20style=%5C%22%5C%22%3E%E2%AC%87%EF%B8%8F%20%E2%AC%87%EF%B8%8F%20%E2%AC%87%EF%B8%8F%3C/div%3E--%3E%5Cn%20%20%20%20%20%20%20%20%3Cinput%20class=%5C%22character-name-output%5C%22%20style=%5C%22backdrop-filter:blur(3px);%20background:rgba(0,%200,%200,%200.8);%20border:1px%20solid%20grey;%20border-radius:2px;%20color-scheme:dark;%5C%22%20placeholder=%5C%22Character%20name%5C%22%3E%5Cn%20%20%20%20%20%20%20%20%3Ctextarea%20class=%5C%22character-description-output%5C%22%20placeholder=%5C%22Click%20the%20%F0%9D%97%B4%F0%9D%97%B2%F0%9D%97%BB%F0%9D%97%B2%F0%9D%97%BF%F0%9D%97%AE%F0%9D%98%81%F0%9D%97%B2%20button%20above!%20The%20character%20description%20will%20appear%20here,%20and%20then%20you%20can%20edit%20it.%5C%22%20style=%5C%22backdrop-filter:blur(3px);%20flex-grow:1;%20background:rgba(0,0,0,0.8);%20border:1px%20solid%20grey;%20border-radius:2px;%20font-size:85%25;%20color-scheme:dark;%5C%22%3E%3C/textarea%3E%5Cn%20%20%20%20%20%20%20%20%3Cdiv%20style=%5C%22display:flex;%20gap:0.25rem;%5C%22%3E%5Cn%20%20%20%20%20%20%20%20%20%20%3Cbutton%20style=%5C%22flex-grow:1;%20color-scheme:dark;%5C%22%20onclick=%5C%22window.t2i_generateChatLink(this.closest('.t2i-image-ctn'))%5C%22%3E%F0%9F%92%AC%20chat%20with%20them%3C/button%3E%5Cn%20%20%20%20%20%20%20%20%20%20%3Cbutton%20style=%5C%22min-width:4rem;%20color-scheme:dark;%5C%22%20onclick=%5C%22this.closest('.char-description-editor-ctn').style.display='none';%20this.closest('.t2i-image-ctn').querySelector('.personality-chat-button').style.visibility='visible';%5C%22%3E%E2%9D%8C%20close%3C/button%3E%5Cn%20%20%20%20%20%20%20%20%3C/div%3E%5Cn%20%20%20%20%20%20%3C/div%3E%60;%5Cn%20%20%20%20%20%20imageCtn.appendChild(tmp.firstElementChild);%5Cn%20%20%20%20%7D%5Cn%20%20%7D;%5Cn%5Cn%20%20window.t2i_generateCharacterDescription%20=%20async%20function(imageCtn)%20%7B%5Cn%20%20%5Cn%20%20%20%20let%20generateBtn%20=%20imageCtn.querySelector(%5C%22.char-description-generate-button%5C%22);%5Cn%20%20%20%20let%20stopBtn%20=%20imageCtn.querySelector(%5C%22.char-description-stop-button%5C%22);%5Cn%20%20%5Cn%20%20%20%20let%20originalGenerateButtonTextContent%20=%20generateBtn.textContent;%5Cn%20%20%20%20generateBtn.innerHTML%20=%20%60%3Cspan%20style=%5C%22display:inline-block;%20animation:rotate%201.5s%20linear%20infinite;%5C%22%3E%E2%8F%B3%3C/span%3E%20loading...%60;%5Cn%20%20%20%20generateBtn.disabled%20=%20true;%5Cn%20%20%20%20stopBtn.style.display%20=%20%5C%22%5C%22;%5Cn%20%20%5Cn%20%20%20%20while(!imageCtn.querySelector(%5C%22iframe%5C%22).textToImagePluginOutput)%20await%20new%20Promise(r%20=%3E%20setTimeout(r,%201000));%20//%20bit%20of%20a%20hacky%20patch,%20just%20to%20cover%20edge%20case%20where%20they%20can%20click%20the%20personality%20button%20before%20image%20generation%20finishes%5Cn%20%20%5Cn%20%20%20%20let%20charDescriptionInstruction%20=%20imageCtn.querySelector(%5C%22.char-description-instruction%5C%22).value.trim();%5Cn%20%20%20%20let%20textToImagePluginOutput%20=%20imageCtn.querySelector(%5C%22iframe%5C%22).textToImagePluginOutput;%5Cn%20%20%20%20let%20nameOutputEl%20=%20imageCtn.querySelector(%5C%22.character-name-output%5C%22);%5Cn%20%20%20%20let%20descriptionOutputEl%20=%20imageCtn.querySelector(%5C%22.character-description-output%5C%22);%5Cn%5Cn%20%20%20%20nameOutputEl.value%20=%20%5C%22%5C%22;%5Cn%20%20%20%20descriptionOutputEl.value%20=%20%5C%22%5C%22;%5Cn%5Cn%20%20%20%20let%20generateObj;%5Cn%20%20%20%20if(true)%20%7B%5Cn%20%20%20%20%20%20generateObj%20=%20aiText(%7B%5Cn%20%20%20%20%20%20%20%20instruction:%20%60%5Cn%20%20%20%20%20%20%20%20TASK:%20The%20user%20has%20created%20an%20image%20of%20a%20character%20using%20a%20prompt.%20The%20prompt%20is%20shown%20below.%20Your%20task%20is%20to%20use%20the%20character%20personality%20hints%20in%20the%20prompt%20to%20generate%20a%20character%20description%20for%20roleplaying%20with.%20Your%20description%20should%20ideally%20include%20personality,%20appearance,%20speech%20examples/mannerisms,%20etc.%20such%20that%20an%20actor%20could%20read%20it%20and%20know%20how%20to%20roleplay%20as%20the%20character%20in%20all%20relevant%20aspects.%20Use%20an%20information-dense%20writing%20style%20to%20*succinctly*%20capture%20all%20aspects%20of%20the%20personality%20of%20the%20character%20that%20you%20generate.%20Your%20description%20should%20be%20between%20200%20and%20600%20words%20in%20length.%20Do%20your%20best%20to%20generate%20a%20character%20based%20on%20what%20you%20see%20below.%20Follow%20the%20hints%20in%20the%20user's%20image%20prompt%20to%20accurately%20capture%20the%20details%20that%20are%20most%20important%20to%20a%20character%20chat/roleplay.%5Cn%5Cn%20%20%20%20%20%20%20%20---%20START%20OF%20IMAGE%20PROMPT%20---%5Cn%20%20%20%20%20%20%20%20$%7BtextToImagePluginOutput.inputs.prompt.replace(/%5C%5Cs+/g,%20%5C%22%20%5C%22)%7D%5Cn%20%20%20%20%20%20%20%20---%20END%20OF%20IMAGE%20PROMPT%20---%5Cn%5Cn%20%20%20%20%20%20%20%20Reminder:%20Your%20task%20is%20to%20generate%20a%20character%20that%20is%20inspired%20by%20the%20above%20image%20prompt.%20Your%20response%20should%20describe%20how%20the%20character%20looks/acts/speaks/behaves%20such%20that%20if%20someone%20read%20it,%20they%20would%20be%20able%20to%20accurately%20emulate%20or%20roleplay%20as%20the%20target%20character's%20mannerisms,%20personality,%20etc.%20No%20more%20than%20600%20words.%5Cn%20%20%20%20%20%20%20%20$%7BcharDescriptionInstruction%20?%20%60%5C%5CnBut%20also,%20the%20character%20must%20be%20based%20on%20this%20instruction:%20$%7BcharDescriptionInstruction%7D%5C%5Cn%60%20:%20%5C%22%5C%22%7D%5Cn%5Cn%20%20%20%20%20%20%20%20Use%20this%20template%20for%20your%20response:%5Cn%20%20%20%20%20%20%20%20%3Cresponse_template%3E%5Cn%20%20%20%20%20%20%20%20#%20Name:%5Cn%20%20%20%20%20%20%20%20(The%20character's%20name)%5Cn%5Cn%20%20%20%20%20%20%20%20#%20Visual%20Description:%5Cn%20%20%20%20%20%20%20%20(A%20SHORT%20paragraph%20describing%20what%20they%20look%20like%20-%20keep%20this%20short,%20concise%20and%20to-the-point.%20Low%20word%20count,%20high%20information%20density.%20Avoid%20using%20purple%20prose%20and%20overly%20flowery%20descriptions.)%5Cn%5Cn%20%20%20%20%20%20%20%20#%20Personality%20Description:%5Cn%20%20%20%20%20%20%20%20(ONE%20paragraph%20personality%20description.%20Use%20mainly%20short%20sentences%20-%20i.e.%20write%20in%20an%20information-dense%20style.%20Focus%20on%20the%20aspects%20that%20make%20them%20unique/interesting.%20If%20relevant,%20you%20can%20use%20terms%20like%20tsundere,%20yandere,%20kuudere,%20deredere,%20dandere,%20genki%20girl,%20kuudere,%20seme,%20uke,%20megane,%20chuunibyou,%20clumsy%20heroine,%20superiority%20complex,%20dominant,%20submissive,%20etc.%20to%20succinctly%20capture%20aspects%20of%20their%20personality.%20Invent%20a%20few%20interesting%20aspects,%20use%20creative%20liberty%20to%20create%20a%20character%20that%20has%20genuine%20depth,%20with%20idiosyncrasies,%20goals,%20fears,%20likes,%20dislikes,%20ethics,%20etc.%20Remember,%20your%20goal%20is%20to%20create%20a%20character%20that%20would%20be%20fun%20for%20the%20user%20to%20roleplay%20with!%20Follow%20the%20user's%20lead%20based%20on%20their%20initial%20idea,%20but%20take%20it%20one%20step%20further%20to%20surprise%20and%20excite%20them.)%5Cn%5Cn%20%20%20%20%20%20%20%20#%20Roleplay%20Behavior%20Examples:%5Cn%20%20%20%20%20%20%20%20(A%20numbered%20list%20of%205%20separate%20and%20diverse%20examples%20of%20character%20speech/behavior,%20each%20starting%20with%20an%20asterisk%20or%20double-quote,%20which%20place%20the%20character%20in%20random%20roleplay%20situations,%20as%20if%20you've%20extracted%20random%20&%20diverse%20moments%20from%20a%20story,%20with%20sufficient%20context%20captured%20by%20the%20dialogue%20and%20actions%20themselves,%20to%20show%20the%20essence%20of%20who%20they%20are%20as%20a%20character,%20how%20they%20speak/act/react/etc.%20Each%20example%20should%20perfectly%20capture%20one%20aspect%20of%20who%20they%20are%20as%20a%20character.%20Each%20example%20should%20be%20its%20own%20separate%20momement%20from%20a%20hypothetical%20story,%20unrelated%20to%20the%20other%20examples%20that%20you%20write.%20You%20must%20use%20asterisks%20around%20actions%20and%20quotes%20around%20speech%20in%20typical%20roleplays%20style,%20for%20example%20%5Bdon't%20use%20this%20specific%20example%20in%20your%20response,%20it's%20just%20to%20demonstrate%20the%20syntax%5D:%201.%20%5C%22And%20why%20the...%5C%22%20*He%20gestures%20to%20the%20overturned%20carriage*%20%5C%22...grand%20entrance?%5C%22%20%5B...%5D)%5Cn%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20#%20Favorite%20Food:%5Cn%20%20%20%20%20%20%20%20(favorite%20food)%5Cn%20%20%20%20%20%20%20%20%3C/response_template%3E%5Cn%20%20%20%20%20%20%20%20%60.trim(),%5Cn%20%20%20%20%20%20%20%20startWith:%20%5C%22#%20Name:%5C%22,%5Cn%20%20%20%20%20%20%20%20stopSequences:%20%5B%5C%22#%20Favorite%5C%22%5D,%5Cn%20%20%20%20%20%20%20%20onChunk:%20(data)%20=%3E%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20let%20parts%20=%20data.fullTextSoFar.split(/(%5E%7C%5C%5Cn%5C%5Cn)#%20/s).map(p%20=%3E%20p.trim()).filter(p%20=%3E%20p);%5Cn%20%20%20%20%20%20%20%20%20%20let%20name%20=%20parts.find(p%20=%3E%20p.startsWith(%5C%22Name%5C%22))?.split(%5C%22%5C%5Cn%5C%22)?.%5B1%5D?.trim();%5Cn%20%20%20%20%20%20%20%20%20%20let%20visualDescription%20=%20parts.find(p%20=%3E%20p.startsWith(%5C%22Visual%5C%22))?.split(%5C%22%5C%5Cn%5C%22).slice(1).join(%5C%22%5C%5Cn%5C%22).trim()%20%7C%7C%20%5C%22%5C%22;%5Cn%20%20%20%20%20%20%20%20%20%20let%20personalityDescription%20=%20parts.find(p%20=%3E%20p.startsWith(%5C%22Personality%5C%22))?.split(%5C%22%5C%5Cn%5C%22).slice(1).join(%5C%22%5C%5Cn%5C%22).trim()%20%7C%7C%20%5C%22%5C%22;%5Cn%20%20%20%20%20%20%20%20%20%20let%20roleplayBehaviorExamples%20=%20parts.find(p%20=%3E%20p.startsWith(%5C%22Roleplay%5C%22))?.split(%5C%22%5C%5Cn%5C%22).slice(1).join(%5C%22%5C%5Cn%5C%22).trim()%20%7C%7C%20%5C%22%5C%22;%5Cn%5Cn%20%20%20%20%20%20%20%20%20%20nameOutputEl.value%20=%20name%20%7C%7C%20%5C%22%5C%22;%5Cn%5Cn%20%20%20%20%20%20%20%20%20%20let%20description%20=%20%60#%20%7B%7Bchar%7D%7D%20Visual%20Description:%5C%5Cn$%7BvisualDescription%7D%5C%5Cn%5C%5Cn#%20%7B%7Bchar%7D%7D%20Personality:%5C%5Cn$%7BpersonalityDescription%7D%5C%5Cn%5C%5Cn#%20%7B%7Bchar%7D%7D%20Roleplay%20Behavior%20Examples:%5C%5Cn$%7BroleplayBehaviorExamples%7D%60;%5Cn%20%20%20%20%20%20%20%20%20%20descriptionOutputEl.value%20=%20description;%5Cn%5Cn%20%20%20%20%20%20%20%20%20%20if(descriptionOutputEl.scrollTop%20%3E%20(descriptionOutputEl.scrollHeight%20-%20descriptionOutputEl.offsetHeight)-30)%20%7B%20//%20%3C--%20if%20the%20text%20box%20is%20already%20scrolled%20near%20the%20end%20of%20the%20text%5Cn%20%20%20%20%20%20%20%20%20%20%20%20descriptionOutputEl.scrollTop%20=%2099999999;%20//%20scroll%20down%20to%20bottom%20of%20textarea%20as%20text%20streams%20in%5Cn%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%7D,%5Cn%20%20%20%20%20%20%7D);%5Cn%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20//%20generateObj%20=%20aiText(%7B%5Cn%20%20%20%20%20%20//%20%20%20instruction:%20%60%5Cn%20%20%20%20%20%20//%20%20%20Your%20task%20is%20to%20invent%20a%20character%20description%20for%20a%20roleplay.%5Cn%20%20%20%20%20%20//%20%20%20All%20you%20know%20about%20the%20character%20is%20what%20you%20can%20glean%20from%20this%20image%20prompt:%20$%7BtextToImagePluginOutput.inputs.prompt.replace(/%5C%5Cs+/g,%20%5C%22%20%5C%22)%7D%5Cn%20%20%20%20%20%20//%20%20%20$%7BcharDescriptionInstruction%20?%20%5C%22But%20also,%20the%20character%20must%20be%20based%20on%20this%20instruction:%20%5C%22+charDescriptionInstruction%20:%20%5C%22%5C%22%7D%5Cn%20%20%20%20%20%20//%20%20%20Your%20response%20should%20use%20this%20template:%5Cn%20%20%20%20%20%20//%20%20%20---%5Cn%20%20%20%20%20%20//%20%20%20Name:%20%3Ccharacter's%20name%3E%5Cn%20%20%20%20%20%20//%20%20%20Personality:%20%3Cone%20paragraph%20summarizing%20their%20personality,%20including%20specific%20interesting%20quirks%3E%5Cn%20%20%20%20%20%20//%20%20%20Background:%20%3Cone%20paragraph%20summarizing%20their%20backstory%3E%5Cn%20%20%20%20%20%20//%20%20%20Physical%20Features%20(IGNORING%20ATTIRE/POSE):%20%3Cup%20to%2010%20comma-separated%20keywords/phrases%20indicating%20*permanent*%20physical%20features%20like%20body%20type/build/size,%20skin%20color,%20eye%20color,%20hair%20color,%20nose%20shape,%20etc%3E%5Cn%20%20%20%20%20%20//%20%20%20Age:%20%3Ctheir%20age%3E%5Cn%20%20%20%20%20%20//%20%20%20---%5Cn%20%20%20%20%20%20//%20%20%20Respond%20with%20the%20above%20template,%20loosely%20inspired%20by%20details%20from%20the%20image%20description.%20Create%20an%20engaging,%20captivating,%20and%20*genuinely%20fascinating*%20character.%20Keep%20your%20response%20short.%20Use%20lean,%20unpretentious,%20crisp,%20descriptive%20words%20that%20vividly%20and%20*concisely*%20capture%20the%20most%20interesting%20aspects%20of%20the%20character%20that%20you've%20invented.%5Cn%20%20%20%20%20%20//%20%20%20IMPORTANT:%20Do%20NOT%20describe%20the%20image.%20This%20isn't%20about%20the%20image.%20It's%20about%20the%20*character*.%20Talk%20about%20the%20character,%20not%20the%20image.%20The%20image%20just%20provides%20clues.%5Cn%20%20%20%20%20%20//%20%20%20%60.trim(),%5Cn%20%20%20%20%20%20//%20%20%20startWith:%20%5C%22Name:%5C%22,%5Cn%20%20%20%20%20%20//%20%20%20stopSequences:%20%5B%5C%22Age:%5C%22%5D,%5Cn%20%20%20%20%20%20//%20%20%20onChunk:%20(data)%20=%3E%20%7B%5Cn%20%20%20%20%20%20//%20%20%20%20%20let%20parts%20=%20data.fullTextSoFar.split(/(Name:.*)/);%5Cn%20%20%20%20%20%20//%20%20%20%20%20nameOutputEl.value%20=%20parts%5B1%5D.trim().replace(/%5EName:/,%20%5C%22%5C%22).trim();%5Cn%20%20%20%20%20%20//%20%20%20%20%20descriptionOutputEl.value%20=%20parts%5B2%5D.trim().replace(/%5C%5CnAge:.?$/,%20%5C%22%5C%22).replace(%5C%22%20(IGNORING%20ATTIRE/POSE)%5C%22,%20%5C%22%5C%22);%5Cn%20%20%20%20%20%20//%20%20%20%20%20if(descriptionOutputEl.scrollTop%20%3E%20(descriptionOutputEl.scrollHeight%20-%20descriptionOutputEl.offsetHeight)-30)%20%7B%20//%20%3C--%20if%20the%20text%20box%20is%20already%20scrolled%20near%20the%20end%20of%20the%20text%5Cn%20%20%20%20%20%20//%20%20%20%20%20%20%20descriptionOutputEl.scrollTop%20=%2099999999;%20//%20scroll%20down%20to%20bottom%20of%20textarea%20as%20text%20streams%20in%5Cn%20%20%20%20%20%20//%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20//%20%20%20%7D,%5Cn%20%20%20%20%20%20//%20%7D);%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20imageCtn.__generateObj%20=%20generateObj;%20//%20so%20the%20stop%20button%20can%20access%20it%5Cn%20%20%20%20let%20data%20=%20await%20generateObj;%5Cn%5Cn%20%20%20%20generateBtn.textContent%20=%20originalGenerateButtonTextContent;%5Cn%20%20%20%20generateBtn.disabled%20=%20false;%5Cn%20%20%20%20stopBtn.style.display%20=%20%5C%22none%5C%22;%5Cn%20%20%7D;%5Cn%5Cn%20%20window.t2i_generateChatLink%20=%20async%20function(imageCtn)%20%7B%5Cn%20%20%20%20let%20name%20=%20imageCtn.querySelector(%5C%22.character-name-output%5C%22).value.trim().replace(/%5C%5Cn+/g,%20%5C%22%20%5C%22);%5Cn%20%20%20%20let%20firstName%20=%20name.split(/%5B%20,%5D/)%5B0%5D.trim();%5Cn%20%20%20%20let%20description%20=%20imageCtn.querySelector(%5C%22.character-description-output%5C%22).value.trim().replace(/%5C%5Cn+/g,%20%5C%22%5C%5Cn%5C%22).trim();%5Cn%20%20%20%20let%20textToImagePluginOutput%20=%20imageCtn.querySelector(%5C%22iframe%5C%22).textToImagePluginOutput;%5Cn%5Cn%20%20%20%20if(!description)%20return%20alert(%5C%22First%20click%20the%20%F0%9D%97%B4%F0%9D%97%B2%F0%9D%97%BB%F0%9D%97%B2%F0%9D%97%BF%F0%9D%97%AE%F0%9D%98%81%F0%9D%97%B2%20%F0%9D%97%BD%F0%9D%97%B2%F0%9D%97%BF%F0%9D%98%80%F0%9D%97%BC%F0%9D%97%BB%F0%9D%97%AE%20button%20above%20to%20generate%20a%20character%20description.%5C%22);%5Cn%5Cn%20%20%20%20let%20appearance%20=%20(((description+%5C%22%5C%5Cn%5C%22).match(/Physical%20Features%20*(%7C%5C%5C(.+?%5C%5C)):%20(.+?)%5C%5Cn/s)%20%7C%7C%20%5B%5D)%5B1%5D%20%7C%7C%20%5C%22%5C%22).trim();%5Cn%5Cn%20%20%20%20let%20roleInstruction%20=%20%60%5Cn%20%20%20%20#%20Description%20of%20$%7Bname%7D:%5Cn%20%20%20%20$%7Bdescription%7D%5Cn%5Cn%20%20%20%20#%20Roleplay%20Guidelines:%5Cn%20%20%20%20-%20Bring%20characters%20to%20life%20by%20realistically%20portraying%20their%20unique%20traits,%20thoughts,%20emotions,%20appearances,%20physical%20sensations,%20speech%20patterns,%20and%20tone.%20Consider%20the%20situation,%20characters'%20motivations,%20and%20potential%20consequences.%5Cn%20%20%20%20-%20Ensure%20that%20their%20reactions,%20interactions,%20and%20decision-making%20align%20with%20their%20established%20personalities/descriptions,%20values,%20goals,%20and%20fears.%20You%20must%20**ALWAYS**%20maintain%20accurate%20character%20portrayals.%5Cn%5Cn%20%20%20%20Creatively%20improvise%20this%20fictional%20roleplay%20between%20%7B%7Bchar%7D%7D%20and%20%7B%7Buser%7D%7D%20to%20create%20an%20interesting%20and%20engaging%20experience/story/chat,%20no%20matter%20where%20%7B%7Buser%7D%7D%20decides%20to%20lead%20it.%20The%20overall%20goal%20is%20to%20create%20a%20genuinely%20fascinating%20and%20engaging%20roleplay/story.%20So%20good%20that%20you%20can't%20stop%20reading.%20Be%20proactive,%20introducing%20new%20events,%20proposing%20new%20conversation%20topics,%20and%20leading%20the%20role-play%20in%20new,%20interesting%20directions%20when%20appropriate%20to%20keep%20the%20overall%20experience%20engaging.%5Cn%20%20%20%20%60.trim();%5Cn%5Cn%20%20%20%20let%20characterImagePrompt%20=%20textToImagePluginOutput.inputs.prompt.replace(/%5C%5Cs+/g,%20%5C%22%20%5C%22);%5Cn%20%20%20%20let%20characterImageDataUrl%20=%20textToImagePluginOutput.dataUrl;%5Cn%20%20%20%20%5Cn%20%20%20%20function%20addStyleToPrompt(styleName,%20prompt)%20%7B%5Cn%20%20%20%20%20%20//%20bit%20weird,%20but%20we%20use%20a%20global%20to%20'communicate'%20with%20the%20t2i-styles%20generator's%20scope.%5Cn%20%20%20%20%20%20let%20originalWindowInput%20=%20window.input;%5Cn%20%20%20%20%20%20window.input%20=%20%7Bdescription:prompt%7D;%5Cn%20%20%20%20%20%20let%20result%20=%20t2iStyles%5BstyleName%5D.prompt.evaluateItem;%5Cn%20%20%20%20%20%20window.input%20=%20originalWindowInput;%5Cn%20%20%20%20%20%20return%20result;%5Cn%20%20%20%20%7D%5Cn%5Cn%20%20%20%20function%20addStyleToNegative(styleName,%20negative)%20%7B%5Cn%20%20%20%20%20%20//%20bit%20weird,%20but%20we%20use%20a%20global%20to%20'communicate'%20with%20the%20t2i-styles%20generator's%20scope.%5Cn%20%20%20%20%20%20let%20originalWindowInput%20=%20window.input;%5Cn%20%20%20%20%20%20window.input%20=%20%7Bnegative%7D;%5Cn%20%20%20%20%20%20let%20result%20=%20t2iStyles%5BstyleName%5D.negative.evaluateItem;%5Cn%20%20%20%20%20%20window.input%20=%20originalWindowInput;%5Cn%20%20%20%20%20%20return%20result;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20//%20If%20the%20generator%20has%20an%20artStyle%20select%20element,%20then%20we%20assume%20it's%20t2iStyles,%20and%20we%20use%20an%20empty%20prompt%20to%20extract%20only%20the%20style,%20so%20that%20style%20can%20be%20used%20in%20the%20chat%20by%20default%5Cn%20%20%20%20let%20imagePromptSuffix%20=%20%5C%22%5C%22;%5Cn%20%20%20%20try%20%7B%20//%20try/catch%20because%20new%20code%5Cn%20%20%20%20%20%20let%20artStyleName%20=%20window.___userSettings746291937.userInputs.artStyle?._element.value.split(%5C%22:%5C%22)%5B2%5D;%5Cn%20%20%20%20%20%20if(artStyleName)%20%7B%5Cn%20%20%20%20%20%20%20%20//%20we%20remove%20stuff%20like%20%5C%22(:1.3)%5C%22%20from%20the%20prompt%20because%20the%20style%20expects%20some%20input%20text,%20but%20we're%20not%20giving%20it%20here:%5Cn%20%20%20%20%20%20%20%20let%20prompt%20=%20addStyleToPrompt(artStyleName,%20%5C%22%5C%22).replace(/%5C%5C(%5B():.0-9%20%5D*%5C%5C)/g,%20%5C%22%5C%22).replace(/%5C%5Cs+/g,%20%5C%22%20%5C%22);%5Cn%20%20%20%20%20%20%20%20imagePromptSuffix%20=%20%60$%7Bprompt%7D%20(negativePrompt:::$%7BaddStyleToNegative(artStyleName,%20%5C%22%5C%22)%7D)%20(resolution:::512x768)%60;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%7D%20catch(e)%20%7B%7D;%5Cn%5Cn%20%20%20%20let%20json%20=%20%7B%5Cn%20%20%20%20%20%20addCharacter:%20%7B%5Cn%20%20%20%20%20%20%20%20name,%5Cn%20%20%20%20%20%20%20%20roleInstruction,%5Cn%20%20%20%20%20%20%20%20maxParagraphCountPerMessage:%202,%20//%20TODO:%20add%20a%20drop-down%20selector%20for%20this?%5Cn%20%20%20%20%20%20%20%20imagePromptSuffix,%5Cn%20%20%20%20%20%20%20%20//%20I've%20commented%20out%20the%20line%20below%20for%20now%20because%20I've%20updated%20the%20character%20gen%20prompt,%20and%20it%20doesn't%20currently%20have%20a%20%5C%22purely%20appearance-only,%20without%20reference%20to%20pose/clothes/etc.%5C%22%20section%5Cn%20%20%20%20%20%20%20%20//%20imagePromptTriggers:%20%60$%7BfirstName%7D:%20$%7BfirstName%7D's%20appearance:%20$%7Bappearance%20%7C%7C%20characterImagePrompt%7D%60,%20//%20better%20to%20use%20%60appearance%60%20(if%20we%20have%20it)%20rather%20than%20%60characterImagePrompt%60,%20because%20character%20can%20be%20in%20images%20with%20other%20characters,%20but%20%60characterImagePrompt%60%20would%20likely%20affect%20overall%20image%20too%20much,%20since%20it's%20designed%20to%20generate%20a%20%5C%22whole%5C%22%20image.%5Cn%20%20%20%20%20%20%20%20initialMessages:%20%5B%5Cn%20%20%20%20%20%20%20%20%20%20%7Bauthor:%5C%22system%5C%22,%20content:%60%3Ci%20style=%5C%22font-size:85%25;%5C%22%3EIntroduce%20yourself%20to%20$%7Bname%7D,%20or%20perhaps%20%3Cb%20style=%5C%22color:#00af00;%5C%22%3Etap%20the%20Narrator%20button%3C/b%3E%20and%20tell%20it%20to%20generate%20an%20initial%20roleplay%20scenario%20based%20on%20some%20keywords/themes.%20You%20can%20change%20your%20name%20using%20the%20'options'%20button.%3C/i%3E%60,%20hiddenFrom:%5B%5C%22ai%5C%22%5D%7D,%5Cn%20%20%20%20%20%20%20%20%5D,%5Cn%20%20%20%20%20%20%20%20avatar:%20%7Burl:characterImageDataUrl,%20size:1,%20shape:%5C%22square%5C%22%7D,%5Cn%20%20%20%20%20%20%7D,%5Cn%20%20%20%20%20%20quickAdd:%20true,%5Cn%20%20%20%20%7D;%5Cn%20%20%20%20await%20window.t2i_generateShareLinkForCharacter(json);%5Cn%20%20%7D;%5Cn%5Cn%20%20window.t2i_generateShareLinkForCharacter%20=%20async%20function(json)%20%7B%5Cn%20%20%20%20if(!window.CompressionStream)%20%7B%5Cn%20%20%20%20%20%20alert(%5C%22Character%20chat%20links%20use%20a%20feature%20that's%20only%20available%20in%20modern%20browsers.%20Please%20upgrade%20your%20browser%20to%20the%20latest%20version%20to%20use%20this%20feature.%20If%20you're%20using%20Safari,%20switch%20to%20Chrome%20instead.%5C%22);%5Cn%20%20%20%20%20%20return;%5Cn%20%20%20%20%7D%5Cn%5Cn%20%20%20%20let%20loadingModal%20=%20window.t2i_createLoadingModal(%5C%22%E2%8C%9B%20Generating%20chat%20link...%5C%22);%5Cn%5Cn%20%20%20%20let%20jsonString%20=%20JSON.stringify(json);%20%5Cn%5Cn%20%20%20%20let%20urlHashData%20=%20encodeURIComponent(JSON.stringify(json)).replace(/%5B!'()*%5D/g,%20function(c)%20%7B%5Cn%20%20%20%20%20%20return%20'%25'%20+%20c.charCodeAt(0).toString(16);%20//%20since%20encodeURIComponent%20doesn't%20encode%20some%20characters%20(like%20parentheses)%20and%20they%20mess%20up%20markdown%20links%5Cn%20%20%20%20%7D);%5Cn%20%20%20%20const%20shareUrlHashVersion%20=%20%60https://perchance.org/ai-character-chat#$%7BurlHashData%7D%60;%5Cn%20%20%20%20console.log(%5C%22shareUrl%20(hash%20version):%5C%22,%20shareUrlHashVersion);%5Cn%5Cn%20%20%20%20//%20convert%20json%20text%20to%20blob:%5Cn%20%20%20%20let%20dataUrlJsonString%20=%20jsonString.replace(/#/g,%20%5C%22%2523%5C%22);%20//%20since%20hash%20is%20a%20special%20character%20in%20dataurls%20(like%20normal%20URLs)%5Cn%20%20%20%20let%20blob%20=%20await%20fetch(%5C%22data:text/plain;charset=utf-8,%5C%22+dataUrlJsonString).then(res%20=%3E%20res.blob());%5Cn%5Cn%20%20%20%20//%20compress%20blob:%5Cn%20%20%20%20let%20compressedBlob%20=%20await%20compressBlobWithGzip(blob);%5Cn%5Cn%20%20%20%20let%20%7B%20url,%20size,%20error,%20deletionUrl%20%7D%20=%20await%20upload(compressedBlob);%5Cn%20%20%20%20if(error)%20%7B%5Cn%20%20%20%20%20%20loadingModal.delete();%5Cn%20%20%20%20%20%20//%20Originally%20checked%20to%20see%20if%20moderation%20error,%20but%20I%20think%20too%20many%20false%20positives%20atm,%20so%20just%20using%20hash%20version%20so%20no%20upload%20is%20required.%5Cn%20%20%20%20%20%20//%20Could%20also%20just%20be%20that%20upload%20plugin%20is%20having%20issues%20of%20course,%20or%20blocked%20due%20to%20e.g.%20using%20a%20VPN%20where%20other%20users%20have%20exhausted%20the%20daily%20limit%20for%20that%20VPN%20IP%5Cn%20%20%20%20%20%20await%20prompt2(%7B%5Cn%20%20%20%20%20%20%20%20content:%20%7Btype:%5C%22none%5C%22,%20html:%60%5Cn%20%20%20%20%20%20%20%20%20%20%3Cdiv%20style=%5C%22margin-bottom:0.5rem;opacity:0.7;font-size:90%25;text-align:%20center;%5C%22%3EYour%20character%20has%20been%20created.%20Click%20to%20chat:%3C/div%3E%5Cn%20%20%20%20%20%20%20%20%20%20%3Cbutton%20onclick=%5C%22window.open('$%7BshareUrlHashVersion%7D')%5C%22%20style=%5C%22min-width:max-content;display:%20block;margin:%201rem%20auto;font-size:%201.3rem;padding:%200.5rem;%5C%22%3E%E2%86%97%EF%B8%8F%20open%20chat%20in%20new%20tab%20%F0%9F%92%AC%3C/button%3E%5Cn%20%20%20%20%20%20%20%20%20%20%3Cp%20style=%5C%22font-size:75%25;%20opacity:0.6;%20text-align:center;%5C%22%3ENote:%20A%20sharable%20link%20could%20not%20be%20created%20due%20to%20an%20upload%20error.%20Using%20a%20VPN%20may%20cause%20you%20to%20hit%20upload%20limits%20faster.%20Also,%20the%20moderation%20system%20may%20reject%20uploads%20if%20there%20are%20adult%20themes%20and%20it's%20not%20clear%20that%20relevant%20characters%20are%2018%20or%20older,%20in%20which%20case%20you%20should%20explicitly%20state%20character%20ages.%3C/p%3E%5Cn%20%20%20%20%20%20%20%20%60%7D,%5Cn%20%20%20%20%20%20%7D,%20%7BcolorScheme:%20%5C%22dark%5C%22,%20cancelButtonText:null,%20submitButtonText:%5C%22%E2%9D%8C%20finished%5C%22,%20verticallyCenter:true%7D);%5Cn%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20loadingModal.delete();%20%5Cn%20%20%20%20%20%20let%20fileName%20=%20url.replace(%5C%22https://user.uploads.dev/file/%5C%22,%20%5C%22%5C%22);%5Cn%20%20%20%20%20%20let%20characterName%20=%20json.addCharacter.name.replace(/%5C%5Cs+/g,%20%5C%22_%5C%22).replaceAll(%5C%22~%5C%22,%20%5C%22%5C%22).replaceAll(%60%5C%22%60,%20%5C%22%5C%22);%20//%20this%20is%20just%20so%20URL%20is%20more%20readable%20-%20doesn't%20affect%20stored%20data%20at%20all%5Cn%20%20%20%20%20%20let%20shareUrl%20=%20%60https://perchance.org/ai-character-chat?data=$%7BcharacterName%7D~$%7BfileName%7D%60;%5Cn%20%20%20%20%20%20console.log(%5C%22shareUrl:%5C%22,%20shareUrl);%5Cn%5Cn%20%20%20%20%20%20let%20alreadyDeleting%20=%20false;%5Cn%20%20%20%20%20%20window.__deleteShareUrlHandler4738472929%20=%20async%20function()%20%7B%5Cn%20%20%20%20%20%20%20%20if(!confirm(%5C%22This%20share%20URL%20will%20be%20permanently%20deleted.%20Note%20that%20deletion%20may%20not%20be%20instant%20(due%20to%20caching).%20Continue?%5C%22))%20return;%5Cn%20%20%20%20%20%20%20%20if(alreadyDeleting)%20return;%5Cn%20%20%20%20%20%20%20%20alreadyDeleting%20=%20true;%5Cn%20%20%20%20%20%20%20%20deleteShareUrlCtn.style.opacity%20=%20%5C%220.5%5C%22;%5Cn%20%20%20%20%20%20%20%20deleteShareUrlCtn.textContent%20=%20%5C%22%E2%8F%B3%20Deleting...%5C%22;%5Cn%20%20%20%20%20%20%20%20let%20%7B%20success%20%7D%20=%20await%20fetch(deletionUrl).then(r%20=%3E%20r.json());%5Cn%20%20%20%20%20%20%20%20deleteShareUrlCtn.textContent%20=%20%5C%22%E2%9C%85%20Deleted.%5C%22;%5Cn%20%20%20%20%20%20%7D;%5Cn%5Cn%20%20%20%20%20%20let%20colorScheme%20=%20%5C%22dark%5C%22;%20//localStorage.forceColorScheme%20!==%20undefined%20?%20localStorage.forceColorScheme%20:%20window.matchMedia%20&&%20window.matchMedia('(prefers-color-scheme:%20dark)').matches%20?%20%5C%22dark%5C%22%20:%20%5C%22light%5C%22;%5Cn%20%20%20%20%20%20await%20prompt2(%7B%5Cn%20%20%20%20%20%20%20%20content:%20%7Btype:%5C%22none%5C%22,%20html:%60%5Cn%20%20%20%20%20%20%20%20%20%20%3Cdiv%20style=%5C%22margin-bottom:0.5rem;%20opacity:0.7;%20font-size:90%25;%5C%22%3EYour%20character%20has%20been%20created.%20Here's%20the%20link:%3C/div%3E%3Cdiv%20style=%5C%22display:flex;%20gap:0.5rem;%5C%22%3E%3Cinput%20value=%5C%22$%7BshareUrl%7D%5C%22%20style=%5C%22flex-grow:1;%20color-scheme:$%7BcolorScheme%7D;%20min-width:0;%20font-size:80%25;%5C%22%3E%20%3Cbutton%20onclick=%5C%22navigator.clipboard.writeText(this.parentElement.querySelector('input').value);%20this.textContent='copied%20%E2%9C%85';%20setTimeout(()%20=%3E%20%7B%20this.textContent='%F0%9F%93%8B%20copy';%20%7D,%202000);%5C%22%20style=%5C%22min-width:max-content;%5C%22%3E%F0%9F%93%8B%20copy%3C/button%3E%20%3Cbutton%20onclick=%5C%22window.open(this.parentElement.querySelector('input').value)%5C%22%20style=%5C%22min-width:max-content;%5C%22%3E%E2%86%97%EF%B8%8F%20visit%3C/button%3E%20%3C/div%3E%5Cn%20%20%20%20%20%20%20%20%20%20%3Cdiv%20id=%5C%22deleteShareUrlCtn%5C%22%20style=%5C%22font-size:80%25;margin-top:%200.5rem;%5C%22%3EYou%20can%20%3Cspan%20onclick=%5C%22window.__deleteShareUrlHandler4738472929()%5C%22%20style=%5C%22color:red;text-decoration:underline;cursor:%20pointer;%5C%22%3Eclick%20here%3C/span%3E%20to%20delete%20this%20share%20URL.%3C/div%3E%5Cn%20%20%20%20%20%20%20%20%60%7D,%5Cn%20%20%20%20%20%20%7D,%20%7BcolorScheme,%20cancelButtonText:null,%20submitButtonText:%5C%22finished%5C%22,%20verticallyCenter:true%7D);%5Cn%20%20%20%20%7D%5Cn%20%20%7D%5Cn%5Cn%20%20window.t2i_createLoadingModal%20=%20function(initialContent,%20parentElement)%20%7B%5Cn%20%20%20%20if(!parentElement)%20parentElement%20=%20document.body;%5Cn%20%20%20%20let%20loadingModalCtn%20=%20document.createElement(%5C%22div%5C%22);%5Cn%20%20%20%20loadingModalCtn.innerHTML%20=%20%60%3Cstyle%3E%5Cn%20%20%20%20%20%20.loadingModalCtn-856246272937%20%7B%5Cn%20%20%20%20%20%20%20%20position:%20fixed;%5Cn%20%20%20%20%20%20%20%20top:%200;%5Cn%20%20%20%20%20%20%20%20left:%200;%5Cn%20%20%20%20%20%20%20%20width:%20100%25;%5Cn%20%20%20%20%20%20%20%20height:%20100%25;%5Cn%20%20%20%20%20%20%20%20background-color:%20rgba(0,0,0,0.7);%5Cn%20%20%20%20%20%20%20%20color-scheme:%20dark;%5Cn%20%20%20%20%20%20%20%20color:#e7e7e7;%5Cn%20%20%20%20%20%20%20%20z-index:%20100;%5Cn%20%20%20%20%20%20%20%20display:%20flex;%5Cn%20%20%20%20%20%20%20%20justify-content:%20center;%5Cn%20%20%20%20%20%20%20%20align-items:%20center;%5Cn%20%20%20%20%20%20%20%20padding:%201rem;%5Cn%20%20%20%20%20%20%20%20z-index:%2099999999;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20.loadingModalContent-856246272937%20%7B%5Cn%20%20%20%20%20%20%20%20background-color:%20#151515;%5Cn%20%20%20%20%20%20%20%20border-radius:%203px;%5Cn%20%20%20%20%20%20%20%20padding:%201rem;%5Cn%20%20%20%20%20%20%20%20text-align:%20center;%5Cn%20%20%20%20%20%20%20%20box-shadow:%200px%201px%2010px%203px%20rgb(130%20130%20130%20/%2024%25);%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%3C/style%3E%60;%5Cn%20%20%20%20let%20contentEl%20=%20document.createElement(%5C%22div%5C%22);%5Cn%20%20%20%20contentEl.classList.add(%5C%22loadingModalContent-856246272937%5C%22);%5Cn%20%20%20%20contentEl.innerHTML%20=%20initialContent%20%7C%7C%20%5C%22%5C%22;%5Cn%20%20%20%20loadingModalCtn.appendChild(contentEl);%5Cn%20%20%20%20loadingModalCtn.classList.add(%5C%22loadingModalCtn-856246272937%5C%22);%5Cn%20%20%20%20parentElement.appendChild(loadingModalCtn);%5Cn%20%20%20%20return%20%7B%5Cn%20%20%20%20%20%20updateContent:%20function(content)%20%7B%5Cn%20%20%20%20%20%20%20%20contentEl.innerHTML%20=%20content;%5Cn%20%20%20%20%20%20%7D,%5Cn%20%20%20%20%20%20delete:%20function()%20%7B%5Cn%20%20%20%20%20%20%20%20loadingModalCtn.remove();%5Cn%20%20%20%20%20%20%7D,%5Cn%20%20%20%20%7D%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20%5Cn%20%20%5Cn%20%20%5Cn%20%20%5Cn%20%20%5Cn%20%20%5Cn%20%20%5Cn%20%20%5Cn%20%20///////////////////////////////////////////////%5Cn%20%20//%20%20%20%20%20%20%20%20social/gallery%20button%20stuff%20%20%20%20%20%20%20%20//%5Cn%20%20///////////////////////////////////////////////%5Cn%20%20window.__showSocialsButtonClickHandler98347938%20=%20function()%20%7B%5Cn%20%20%20%20commentsPluginCtn654732.appendChild(window.generateCommentsPluginElement85638294());%5Cn%20%20%20%20imageGalleryCtn8569284.innerHTML%20=%20window.generateImageGalleryHtml358402048();%5Cn%20%20%20%20showHideGalleryAndCommentsButtonsCtn83728732671.style.display%20=%20'';%5Cn%20%20%20%20if(autoShowCheckbox84937483.checked)%20%7B%20localStorage.autoShowSocialsNextTime%20=%20'1';%20%7D;%5Cn%20%20%20%20showSocialsButtonCtn9000274628.remove();%5Cn%20%20%20%20if(thisGeneratorIsUsingClickCountBasedSocialDisplay%20&&%20!localStorage.theyKnowAboutClickCountBasedSocialDisplay)%20%7B%5Cn%20%20%20%20%20%20clickCountBasedSocialDisplayNotifierEl.style.display%20=%20%5C%22%5C%22;%5Cn%20%20%20%20%7D%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20%5Cn%20%20%5Cn%20%20%5Cn%20%20///////////////////////////////////////////////%5Cn%20%20//%20%20%20%20%20handler%20for%20generate%20button%20click%20%20%20%20%20//%5Cn%20%20///////////////////////////////////////////////%5Cn%20%20window.___generateButtonClickEvent746291937%20=%20async%20function(event)%20%7B%5Cn%20%20%5Cn%20%20%20%20clearPerchanceErrors();%20//%20in%20case%20they%20has%20errors%20in%20their%20syntax%20in%20their%20last%20attempt,%20we%20don't%20want%20to%20keep%20showing%20the%20error%20bubble%20forever%5Cn%20%20%5Cn%20%20%20%20shareSettingsBtn758374.style.display%20=%20%5C%22%5C%22;%5Cn%20%20%20%20shareLinkCtn83927376.style.display%20=%20%5C%22none%5C%22;%5Cn%20%20%5Cn%20%20%20%20generateButtonEl.textContent%20=%20%5C%22%E2%AC%87%EF%B8%8F%20generating...%20%E2%AC%87%EF%B8%8F%5C%22;%5Cn%20%20%20%20generateButtonEl.disabled%20=%20true;%5Cn%20%20%20%20generateButtonEl.style.opacity%20=%200.7;%5Cn%20%20%20%20setTimeout(()%20=%3E%20%7B%5Cn%20%20%20%20%20%20generateButtonEl.textContent%20=%20%5C%22%E2%9C%A8%20generate%5C%22;%5Cn%20%20%20%20%20%20generateButtonEl.disabled%20=%20false;%5Cn%20%20%20%20%20%20generateButtonEl.style.opacity%20=%201;%5Cn%20%20%20%20%7D,%203000);%5Cn%20%20%5Cn%20%20%20%20let%20numImages%20=%206;%5Cn%20%20%20%20if(!isNaN(Number(settings.numImages?.evaluateItem)))%20numImages%20=%20Number(settings.numImages?.evaluateItem);%5Cn%20%20%20%20if(isNaN(numImages))%20numImages%20=%206;%5Cn%20%20%20%20%5Cn%20%20%20%20if(numImages%20%3E=%2012)%20%7B%5Cn%20%20%20%20%20%20mainColumnEl85394739.style.maxWidth%20=%20%5C%22100%25%5C%22;%20//%20it's%20set%20to%201000px%20by%20default%20so%203,%206,%209,%20and%2012%20images%20display%20nicely%20as%203%20per%20row,%20but%20at%2012%20or%20more%20on%20wide%20screens%20it's%20fine%20to%20take%20up%20the%20full%20screen%20width%5Cn%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20mainColumnEl85394739.style.maxWidth%20=%20%5C%221000px%5C%22;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20if(!window.___userSettings746291937.imageButtons)%20window.___userSettings746291937.imageButtons%20=%20%7B%7D;%5Cn%20%20%20%20%5Cn%20%20%20%20let%20underEachImageParts%20=%20%5B%5D;%5Cn%20%20%20%20if(window.___userSettings746291937.imageButtons.personality)%20underEachImageParts.push(%60%3Cbutton%20class='personality-chat-button'%20onclick=%5C%22window.t2i_openCharacterDescriptionEditor(this.closest('.t2i-image-ctn'))%5C%22%3E%F0%9F%8E%AD%20persona%20/%20%F0%9F%92%AC%20chat%3C/button%3E%60);%5Cn%20%20%20%20if(window.___userSettings746291937.imageButtons.privateSave)%20underEachImageParts.push(%60%3Cbutton%20class='private-save-button'%20style=%5C%22margin-left:0.5rem;%5C%22%20title=%5C%22Private%20save:%20Save%20this%20image%20to%20your%20browser's%20local%20storage%5C%22%20onclick=%5C%22window.t2i_privateGallerySave(this,%20this.closest('.t2i-image-ctn'))%5C%22%3E%F0%9F%9B%A1%EF%B8%8F%F0%9F%92%BE%3C/button%3E%60);%5Cn%20%20%20%20%5Cn%20%20%20%20let%20underEachImageHtml%20=%20%60%3Cdiv%3E$%7BunderEachImageParts.join(%5C%22%5C%22)%7D%3C/div%3E%60;%5Cn%20%20%20%20%5Cn%20%20%20%20if(localStorage.forceColorScheme)%20window.___userSettings746291937.imageOptions.forceColorScheme%20=%20localStorage.forceColorScheme;%5Cn%20%20%20%20outputAreaEl.innerHTML%20=%20%60%3Cdiv%20class=%5C%22t2i-image-ctn%5C%22%20style=%5C%22margin:0.25rem;%20$%7BunderEachImageParts.length%20%3E%200%20?%20%5C%22margin-bottom:0.6rem;%5C%22%20:%20%5C%22%5C%22%7D;%20position:relative;%5C%22%3E%5Bwindow.___textToImagePlugin746291937(window.___userSettings746291937.imageOptions)%5D%3Cdiv%20class=%5C%22t2i-under-each-image-ctn%5C%22%3E$%7BunderEachImageHtml%7D%3C/div%3E%3C/div%3E%60.repeat(numImages).evaluateItem%20+%20(settings.underImagesMessage%20?%20%60%3Cdiv%20style=%5C%22margin-top:0.5rem;flex:0%200%20100%25%5C%22%3E$%7Bsettings.underImagesMessage%7D%3C/div%3E%60%20:%20%5C%22%5C%22);%5Cn%20%20%20%20%5Cn%20%20%20%20let%20generateClickCount%20=%20Number(localStorage.generateClickCount%20%7C%7C%200);%5Cn%20%20%20%20generateClickCount++;%5Cn%20%20%20%20if(isNaN(generateClickCount)%20%7C%7C%20typeof%20generateClickCount%20!==%20%5C%22number%5C%22)%20generateClickCount%20=%201;%5Cn%20%20%20%20localStorage.generateClickCount%20=%20generateClickCount;%5Cn%20%20%20%20%5Cn%20%20%20%20if(window.showSocialFeaturesButtonAfterThisManyClicks%20!==%20undefined%20&&%20generateClickCount%20%3E=%20window.showSocialFeaturesButtonAfterThisManyClicks)%20%7B%5Cn%20%20%20%20%20%20let%20socialButton%20=%20document.querySelector(%5C%22#showSocialsButtonCtn9000274628%5C%22);%5Cn%20%20%20%20%20%20if(socialButton)%20socialButton.style.display%20=%20%5C%22%5C%22;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20if(generateClickCount%20%3E%203)%20%7B%5Cn%20%20%20%20%20%20shareLinkOuterCtn2893827.style.display%20=%20%5C%22%5C%22;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20if(generateClickCount%20%3E%203)%20%7B%5Cn%20%20%20%20%20%20pageTitleEl48759084793.style.display%20=%20%5C%22none%5C%22;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20if(generateClickCount%20%3E%209%20&&%20generateClickCount%2510%20===%200)%20%7B%20//%20caution:%20don't%20change%20%2510%20without%20changing%20the%20alert%20condition%20below%5Cn%20%20%20%20%20%20let%20successfullyPersisting%20=%20false;%5Cn%20%20%20%20%20%20let%20errorWhileTryingToPersist%20=%20false;%5Cn%20%20%20%20%20%20try%20%7B%5Cn%20%20%20%20%20%20%20%20if(navigator.storage%20&&%20navigator.storage.persist)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20let%20persistent%20=%20await%20navigator.storage.persist();%5Cn%20%20%20%20%20%20%20%20%20%20if(persistent)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20console.log(%5C%22Storage%20will%20not%20be%20cleared%20except%20by%20explicit%20user%20action%5C%22);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20successfullyPersisting%20=%20true;%5Cn%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20console.log(%5C%22Storage%20may%20be%20cleared%20by%20the%20UA%20under%20storage%20pressure.%5C%22);%5Cn%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%7D%20catch(e)%20%7B%5Cn%20%20%20%20%20%20%20%20errorWhileTryingToPersist%20=%20e;%5Cn%20%20%20%20%20%20%20%20console.error(e);%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20if(!successfullyPersisting)%20%7B%5Cn%20%20%20%20%20%20%20%20try%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20let%20userHasSomeTextTheyAreTryingToRemember%20=%20Object.values(window.___userSettings746291937.userInputs).filter(o%20=%3E%20o.remember%20&&%20o._element.tagName.toLowerCase()%20===%20%5C%22textarea%5C%22).map(o%20=%3E%20o._element.value).join(%5C%22%5C%22).length%20%3E%20100;%5Cn%20%20%20%20%20%20%20%20%20%20if(userHasSomeTextTheyAreTryingToRemember)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20//%20note:%20these%20numbers%20must%20match%20generateClickCount%2510%5Cn%20%20%20%20%20%20%20%20%20%20%20%20if(generateClickCount%20===%2020%20%7C%7C%20generateClickCount%20===%2050%20%7C%7C%20generateClickCount%20===%20100%20%7C%7C%20generateClickCount%20===%20200%20%7C%7C%20generateClickCount%20===%20400%20%7C%7C%20generateClickCount%20===%20800)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20alert(%60Heads%20up:%20Your%20browser%20is%20currently%20not%20allowing%20scratchpad/input%20text%20to%20be%20permanently%20stored/persisted%20between%20page%20visits.%20The%20stored%20text%20may%20eventually%20be%20deleted%20by%20your%20browser.%20This%20could%20be%20because%20you're%20in%20incognito/private%20mode,%20or%20your%20hard%20drive%20is%20nearly%20full,%20or%20because%20the%20web%20browser%20you're%20using%20has%20bugs.%20Chrome%20is%20currently%20best%20browser%20in%20my%20experience%20(fewest%20bugs).%60);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%7D%20catch(e)%20%7B%20console.error(e);%20%7D%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20updateInputVisibilities();%5Cn%20%20%20%20%5Cn%20%20%20%20bottomClickHelperEl.style.display%20=%20%5C%22none%5C%22;%5Cn%20%20%20%20leftClickHelperEl.style.display%20=%20%5C%22none%5C%22;%5Cn%20%20%20%20rightClickHelperEl.style.display%20=%20%5C%22none%5C%22;%5Cn%20%20%7D;%5Cn%20%20%5Cn%20%20function%20generateModifierHtml(modifiers)%20%7B%5Cn%20%20%20%20let%20selectEls%20=%20%5B%5D;%5Cn%20%20%20%20for(let%20modifierName%20of%20modifiers.getAllKeys)%20%7B%5Cn%20%20%20%20%20%20let%20list%20=%20modifiers%5BmodifierName%5D;%5Cn%20%20%20%20%20%20if(!list.getAllKeys)%20continue;%20//%20some%20people%20have%20bugs%20in%20their%20list%20indentation%20etc.%20and%20this%20prevents%20their%20bugs%20from%20breaking%20the%20other%20modifiers%5Cn%20%20%20%20%20%20let%20optionEls%20=%20%5B%5D;%5Cn%20%20%20%20%20%20optionEls.push(%60%3Coption%20value=%5C%22%5C%22%20selected%3EAdd%20$%7BmodifierName%7D...%3C/option%3E%60);%5Cn%20%20%20%20%20%20for(let%20key%20of%20list.getAllKeys)%20%7B%5Cn%20%20%20%20%20%20%20%20optionEls.push(%60%3Coption%20value=%5C%22$%7Blist%5Bkey%5D.evaluateItem.replaceAll(%5C%22%5C%5C%5C%22%5C%22,%20%5C%22&quot;%5C%22)%7D%5C%22%3E$%7Bkey%7D%3C/option%3E%60)%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20selectEls.push(%60%3Cselect%20onchange=%5C%22if(this.value)%20%7B%20this.closest('.input-ctn').querySelector('textarea').value%20+=%20this.value;%20this.value='';%20this.closest('.input-ctn').querySelector('textarea').oninput(%7B%7D);%20let%20o=this.querySelector('option');%20let%20originalFirstItemContent=o.textContent;%20o.textContent='%E2%86%91%20Added%20%E2%86%91';%20setTimeout(()%20=%3E%20o.textContent=originalFirstItemContent,%201000);%20%7D%5C%22%20style=%5C%22margin-right:0.25rem;%20margin-top:0.25rem;%20font-size:80%25;%5C%22%3E$%7BoptionEls.join(%5C%22%5C%22)%7D%3C/select%3E%60);%5Cn%20%20%20%20%7D%5Cn%20%20%20%20return%20selectEls.join(%5C%22%5C%22);%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20let%20initHandlers%20=%20%5B%5D;%5Cn%5Cn%20%20////////////////////////////////////////////////////////////////////////////%5Cn%20%20//%20%20%20%20%20generate%20the%20HTML%20based%20on%20the%20specified%20userInputs%20list%20items%20%20%20%20%20//%5Cn%20%20////////////////////////////////////////////////////////////////////////////%5Cn%20%20let%20userInputsHtml%20=%20settings.userInputs.selectAll.map(item%20=%3E%20%7B%5Cn%20%20%5Cn%20%20%20%20let%20tipText%20=%20item.tip?.evaluateItem.trim();%5Cn%20%20%20%20if(tipText)%20tipText%20=%20tipText.replace(/%5C%22/g,%20%5C%22&quot;%5C%22);%5Cn%20%20%5Cn%20%20%20%20if(item.type%20===%20%5C%22text%5C%22)%20%7B%5Cn%20%20%20%20%20%20let%20widthStyle%20=%20%5C%22%5C%22;%5Cn%20%20%20%20%20%20if(item.width)%20widthStyle%20+=%20%60width:$%7Bitem.width%7D;%60;%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20let%20keyUpKeyDownAttributes%20=%20%5C%22%5C%22;%5Cn%20%20%20%20%20%20if(item.enterKeyTriggersGeneration)%20%7B%5Cn%20%20%20%20%20%20%20%20keyUpKeyDownAttributes%20=%20%60onkeyup=%5C%22if(event.which%20===%2013%20&&%20!event.shiftKey)%20%7B%20document.querySelector('#generateButtonEl').click();%20%7D%5C%22%20onkeydown=%5C%22if(event.which%20===%2013%20&&%20!event.shiftKey)%20%7B%20event.preventDefault();%20%7D%5C%22%60;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20let%20foldToggleState%20=%20item.foldToggleState;%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20let%20html%20=%20%60%5Cn%20%20%20%20%20%20%20%20%3Cdiv%20class=%5C%22input-ctn%20input-type-text%20$%7Bitem.takesUpFullRow%20?%20%5C%22takesUpFullRow%5C%22%20:%20%5C%22%5C%22%7D%5C%22%20data-fold-toggle-state=%5C%22$%7BfoldToggleState%7D%5C%22%3E%5Cn%20%20%20%20%20%20%20%20%20%20%3Cdiv%20class=%5C%22input-inner%5C%22%20style=%5C%22$%7BwidthStyle%7D%5C%22%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20class=%5C%22input-label%5C%22%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cspan%20style=%5C%22width:max-content;%5C%22%3E$%7Bitem.label%20%7C%7C%20item.getName.sentenceCase%7D%3C/span%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20$%7BtipText%20?%20%60%20%3Cspan%20class=%5C%22input-tip-btn%5C%22%20title=%5C%22$%7BtipText%7D%5C%22%20onclick=%5C%22alert(this.title)%5C%22%3E%E2%93%98%3C/span%3E%60%20:%20%5C%22%5C%22%7D%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20$%7BfoldToggleState%20===%20undefined%20?%20%5C%22%5C%22%20:%20%60%3Cbutton%20onclick=%5C%22let%20s%20=%20this.closest('.input-ctn').dataset.foldToggleState;%20if(s==='hidden')%20%7B%20this.closest('.input-ctn').dataset.foldToggleState='shown';%20%7D%20else%20%7B%20this.closest('.input-ctn').dataset.foldToggleState='hidden';%20%7D%5C%22%20class=%5C%22input-toggle-button%5C%22%3E%3C/button%3E%60%7D%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%3C/div%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20class=%5C%22input-wrapper%5C%22%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20style=%5C%22width:100%25;%20position:relative;%5C%22%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cspan%20style=%5C%22$%7Bitem.autoSuggest%20?%20%5C%22%5C%22%20:%20%5C%22display:none;%5C%22%7D%5C%22%20class=%5C%22auto-suggest-btn%5C%22%3E%F0%9F%92%AD%3C/span%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cinput%20style=%5C%22$%7Bitem.autoSuggest%20?%20%5C%22%5C%22%20:%20%5C%22padding-right:0;%5C%22%7D%5C%22%20class=%5C%22text-input%5C%22%20data-name=%5C%22$%7Bitem.getName%7D%5C%22%20type=%5C%22text%5C%22%20oninput=%5C%22window.___inputElInputEvent746291937.bind(this)(event);%5C%22%20$%7BkeyUpKeyDownAttributes%7D%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C/div%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20$%7Bitem.random%20?%20%60%3Cdiv%20class=%5C%22random-input-btn-ctn%5C%22%20data-input-name=%5C%22$%7Bitem.getName%7D%5C%22%3E%3Cbutton%3E%F0%9F%8E%B2%3C/button%3E%3C/div%3E%60%20:%20%5C%22%5C%22%7D%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%3C/div%3E%5Cn%20%20%20%20%20%20%20%20%20%20%3C/div%3E%5Cn%20%20%20%20%20%20%20%20%3C/div%3E%60;%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20return%20html;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20if(item.type%20===%20%5C%22paragraph%5C%22)%20%7B%5Cn%20%20%20%20%20%20let%20widthStyle%20=%20%5C%22%5C%22;%5Cn%20%20%20%20%20%20if(item.width)%20widthStyle%20+=%20%60width:$%7Bitem.width%7D;%60;%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20let%20textareaStyle%20=%20%5C%22%5C%22;%5Cn%20%20%20%20%20%20let%20height%20=%20%5C%224rem%5C%22;%5Cn%20%20%20%20%20%20if(item.height)%20%7B%5Cn%20%20%20%20%20%20%20%20height%20=%20%60$%7Bitem.height%7D%60;%5Cn%20%20%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20%20%20if(window.innerWidth%20%3C%20550%20%7C%7C%20(item.random%20&&%20item.randomAppend))%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20height%20=%20%5C%226rem%5C%22;%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20textareaStyle%20+=%20%60height:$%7Bheight%7D;%60;%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20let%20foldToggleState%20=%20item.foldToggleState;%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20let%20keyUpKeyDownAttributes%20=%20%5C%22%5C%22;%5Cn%20%20%20%20%20%20if(item.enterKeyTriggersGeneration)%20%7B%5Cn%20%20%20%20%20%20%20%20keyUpKeyDownAttributes%20=%20%60onkeyup=%5C%22if(event.which%20===%2013%20&&%20!event.shiftKey)%20%7B%20document.querySelector('#generateButtonEl').click();%20%7D%5C%22%20onkeydown=%5C%22if(event.which%20===%2013%20&&%20!event.shiftKey)%20%7B%20event.preventDefault();%20%7D%5C%22%60;%5Cn%20%20%20%20%20%20%7D%5Cn%5Cn%20%20%20%20%20%20let%20modifiersHtml%20=%20%5C%22%5C%22;%5Cn%20%20%20%20%20%20try%20%7B%20//%20try/catch%20just%20while%20testing%20this%5Cn%20%20%20%20%20%20%20%20let%20modifiersContainerId%20=%20%5C%22id%5C%22+Math.random().toString().replace(%5C%22.%5C%22,%20%5C%22%5C%22)+Math.random().toString().replace(%5C%22.%5C%22,%20%5C%22%5C%22);%5Cn%20%20%20%20%20%20%20%20modifiersHtml%20=%20%60%3Cdiv%20id=%5C%22$%7BmodifiersContainerId%7D%5C%22%20class=%5C%22input-modifiers%5C%22%20style=%5C%22display:flex;flex-wrap:%20wrap;%5C%22%3E$%7Bitem.modifiers%20?%20generateModifierHtml(item.modifiers)%20:%20%5C%22%5C%22%7D%3C/div%3E%60;%5Cn%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20if(item.modifierUpdates)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20let%20handlers%20=%20item.modifierUpdates.evaluateItem.split(%5C%22,%5C%22).map(h%20=%3E%20h.trim()).filter(h%20=%3E%20h.startsWith(%5C%22event:%5C%22)).map(h%20=%3E%20h.replace(/%5Eevent:/,%20%5C%22%5C%22).split(%5C%22.%5C%22)).map(a%20=%3E%20(%7BinputName:a%5B0%5D,%20eventName:a%5B1%5D%7D));%5Cn%20%20%20%20%20%20%20%20%20%20for(let%20h%20of%20handlers)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20let%20handlerFunction%20=%20function()%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20document.querySelector(%60#$%7BmodifiersContainerId%7D%60).innerHTML%20=%20item.modifiers%20?%20generateModifierHtml(item.modifiers)%20:%20%5C%22%5C%22;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%7D;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20initHandlers.push(%7BinputName:h.inputName,%20eventName:h.eventName,%20handler:handlerFunction%7D);%5Cn%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%7D%20catch(e)%20%7B%5Cn%20%20%20%20%20%20%20%20console.log(e);%5Cn%20%20%20%20%20%20%7D%5Cn%5Cn%20%20%20%20%20%20let%20randomAppendHtml%20=%20item.randomAppend%20?%20%60%3Cbutton%20class=%5C%22random-append-btn%5C%22%20style=%5C%22margin-top:0.5rem;%5C%22%3E%E2%9E%95%3C/button%3E%60%20:%20%5C%22%5C%22;%5Cn%5Cn%20%20%20%20%20%20let%20html%20=%20%60%5Cn%20%20%20%20%20%20%20%20%3Cdiv%20class=%5C%22input-ctn%20input-type-paragraph%20$%7Bitem.takesUpFullRow%20?%20%5C%22takesUpFullRow%5C%22%20:%20%5C%22%5C%22%7D%5C%22%20data-fold-toggle-state=%5C%22$%7BfoldToggleState%7D%5C%22%3E%5Cn%20%20%20%20%20%20%20%20%20%20%3Cdiv%20class=%5C%22input-inner%5C%22%20style=%5C%22$%7BwidthStyle%7D%5C%22%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20class=%5C%22input-label%5C%22%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cspan%20style=%5C%22width:max-content;%5C%22%3E$%7Bitem.label%20%7C%7C%20item.getName.sentenceCase%7D%3C/span%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20$%7BtipText%20?%20%60%20%3Cspan%20class=%5C%22input-tip-btn%5C%22%20title=%5C%22$%7BtipText%7D%5C%22%20onclick=%5C%22alert(this.title)%5C%22%3E%E2%93%98%3C/span%3E%60%20:%20%5C%22%5C%22%7D%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20$%7BfoldToggleState%20===%20undefined%20?%20%5C%22%5C%22%20:%20%60%3Cbutton%20onclick=%5C%22let%20s%20=%20this.closest('.input-ctn').dataset.foldToggleState;%20if(s==='hidden')%20%7B%20this.closest('.input-ctn').dataset.foldToggleState='shown';%20%7D%20else%20%7B%20this.closest('.input-ctn').dataset.foldToggleState='hidden';%20%7D%5C%22%20class=%5C%22input-toggle-button%5C%22%3E%3C/button%3E%60%7D%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%3C/div%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20class=%5C%22input-wrapper%5C%22%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20style=%5C%22width:100%25;%20position:relative;%5C%22%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cspan%20style=%5C%22$%7Bitem.autoSuggest%20?%20%5C%22%5C%22%20:%20%5C%22display:none;%5C%22%7D%5C%22%20class=%5C%22auto-suggest-btn%5C%22%3E%F0%9F%92%AD%3C/span%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Ctextarea%20style=%5C%22$%7Bitem.autoSuggest%20?%20%5C%22%5C%22%20:%20%5C%22padding-right:0;%5C%22%7D%20$%7BtextareaStyle%7D%5C%22%20class=%5C%22paragraph-input%5C%22%20data-name=%5C%22$%7Bitem.getName%7D%5C%22%20oninput=%5C%22window.___inputElInputEvent746291937.bind(this)(event);%5C%22%20$%7BkeyUpKeyDownAttributes%7D%3E%3C/textarea%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C/div%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20$%7Bitem.random%20?%20%60%3Cdiv%20class=%5C%22random-input-btn-ctn%5C%22%20data-input-name=%5C%22$%7Bitem.getName%7D%5C%22%3E%3Cbutton%20class=%5C%22random-input-btn%5C%22%3E%F0%9F%8E%B2%3C/button%3E%3Cbutton%20class=%5C%22ai-suggest-btn%5C%22%20style=%5C%22margin-top:0.5rem;%5C%22%3E%F0%9F%A7%A0%3C/button%3E$%7BrandomAppendHtml%7D%3C/div%3E%60%20:%20%5C%22%5C%22%7D%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%3C/div%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20$%7BmodifiersHtml%7D%5Cn%20%20%20%20%20%20%20%20%20%20%3C/div%3E%5Cn%20%20%20%20%20%20%20%20%3C/div%3E%60;%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20return%20html;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20if(item.type%20===%20%5C%22select%5C%22%20%7C%7C%20item.type%20===%20%5C%22visual-select%5C%22)%20%7B%5Cn%20%20%20%20%20%20let%20options%20=%20%5B%5D;%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20let%20thereAreImports%20=%20false;%5Cn%20%20%20%20%20%20item.compiledOptions%20=%20new%20Map();%20//%20use%20map%20to%20maintain%20insertion%20order%20when%20converting%20to%20%60entries%60%5Cn%20%20%20%20%20%20let%20nameToForcedPosition%20=%20%7B%7D;%5Cn%20%20%20%20%20%20let%20groupIndex%20=%20-1;%20//%20all%20items%20within%20an%20import%20have%20the%20same%20group%20index%20and%20normally-defined%20items%20are%20their%20own%20single-item%20group%20-%20this%20is%20so%20we%20can%20properly%20do%20sorting%20at%20the%20end,%20so%20that%20all%20imports%20are%20only%20sorted%20within%20their%20group.%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20for(let%20key%20of%20item.options.getAllKeys)%20%7B%5Cn%20%20%20%20%20%20%20%20groupIndex++;%5Cn%20%20%20%20%20%20%20%20if(key.startsWith(%5C%22meta:import%5C%22))%20%7B%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20%20%20thereAreImports%20=%20true;%5Cn%20%20%20%20%20%20%20%20%20%20let%20tagImportWeights%20=%20%7B%7D;%5Cn%20%20%20%20%20%20%20%20%20%20if(item.options%5Bkey%5D.tagWeights)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20tagImportWeights%20=%20Object.fromEntries(item.options%5Bkey%5D.tagWeights.evaluateItem.split(%5C%22,%5C%22).map(t%20=%3E%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20let%20tag%20=%20t.split(%5C%22:%5C%22)%5B0%5D.trim();%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20let%20factor%20=%20Number(t.split(%5C%22:%5C%22)%5B1%5D%20??%2010);%20//%20default%20boost%20is%2010.%20note%20that%20'boost'%20can%20be%20less%20than%201,%20which%20supresses%20the%20tag,%20and%20can%20even%20be%200,%20which%20filters%20out%20items%20with%20that%20tag%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20if(isNaN(factor))%20factor%20=%2010;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20%5Btag,%20factor%5D;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%7D));%5Cn%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20let%20intraGroupSortingEpsilon%20=%200.00001;%20//%20%3C--%20just%20a%20little%20hack%20so%20that%20the%20imports%20that%20have%20the%20same%20score%20stay%20in%20the%20order%20in%20which%20they%20were%20defined%20in%20the%20imported%20list%5Cn%20%20%20%20%20%20%20%20%20%20for(let%20optionItem%20of%20item.options%5Bkey%5D.from.selectAll)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20if(item.compiledOptions.has(optionItem.getName))%20continue;%20//%20we%20don't%20overwrite%20ones%20that%20came%20before%20(higher%20takes%20precedence%20over%20lower)%5Cn%5Cn%20%20%20%20%20%20%20%20%20%20%20%20optionItem.___groupIndex%20=%20groupIndex;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20item.compiledOptions.set(optionItem.getName,%20optionItem);%5Cn%5Cn%20%20%20%20%20%20%20%20%20%20%20%20if(optionItem%5B%5C%22meta:position%5C%22%5D)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20nameToForcedPosition%5BoptionItem.getName%5D%20=%20optionItem%5B%5C%22meta:position%5C%22%5D;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%7D%5Cn%5Cn%20%20%20%20%20%20%20%20%20%20%20%20if(optionItem%5B%5C%22meta:tags%5C%22%5D)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20for%20each%20importer%20tag%20weight,%20we%20multiply%20it%20by%20the%20matching%20'inherent'%20weight%20of%20the%20tag%20(if%20it%20exists%20on%20this%20imported%20item).%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20note%20that%20this%20means%20that%20if%20there%20are%20*any*%20matches,%20then%20ONLY%20those%20matches%20are%20considered.%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20optionItem.___intraGroupRankingScore%20=%200;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20let%20thereWereTagWeightMatches%20=%20false;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20for(let%20%5Btag,%20inherentTagWeight%5D%20of%20Object.entries(optionItem%5B%5C%22meta:tags%5C%22%5D))%20%7B%20//%20for%20each%20tag%20on%20this%20imported%20item%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if(tagImportWeights%5Btag%5D%20!==%20undefined)%20%7B%20//%20if%20the%20importer%20has%20specified%20a%20weight%20for%20this%20tag%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20thereWereTagWeightMatches%20=%20true;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20optionItem.___intraGroupRankingScore%20+=%20inherentTagWeight*tagImportWeights%5Btag%5D;%20//%20add%20to%20the%20score%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20if%20this%20imported%20style%20didn't%20have%20any%20tags%20that%20matched%20any%20of%20the%20importer%20tag%20weights,%20then%20we%20set%20its%20ranking%20score%20to%201%20+%20a%20small%20amount%20based%20on%20the%20mean%20of%20its%20inherent%20tag%20weights:%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20if(!thereWereTagWeightMatches)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20let%20inherentTagWeights%20=%20Object.values(optionItem%5B%5C%22meta:tags%5C%22%5D);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20EDIT:%20the%20problem%20with%20this%20is%20that%20it%20separates%20'categories'%20of%20styles%20which%20are%20better%20defined%20together%20-%20e.g.%20if%20all%20the%20anime%20styles%20are%20defined%20one%20after%20the%20other,%20then%20it's%20better%20to%20leave%20them%20like%20that%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20so%20for%20now%20I'm%20just%20going%20to%20set%20the%20score%20to%201%20if%20there%20were%20no%20matching%20tags.%20Can%20change%20this%20in%20v3%20if%20needed.%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20optionItem.___intraGroupRankingScore%20=%201;%20//%20+%20(inherentTagWeights.reduce((a,v)%20=%3E%20a+v,%200)%20/%20inherentTagWeights.length)%20/%2010000;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20optionItem.___intraGroupRankingScore%20=%201;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20%20%20%20%20optionItem.___intraGroupRankingScore%20+=%20intraGroupSortingEpsilon;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20intraGroupSortingEpsilon%20-=%20intraGroupSortingEpsilon*0.00001;%20//%20so%20the%20next%20item%20will%20get%20a%20slightly%20smaller%20boost%5Cn%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20item.options%5Bkey%5D.___groupIndex%20=%20groupIndex;%5Cn%20%20%20%20%20%20%20%20%20%20item.options%5Bkey%5D.___intraGroupRankingScore%20=%201;%5Cn%20%20%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20%20%20item.compiledOptions.set(key,%20item.options%5Bkey%5D);%5Cn%20%20%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20%20%20if(item.options%5Bkey%5D%5B%5C%22meta:position%5C%22%5D)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20nameToForcedPosition%5Bkey%5D%20=%20item.options%5Bkey%5D%5B%5C%22meta:position%5C%22%5D;%5Cn%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20let%20entries%20=%20%5B...item.compiledOptions.entries()%5D;%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20if(thereAreImports)%20%7B%5Cn%20%20%20%20%20%20%20%20//%20filter%20out%20items%20with%20a%20score%20below%20or%20equal%20to%20zero%5Cn%20%20%20%20%20%20%20%20entries%20=%20entries.filter(e%20=%3E%20e%5B1%5D.___intraGroupRankingScore%20%3E%200);%5Cn%5Cn%20%20%20%20%20%20%20%20//%20here%20we%20do%20score-based%20ordering%20while%20strictly%20maintaining%20group%20index%20ordering.%5Cn%20%20%20%20%20%20%20%20//%20note%20that%20items%20from%20a%20meta:import%20are%20all%20part%20of%20their%20own%20group,%20whereas%20items%20that%20are%20defined%20normally%20are%20their%20own%20single-item%20group.%5Cn%20%20%20%20%20%20%20%20entries.sort((a,%20b)%20=%3E%20a%5B1%5D.___groupIndex%20-%20b%5B1%5D.___groupIndex%20%7C%7C%20b%5B1%5D.___intraGroupRankingScore%20-%20a%5B1%5D.___intraGroupRankingScore);%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20//%20do%20forced%20positioning:%5Cn%20%20%20%20%20%20for(let%20%5Bname,%20position%5D%20of%20Object.entries(nameToForcedPosition))%20%7B%5Cn%20%20%20%20%20%20%20%20let%20index%20=%20entries.findIndex((%5Bkey%5D)%20=%3E%20key%20===%20name);%5Cn%20%20%20%20%20%20%20%20if(index%20!==%20-1)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20let%20%5Bremoved%5D%20=%20entries.splice(index,%201);%20//%20remove%20the%20item%20from%20its%20current%20position%5Cn%20%20%20%20%20%20%20%20%20%20entries.splice(position,%200,%20removed);%20//%20insert%20it%20into%20the%20desired%20position%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20item.compiledOptions%20=%20Object.fromEntries(entries);%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20options.push(...entries.map((%5Bname,%20obj%5D)%20=%3E%20name).map(n%20=%3E%20%7B%5Cn%20%20%20%20%20%20%20%20let%20hasSubKeys%20=%20false;%5Cn%20%20%20%20%20%20%20%20if(item.compiledOptions%5Bn%5D.getAllKeys%20&&%20item.compiledOptions%5Bn%5D.getAllKeys.length%20%3E%200)%20hasSubKeys%20=%20true;%20//%20hasSubKeys%20is%20needed%20because%20if%20it%20does%20have%20subkeys,%20then%20we%20expose%20the%20whole%20option%20object/node%20as%20%60keyName%60,%20rather%20than%20just%20the%20value%5Cn%20%20%20%20%20%20%20%20let%20keyName%20=%20n;%5Cn%20%20%20%20%20%20%20%20let%20display%20=%20item.compiledOptions%5Bn%5D.name%20??%20n;%5Cn%20%20%20%20%20%20%20%20let%20value%20=%20item.compiledOptions%5Bn%5D;%5Cn%20%20%20%20%20%20%20%20return%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20value,%5Cn%20%20%20%20%20%20%20%20%20%20display,%5Cn%20%20%20%20%20%20%20%20%20%20keyName:n,%5Cn%20%20%20%20%20%20%20%20%20%20hasSubKeys,%5Cn%20%20%20%20%20%20%20%20%20%20disabled:%20item.compiledOptions%5Bn%5D%5B%5C%22meta:disabled%5C%22%5D%20===%20true,%5Cn%20%20%20%20%20%20%20%20%20%20image:%20item.compiledOptions%5Bn%5D%5B%5C%22meta:image%5C%22%5D,%5Cn%20%20%20%20%20%20%20%20%20%20selected:%20item.compiledOptions%5Bn%5D%5B%5C%22meta:selected%5C%22%5D%20===%20true,%5Cn%20%20%20%20%20%20%20%20%7D;%20%5Cn%20%20%20%20%20%20%7D));%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20let%20selectedOpt%20=%20options.find(opt%20=%3E%20opt.selected);%5Cn%20%20%20%20%20%20if(!selectedOpt)%20options%5B0%5D.selected%20=%20true;%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20let%20selectElHtml%20=%20%60%5Cn%20%20%20%20%20%20%20%20%3Cselect%20style=%5C%22$%7Bitem.type%20===%20%5C%22visual-select%5C%22%20?%20%5C%22display:none;%5C%22%20:%20%5C%22%5C%22%7D%20width:-webkit-fill-available;%20width:-moz-available;%20width:fill-available;%20max-width:9rem;%5C%22%20data-name=%5C%22$%7Bitem.getName%7D%5C%22%20onchange=%5C%22window.___selectElChangeEvent746291937.bind(this)(event);%5C%22%3E%5Cn%20%20%20%20%20%20%20%20%20%20$%7Boptions.map(opt%20=%3E%20%60%3Coption%20value=%5C%22$%7Bopt.hasSubKeys%20?%20%60ref:optionKeyName:$%7Bopt.keyName%7D%60%20:%20opt.value%7D%5C%22%20$%7Bopt.disabled%20?%20%5C%22disabled%5C%22%20:%20%5C%22%5C%22%7D%20%20$%7Bopt.selected%20?%20%5C%22selected%5C%22%20:%20%5C%22%5C%22%7D%3E$%7Bopt.display%7D%3C/option%3E%60).join(%5C%22%5C%5Cn%5C%22)%7D%5Cn%20%20%20%20%20%20%20%20%3C/select%3E%5Cn%20%20%20%20%20%20%60;%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20//%20the%20visual%20select%20is%20just%20a%20%5C%22facade%5C%22%20over%20the%20top%20of%20a%20normal%20(hidden)%20select%20-%20the%20underlying%20%3Cselect%3E%20is%20still%20used%20for%20all%20relevant%20logic%5Cn%20%20%20%20%20%20if(item.type%20===%20%5C%22visual-select%5C%22)%20%7B%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20let%20visualSelectOptions%20=%20options.map(opt%20=%3E%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20let%20visualHtml;%5Cn%20%20%20%20%20%20%20%20%20%20if(false%20&&%20opt.image)%20%7B%20//%20TODO:%20work%20out%20the%20best%20approach%20here%20(e.g.%20grid%20+%20%5C%22slideshow%5C%22%20for%20each%20style?)%20and%20then%20enabled%20this%5Cn%20%20%20%20%20%20%20%20%20%20%20%20visualHtml%20=%20%60%3Cimg%20src=%5C%22$%7Bopt.image%7D%5C%22%20style=%5C%22max-height:20vh;%20display:block;%5C%22%3E%3Cdiv%20style=%5C%22font-size:85%25;position:%20sticky;bottom:%202rem;left:0;right:0;width:100%25;height:%200;text-align:center;%5C%22%3E%3Cspan%20style=%5C%22background:#ffffff;%20padding:0.25rem;%20border:2px%20solid%20black;%20border-radius:0.25rem;%20color:black;%5C%22%3E$%7Bopt.display%7D%3C/span%3E%3C/div%3E%60;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20if(!window.__preloadedVisualSelectImageUrls_957378)%20window.__preloadedVisualSelectImageUrls_957378%20=%20%7B%7D;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20if(!window.__preloadedVisualSelectImageUrls_957378%5Bopt.image%5D)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20let%20img%20=%20document.createElement(%5C%22img%5C%22);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20img.src%20=%20opt.image;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20img.style.cssText%20=%20%60position:fixed;%20width:1px;%20height:1px;%20left:-10px;%20top:-10px;%60;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20document.body.appendChild(img);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20window.__preloadedVisualSelectImageUrls_957378%5Bopt.image%5D%20=%20true;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20visualHtml%20=%20%60%3Cdiv%20style=%5C%22display:flex;%20justify-content:center;%20align-items:center;%20min-height:3rem;%5C%22%3E$%7Bopt.display%7D%3C/div%3E%60;%5Cn%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20return%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20value:%20opt.hasSubKeys%20?%20%60ref:optionKeyName:$%7Bopt.keyName%7D%60%20:%20opt.value,%20%5Cn%20%20%20%20%20%20%20%20%20%20%20%20disabled:%20opt.disabled,%5Cn%20%20%20%20%20%20%20%20%20%20%20%20selected:%20opt.selected,%5Cn%20%20%20%20%20%20%20%20%20%20%20%20html:%20%60%3Cdiv%20style=%5C%22border-radius:3px;%20overflow:hidden;%5C%22%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20style=%5C%22overflow-x:auto;%20overflow-y:hidden;%20position:relative;%5C%22%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20$%7BvisualHtml%7D%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C/div%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%3C/div%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%60,%5Cn%20%20%20%20%20%20%20%20%20%20%7D;%5Cn%20%20%20%20%20%20%20%20%7D);%5Cn%20%20%20%20%20%20%20%20selectElHtml%20=%20%60%5Cn%20%20%20%20%20%20%20%20%20%20%3Cbutton%20class=%5C%22visual-select-btn%5C%22%20style=%5C%22width:max-content;%5C%22%20onclick=%5C%22window.__createSelectorModal_56974639274(JSON.parse(decodeURIComponent(this.dataset.options))).then(v%20=%3E%20%7B%20if(v%20!==%20null)%20%7B%20let%20selectEl%20=%20this.parentElement.querySelector('select');%20selectEl.value=v;%20selectEl.onchange(%7B%7D);%20%7D%20%7D)%5C%22%20data-options=%5C%22$%7BencodeURIComponent(JSON.stringify(visualSelectOptions))%7D%5C%22%3E$%7Boptions.find(opt%20=%3E%20opt.selected).display%7D%3C/button%3E%5Cn%20%20%20%20%20%20%20%20%20%20$%7BselectElHtml%7D%5Cn%20%20%20%20%20%20%20%20%60;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20let%20html%20=%20%60%3Cdiv%20class=%5C%22input-ctn%20input-type-select%5C%22%3E%5Cn%20%20%20%20%20%20%20%20%3Cdiv%20class=%5C%22input-inner%5C%22%3E%5Cn%20%20%20%20%20%20%20%20%20%20%3Cdiv%20class=%5C%22input-label%5C%22%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%3Cspan%20style=%5C%22width:max-content;%5C%22%3E$%7Bitem.label%20%7C%7C%20item.getName.sentenceCase%7D%3C/span%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20$%7BtipText%20?%20%60%20%3Cspan%20class=%5C%22input-tip-btn%5C%22%20title=%5C%22$%7BtipText%7D%5C%22%20onclick=%5C%22alert(this.title)%5C%22%3E%E2%93%98%3C/span%3E%60%20:%20%5C%22%5C%22%7D%5Cn%20%20%20%20%20%20%20%20%20%20%3C/div%3E%5Cn%20%20%20%20%20%20%20%20%20%20%3Cdiv%20class=%5C%22input-wrapper%5C%22%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20$%7BselectElHtml%7D%5Cn%20%20%20%20%20%20%20%20%20%20%3C/div%3E%5Cn%20%20%20%20%20%20%20%20%3C/div%3E%5Cn%20%20%20%20%20%20%3C/div%3E%60;%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20if(item.takesUpFullRow)%20%7B%5Cn%20%20%20%20%20%20%20%20html%20=%20%60%3Cdiv%20style=%5C%22width:100%25;%20display:flex;%20align-items:center;%20justify-content:center;%5C%22%3E$%7Bhtml%7D%3C/div%3E%60;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20return%20html;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20%5Cn%20%20%7D).join(%5C%22%5C%5Cn%5C%22);%5Cn%20%20%5Cn%20%20window.getCurrentColorScheme%20=%20function()%20%7B%5Cn%20%20%20%20if(localStorage.forceColorScheme%20!==%20undefined)%20%7B%5Cn%20%20%20%20%20%20return%20localStorage.forceColorScheme;%5Cn%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20return%20window.matchMedia%20&&%20window.matchMedia('(prefers-color-scheme:%20dark)').matches%20?%20%5C%22dark%5C%22%20:%20%5C%22light%5C%22;%5Cn%20%20%20%20%7D%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20window.toggleManualDarkMode_jv83hb27igksf%20=%20function()%20%7B%5Cn%20%20%20%20//%20get%20current%20mode:%5Cn%20%20%20%20let%20colorScheme%20=%20window.getCurrentColorScheme();%5Cn%20%20%20%20%5Cn%20%20%20%20//%20change%20mode:%5Cn%20%20%20%20let%20newColorScheme%20=%20(colorScheme%20===%20%5C%22dark%5C%22%20?%20%5C%22light%5C%22%20:%20%5C%22dark%5C%22);%5Cn%20%20%20%20localStorage.forceColorScheme%20=%20newColorScheme;%5Cn%20%20%20%20setColorScheme(newColorScheme);%5Cn%20%20%20%20%5Cn%20%20%20%20//%20if%20chosen%20mode%20matches%20current%20OS%20default,%20we%20remove%20manual%20%5C%22forced%5C%22%20mode:%5Cn%20%20%20%20let%20systemColorScheme%20=%20window.matchMedia%20&&%20window.matchMedia('(prefers-color-scheme:%20dark)').matches%20?%20%5C%22dark%5C%22%20:%20%5C%22light%5C%22;%5Cn%20%20%20%20if(systemColorScheme%20===%20newColorScheme)%20%7B%5Cn%20%20%20%20%20%20localStorage.removeItem(%5C%22forceColorScheme%5C%22);%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20//%20regenerate%20comments%20and%20gallery%20(to%20propagate%20forceColorScheme%20if%20needed)%5Cn%20%20%20%20if(imageGalleryCtn8569284.querySelector(%5C%22iframe%5C%22))%20%7B%5Cn%20%20%20%20%20%20imageGalleryCtn8569284.innerHTML%20=%20%5C%22%5C%22;%20//%20need%20to%20clear%20it%20first%20because%20text-to-image%20plugin%20returns%20%5C%22%5C%22%20for%20gallery%20if%20one%20already%20exists%20(it's%20doing%20a%20hacky%20thing%20to%20prevent%20update()%20from%20reloading%20the%20gallery)%5Cn%20%20%20%20%20%20imageGalleryCtn8569284.innerHTML%20=%20window.generateImageGalleryHtml358402048();%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20if(commentsPluginCtn654732.querySelector(%5C%22iframe%5C%22))%20%7B%5Cn%20%20%20%20%20%20commentsPluginCtn654732.innerHTML%20=%20%5C%22%5C%22;%5Cn%20%20%20%20%20%20commentsPluginCtn654732.appendChild(window.generateCommentsPluginElement85638294())%5Cn%20%20%20%20%7D%5Cn%20%20%7D%5Cn%5Cn%20%20function%20setColorScheme(scheme)%20%7B%5Cn%20%20%20%20if(scheme%20!==%20%5C%22dark%5C%22%20&&%20scheme%20!==%20%5C%22light%5C%22)%20throw%20new%20Error(%5C%22scheme%20should%20be%20'light'%20or%20'dark'%5C%22);%5Cn%20%20%20%20document.querySelector(%5C%22#darkModeBtn_875979f948%5C%22).textContent%20=%20(scheme%20===%20%5C%22dark%5C%22%20?%20%5C%22%F0%9F%8C%84%5C%22%20:%20%5C%22%F0%9F%8C%83%5C%22);%5Cn%20%20%20%20if(scheme%20===%20%5C%22dark%5C%22)%20%7B%5Cn%20%20%20%20%20%20document.documentElement.style.colorScheme%20=%20%5C%22dark%5C%22;%5Cn%20%20%20%20%20%20document.body.style.color%20=%20%5C%22#d8d4cf%5C%22;%5Cn%20%20%20%20%20%20document.body.style.backgroundColor%20=%20%5C%22#131516%5C%22;%5Cn%20%20%20%20%20%20document.documentElement.style.setProperty('--box-color',%20'#2a2a2a');%20//%20CAUTION!!!!%20--%3E%20do%20not%20rename%20this%20variable%20-%20it%20is%20being%20used%20in%20%5C%22user-land%5C%22%20on%20some%20generators%5Cn%20%20%20%20%20%20document.documentElement.style.setProperty('--active-comment-channel-tab-color',%20'#5b5b5b');%5Cn%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20document.documentElement.style.colorScheme%20=%20%5C%22light%5C%22;%5Cn%20%20%20%20%20%20document.body.style.color%20=%20%5C%22black%5C%22;%5Cn%20%20%20%20%20%20document.body.style.backgroundColor%20=%20%5C%22white%5C%22;%5Cn%20%20%20%20%20%20document.documentElement.style.setProperty('--box-color',%20'#ebebeb');%5Cn%20%20%20%20%20%20document.documentElement.style.setProperty('--active-comment-channel-tab-color',%20'#c6c6c6');%5Cn%20%20%20%20%7D%5Cn%20%20%7D%5Cn%5Cn%20%20///////////////////////////////////////////%5Cn%20%20//%20%20%20%20%20do%20some%20stuff%20after%20page%20loads%20%20%20%20%20//%5Cn%20%20///////////////////////////////////////////%5Cn%20%20window.___pageLoadHandler746291937%20=%20function()%20%7B%5Cn%20%20%20%20%5Cn%20%20%20%20//%20let%20pageUrlIsShareLink%20=%20window.location.hash.slice(1).startsWith(%5C%22data=%5C%22);%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20//%20during%20page%20load,%20set%20the%20chosen%20mode%20based%20on%20localStorage%20value%20if%20it%20exists:%5Cn%20%20%20%20if(localStorage.forceColorScheme%20!==%20undefined)%20%7B%5Cn%20%20%20%20%20%20setColorScheme(localStorage.forceColorScheme);%5Cn%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20//%20user%20has%20not%20manually%20overwritten,%20so%20we%20use%20OS%20default:%5Cn%20%20%20%20%20%20let%20systemIsInDarkMode%20=%20!!(window.matchMedia%20&&%20window.matchMedia('(prefers-color-scheme:%20dark)').matches);%5Cn%20%20%20%20%20%20setColorScheme(systemIsInDarkMode%20?%20%5C%22dark%5C%22%20:%20%5C%22light%5C%22);%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20if(socialFeatures%20===%20%5C%22enabled%5C%22)%20%7B%5Cn%20%20%20%20%20%20commentsPluginCtn654732.appendChild(window.generateCommentsPluginElement85638294());%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20let%20generateClickCount%20=%20localStorage.generateClickCount%20?%20Number(localStorage.generateClickCount)%20:%200;%5Cn%20%20%20%20%5Cn%20%20%20%20if(thisGeneratorIsUsingClickCountBasedSocialDisplay%20&&%20!localStorage.theyKnowAboutClickCountBasedSocialDisplay)%20%7B%5Cn%20%20%20%20%20%20//%20clickCountBasedSocialDisplayNotifierEl.style.display%20=%20%5C%22%5C%22;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20if(generateClickCount%20===%200)%20%7B%5Cn%20%20%20%20%20%20bottomClickHelperEl.style.display%20=%20%5C%22%5C%22;%5Cn%20%20%20%20%20%20leftClickHelperEl.style.display%20=%20%5C%22%5C%22;%5Cn%20%20%20%20%20%20rightClickHelperEl.style.display%20=%20%5C%22%5C%22;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20if(generateClickCount%20%3E%203)%20%7B%5Cn%20%20%20%20%20%20shareLinkOuterCtn2893827.style.display%20=%20%5C%22%5C%22;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20//%20Do%20init%20stuff%20like%20triggering%20oninput/onchange%20for%20each%20input%20right%20after%20init.%5Cn%20%20%20%20setTimeout(async%20()%20=%3E%20%7B%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20if(localStorage.autoShowSocialsNextTime%20&&%20document.querySelector(%5C%22#showSocialsButton927514532%5C%22))%20%7B%5Cn%20%20%20%20%20%20%20%20if(socialFeatures%20!=%20%5C%22enabled%5C%22)%20document.querySelector(%5C%22#showSocialsButton927514532%5C%22).click();%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20userInputsCtn8462746262.querySelectorAll('input,%20select,%20textarea').forEach(el%20=%3E%20%7B%5Cn%20%20%20%20%20%20%20%20let%20userInputSpec%20=%20window.___userSettings746291937.userInputs%5Bel.dataset.name%5D;%5Cn%20%20%20%20%20%20%20%20userInputSpec._element%20=%20el;%5Cn%20%20%20%20%20%20%7D);%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20for(let%20h%20of%20initHandlers)%20%7B%5Cn%20%20%20%20%20%20%20%20let%20element%20=%20window.___userSettings746291937.userInputs%5Bh.inputName%5D._element;%5Cn%20%20%20%20%20%20%20%20element.addEventListener(h.eventName,%20h.handler);%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20//%20set%20initial%20values%5Cn%20%20%20%20%20%20userInputsCtn8462746262.querySelectorAll('input,%20select,%20textarea').forEach(el%20=%3E%20%7B%5Cn%20%20%20%20%20%20%20%20let%20userInputSpec%20=%20window.___userSettings746291937.userInputs%5Bel.dataset.name%5D;%5Cn%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20let%20value;%5Cn%20%20%20%20%20%20%20%20if(userInputSpec.remember)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20value%20=%20getRememberedInput(el.dataset.name);%5Cn%20%20%20%20%20%20%20%20%7D%20else%20if(el.tagName%20===%20%5C%22TEXTAREA%5C%22%20%7C%7C%20(el.tagName%20===%20%5C%22INPUT%5C%22%20&&%20el.type%20===%20%5C%22text%5C%22))%20%7B%20//%20%3C--%20just%20to%20be%20sure%5Cn%20%20%20%20%20%20%20%20%20%20//%20value%20=%20localStorage%5B%5C%22t2i_tempRememberedInput_fisuyr9hf_%5C%22+el.dataset.name%5D;%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20if(value%20!==%20undefined)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20el.value%20=%20value;%5Cn%20%20%20%20%20%20%20%20%20%20//%20%3Cselect%3E%20options%20can%20be%20removed%20by%20gen%20authors,%20so%20if%20the%20option%20doesn't%20exist,%20we%20just%20set%20it%20to%20the%20first%20option:%5Cn%20%20%20%20%20%20%20%20%20%20if((userInputSpec.type%20===%20%5C%22select%5C%22%20%7C%7C%20userInputSpec.type%20===%20%5C%22visual-select%5C%22)%20&&%20!%5B...el.querySelectorAll(%60option%60)%5D.find(el%20=%3E%20el.value%20===%20value))%20%7B%20//%20&&%20userInputSpec.compiledOptions%5Bvalue.replace(/%5Eref:optionKeyName:/,%20%5C%22%5C%22)%5D%20===%20undefined%5Cn%20%20%20%20%20%20%20%20%20%20%20%20el.value%20=%20el.querySelector(%5C%22option%5C%22).value;%5Cn%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20//%20NOTE:%20triggering%20change/input%20events%20like%20this%20doesn't%20trigger%20addEventListener%20handlers%20-%20like%20those%20added%20via%20initHandlers,%20above,%20but%5Cn%20%20%20%20%20%20%20%20//%20for%20now%20this%20is%20a%20happy%20accident%20because%20it's%20not%20for%20modifiers%20to%20not%20show%20up%20until%20you've%20actually%20typed%20something%20-%20reduces%20UI%5Cn%20%20%20%20%20%20%20%20//%20complexity%20on%20first%20impression.%5Cn%20%20%20%20%20%20%20%20if(el.onchange)%20el.onchange(%7B_isInitCall:true%7D);%5Cn%20%20%20%20%20%20%20%20if(el.oninput)%20el.oninput(%7B_isInitCall:true%7D);%5Cn%20%20%20%20%20%20%7D);%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20updateInputVisibilities();%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20//%20set%20up%20intervals%20for%20the%20rotating%20'example'%20placeholders%5Cn%20%20%20%20%20%20userInputsCtn8462746262.querySelectorAll('input,%20select,%20textarea').forEach(el%20=%3E%20%7B%5Cn%20%20%20%20%20%20%20%20let%20userInputSpec%20=%20window.___userSettings746291937.userInputs%5Bel.dataset.name%5D;%5Cn%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20let%20examplesList%20=%20userInputSpec.examples;%5Cn%20%20%20%20%20%20%20%20if(examplesList%20&&%20((el.nodeName%20===%20%5C%22INPUT%5C%22%20&&%20el.type%20===%20%5C%22text%5C%22)%20%7C%7C%20el.nodeName%20===%20%5C%22TEXTAREA%5C%22))%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20//%20set%20rotating%20placeholder%20text%20on%20text%20inputs%5Cn%20%20%20%20%20%20%20%20%20%20function%20nextExample()%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20if(userInputSpec.useVariables%20&&%20window%5Bel.dataset.name.toUpperCase()%5D)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20window.ignorePerchanceErrors(()%20=%3E%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20el.placeholder%20=%20window%5Bel.dataset.name.toUpperCase()%5D.evaluateItem;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20let%20text%20=%20selectLeaf(examplesList).evaluateItem;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20try%20a%20few%20times%20to%20get%20a%20different%20one%20to%20the%20last-displayed%20one:%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20if(text%20===%20el.placeholder)%20text%20=%20selectLeaf(examplesList).evaluateItem;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20if(text%20===%20el.placeholder)%20text%20=%20selectLeaf(examplesList).evaluateItem;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20if(text%20===%20el.placeholder)%20text%20=%20selectLeaf(examplesList).evaluateItem;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20simple%20hack%20to%20save%20me%20a%20headache%20with%20escaping%20(e.g.%20for%20scratchpad%20placholder%20text)%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20text%20=%20text.replace(/&lsqb;/g,%20%5C%22%5B%5C%22);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20text%20=%20text.replace(/&rsqb;/g,%20%5C%22%5D%5C%22);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20text%20=%20text.replace(/&lcub;/g,%20%5C%22%7B%5C%22);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20text%20=%20text.replace(/&rcub;/g,%20%5C%22%7D%5C%22);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20el.placeholder%20=%20text;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20nextExample();%5Cn%20%20%20%20%20%20%20%20%20%20setInterval(nextExample,%203500);%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%7D);%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20//%20set%20up%20click%20handlers%20for%20the%20'random'%20buttons:%5Cn%20%20%20%20%20%20userInputsCtn8462746262.querySelectorAll('.random-input-btn-ctn').forEach(el%20=%3E%20%7B%5Cn%20%20%20%20%20%20%20%20if(el.querySelector(%5C%22.random-input-btn%5C%22))%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20el.querySelector(%5C%22.random-input-btn%5C%22).onclick%20=%20function()%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20let%20inputEl%20=%20el.closest(%5C%22.input-ctn%5C%22).querySelector(%5C%22input,%20textarea%5C%22);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20let%20userInputSpec%20=%20window.___userSettings746291937.userInputs%5Bel.dataset.inputName%5D;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20if(userInputSpec.useVariables%20&&%20window%5Bel.dataset.inputName.toUpperCase()%5D)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20window.clearPerchanceErrors();%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20inputEl.value%20=%20window%5Bel.dataset.inputName.toUpperCase()%5D.evaluateItem;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20let%20randomList%20=%20userInputSpec.random;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20inputEl.value%20=%20selectLeaf(randomList).evaluateItem;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20%20%20inputEl.oninput(%7B%7D);%5Cn%20%20%20%20%20%20%20%20%20%20%7D;%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20if(el.querySelector(%5C%22.ai-suggest-btn%5C%22))%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20el.querySelector(%5C%22.ai-suggest-btn%5C%22).onclick%20=%20async%20function()%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20let%20input%20=%20prompt(%5C%22Enter%20a%20couple%20of%20keywords%20or%20ideas%20and%20the%20AI%20will%20generate%20a%20prompt%20for%20you%20based%20on%20that:%5C%22,%20window.lastUsedAiSuggestPrompt%20%7C%7C%20%5C%22%5C%22);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20if(input%20&&%20input.trim())%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20window.lastUsedAiSuggestPrompt%20=%20input.trim();%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20return;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20%20%20let%20suggestBtn%20=%20el.querySelector(%5C%22.ai-suggest-btn%5C%22);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20suggestBtn.innerHTML%20=%20%60%3Cspan%20style=%5C%22display:inline-block;%20animation:rotate%201.5s%20linear%20infinite;%5C%22%3E%E2%8F%B3%3C/span%3E%60;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20suggestBtn.disabled%20=%20true;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20let%20originalSuggestBtnDisplay%20=%20suggestBtn.style.display;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20%20%20%20%20let%20stopBtn%20=%20document.createElement(%5C%22button%5C%22);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20stopBtn.innerHTML%20=%20%60%E2%9C%8B%60;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20stopBtn.style.display%20=%20%5C%22none%5C%22;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20stopBtn.style.marginTop%20=%20%5C%220.25rem%5C%22;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20%20%20%20%20let%20inputEl%20=%20el.closest(%5C%22.input-ctn%5C%22).querySelector(%5C%22input,%20textarea%5C%22);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20let%20chunkCount%20=%200;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20let%20fullTextSoFar%20=%20%5C%22%5C%22;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20let%20originalInputElHeight%20=%20inputEl.offsetHeight;%20//%20so%20we%20don't%20make%20the%20textarea%20smaller%20than%20it%20originally%20was%5Cn%20%20%20%20%20%20%20%20%20%20%20%20inputEl.value%20=%20%5C%22Loading...%5C%22;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20let%20pendingObj%20=%20aiText(%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20instruction:%20%60Your%20task%20is%20to%20create%20a%20description%20of%20a%20hypothetical%20image%20which%20is%20based%20on%20the%20following%20idea/keywords/instruction:%20$%7Binput.evaluateItem%7D%5C%5Cn%5C%5CnCome%20up%20with%20a%20fully-formed%20idea%20based%20on%20that%20instruction,%20and%20write%20a%20description/caption%20which%20fully%20captures%20all%20visual%20aspects%20the%20image.%20Your%20response%20should%20be%20crisp/lean/efficient,%20descriptive,%20and%20engaging.%5C%5Cn%5C%5CnStart%20your%20response%20with%20%5C%22Description:%20The%20image%20shows%5C%22%20and%20then%20give%20a%20one-paragraph%20description%20which%20captures%20all%20visual%20details%20of%20the%20idea%20in%20a%20medium-length%20paragraph.%60,%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20startWith:%20%60Description:%20The%20image%20shows%60,%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20stopSequences:%20%5B%5C%22%5C%5Cn%5C%22%5D,%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20hideStartWith:%20true,%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20onChunk:%20(data)%20=%3E%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if(chunkCount%20===%200)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20inputEl.value%20=%20%5C%22%5C%22;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20stopBtn.style.display%20=%20%5C%22%5C%22;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20suggestBtn.style.display%20=%20%5C%22none%5C%22;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if(!data.isFromStartWith)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20fullTextSoFar%20+=%20data.textChunk;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20inputEl.value%20=%20fullTextSoFar.trim()%5B0%5D.toUpperCase()%20+%20fullTextSoFar.trim().slice(1);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if(inputEl.offsetHeight%20%3C%20inputEl.scrollHeight+10)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20inputEl.style.height%20=%20%5C%2210px%5C%22;%20//%20otherwise%20scrollHeight%20can%20be%20bigger%20than%20the%20text.%20this%20ensures%20that%20the%20textarea%20is%20short%20enough%20for%20the%20textarea%20scrollbar%20to%20be%20showing%20-%20user%20shouldn't%20see%20it%20because%20its%20done%20synchonously%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20inputEl.style.height%20=%20Math.max(originalInputElHeight,%20inputEl.scrollHeight+10)%20+%20%5C%22px%5C%22;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20chunkCount++;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D,%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%7D);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20suggestBtn.parentElement.append(stopBtn);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20%20%20%20%20stopBtn.onclick%20=%20function()%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20stopBtn.disabled%20=%20true;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20pendingObj.stop();%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%7D;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20%20%20%20%20let%20onInputInterval%20=%20setInterval(()%20=%3E%20inputEl.oninput(%7B%7D),%202000);%20//%20so%20that%20if%20they%20click%20'generate'%20mid-text-gen,%20it'll%20still%20work%5Cn%20%20%20%20%20%20%20%20%20%20%20%20try%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20await%20pendingObj.onFinishPromise;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%7D%20catch(e)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20console.error(e);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20%20%20clearInterval(onInputInterval);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20inputEl.oninput(%7B%7D);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20%20%20%20%20stopBtn.remove();%5Cn%20%20%20%20%20%20%20%20%20%20%20%20suggestBtn.style.display%20=%20originalSuggestBtnDisplay;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20suggestBtn.innerHTML%20=%20%60%F0%9F%A7%A0%60;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20suggestBtn.disabled%20=%20false;%5Cn%20%20%20%20%20%20%20%20%20%20%7D;%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20if(el.querySelector(%5C%22.random-append-btn%5C%22))%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20el.querySelector(%5C%22.random-append-btn%5C%22).onclick%20=%20function()%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20let%20inputEl%20=%20el.closest(%5C%22.input-ctn%5C%22).querySelector(%5C%22input,%20textarea%5C%22);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20let%20userInputSpec%20=%20window.___userSettings746291937.userInputs%5Bel.dataset.inputName%5D;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20const%20randomAppendList%20=%20userInputSpec.randomAppend;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20const%20randomAppendStr%20=%20selectLeaf(randomAppendList).evaluateItem;%5Cn%5Cn%20%20%20%20%20%20%20%20%20%20%20%20let%20start%20=%20inputEl.selectionStart;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20let%20end%20=%20inputEl.selectionEnd;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20if(start%20===%20end)%20start%20=%20end%20=%20inputEl.value.length;%20//%20append%20when%20nothing%20selected%5Cn%20%20%20%20%20%20%20%20%20%20%20%20inputEl.setRangeText(randomAppendStr,%20start,%20end,%20%5C%22select%5C%22);%20//%20undo-friendly%20replace/append%5Cn%20%20%20%20%20%20%20%20%20%20%20%20inputEl.focus();%5Cn%20%20%20%20%20%20%20%20%20%20%20%20inputEl.oninput(%7B%7D);%5Cn%20%20%20%20%20%20%20%20%20%20%7D;%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%7D);%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20//%20focus%20on%20first%20non-hidden%20text%20input%20(only%20on%20non-mobile%20devices,%20otherwise%20onscreen%20keyboard%20pops%20up,%20which%20might%20be%20annoying):%5Cn%20%20%20%20%20%20if(window.innerWidth%20%3E%20700%20&&%20!window.location.hash.startsWith(%5C%22#edit%5C%22)%20&&%20!window.alreadyFocussedTextAreaOnLoad)%20%7B%5Cn%20%20%20%20%20%20%20%20let%20textInput%20=%20%5B...userInputsCtn8462746262.querySelectorAll('textarea,%20input')%5D.filter(el%20=%3E%20el.offsetHeight%20!==%200)%5B0%5D;%5Cn%20%20%20%20%20%20%20%20if(textInput)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20let%20distanceFromTopOfPage%20=%20textInput.getBoundingClientRect().top;%5Cn%20%20%20%20%20%20%20%20%20%20if(distanceFromTopOfPage%20%3C%20300)%20%7B%20//%20don't%20focus%20if%20it's%20way%20down%20the%20page%20-%20we%20want%20to%20keep%20the%20page%20scrolled%20to%20the%20top%20on%20load%5Cn%20%20%20%20%20%20%20%20%20%20%20%20textInput.focus();%5Cn%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20window.alreadyFocussedTextAreaOnLoad%20=%20true;%20//%20this%20is%20a%20hacky%20way%20to%20disable%20this%20when%20someone%20is%20editing%20a%20t2i-framework%20powered%20generator,%20since%20that's%20the%20only%20case%20where%20this%20plugin's%20code%20will%20be%20called%20multiple%20times%20(and%20the%20focus%20will%20annoyingly%20steal%20away%20focus%20from%20the%20perchance%20code%20editor)%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20//%20wait%20a%20'tick'%20and%20then%20load%20share%20link%20data%20if%20it%20exists:%5Cn%20%20%20%20%20%20await%20new%20Promise(r%20=%3E%20setTimeout(r,%2010));%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20let%20hash%20=%20window.location.hash.slice(1);%5Cn%20%20%20%20%20%20if(hash%20&&%20hash.startsWith(%5C%22data=%5C%22))%20%7B%5Cn%20%20%20%20%20%20%20%20console.log(%5C%22Loading%20data%20from%20URL%20hash...%5C%22);%5Cn%20%20%20%20%20%20%20%20let%20result%20=%20await%20loadDataFromUrlHash();%5Cn%20%20%20%20%20%20%20%20if(result.success)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20console.log(%5C%22Loaded%20data%20from%20URL%20hash.%5C%22);%5Cn%20%20%20%20%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20console.log(%5C%22Loading%20share%20data%20from%20URL%20hash%20failed:%5C%22,%20result);%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20//%20If%20there's%20an%20%5C%22Art%20Style%5C%22%20drop-down,%20then%20flash%20it%20a%20few%20times%20on%20page%20load%20to%20ensure%20people%20understand%20that%20they%20can%20change%20the%20style%5Cn%20%20%20%20%20%20try%20%7B%5Cn%20%20%20%20%20%20%20%20if(!localStorage.generateClickCount%20%7C%7C%20Number(localStorage.generateClickCount)%20%3C=%201)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20let%20artStyleInnerEl%20=%20%5B...document.querySelectorAll(%5C%22.input-ctn.input-type-select%20.input-inner%5C%22)%5D.filter(el%20=%3E%20el.textContent.toLowerCase().includes(%5C%22art%20style%5C%22))%5B0%5D;%5Cn%20%20%20%20%20%20%20%20%20%20if(artStyleInnerEl)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20let%20isDarkMode%20=%20window.matchMedia('(prefers-color-scheme:%20dark)').matches;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20let%20originalBackgroundColor%20=%20artStyleInnerEl.style.backgroundColor;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20let%20flashCount%20=%200;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20let%20flashInterval%20=%20setInterval(()%20=%3E%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20if(artStyleInnerEl.style.backgroundColor%20===%20originalBackgroundColor)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20artStyleInnerEl.style.backgroundColor%20=%20isDarkMode%20?%20%5C%22#364183%5C%22%20:%20%5C%22#7fb4ff%5C%22;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20artStyleInnerEl.style.backgroundColor%20=%20originalBackgroundColor;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20flashCount++;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20if(flashCount%20%3E%208)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20clearInterval(flashInterval);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20artStyleInnerEl.style.backgroundColor%20=%20originalBackgroundColor;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%7D,%20400);%5Cn%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%7D%20catch(e)%20%7B%5Cn%20%20%20%20%20%20%20%20console.error(e);%5Cn%20%20%20%20%20%20%7D%5Cn%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%7D,%20100);%5Cn%20%20%7D;%5Cn%20%20%5Cn%20%20//%20Hackily%20trigger%20the%20page%20load%20handler%20with%20an%20%3Cimg%3E%20onerror%20because%20it's%20an%20easy%20way%20to%20execute%20a%20script%20right%20after%20the%20HTML%20has%20been%20rendered.%5Cn%20%20let%20dummyImageScriptTrigger%20=%20%60%3Cimg%20style=%5C%22display:fixed;opacity:0;pointer-events:none;top:-2000px;%5C%22%20src=%5C%22%5C%22%20onerror=%5C%22window.___pageLoadHandler746291937();%20this.remove();%5C%22%3E%60;%5Cn%20%20%5Cn%20%20window.generateFeedbackCommentsHtml_8974sklfjosifo%20=%20function()%20%7B%5Cn%20%20%20%20//%20old%20channel%20name:%20feedback-94d35yisdfiwh%20(annoying%20to%20subscribe%20to%20notifications%20for)%5Cn%20%20%20%20let%20options%20=%20%7Bchannel:%5C%22t2i-feedback%5C%22,%20hideComments:settings.showFeedback%20%7C%7C%20location.hash.startsWith(%5C%22#showfeedback%5C%22)%20?%20false%20:%20true,%20height:settings.showFeedback%20%7C%7C%20location.hash.startsWith(%5C%22#showfeedback%5C%22)%20?%20500%20:%20220,%20width:300,%20commentPlaceholderText:%20%5C%22Share%20some%20feedback.%20Do%20not%20share%20personal%20info,%20this%20feedback%20data%20is%20public.%20If%20there's%20a%20technical%20issue/bug%20%F0%9D%98%81%F0%9D%97%BF%F0%9D%98%86%20%F0%9D%98%82%F0%9D%98%80%F0%9D%97%B6%F0%9D%97%BB%F0%9D%97%B4%20%F0%9D%97%96%F0%9D%97%B5%F0%9D%97%BF%F0%9D%97%BC%F0%9D%97%BA%F0%9D%97%B2%20%F0%9D%97%BC%F0%9D%97%BF%20%F0%9D%97%99%F0%9D%97%B6%F0%9D%97%BF%F0%9D%97%B2%F0%9D%97%B3%F0%9D%97%BC%F0%9D%98%85,%20otherwise%20give%20as%20much%20detail%20as%20you%20can%20about%20the%20issue,%20including%20your%20device%20(e.g.%20Android/iPhone).%20If%20the%20issue%20is%20about%20bad%20outputs,%20specify%20the%20chosen%20style%20and%20prompt%20you%20used%20(if%20relevant).%5C%22,%20submitButtonText:%20%5C%22submit%20feedback%5C%22,%20hideSettingsButton:true,%20hideFullscreenButton:true%7D;%5Cn%20%20%20%20if(localStorage.forceColorScheme)%20options.forceColorScheme%20=%20localStorage.forceColorScheme;%5Cn%20%20%20%20return%20window.___commentsPlugin746291937(options);%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20window.generateCommentsPluginElement85638294%20=%20function()%20%7B%5Cn%20%20%20%20let%20defaultChannelOptions%20=%20window.___userSettings746291937.defaultCommentOptions;%5Cn%20%20%20%20let%20channels%20=%20window.___userSettings746291937.commentChannels;%5Cn%20%20%20%20if(!channels)%20%7B%5Cn%20%20%20%20%20%20let%20styleEl%20=%20document.createElement(%5C%22style%5C%22);%5Cn%20%20%20%20%20%20styleEl.textContent%20=%20%60#hideCommentsBtn85937402%20%7B%20display:none%20!important;%20%7D%60;%5Cn%20%20%20%20%20%20document.head.append(styleEl);%5Cn%20%20%20%20%20%20return%20document.createElement(%5C%22div%5C%22);%5Cn%20%20%20%20%7D%5Cn%20%20%20%20return%20tabbedCommentsPlugin(%7Bchannels,%20defaultChannelOptions%7D);%5Cn%20%20%20%20%5Cn%20%20%20%20//%20let%20defaultCommentOptions%20=%20window.___userSettings746291937.defaultCommentOptions;%5Cn%20%20%20%20//%20let%20commentChannelsList%20=%20window.___userSettings746291937.commentChannels;%5Cn%20%20%20%20//%20let%20items%20=%20%5B%5D;%5Cn%20%20%20%20//%20for(let%20channel%20of%20commentChannelsList.selectAll)%20%7B%5Cn%20%20%20%20//%20%20%20let%20item%20=%20%7Bname:channel.getName,%20label:channel.label%7D;%5Cn%20%20%20%20//%20%20%20let%20commentOptions%20=%20%7B%7D;%5Cn%20%20%20%20//%20%20%20//%20get%20default%20options:%5Cn%20%20%20%20//%20%20%20for(let%20key%20of%20defaultCommentOptions.getAllKeys)%20%7B%5Cn%20%20%20%20//%20%20%20%20%20commentOptions%5Bkey%5D%20=%20defaultCommentOptions%5Bkey%5D;%5Cn%20%20%20%20//%20%20%20%7D%5Cn%20%20%20%20//%20%20%20//%20apply%20channel-specific%20comment%20option%20overrides:%5Cn%20%20%20%20//%20%20%20for(let%20key%20of%20channel.getAllKeys)%20%7B%20%5Cn%20%20%20%20//%20%20%20%20%20commentOptions%5Bkey%5D%20=%20channel%5Bkey%5D;%5Cn%20%20%20%20//%20%20%20%7D%5Cn%20%20%20%20//%20%20%20if(channel.getName%20!==%20%5C%22general%5C%22)%20%7B%20//%20%3C--%20for%20backwards%20compatibility%20with%20v1%20of%20this%20framework%20(i.e.%20to%20keep%20comment%20history)%5Cn%20%20%20%20//%20%20%20%20%20commentOptions.channel%20=%20channel.getName;%5Cn%20%20%20%20//%20%20%20%7D%5Cn%20%20%20%20//%20%20%20//%20Note:%20If%20you%20change%20stuff%20here,%20make%20sure%20to%20update%20the%20custom%20tab%20creation%20code%20in%20createCommentsTabs%20too.%5Cn%20%20%20%20//%20%20%20if(localStorage.forceColorScheme)%20commentOptions.forceColorScheme%20=%20localStorage.forceColorScheme;%5Cn%20%20%20%20//%20%20%20item.content%20=%20window.___commentsPlugin746291937(commentOptions);%5Cn%20%20%20%20//%20%20%20items.push(item);%5Cn%20%20%20%20//%20%7D%5Cn%20%20%20%20//%20return%20createCommentsTabs(items,%20%7BallowCustomChannels:!!commentChannelsList.allowCustomChannels%7D);%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20window.generateImageGalleryHtml358402048%20=%20function()%20%7B%5Cn%20%20%20%20const%20settings%20=%20window.___userSettings746291937;%5Cn%20%20%20%20if(!settings.galleryOptions%20%7C%7C%20!settings.galleryOptions.gallery)%20%7B%5Cn%20%20%20%20%20%20let%20styleEl%20=%20document.createElement(%5C%22style%5C%22);%5Cn%20%20%20%20%20%20styleEl.textContent%20=%20%60#hideGalleryBtn85937402%20%7B%20display:none%20!important;%20%7D%60;%5Cn%20%20%20%20%20%20document.head.append(styleEl);%5Cn%20%20%20%20%20%20return%20%5C%22%5C%22;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20settings.galleryOptions.forceColorScheme%20=%20null;%5Cn%20%20%20%20if(localStorage.forceColorScheme)%20settings.galleryOptions.forceColorScheme%20=%20localStorage.forceColorScheme;%5Cn%5Cn%20%20%20%20//%20Integrate%20privateSave%20and%20gallery%20customButton%20features:%5Cn%20%20%20%20if(settings.imageButtons?.privateSave)%20%7B%5Cn%20%20%20%20%20%20const%20blobToDataURL%20=%20b%20=%3E%20new%20Promise(r=%3E%7Bconst%20fr=new%20FileReader();fr.onload=()=%3Er(fr.result);fr.readAsDataURL(b);%7D);%5Cn%20%20%20%20%20%20if(!settings.galleryOptions.customButton)%20%7B%5Cn%20%20%20%20%20%20%20%20settings.galleryOptions.customButton%20=%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20emoji:%20%5C%22%E2%AD%90%5C%22,%5Cn%20%20%20%20%20%20%20%20%20%20onClick:%20async%20(data)%20=%3E%20%7B%5Cn%20%20%5Cn%20%20%20%20%20%20%20%20%20%20%20%20let%20%7B%20prompt,%20negativePrompt,%20seed,%20guidanceScale%20%7D%20=%20data;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20let%20imageBlob%20=%20await%20fetch(data.imageUrl).then(r%20=%3E%20r.blob());%5Cn%20%20%20%20%20%20%20%20%20%20%20%20await%20window.t2i_privateGallery.add(imageBlob,%20%7Binfo:%7Bprompt,%20negativePrompt,%20seed,%20guidanceScale%7D%7D);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20%20%20%20%20let%20dataUrl%20=%20await%20blobToDataURL(imageBlob)%5Cn%20%20%20%20%20%20%20%20%20%20%20%20let%20imgEl%20=%20document.createElement(%5C%22img%5C%22);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20imgEl.style.cssText%20=%20%5C%22opacity:0.5;%20pointer-events:none;%20background:#333;%20border-radius:3px;%20width:200px;%20height:200px;%20position:fixed;%20top:calc(50%25%20-%2050px);%20left:calc(50%25%20-%2050px);%20object-fit:contain;%20object-position:center;%5C%22;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20imgEl.src%20=%20dataUrl;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20document.body.append(imgEl);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20animateImageIntoTarget(%7BimgEl,%20sourceEl:imgEl,%20targetEl:privateGalleryCtn97364827.querySelector(%5C%22button%5C%22),%20durationMs:700,%20wiggle:true%7D);%5Cn%20%20%20%20%20%20%20%20%20%20%7D,%5Cn%20%20%20%20%20%20%20%20%7D;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%7D%5Cn%20%20%20%20//%20Use%20the%20second%20custom%20button%20for%20comments%20popup%20on%20each%20image:%5Cn%20%20%20%20if(!settings.galleryOptions.customButton2)%20%7B%5Cn%20%20%20%20%20%20settings.galleryOptions.customButton2%20=%20%7B%5Cn%20%20%20%20%20%20%20%20emoji:%20%5C%22%F0%9F%92%AC%5C%22,%5Cn%20%20%20%20%20%20%20%20onClick:%20async%20(data)%20=%3E%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20let%20options%20=%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20channel:%20%5C%22image-%5C%22+data.imageId.slice(0,%2025),%5Cn%20%20%20%20%20%20%20%20%20%20%20%20style:%20%5C%22display:block;%20height:100%25;%20width:100%25;%5C%22,%5Cn%20%20%20%20%20%20%20%20%20%20%7D;%5Cn%20%20%20%20%20%20%20%20%20%20let%20defaultChannelOptions%20=%20window.___userSettings746291937.defaultCommentOptions;%5Cn%20%20%20%20%20%20%20%20%20%20for(let%20key%20of%20%5B%5C%22commentPlaceholderText%5C%22,%20%5C%22submitButtonText%5C%22,%20%5C%22newestCommentsAtTop%5C%22,%20%5C%22customEmojis%5C%22,%20%5C%22customEmojiSize%5C%22,%20%5C%22hideDates%5C%22,%20%5C%22slashCommands%5C%22,%20%5C%22forceColorScheme%5C%22,%20%5C%22messageBubbleStyle%5C%22,%20%5C%22messageFeedStyle%5C%22,%20%5C%22inputAreaStyle%5C%22,%20%5C%22submitButtonStyle%5C%22,%20%5C%22settingsButtonStyle%5C%22,%20%5C%22fullscreenButtonStyle%5C%22,%20%5C%22submitButtonSuccessText%5C%22,%20%5C%22hideSettingsButton%5C%22,%20%5C%22hideFullscreenButton%5C%22,%20%5C%22loadFonts%5C%22,%20%5C%22adminPasswordHash%5C%22,%20%5C%22adminFlair%5C%22,%20%5C%22deleteButtonIcon%5C%22,%20%5C%22bannedUsers%5C%22,%20%5C%22bannedWords%5C%22,%20%5C%22rateLimits%5C%22%5D)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20if(defaultChannelOptions%5Bkey%5D%20!==%20undefined)%20options%5Bkey%5D%20=%20defaultChannelOptions%5Bkey%5D;%5Cn%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20showModal(%60%3Cdiv%20style=%5C%22height:95vh;%20width:95vw;%20max-height:600px;%20max-width:900px;%5C%22%3E$%7Bwindow.___commentsPlugin746291937(options)%7D%3C/div%3E%60);%5Cn%20%20%20%20%20%20%20%20%7D,%5Cn%20%20%20%20%20%20%7D;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20return%20window.___textToImagePlugin746291937(settings.galleryOptions).evaluateItem;%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20try%20%7B%5Cn%20%20%20%20let%20isSafari%20=%20navigator.vendor%20&&%20navigator.vendor.indexOf('Apple')%20%3E%20-1%20&&%20navigator.userAgent%20&&%20navigator.userAgent.indexOf('CriOS')%20==%20-1%20&&%20navigator.userAgent.indexOf('FxiOS')%20==%20-1;%5Cn%20%20%20%20let%20isTouchScreen%20=%20window.matchMedia(%5C%22(pointer:%20coarse)%5C%22).matches;%5Cn%20%20%20%20if(isSafari%20&&%20window.innerWidth%20%3C%20800%20&&%20isTouchScreen)%20%7B%5Cn%20%20%20%20%20%20let%20viewportMetaEl%20=%20document.querySelector(%5C%22%5Bname=viewport%5D%5C%22);%5Cn%20%20%20%20%20%20if(!viewportMetaEl.getAttribute(%5C%22content%5C%22).includes(%5C%22maximum-scale%5C%22))%20%7B%5Cn%20%20%20%20%20%20%20%20viewportMetaEl.setAttribute(%5C%22content%5C%22,%20viewportMetaEl.getAttribute(%5C%22content%5C%22)%20+%20%5C%22,%20maximum-scale=1%5C%22);%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20console.log(%5C%22Safari%20iOS%20detected.%20Added%20maximum-scale%20attribute%20to%20prevent%20zooming:%5C%22,%20viewportMetaEl.getAttribute(%5C%22content%5C%22));%5Cn%20%20%20%20%7D%5Cn%20%20%7D%20catch(e)%20%7B%5Cn%20%20%20%20console.error(e);%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20return%20%60%3Cstyle%3E%5Cn%20%20%20%20body%20*:not(a,%20button)%20%7B%5Cn%20%20%20%20%20%20color:%20inherit;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20.input-ctn%20%7B%5Cn%20%20%20%20%20%20width:%20min-content;%5Cn%20%20%20%20%20%20display:%20flex;%5Cn%20%20%20%20%20%20align-items:%20center;%5Cn%20%20%20%20%20%20justify-content:%20center;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20.input-ctn.takesUpFullRow%20%7B%5Cn%20%20%20%20%20%20width:%20100%25;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20.input-ctn.takesUpFullRow%5C%5C%5C%5C%5Bdata-fold-toggle-state='shown'%5C%5C%5C%5C%5D%20%7B%5Cn%20%20%20%20%20%20width:%20100%25;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20.input-ctn.takesUpFullRow%5C%5C%5C%5C%5Bdata-fold-toggle-state='hidden'%5C%5C%5C%5C%5D%20%7B%5Cn%20%20%20%20%20%20width:%20min-content;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20.input-ctn%5C%5C%5C%5C%5Bdata-fold-toggle-state='hidden'%5C%5C%5C%5C%5D%20.input-wrapper%20%7B%5Cn%20%20%20%20%20%20display:%20none;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20.input-inner%20%7B%5Cn%20%20%20%20%20%20padding:%200.25rem;%20/*%20%3C--%20if%20you%20change%20this,%20you%20need%20to%20change%20the%20CSS%20width%20calc%20on%20input-wrapper,%20generated%20by%20the%20JS%20code%20*/%5Cn%20%20%20%20%20%20margin:%200.25rem;%5Cn%20%20%20%20%20%20border-radius:%203px;%5Cn%20%20%20%20%20%20background:%20var(--box-color,%20#ebebeb);%5Cn%20%20%20%20%7D%5Cn%20%20%20%20.input-type-text%20.input-inner,%20.input-type-paragraph%20.input-inner%20%7B%5Cn%20%20%20%20%20%20width:%20300px;%5Cn%20%20%20%20%20%20/*%20min-width:%20max-content;%20*/%20/*%20this%20breaks%20display%20on%20mobile%20*/%5Cn%20%20%20%20%7D%5Cn%20%20%20%20.input-label%20%7B%5Cn%20%20%20%20%20%20font-size:%2080%25;%20%5Cn%20%20%20%20%20%20text-align:%20left;%5Cn%20%20%20%20%20%20display:%20flex;%5Cn%20%20%20%20%20%20align-items:%20center;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20.input-ctn%5C%5C%5C%5C%5Bdata-fold-toggle-state='shown'%5C%5C%5C%5C%5D%20.input-toggle-button%20%7B%5Cn%20%20%20%20%20%20margin-left:%20auto;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20.input-ctn%5C%5C%5C%5C%5Bdata-fold-toggle-state='hidden'%5C%5C%5C%5C%5D%20.input-toggle-button%20%7B%5Cn%20%20%20%20%20%20margin-left:%201rem;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20.input-ctn%5C%5C%5C%5C%5Bdata-fold-toggle-state='hidden'%5C%5C%5C%5C%5D%20.input-toggle-button::before%20%7B%5Cn%20%20%20%20%20%20content:%20%5C%22show%5C%22;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20.input-ctn%5C%5C%5C%5C%5Bdata-fold-toggle-state='shown'%5C%5C%5C%5C%5D%20.input-toggle-button::before%20%7B%5Cn%20%20%20%20%20%20content:%20%5C%22hide%5C%22;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20.input-wrapper%20%7B%5Cn%20%20%20%20%20%20width:%20100%25;%5Cn%20%20%20%20%20%20display:%20flex;%5Cn%20%20%20%20%20%20justify-content:%20center;%5Cn%20%20%20%20%20%20align-items:%20center;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20.input-wrapper%20.text-input%20%7B%5Cn%20%20%20%20%20%20width:%20100%25;%5Cn%20%20%20%20%20%20padding-right:%201.375rem;%5Cn%20%20%20%20%20%20display:%20block;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20.input-wrapper%20.paragraph-input%20%7B%5Cn%20%20%20%20%20%20width:%20100%25;%5Cn%20%20%20%20%20%20padding-right:%201.375rem;%5Cn%20%20%20%20%20%20display:%20block;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20.random-input-btn-ctn%20%7B%5Cn%20%20%20%20%20%20margin-left:%200.25rem;%5Cn%20%20%20%20%20%20display:%20flex;%5Cn%20%20%20%20%20%20flex-direction:%20column;%5Cn%20%20%20%20%20%20justify-content:%20center;%5Cn%20%20%20%20%20%20align-items:%20center;%5Cn%20%20%20%20%20%20cursor:%20pointer;%5Cn%20%20%20%20%20%20margin-bottom:%20auto;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20.auto-suggest-btn%20%7B%5Cn%20%20%20%20%20%20position:absolute;%5Cn%20%20%20%20%20%20top:0.125rem;%5Cn%20%20%20%20%20%20right:0.125rem;%5Cn%20%20%20%20%20%20cursor:pointer;%5Cn%20%20%20%20%20%20opacity:0.6;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20.auto-suggest-btn:hover%20%7B%5Cn%20%20%20%20%20%20opacity:1;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20.input-tip-btn%20%7B%5Cn%20%20%20%20%20%20cursor:pointer;%5Cn%20%20%20%20%20%20font-weight:bold;%5Cn%20%20%20%20%20%20margin-left:0.25rem;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20@keyframes%20rotate%7B%5Cn%20%20%20%20%20%20to%20%7B%20transform:%20rotate(360deg);%20%7D%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20.tabs-header%20%7B%5Cn%20%20%20%20%20%20display:%20flex;%5Cn%20%20%20%20%20%20font-size:%2070%25;%5Cn%20%20%20%20%20%20overflow:auto;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20.tab%20%7B%5Cn%20%20%20%20%20%20padding:%200.25rem;%5Cn%20%20%20%20%20%20cursor:%20pointer;%5Cn%20%20%20%20%20%20background:%20var(--box-color,%20#ebebeb);%5Cn%20%20%20%20%20%20border-radius:%200.25rem;%5Cn%20%20%20%20%20%20margin:%200.25rem;%5Cn%20%20%20%20%20%20user-select:%20none;%5Cn%20%20%20%20%20%20min-width:%20max-content;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20.active-tab%20%7B%5Cn%20%20%20%20%20%20background:%20var(--active-comment-channel-tab-color,%20#c6c6c6);%5Cn%20%20%20%20%7D%5Cn%20%20%20%20.tab-content%20%7B%5Cn%20%20%20%20%20%20display:%20none;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20.active-content%20%7B%5Cn%20%20%20%20%20%20display:%20block;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20.t2i-under-each-image-ctn%20%7B%5Cn%20%20%20%20%20%20font-size:%2080%25;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20.t2i-under-each-image-ctn%20.personality-chat-button%20%7B%20opacity:%200.5;%20%7D%5Cn%20%20%20%20.t2i-under-each-image-ctn%20.personality-chat-button:hover%20%7B%20opacity:%201;%20%7D%5Cn%20%20%20%20.t2i-under-each-image-ctn%20.private-save-button%20%7B%20opacity:%200.5;%20%7D%5Cn%20%20%20%20.t2i-under-each-image-ctn%20.private-save-button:hover%20%7B%20opacity:%201;%20%7D%5Cn%20%20%20%20iframe.text-to-image-plugin-image-iframe%20%7B%5Cn%20%20%20%20%20%20max-width:%20100%25;%5Cn%20%20%20%20%7D%5Cn%20%20%3C/style%3E%5Cn%5Cn%20%20%3Ch1%20id=%5C%22pageTitleEl48759084793%5C%22%20style=%5C%22font-size:1.2rem;%20margin-bottom:0.5rem;%5C%22%3E$%7Bsettings.pageTitle%7D%3C/h1%3E%20%5Cn%5Cn%20%20%3Cdiv%20id=%5C%22mainColumnEl85394739%5C%22%20style=%5C%22margin:0%20auto;%20max-width:1000px;%5C%22%3E%20%3C!--%20NOTE:%20if%20you%20change%201000px%20to%20something%20else,%20ctrl+f%20for%20mainColumnEl85394739%20and%20change%20the%20numImage-based%20stuff%20--%3E%5Cn%20%20%20%20%3Cdiv%20id=%5C%22userInputsCtn8462746262%5C%22%20style=%5C%22display:flex;%20padding:0.25rem;%20justify-content:center;%20flex-wrap:wrap;%5C%22%3E%5Cn%20%20%20%20%20%20$%7BuserInputsHtml%7D%5Cn%20%20%20%20%3C/div%3E%5Cn%20%20%20%20$%7BdummyImageScriptTrigger%7D%5Cn%5Cn%20%20%20%20%3C!--%3Cdiv%20style=%5C%22margin:1rem%200;%20display:%20flex;%20align-items:%20center;%20justify-content:%20center;%5C%22%3E%5Cn%20%20%20%20%20%20%E2%9E%A1%EF%B8%8F&nbsp;%3Cbutton%20id=%5C%22generateButtonEl%5C%22%20style=%5C%22font-size:1.5rem;%5C%22%20onclick=%5C%22window.___generateButtonClickEvent746291937(event);%5C%22%3E%E2%9C%A8%20generate%3C/button%3E&nbsp;%E2%AC%85%EF%B8%8F%5Cn%20%20%20%20%3C/div%3E--%3E%5Cn%20%20%20%20%5Cn%20%20%20%20%3Cdiv%20id=%5C%22shareLinkOuterCtn2893827%5C%22%20style=%5C%22display:none;%20margin-bottom:2rem;%5C%22%3E%5Cn%20%20%20%20%20%20%3Cbutton%20id=%5C%22shareSettingsBtn758374%5C%22%20onclick=%5C%22window.__generateSettingsShareLink084722()%5C%22%20style=%5C%22font-size:70%25;%5C%22%3E%F0%9F%94%97%20share%20these%20settings%3C/button%3E%5Cn%20%20%20%20%20%20%3Cdiv%20id=%5C%22shareLinkCtn83927376%5C%22%20style=%5C%22display:none;%20margin-top:0.5rem;%20font-size:80%25;%5C%22%3E%5Cn%20%20%20%20%20%20%20%20%3Cinput%20style=%5C%22width:200px;%5C%22%20id=%5C%22shareSettingsLinkInputEl759307%5C%22%20disabled%3E%20%3Cbutton%20style=%5C%22min-width:80px;%5C%22%20onclick=%5C%22navigator.clipboard.writeText(shareSettingsLinkInputEl759307.value).then(r%20=%3E%20this.innerHTML='%E2%9C%85');%20setTimeout(()%20=%3E%20this.innerHTML='copy%20link',%202000);%5C%22%3Ecopy%20link%3C/button%3E%5Cn%20%20%20%20%20%20%20%20%3Cdiv%20style=%5C%22font-size:80%25;%20opacity:0.7;%5C%22%3E(this%20link%20contains%20a%20snapshot%20of%20the%20above%20settings)%3C/div%3E%5Cn%20%20%20%20%20%20%3C/div%3E%5Cn%20%20%20%20%3C/div%3E%5Cn%20%20%20%20%5Cn%20%20%20%20%3Cdiv%20style=%5C%22margin:1rem%200;%5C%22%3E%5Cn%20%20%20%20%20%20%3Cdiv%20style=%5C%22display:%20flex;align-items:%20center;justify-content:%20center;%5C%22%3E%3Cspan%20id=%5C%22leftClickHelperEl%5C%22%20style=%5C%22display:none;%5C%22%3Eclick%20%E2%9E%A1&nbsp;%3C/span%3E%3Cbutton%20id=%5C%22generateButtonEl%5C%22%20style=%5C%22font-size:1.5rem;%5C%22%20onclick=%5C%22window.___generateButtonClickEvent746291937(event);%5C%22%3E%E2%9C%A8%20generate%3C/button%3E%3Cspan%20id=%5C%22rightClickHelperEl%5C%22%20style=%5C%22display:none;%5C%22%3E&nbsp;%E2%AC%85%20click%3C/span%3E%3C/div%3E%5Cn%20%20%20%20%20%20%3Cdiv%20id=%5C%22bottomClickHelperEl%5C%22%20style=%5C%22display:none;%5C%22%3E%3Cdiv%3E%E2%AC%86%3C/div%3E%3Cdiv%3Eclick%3C/div%3E%3C/div%3E%5Cn%20%20%20%20%3C/div%3E%5Cn%5Cn%20%20%20%20%3Cdiv%20id=%5C%22outputAreaEl%5C%22%20style=%5C%22margin-top:1rem;%20min-height:12rem;%20display:flex;%20flex-wrap:wrap;%20justify-content:center;%20align-items:center;%20padding:0.25rem;%5C%22%3E%5Cn%20%20%20%20%20%20%3Cspan%3E$%7Bsettings.introMessage%20%7C%7C%20%5C%22%E2%86%91%20Set%20inputs%20and%20click%20%3Ci%3Egenerate%3C/i%3E%20to%20begin.%20%E2%86%91%5C%22%7D%3C/span%3E%5Cn%20%20%20%20%3C/div%3E%5Cn%20%20%20%20%5Cn%20%20%20%20%3Cdiv%20style=%5C%22position:fixed;%20bottom:0.5rem;%20right:0.5rem;%20text-align:right;%20z-index:100;%5C%22%3E%5Cn%20%20%20%20%20%20%3Cdiv%20id=%5C%22feedbackCommentsCtn%5C%22%3E%3C/div%3E%5Cn%20%20%20%20%20%20%3Cbutton%20id=%5C%22feedbackBtn893745ykfuhd%5C%22%20onclick=%5C%22if(feedbackCommentsCtn.innerHTML.length%20===%200)%20%7B%20feedbackCommentsCtn.innerHTML=window.generateFeedbackCommentsHtml_8974sklfjosifo();%20this.innerHTML='%E2%9C%96%20close';%20%7D%20else%20%7B%20%20feedbackCommentsCtn.innerHTML='';%20%20this.innerHTML='%F0%9F%97%A8%EF%B8%8F%20feedback';%20%7D%5C%22%20style=%5C%22font-size:0.85rem;%5C%22%3E%F0%9F%97%A8%EF%B8%8F%20feedback%3C/button%3E%5Cn%20%20%20%20%3C/div%3E%5Cn%20%20%20%20%5Cn%20%20%20%20%3Cdiv%20id=%5C%22showSocialsButtonCtn9000274628%5C%22%20style=%5C%22$%7BsocialFeatures%20===%20'button'%20?%20''%20:%20'display:none;'%7D%5C%22%3E%5Cn%20%20%20%20%20%20%3Cbutton%20id=%5C%22showSocialsButton927514532%5C%22%20style=%5C%22margin-top:2rem;%20margin-bottom:0.5rem;%5C%22%20onclick=%5C%22window.__showSocialsButtonClickHandler98347938();%5C%22%3E%3Cdiv%20style=%5C%22padding:0.5rem;%5C%22%3E%F0%9F%92%AC%20show%20comments%20&%20gallery%20%F0%9F%96%BC%EF%B8%8F%3C/div%3E%3C/button%3E%5Cn%20%20%20%20%20%20%3Cdiv%20style=%5C%22display:flex;%20align-items:center;%20justify-content:center;%5C%22%3E%5Cn%20%20%20%20%20%20%20%20%3Cinput%20id=%5C%22autoShowCheckbox84937483%5C%22%20style=%5C%22cursor:pointer;%5C%22%20type=%5C%22checkbox%5C%22%3E%3Cspan%20style=%5C%22margin-left:0.25rem;%20cursor:pointer;%5C%22%20onclick=%5C%22autoShowCheckbox84937483.checked=!autoShowCheckbox84937483.checked;%5C%22%3Eauto-show%20next%20time%3C/span%3E%5Cn%20%20%20%20%20%20%3C/div%3E%5Cn%20%20%20%20%3C/div%3E%5Cn%5Cn%20%20%20%20%3Cdiv%20id=%5C%22showHideGalleryAndCommentsButtonsCtn83728732671%5C%22%20style=%5C%22$%7BsocialFeatures%20===%20%5C%22button%5C%22%20%7C%7C%20socialFeatures%20===%20%5C%22disabled%5C%22%20?%20%5C%22display:none;%5C%22%20:%20%5C%22%5C%22%7D%20margin-top:1rem;%5C%22%3E%5Cn%20%20%20%20%20%20%3Cbutton%20id=%5C%22hideCommentsBtn85937402%5C%22%20onclick=%5C%22if(this.dataset.hidden)%20%7B%20this.dataset.hidden='';%20this.textContent%20=%20'hide%20comments';%20commentsPluginCtn654732.style.display%20=%20'';%20%7D%20else%20%7B%20this.dataset.hidden='1';%20this.textContent%20=%20'show%20comments';%20commentsPluginCtn654732.style.display%20=%20'none';%20%7D%5C%22%20data-hidden=%5C%22%5C%22%3Ehide%20comments%3C/button%3E%5Cn%20%20%20%20%20%20%3Cbutton%20id=%5C%22hideGalleryBtn85937402%5C%22%20onclick=%5C%22if(this.dataset.hidden)%20%7B%20this.dataset.hidden='';%20this.textContent%20=%20'hide%20gallery';%20imageGalleryCtn8569284.style.display%20=%20'';%20%7D%20else%20%7B%20this.dataset.hidden='1';%20this.textContent%20=%20'show%20gallery';%20imageGalleryCtn8569284.style.display%20=%20'none';%20%7D%5C%22%20data-hidden=%5C%22%5C%22%3Ehide%20gallery%3C/button%3E%5Cn%20%20%20%20%3C/div%3E%5Cn%20%20%20%20%5Cn%20%20%20%20%3Cdiv%20style=%5C%22position:fixed;%20bottom:0.5rem;%20left:0.5rem;%5C%22%3E%5Cn%20%20%20%20%20%20%3Cbutton%20id=%5C%22darkModeBtn_875979f948%5C%22%20style=%5C%22cursor:pointer;%20font-size:0.85rem;%5C%22%20onclick=%5C%22window.toggleManualDarkMode_jv83hb27igksf();%5C%22%3E%F0%9F%8C%83%3C/button%3E%5Cn%20%20%20%20%20%20%3Cdiv%20style=%5C%22display:inline-block;%20font-size:0.85rem;%5C%22%3E%5Bwindow.___fullscreenButton893479(%5C%22&nbsp;&nbsp;&nbsp;%E2%87%B1&nbsp;&nbsp;&nbsp;%5C%22,%20%5C%22&nbsp;&nbsp;&nbsp;%E2%87%B2&nbsp;&nbsp;&nbsp;%5C%22,%20%5C%22line-height:initial;%5C%22)%5D%3C/div%3E%5Cn%20%20%20%20%3C/div%3E%5Cn%20%20%3C/div%3E%5Cn%20%20%5Cn%20%20%3Cdiv%20id=%5C%22privateGalleryCtn97364827%5C%22%20$%7Bsettings.imageButtons?.privateSave%20?%20%5C%22%5C%22%20:%20%5C%22hidden%5C%22%7D%20style=%5C%22pointer-events:none;bottom:0.5rem;left:0;right:0;width:100%25;text-align:center;position:fixed;z-index:100;font-size:0.85rem;%5C%22%3E%5Cn%20%20%20%20%3Cbutton%20onclick=%5C%22window.t2i_privateGallery.show()%5C%22%20title=%5C%22Ctrl+Shift+G%5C%22%20style=%5C%22pointer-events:auto;%20cursor:pointer;%5C%22%3E%F0%9F%9B%A1%EF%B8%8F%20$%7Bwindow.innerWidth%20%3E%20600%20?%20%5C%22show%20%5C%22%20:%20%5C%22%5C%22%7Dprivate%20gallery%3C/button%3E%5Cn%20%20%3C/div%3E%5Cn%20%20%5Cn%20%20%3Cdiv%20id=%5C%22commentsPluginCtn654732%5C%22%20style=%5C%22padding:0.25rem;%20width:100%25;%20margin:0%20auto;%20margin-top:1rem;%5C%22%3E%3C/div%3E%5Cn%20%20%5Cn%20%20%3C!--%20%3Cdiv%20style=%5C%22background-image:url(https://example.com/image.webp);%20filter:%20blur(1px);%20opacity:0.5;%20background-position:center;%20background-size:cover;%20z-index:-10;%20position:fixed;%20top:0;left:0;right:0;bottom:0;%5C%22%3E%3C/div%3E%20--%3E%5Cn%20%20%3Cdiv%20id=%5C%22clickCountBasedSocialDisplayNotifierEl%5C%22%20style=%5C%22font-size:80%25;%20max-width:800px;%20margin:0%20auto;%20padding:0.5rem;%20text-align:left;%20display:none;%5C%22%3E%5Cn%20%20%20%20%3Cdiv%20style=%5C%22background:var(--box-color);padding:%200.5rem;%20border-radius:3px;%5C%22%3E%3Cb%3ENote:%3C/b%3E%20The%20comments%20and%20gallery%20only%20appear%20after%20generating%20several%20batches%20of%20images.%20If%20you%20visit%20this%20page%20again%20later%20and%20don't%20see%20the%20gallery/comments,%20it's%20because%20your%20cookies/storage%20for%20this%20site%20got%20cleared%20for%20some%20reason,%20so%20you'd%20need%20to%20generate%20some%20more%20images.%20%3Cbutton%20style=%5C%22font-size:80%25;%5C%22%20onclick=%5C%22localStorage.theyKnowAboutClickCountBasedSocialDisplay='1';%20this.parentElement.style.display='none';%5C%22%3E%E2%9C%85%20got%20it%3C/button%3E%3C/div%3E%5Cn%20%20%3C/div%3E%5Cn%20%20%5Cn%20%20%3Cdiv%20id=%5C%22imageGalleryCtn8569284%5C%22%20style=%5C%22margin-top:1rem;%5C%22%3E%5Cn%20%20%20%20$%7B%5B%5C%22disabled%5C%22,%20%5C%22button%5C%22%5D.includes(socialFeatures)%20?%20%5C%22%5C%22%20:%20window.generateImageGalleryHtml358402048()%7D%5Cn%20%20%3C/div%3E%5Cn%20%20%3Cbr%3E%3Cbr%3E%3Cbr%3E%3Cbr%3E%5Cn%20%20%60.replaceAll(%5C%22%7B%5C%22,%20%5C%22%5C%5C%5C%5C%7B%5C%22).replaceAll(%5C%22%7D%5C%22,%20%5C%22%5C%5C%5C%5C%7D%5C%22);%5Cn%20%20%5Cn%20%20%5Cn%20%20%5CncreateCommentsTabs(items,%20opts)%20=%3E%20//%20items%20=%20%5B%7Bname,%20label,%20content%7D,%20%7Bname,%20label,%20content%7D,%20...%5D%5Cn%20%20if(!opts)%20opts%20=%20%7B%7D;%5Cn%20%20let%20ctn%20=%20document.createElement(%5C%22div%5C%22);%5Cn%20%20ctn.innerHTML%20=%20%60%5Cn%20%20%20%20%3Cdiv%20class=%5C%22tabs-header%5C%22%3E%3C/div%3E%5Cn%20%20%20%20%3Cdiv%20class=%5C%22tabs-content%5C%22%3E%3C/div%3E%60;%5Cn%5Cn%20%20const%20tabsHeaderEl%20=%20ctn.querySelector('.tabs-header');%5Cn%20%20const%20tabsContentEl%20=%20ctn.querySelector('.tabs-content');%5Cn%5Cn%20%20//%20Function%20to%20handle%20tab%20click%5Cn%20%20function%20handleTabClick(event)%20%7B%5Cn%20%20%20%20let%20clickedTab%20=%20event.target;%5Cn%20%20%20%20if(!clickedTab.classList.contains('tab'))%20return;%5Cn%20%20%20%20%5Cn%20%20%20%20if(event.target.classList.contains('addCustomChannel'))%20%7B%5Cn%20%20%20%20%20%20let%20name%20=%20prompt(%5C%22Choose%20a%20channel%20name.%20Others%20will%20only%20see%20this%20channel%20if%20they%20also%20add%20it.%20Start%20the%20name%20with%20an%20exclaimation%20mark%20to%20remove%20an%20existing%20channel.%5C%22);%5Cn%20%20%20%20%20%20if(name)%20%7B%5Cn%20%20%20%20%20%20%20%20let%20removeChannel%20=%20false;%5Cn%20%20%20%20%20%20%20%20if(name.startsWith(%5C%22!%5C%22))%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20removeChannel%20=%20true;%5Cn%20%20%20%20%20%20%20%20%20%20name%20=%20name.slice(1);%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20name%20=%20name.toLowerCase();%5Cn%20%20%20%20%20%20%20%20name%20=%20name.replace(/%5B%5Ea-z0-9%5C%5C-%5D/g,%20%5C%22%5C%22);%5Cn%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20if(!name)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20alert(%5C%22Channel%20names%20can%20only%20contain%20lower-case%20letters,%20numbers%20and%20hyphens.%5C%22);%5Cn%20%20%20%20%20%20%20%20%20%20return;%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20if(name%20===%20%5C%22t2i-feedback%5C%22)%20return;%5Cn%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20if(!localStorage.__t2iFrameworkCustomChannels)%20localStorage.__t2iFrameworkCustomChannels%20=%20%5C%22%7B%7D%5C%22;%5Cn%20%20%20%20%20%20%20%20let%20customChannels%20=%20%7B%7D;%5Cn%20%20%20%20%20%20%20%20try%20%7B%20customChannels%20=%20JSON.parse(localStorage.__t2iFrameworkCustomChannels)%20%7D%20catch(e)%20%7B%20console.error(%5C%22Failed%20to%20parse%20custom%20channels%20from%20localStorage:%5C%22,%20e);%20%7D%5Cn%20%20%20%20%20%20%20%20if(removeChannel)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20delete%20customChannels%5Bname%5D;%5Cn%20%20%20%20%20%20%20%20%20%20tabsHeaderEl.querySelector(%60%5Bdata-name='$%7Bname%7D'%5D%60).remove();%5Cn%20%20%20%20%20%20%20%20%20%20tabsContentEl.querySelector(%60%5Bdata-name='$%7Bname%7D'%5D%60).remove();%5Cn%20%20%20%20%20%20%20%20%20%20showTabByName(tabsHeaderEl.firstElementChild.dataset.name);%5Cn%20%20%20%20%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20if(!customChannels%5Bname%5D)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20customChannels%5Bname%5D%20=%20%7Bname:name,%20label:name%7D;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20let%20item%20=%20JSON.parse(JSON.stringify(customChannels%5Bname%5D));%5Cn%20%20%20%20%20%20%20%20%20%20%20%20item.content%20=%20createCustomTabContent(item);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20addTab(item);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20tabsHeaderEl.append(event.target);%20//%20move%20%5C%22+%5C%22%20button%20to%20the%20end%5Cn%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20showTabByName(name);%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20localStorage.__t2iFrameworkCustomChannels%20=%20JSON.stringify(customChannels);%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20return;%5Cn%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20showTabByName(clickedTab.dataset.name);%5Cn%20%20%20%20%7D%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20function%20showTabByName(name)%20%7B%5Cn%20%20%20%20tabsHeaderEl.querySelectorAll('.tab').forEach(el%20=%3E%20el.classList.remove('active-tab'));%5Cn%20%20%20%20tabsHeaderEl.querySelector(%60.tab%5Bdata-name='$%7Bname%7D'%5D%60).classList.add('active-tab');%5Cn%20%20%20%20%5Cn%20%20%20%20tabsContentEl.querySelectorAll('.tab-content').forEach(el%20=%3E%20el.classList.remove('active-content'));%5Cn%20%20%20%20tabsContentEl.querySelector(%60.tab-content%5Bdata-name='$%7Bname%7D'%5D%60).classList.add('active-content');%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20function%20addTab(item)%20%7B%5Cn%20%20%20%20const%20tab%20=%20document.createElement('div');%5Cn%20%20%20%20tab.className%20=%20'tab';%5Cn%20%20%20%20tab.textContent%20=%20item.label;%5Cn%20%20%20%20tab.dataset.name%20=%20item.name;%5Cn%5Cn%20%20%20%20const%20tabContent%20=%20document.createElement('div');%5Cn%20%20%20%20tabContent.className%20=%20'tab-content';%5Cn%20%20%20%20tabContent.innerHTML%20=%20item.content;%5Cn%20%20%20%20tabContent.dataset.name%20=%20item.name;%5Cn%20%20%20%20%5Cn%20%20%20%20tabsHeaderEl.appendChild(tab);%5Cn%20%20%20%20tabsContentEl.appendChild(tabContent);%5Cn%20%20%20%20return%20%7Btab,%20tabContent%7D;%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20function%20createCustomTabContent(item)%20%7B%5Cn%20%20%20%20let%20commentOptions%20=%20JSON.parse(JSON.stringify(item));%5Cn%20%20%20%20let%20defaultCommentOptions%20=%20window.___userSettings746291937.defaultCommentOptions;%5Cn%20%20%20%20for(let%20key%20of%20defaultCommentOptions.getAllKeys)%20%7B%5Cn%20%20%20%20%20%20commentOptions%5Bkey%5D%20=%20defaultCommentOptions%5Bkey%5D;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20if(localStorage.forceColorScheme)%20%7B%5Cn%20%20%20%20%20%20commentOptions.forceColorScheme%20=%20localStorage.forceColorScheme;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20commentOptions.channel%20=%20commentOptions.name;%5Cn%20%20%20%20delete%20commentOptions.name;%5Cn%20%20%20%20return%20window.___commentsPlugin746291937(commentOptions);%5Cn%20%20%7D%5Cn%5Cn%20%20let%20i%20=%200;%5Cn%20%20for(let%20item%20of%20items)%20%7B%5Cn%20%20%20%20let%20%7Btab,%20tabContent%7D%20=%20addTab(item);%5Cn%20%20%20%20if(i%20===%200)%20%7B%5Cn%20%20%20%20%20%20tabContent.classList.add('active-content');%5Cn%20%20%20%20%20%20tab.classList.add('active-tab');%5Cn%20%20%20%20%7D%5Cn%20%20%20%20i++;%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20if(opts.allowCustomChannels)%20%7B%5Cn%20%20%20%20//%20add%20user-specified%20custom%20channels:%5Cn%20%20%20%20if(!localStorage.__t2iFrameworkCustomChannels)%20localStorage.__t2iFrameworkCustomChannels%20=%20%5C%22%7B%7D%5C%22;%5Cn%20%20%20%20let%20customChannels%20=%20%7B%7D;%5Cn%20%20%20%20try%20%7B%20customChannels%20=%20JSON.parse(localStorage.__t2iFrameworkCustomChannels)%20%7D%20catch(e)%20%7B%20console.error(%5C%22Failed%20to%20parse%20custom%20channels%20from%20localStorage:%5C%22,%20e);%20%7D%5Cn%20%20%20%20for(let%20item%20of%20Object.values(customChannels))%20%7B%5Cn%20%20%20%20%20%20let%20itemCopy%20=%20JSON.parse(JSON.stringify(item));%5Cn%20%20%20%20%20%20itemCopy.content%20=%20createCustomTabContent(itemCopy);%5Cn%20%20%20%20%20%20addTab(itemCopy);%5Cn%20%20%20%20%7D%5Cn%20%20%20%20//%20add%20the%20%5C%22+%5C%22%20button:%5Cn%20%20%20%20const%20tab%20=%20document.createElement('div');%5Cn%20%20%20%20tab.className%20=%20'tab%20addCustomChannel';%5Cn%20%20%20%20tab.textContent%20=%20%5C%22+%5C%22;%5Cn%20%20%20%20tab.style.cssText%20=%20%5C%22min-width:1.4rem;%5C%22;%5Cn%20%20%20%20tabsHeaderEl.appendChild(tab);%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20tabsHeaderEl.addEventListener('click',%20handleTabClick);%5Cn%5Cn%20%20return%20ctn;%5Cn%5Cn%5Cn%5Cn%5Cnasync%20showModal(html)%20=%3E%5Cn%20%20if(!html)%20html%20=%20%5C%22%3Cp%3E?%3C/p%3E%5C%22;%5Cn%20%20return%20new%20Promise(resolve%20=%3E%20%7B%5Cn%20%20%20%20const%20overlay%20=%20Object.assign(document.createElement(%5C%22div%5C%22),%20%7B%20tabIndex:%200%20%7D);%5Cn%20%20%20%20overlay.style.cssText%20=%20%60position:fixed;inset:0;z-index:9999;display:grid;place-items:center;background-color:rgba(0,0,0,.65);font:16px/1.4%20system-ui%60;%5Cn%20%20%20%20overlay.innerHTML%20=%20%60%3Cdiv%20style=%5C%22position:relative;%5C%22%3E%5Cn%20%20%20%20%20%20%3Cbutton%20style=%5C%22position:absolute;z-index:10;top:-12px;right:-12px;width:28px;height:28px;border:none;border-radius:50%25;background-color:light-dark(#fff,#444);color:light-dark(#666,#aaa);cursor:pointer;font-size:18px;line-height:1;padding:0;box-shadow:0%202px%204px%20rgba(0,0,0,.2);%5C%22%3E%E2%9C%95%3C/button%3E%5Cn%20%20%20%20%20%20%3Cdiv%20style=%5C%22text-align:left%20!important;border-radius:8px;background-color:light-dark(#fff,#222);color:light-dark(#000,#fff);box-shadow:0%202px%208px%20rgba(0,0,0,.2);%5C%22%3E%5Cn%20%20%20%20%20%20%20%20$%7Bhtml%7D%5Cn%20%20%20%20%20%20%3C/div%3E%5Cn%20%20%20%20%3C/div%3E%60;%5Cn%20%20%20%20const%20%5Bwrapper,%20closeBtn%5D%20=%20%5Boverlay.firstChild,%20overlay.querySelector(%5C%22button%5C%22)%5D;%5Cn%20%20%20%20const%20finish%20=%20()%20=%3E%20%7B%20overlay.remove();%20resolve();%20%7D;%5Cn%20%20%20%20closeBtn.onclick%20=%20finish;%5Cn%20%20%20%20overlay.onmousedown%20=%20e%20=%3E%20%7B%20if(e.target%20===%20overlay)%20finish();%20%7D;%5Cn%20%20%20%20overlay.onkeydown%20=%20e%20=%3E%20%7B%20if(e.key%20===%20%5C%22Escape%5C%22)%20finish();%20%7D;%5Cn%20%20%20%20document.body.append(overlay);%5Cn%20%20%7D);%5Cn%5Cnasync%20confirmAsync(message,%20opts)%20=%3E%5Cn%20%20if(!opts)%20opts%20=%20%7B%7D;%5Cn%20%20if(!message)%20message%20=%20%5C%22Are%20you%20sure?%5C%22%5Cn%20%20return%20new%20Promise(resolve%20=%3E%20%7B%5Cn%20%20%20%20const%20overlay%20=%20Object.assign(document.createElement(%5C%22div%5C%22),%20%7B%20tabIndex:%200%20%7D);%5Cn%20%20%20%20overlay.style.cssText%20=%20%60position:fixed;inset:0;z-index:9999;display:grid;place-items:center;background-color:rgba(0,0,0,.65);font:16px/1.4%20system-ui%60;%5Cn%20%20%20%20overlay.innerHTML%20=%20%60%3Cdiv%20style=%5C%22text-align:left%20!important;max-width:min(97vw,%20450px);padding:15px;border-radius:8px;background-color:light-dark(#fff,#222);color:light-dark(#000,#fff);box-shadow:0%202px%208px%20rgba(0,0,0,.2);%5C%22%3E%5Cn%20%20%20%20%20%20%3Cp%20style=%5C%22margin:0%200%2020px;white-space:pre-wrap;%5C%22%3E$%7Bmessage.replace(/%5B%3C%3E&%5D/g,%20m%20=%3E%20(%7B%5C%22%3C%5C%22:%5C%22&lt;%5C%22,%5C%22&%5C%22:%5C%22&amp;%5C%22,%5C%22%3E%5C%22:%5C%22&gt;%5C%22%7D%5Bm%5D))%7D%3C/p%3E%5Cn%20%20%20%20%20%20%3Cdiv%20style=%5C%22display:flex;justify-content:flex-end;gap:8px;%5C%22%3E%5Cn%20%20%20%20%20%20%20%20%3Cbutton%20$%7Bopts.hideCancel%20?%20%5C%22hidden%5C%22%20:%20%5C%22%5C%22%7D%20style=%5C%22padding:6px%2016px;border:1px%20solid%20light-dark(#ccc,#555);border-radius:6px;background-color:light-dark(#f6f6f6,#333);color:inherit;cursor:pointer;%5C%22%3ECancel%3C/button%3E%5Cn%20%20%20%20%20%20%20%20%3Cbutton%20autofocus%20style=%5C%22padding:6px%2016px;border:none;border-radius:6px;background-color:light-dark(#1677ff,#2b87ff);color:#fff;cursor:pointer;%5C%22%3EOkay%3C/button%3E%5Cn%20%20%20%20%20%20%3C/div%3E%5Cn%20%20%20%20%3C/div%3E%60;%5Cn%20%20%20%20const%20%5BcancelBtn,%20okBtn%5D%20=%20overlay.querySelectorAll(%5C%22button%5C%22);%5Cn%20%20%20%20const%20finish%20=%20val%20=%3E%20%7B%20overlay.remove();%20resolve(val);%20%7D;%5Cn%20%20%20%20cancelBtn.onclick%20=%20()%20=%3E%20finish(false);%5Cn%20%20%20%20okBtn.onclick%20=%20()%20=%3E%20finish(true);%5Cn%20%20%20%20overlay.onkeydown%20=%20e%20=%3E%20%7B%5Cn%20%20%20%20%20%20if%20(e.key%20===%20%5C%22Escape%5C%22)%20finish(false);%5Cn%20%20%20%20%20%20else%20if%20(e.key%20===%20%5C%22Enter%5C%22)%20finish(true);%5Cn%20%20%20%20%7D;%5Cn%20%20%20%20document.body.append(overlay);%5Cn%20%20%20%20overlay.focus(%7B%20preventScroll:%20true%20%7D);%20//%20enables%20Esc%20handling%20immediately%5Cn%20%20%7D);%5Cn%20%20%5Cn%22,%22imports%22:%5B%22ai-text-plugin%22,%22comments-plugin%22,%22create-media-gallery-plugin%22,%22fullscreen-button-plugin%22,%22prompt2-plugin%22,%22select-leaf-plugin%22,%22t2i-styles%22,%22tabbed-comments-plugin-v1%22,%22text-to-image-plugin%22,%22upload-plugin%22%5D,%22lastEditTime%22:1751824496320,%22found%22:true%7D,%7B%22name%22:%22t2i-styles%22,%22modelText%22:%22//%20note%20that%20%60input%60%20is%20a%20global%20variable%20(i.e.%20%60input%60%20is%20%60window.input%60),%20which%20is%20created%20by%20t2i-framework-plugin%5Cn//%20see%20here%20for%20an%20example%20generator%20that%20imports%20these%20styles:%20https://perchance.org/ai-character-generator#edit%5Cn%5Cn//%20style%20tester:%20https://perchance.org/prompt-style-tester%5Cn%5Cn%5Cn%20%20Painted%20Anime%5Cn%20%20%20%20prompt%20//%20this%20style%20is%20biased%20towards%20female%20characters%20due%20to%20the%20biases%20of%20the%20artists%20mentioned,%20so%20we%20alter%20the%20description%20if%20'male'%20is%20mentioned%20to%20boost%20'maleness'%20and%20supress%20'femaleness'%5Cn%20%20%20%20%20%20%5Binput.description%5D,%20art%20by%20atey%20ghailan,%20painterly%20anime%20style%20at%20pixiv,%20art%20by%20kantoku,%20in%20art%20style%20of%20redjuice/nec%C3%B6mi/rella/tiv%20pixiv%20collab,%20your%20name%20anime%20art%20style,%20masterpiece%20digital%20painting,%20exquisite%20lighting%20and%20composition,%20inspired%20by%20wlop%20art%20style,%208k,%20sharp,%20very%20detailed,%20high%20resolution,%20illustration.%5C%5Cn%5C%5CnOverall,%20it's%20an%20absolute%20world-class%20masterpiece%20painterly%20anime-inspired%20digital%20art.%20It's%20an%20aesthetically%20pleasing%20painterly%20anime-inspired%20digital%20artwork%20with%20impeccable%20attention%20to%20detail%20and%20impressive%20composition.%20%5E2%5Cn%20%20%20%20%20%20painterly%20anime%20artwork,%20%5Binput.description%5D,%20world-class%20masterpiece,%20fine%20details,%20breathtaking%20artwork,%20painterly%20art%20style,%20high%20quality,%208k,%20very%20detailed,%20high%20resolution,%20exquisite%20composition%20and%20lighting.%5C%5Cn%5C%5CnOverall,%20it's%20an%20absolute%20world-class%20masterpiece%20painterly%20anime%20artwork.%20It's%20an%20aesthetically%20pleasing%20painterly%20anime%20artwork%20with%20impeccable%20attention%20to%20detail%20and%20impressive%20composition.%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Banime:100,%20painting:100,%20paintedAnime:100,%20drawing:55,%20cartoon:50%7D)%5D%5Cn%20%20%20%20modifiers%20=%20%5BanimeModifiers%5D%5Cn%20%20Casual%20Photo%5Cn%20%20%20%20prompt%20=%20A%20casual%20photo%20of%20%5Binput.description%5D.%20It's%20a%20casual%20photo.%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bphoto:98,%20casualPhoto:100,%20portrait:80%7D)%5D%5Cn%20%20%20%20modifiers%5Cn%20%20%20%20%20%20shot%20=%20%5BphotoModifiers.shot%5D%5Cn%20%20%20%20%20%20color%20=%20%5BphotoModifiers.color%5D%5Cn%20%20%20%20%20%20effect%20=%20%5BphotoModifiers.effect%5D%5Cn%20%20Cinematic%5Cn%20%20%20%20prompt%20=%20%5Binput.description%5D,%20cinematic%20shot,%20dynamic%20lighting,%2075mm,%20Technicolor,%20Panavision,%20cinemascope,%20sharp%20focus,%20fine%20details,%208k,%20HDR,%20realism,%20realistic,%20key%20visual,%20film%20still,%20cinematic%20color%20grading,%20depth%20of%20field.%5C%5Cn%5C%5CnOverall,%20it's%20an%20absolute%20world-class%20cinematic%20masterpiece.%20It's%20an%20aesthetically%20pleasing%20cinematic%20shot%20with%20impeccable%20attention%20to%20detail%20and%20impressive%20composition.%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bphoto:100,%20portrait:85,%20render:70,%20cinematic:100%7D)%5D%5Cn%20%20%20%20modifiers%5Cn%20%20%20%20%20%20shot%20=%20%5BphotoModifiers.shot%5D%5Cn%20%20%20%20%20%20color%20=%20%5BphotoModifiers.color%5D%5Cn%20%20%20%20%20%20effect%20=%20%5BphotoModifiers.effect%5D%5Cn%20%20%20%20%20%20genre%5Cn%20%20%20%20%20%20%20%20adventure%20=%20,%20adventure%5Cn%20%20%20%20%20%20%20%20b-horror%20=%20,%20b-horror%20film%20screencap%5Cn%20%20%20%20%20%20%20%20epic%20fantasy%20=%20,%20epic%20fantasy%5Cn%20%20%20%20%20%20%20%20sci-fi%20=%20,%20sci-fi%5Cn%20%20%20%20%20%20%20%20film%20noir%20=%20,%20film%20noir%5Cn%20%20%20%20%20%20%20%20horror%20=%20,%20horror%5Cn%20%20%20%20%20%20%20%20indie%20=%20,%20indie%20film%20screencap%5Cn%20%20%20%20%20%20%20%20western%20=%20,%20western,%20wild%20west%5Cn%20%20%20%20%20%20%20%20thriller%20=%20,%20thriller%5Cn%20%20Digital%20Painting%5Cn%20%20%20%20prompt%20=%20%5Binput.description%5D,%20breathtaking%20digital%20art,%20trending%20on%20artstation,%20by%20atey%20ghailan,%20by%20greg%20rutkowski,%20by%20greg%20tocchini,%20by%20james%20gilleard,%208k,%20high%20resolution,%20best%20quality.%5C%5Cn%5C%5CnOverall,%20it's%20an%20absolute%20world-class%20masterpiece%20digital%20painting.%20It's%20an%20aesthetically%20pleasing%20digital%20painting%20with%20impeccable%20attention%20to%20detail%20and%20impressive%20composition.%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bpainting:90,%20landscape:70,%20digitalPainting:100,%20drawing:60%7D)%5D%5Cn%20%20Concept%20Art%5Cn%20%20%20%20prompt%20=%20%5Binput.description%5D,%20concept%20art,%20digital%20art,%20illustration,%20inspired%20by%20wlop%20style,%208k,%20fine%20details,%20sharp,%20very%20detailed,%20high%20resolution,%20world-class%20masterpiece.%5C%5Cn%5C%5CnOverall,%20it's%20absolute%20world-class%20masterpiece%20concept%20art.%20It's%20an%20aesthetically%20pleasing%20concept%20art%20with%20impeccable%20attention%20to%20detail%20and%20impressive%20composition.%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bpainting:50,%20landscape:70%7D)%5D%5Cn%20%20%20%20modifiers%5Cn%20%20%20%20%20%20modifier%5Cn%20%20%20%20%20%20%20%20league%20of%20legends%20=%20,%20league%20of%20legends%20style%20concept%20art%5Cn%20%20%20%20%20%20%20%20epic%20fantasy%20=%20,%20epic%20fantasy%20concept%20art%20by%20noah%20bradley%5Cn%20%20%20%20%20%20%20%20sci-fi%20=%20,%20sci-fi%20concept%20art%5Cn%20%20%20%20%20%20%20%20horror%20=%20,%20horror%20concept%20art%5Cn%20%20%20%20%20%20%20%20western%20=%20,%20western,%20wild%20west%20concept%20art%5Cn%20%203D%20Disney%20Character%5Cn%20%20%20%20prompt%20=%203D%20cartoon%20Disney%20character%20portrait%20render.%20%5Binput.description%5D,%20bokeh,%204k,%20highly%20detailed,%20Pixar%20render,%20CGI%20Animation,%20Disney,%20cute%20big%20circular%20reflective%20eyes,%20dof,%20cinematic%20film,%20Disney%20realism,%20subtle%20details,%20breathtaking%20Pixar%20short,%20fine%20details,%20close%20up,%20sharp%20focus,%20HDR,%20Disney-style%20octane%20render,%20incredible%20composition,%20superb%20lighting%20and%20detail,%20%5Binput.description%5D.%5C%5Cn%5C%5CnOverall,%20it's%20an%20absolute%20world-class%20masterpiece%203D%20Disney-inspired%20Character.%20It's%20an%20aesthetically%20pleasing%203D%20Disney-inspired%20piece%20with%20impeccable%20attention%20to%20detail%20and%20impressive%20composition.%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bdisney:95,%20render:80,%20portrait:75,%20cartoon:90%7D)%5D%5Cn%20%202D%20Disney%20Character%5Cn%20%20%20%20prompt%20=%202D%20cartoon%20Disney%20character%20digital%20art%20of%20%5Binput.description%5D.%20superb%20linework,%20classic%202D%20Disney%20style%20art,%20inspired%20by%20the%20art%20styles%20of%20Glen%20Keane%20and%20Aaron%20Blaise,%20Disney-style%20character%20concept%20with%20a%20Disney-style%20face,%20trending%20on%20artstation,%20Disney-style%20version%20of%20%5Binput.description%5D.%5C%5Cn%5C%5CnOverall,%20it's%20an%20absolute%20world-class%20masterpiece%202D%20Disney-inspired%20Character.%20It's%20an%20aesthetically%20pleasing%202D%20Disney-inspired%20piece%20with%20impeccable%20attention%20to%20detail%20and%20impressive%20composition.%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bdisney:90,%20portrait:75,%20cartoon:100,%20comic:80,%20drawing:75%7D)%5D%5Cn%20%20Disney%20Sketch%5Cn%20%20%20%20prompt%20=%20Glen%20Keane%20character%20concept%20art%20black%20and%20white%20pencil%20sketch%20of%20%5Binput.description%5D.%20rough%20pencil%20sketch%20by%20Glen%20Keane,%20rough%20pencil%20sketch,%20close%20up,%20loose%20Disney-style%20character%20concept%20art%20sketch,%20nice%20sketchy%20pencil%20strokes,%20Disney%20character%20design%20sketch,%20pencil%20texture,%20a%20concept%20art%20pencil%20sketch%20of%20%5Binput.description%5D,%20by%20Glen%20Keane.%5C%5Cn%5C%5CnOverall,%20it's%20an%20charmingly%20aesthetic%20and%20well-composed%20Disney-style%20sketch.%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bdisney:90,%20cartoon:85,%20sketch:80,%20comic:80,%20drawing:70%7D)%5D%5Cn%20%20Concept%20Sketch%5Cn%20%20%20%20prompt%20=%20black%20and%20white%20technical%20drawing%20showcasing%20%7Ba%7D%20%5Binput.description%5D,%20annotation%20details,%20world-class%20masterpiece%20black%20and%20white,%20pencil%20strokes,%20annotated%20technical%20concept%20art%20sketch,%20pencil%20texture.%5C%5Cn%5C%5CnOverall,%20it's%20a%20charmingly%20aesthetic%20and%20well-composed%20concept%20sketch.%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bsketch:75,%20comic:50,%20drawing:75%7D)%5D%20%5Cn%20%20Painterly%5Cn%20%20%20%20prompt%20=%20painterly%20digital%20painting,%20%5Binput.description%5D,%20digital%20painting%20by%20Ilya%20Kuvshinov%20with%20painterly%20brush%20strokes,%20by%20Ilya%20Kuvshinov,%20world-class%20painterly%20masterpiece.%5C%5Cn%5C%5CnOverall,%20it's%20an%20absolute%20world-class%20masterpiece%20painterly%20digital%20painting.%20It's%20an%20aesthetically%20pleasing%20painterly%20digital%20painting%20with%20impeccable%20attention%20to%20detail%20and%20impressive%20composition.%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bpainting:85,%20landscape:65,%20digitalPainting:95,%20drawing:45%7D)%5D%5Cn%20%20Oil%20Painting%5Cn%20%20%20%20prompt%20=%20breathtaking%20alla%20prima%20oil%20painting,%20%5Binput.description%5D,%20close%20up,%20alla%20prima%20style,%20oil%20on%20linen,%20painterly%20oil%20on%20canvas,%20painterly%20style,%20exquisite%20composition%20and%20lighting,%20modern%20painterly%20masterpiece,%20by%20alexi%20zaitsev,%20award-winning%20painterly%20alla%20prima%20oil%20painting.%5C%5Cn%5C%5CnOverall,%20it's%20an%20absolute%20world-class%20masterpiece%20oil%20painting.%20It's%20an%20aesthetically%20pleasing%20oil%20painting%20with%20impeccable%20attention%20to%20detail%20and%20impressive%20composition.%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bpainting:87,%20oilPainting:100,%20landscape:60,%20portrait:65,%20drawing:40%7D)%5D%5Cn%20%20Oil%20Painting%20-%20Realism%5Cn%20%20%20%20prompt%20=%20breathtaking%20oil%20painting,%20%5Binput.description%5D,%20photorealistic%20oil%20painting,%20by%20charlie%20bowater,%20fine%20details,%20by%20wlop,%20trending%20on%20artstation,%20very%20detailed.%5C%5Cn%5C%5CnOverall,%20it's%20an%20absolute%20world-class%20masterpiece%20realism%20oil%20painting.%20It's%20an%20aesthetically%20pleasing%20realism%20oil%20painting%20with%20impeccable%20attention%20to%20detail%20and%20impressive%20composition.%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bpainting:87,%20oilPainting:95,%20landscape:60,%20portrait:70,%20drawing:40%7D)%5D%5Cn%20%20Oil%20Painting%20-%20Old%5Cn%20%20%20%20prompt%20=%20%5Binput.description%5D,%20Oil%20painting%20by%20Jean-Fran%C3%A7ois%20Millet%20and%20Gustave%20Courbet%20and%20Jules%20Breton%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bpainting:85,%20oilPainting:90,%20vintage:40,%20landscape:55,%20portrait:65,%20drawing:35%7D)%5D%5Cn%20%20Oil%20Painting%20-%2070s%20Pulp%5Cn%20%20%20%20prompt%20=%201970s%20vintage%20pulp%20art,%20ultra%20realistic,%20fully%20restored,%20exquisite%20lighting%20and%20composition,%20polished,%20masterpiece,%20vintage%20pulp%20art,%20by%20Earle%20K.%20Bergey,%20by%20Kelly%20Freas,%20by%20Alex%20Schomburg,%20by%20H.%20J.%20Ward,%20glossy%20pulp%20art,%20Amazing%20Stories,%20Weird%20Tales,%208k,%20high%20resolution,%20best%20quality,%20hyper-realistic,%20Mattias%20Adolfsson%20style,%20detailed%20stylization,%20%5Binput.description%5D,%20ultra%20realistic,%20wlop-style,%20exquisite%20lighting%20and%20composition,%20polished,%20world-class%20masterpiece,%20digitally%20enhanced,%20breathtaking%20shot,%20subtle%20details,%20superb%20quality,%20art%20by%20Kuvshinov,%20Kuvshinov%20style,%20detailed%20stylization.%5C%5Cn%5C%5CnOverall,%20it's%20an%20absolute%20world-class%20masterpiece%20artwork.%20It's%20an%20aesthetically%20pleasing%20restored%201970s%20vintage%20pulp%20art%20with%20impeccable%20attention%20to%20detail%20and%20impressive%20composition.%20It%20has%20perfect%20contrast%20and%20color%20balance.%20Almost%20photorealism.%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D,%20scratches,%20faded,%20washed%20out,%20grainy,%20dirty%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bpainting:80,%20oilPainting:85,%20vintage:50,%20landscape:20,%20portrait:60,%20drawing:35%7D)%5D%5Cn%20%20Professional%20Photo%5Cn%20%20%20%20prompt%20=%20%5Binput.description%5D,%20%7Bsharp%7Csoft%7D%20focus,%20depth%20of%20field,%208k%20photo,%20HDR,%20professional%20lighting,%20taken%20with%20Canon%20EOS%20R5,%20DSLR,%2075mm%20lens%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bphoto:95,%20portrait:60%7D)%5D%5Cn%20%20%20%20modifiers%5Cn%20%20%20%20%20%20shot%20=%20%5BphotoModifiers.shot%5D%5Cn%20%20%20%20%20%20color%20=%20%5BphotoModifiers.color%5D%5Cn%20%20%20%20%20%20effect%20=%20%5BphotoModifiers.effect%5D%5Cn%20%20Anime%5Cn%20%20%20%20prompt%20=%20anime%20art%20of%20%5Binput.description%5D,%20world-class%20masterpiece,%204k,%20best%20quality,%20anime%20art.%5C%5Cn%5C%5CnOverall,%20it's%20an%20absolute%20world-class%20masterpiece%20anime-inspired%20artwork.%20It's%20an%20aesthetically%20pleasing%20anime%20art%20with%20impeccable%20attention%20to%20detail%20and%20beautiful%20composition.%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D%5Cn%20%20%20%20meta:tags%20=%20%5B(%7BbasicAnime:100,%20anime:60,%20drawing:50,%20cartoon:30%7D)%5D%5Cn%20%20%20%20modifiers%20=%20%5BanimeModifiers%5D%5Cn%20%20Drawn%20Anime%5Cn%20%20%20%20prompt%20=%20anime-style%20illustration%20with%20perfect%20clean%20lines,%20illustration%20of%20%5Binput.description%5D,%20anime%20drawing/art,%20bold%20linework,%20illustration,%20cel%20shaded,%20anime-style%20digital%20illustration.%20It's%20an%20anime-inspired%202D-style%20anime%20illustration.%20Aesthetic%20high-skill,%20professional%20anime%20illustration,%20which%20looks%20like%20a%20screencap%20from%20an%20anime%20series.%20It%20has%20clean%20line%20work%20and%20a%20pleasant,%20appealing%20drawn%20aesthetic%20style.%20Overall,%20it's%20a%20world-class%20illustration%20with%20flawless%20line%20work,%20perfect%20composition,%20and%20impeccable%20attention%20to%20detail.%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Banime:60,%20drawing:85,%20drawnAnime:100,%20cartoon:40%7D)%5D%5Cn%20%20%20%20modifiers%20=%20%5BanimeModifiers%5D%5Cn%20%20Anime%20Screencap%5Cn%20%20%20%20prompt%20=%20Anime%20screencap,%20%5Binput.description%5D.%20It's%20an%20anime%20screencap%20from%20a%20popular%20anime.%20Beautiful%20visual%20quality,%20remastered,%20extremely%20high%20quality,%20very%20aesthetic,%20high%20production%20value,%20high-skill%20masterpiece.%20The%20image%20shows%20impeccable%20and%20beautiful%20composition%20and%20contrast.%20It's%20an%20exquisite%20anime%20screencap%20style%20image.%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D,%20faded,%20washed%20out,%20low%20quality%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Banime:65,%20drawing:80,%20cartoon:45%7D)%5D%5Cn%20%20%20%20modifiers%20=%20%5BanimeModifiers%5D%5Cn%20%20Cute%20Anime%5Cn%20%20%20%20prompt%20=%20adorable,%20cute,%20kawaii,%20%5Binput.description%5D,%20cute%20moe%20anime%20character%20portrait,%20adorable,%20featured%20on%20pixiv,%20kawaii%20mo%C3%A9%20masterpiece,%20cuteness%20overload,%20very%20detailed,%20sooooo%20adorable.%5C%5Cn%5C%5CnOverall,%20it's%20an%20absolute%20world-class%20masterpiece%20anime-inspired%20artwork.%20It's%20an%20aesthetically%20pleasing%20anime%20art%20with%20impeccable%20attention%20to%20detail%20and%20beautiful%20composition.%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Banime:55,%20drawing:50,%20cuteAnime:100,%20cartoon:30%7D)%5D%5Cn%20%20%20%20modifiers%20=%20%5BanimeModifiers%5D%5Cn%20%20Soft%20Anime%5Cn%20%20%20%20prompt%20=%20%5Binput.description%5D,%20anime%20masterpiece%20with%20soft%20lighting,%20gentle%20intricate%20style,%20highly%20detailed,%20pixiv,%20anime%20art,%204k,%20art%20from%20your%20name%20anime,%20garden%20of%20words%20style%20art,%20high%20quality.%5C%5Cn%5C%5CnOverall,%20it's%20an%20absolute%20world-class%20masterpiece%20soft%20beautiful%20anime-inspired%20artwork.%20It's%20an%20aesthetically%20pleasing,%20soft,%20beautiful%20anime%20art%20with%20impeccable%20attention%20to%20detail%20and%20beautiful%20composition.%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Banime:50,%20drawing:50,%20cartoon:30%7D)%5D%5Cn%20%20%20%20modifiers%20=%20%5BanimeModifiers%5D%5Cn%20%20Fantasy%20Painting%5Cn%20%20%20%20prompt%20=%20%5Binput.description%5D,%20d&d,%20fantasy,%20highly%20detailed,%20digital%20painting,%20artstation,%20sharp%20focus,%20fantasy%20art,%20illustration,%208k,%20in%20the%20style%20of%20greg%20rutkowski.%20It's%20an%20absolute%20world-class%20masterpiece%20artwork.%20It's%20an%20aesthetically%20pleasing%20artwork%20with%20impeccable%20attention%20to%20detail%20and%20impressive%20composition.%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bpainting:50,%20landscape:80,%20fantasy:80%7D)%5D%5Cn%20%20Fantasy%20Landscape%5Cn%20%20%20%20prompt%20=%20%5Binput.description%5D,%20fantasy%20matte%20painting,%20absolute%20masterpiece,%20detailed%20matte%20painting%20by%20andreas%20rocha%20and%20greg%20rutkowski,%20by%20Brothers%20Hildebrandt,%20superb%20composition,%20vivid%20fantasy%20art,%20breathtaking%20fantasy%20masterpiece.%20It's%20an%20absolute%20world-class%20masterpiece%20artwork.%20It's%20an%20aesthetically%20pleasing%20artwork%20with%20impeccable%20attention%20to%20detail%20and%20impressive%20composition.%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bpainting:30,%20poster:30,%20coverArt:50,%20vintage:30,%20landscape:90,%20fantasy:20%7D)%5D%5Cn%20%20%20%20modifiers%5Cn%20%20%20%20%20%20shot%20=%20%5BlandscapeModifiers.shot%5D%5Cn%20%20%20%20%20%20color%20=%20%5BlandscapeModifiers.color%5D%5Cn%20%20%20%20%20%20effect%20=%20%5BlandscapeModifiers.effect%5D%5Cn%20%20Fantasy%20Portrait%5Cn%20%20%20%20prompt%20=%20%5Binput.description%5D,%20d&d,%20fantasy,%20highly%20detailed,%20digital%20painting,%20artstation,%20sharp%20focus,%20fantasy%20art,%20character%20art,%20illustration,%208k,%20art%20by%20artgerm%20and%20greg%20rutkowski.%20It's%20an%20absolute%20world-class%20masterpiece%20artwork.%20It's%20an%20aesthetically%20pleasing%20artwork%20with%20impeccable%20attention%20to%20detail%20and%20impressive%20composition.%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D%5Cn%20%20%20%20meta:tags%20=%20%5B(%7BfantasyPortrait:100,%20painting:50,%20fantasy:70,%20portrait:75%7D)%5D%5Cn%20%20Studio%20Ghibli%5Cn%20%20%20%20prompt%20=%20Studio%20Ghibli%20style%20artwork%20of%20%5Binput.description%5D,%20Studio%20Ghibli%20style%20art%20film%20still,%20sharp,%20very%20detailed,%20high%20resolution,%20inspired%20by%20Hayao%20Miyazaki,%20anime,%20film%20still%20from%20Spirited%20Away.%20In%20the%20style%20of%20Kiki%20Delivery%20Service,%20with%20a%20similar%20art%20style%20to%20Princess%20Mononoke.%20Aesthetically%20similar%20to%20My%20Neighbor%20Totoro's%20art%20style.%5C%5Cn%5C%5CnOverall,%20it's%20an%20absolute%20world-class%20masterpiece%20Studio%20Ghibli-inspired%20artwork.%20It's%20an%20aesthetically%20pleasing%20classic%20Studio%20Ghibli%20style%20artwork%20with%20impeccable%20attention%20to%20detail%20and%20impressive%20composition.%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bghibli:100,%20anime:50,%20cartoon:50%7D)%5D%5Cn%20%2050s%20Enamel%20Sign%5Cn%20%20%20%20prompt%20=%2050s%20enamel%20sign%20of%20%5Binput.description%5D,%2050s%20advert%20enamel%20sign,%20masterpiece,%20authentic%20vintage%20enamel%20sign%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bvintage:85%7D)%5D%5Cn%20%20Vintage%20Comic%5Cn%20%20%20%20prompt%20=%20comic%20book%20style%20art%20of%20%5Binput.description%5D,%20drawing,%20by%20Dave%20Stevens,%20by%20Adam%20Hughes,%201940's,%201950's,%20hand-drawn,%20color,%20high%20resolution,%20best%20quality,%20closeup%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bvintage:80,%20comic:90,%20cartoon:70%7D)%5D%5Cn%20%20%20%20modifiers%5Cn%20%20%20%20%20%20effect%5Cn%20%20%20%20%20%20%20%20retrofuturism%20=%20,%20(retrofuturism,%20atompunk)%5Cn%20%20%20%20%20%20%20%20gritty%20noir%20=%20,%20(gritty%20noir)%5Cn%20%20%20%20%20%20%20%20pop%20art%20=%20,%20(pop%20art%20style)%5Cn%20%20%20%20%20%20%20%20cyberpunk%20=%20,%20(cyberpunk%20aesthetic)%5Cn%20%20%20%20%20%20%20%20steampunk%20=%20,%20(steampunk)%5Cn%20%20%20%20%20%20%20%20watercolor%20=%20,%20(watercolor%20wash)%5Cn%20%20%20%20%20%20%20%20sketchy%20ink%20=%20,%20sketchy%20ink%20work%5Cn%20%20%20%20%20%20%20%20manga%20fusion%20=%20,%20(manga%20fusion)%5Cn%20%20%20%20%20%20%20%20psychedelic%20=%20,%20psychedelic%20imagery%5Cn%20%20%20%20%20%20%20%20pulp%20magazine%20=%20,%20pulp%20magazine%20look%5Cn%20%20%20%20%20%20%20%20heroic%20proportions%20=%20,%20heroic%20proportions%5Cn%20%20Franco-Belgian%20Comic%5Cn%20%20%20%20prompt%20=%20franco-belgian%20color%20comic%20about%20%5Binput.description%5D,%20bande%20dessin%C3%A9e,%20franco-belgian%20comic%20panel,%20masterpiece,%20breathtaking%20composition,%20intricate,%20detailed,%20best%20quality%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bvintage:75,%20comic:85,%20cartoon:75%7D)%5D%5Cn%20%20%20%20modifiers%5Cn%20%20%20%20%20%20modifier%5Cn%20%20%20%20%20%20%20%20single-panel%20=%20,%20splash%20panel,%20full%20cover%20image%5Cn%20%20%20%20%20%20%20%20multi-panel%20=%20,%20multi-panel%20comic%20book%20page,%20comic%20panel%20layout%5Cn%20%20%20%20%20%20%20%20cyberpunk%20=%20,%20(cyberpunk%20aesthetic)%5Cn%20%20%20%20%20%20%20%20steampunk%20=%20,%20(steampunk)%5Cn%20%20%20%20%20%20%20%20manga%20fusion%20=%20,%20(manga%20fusion)%5Cn%20%20%20%20%20%20%20%20psychedelic%20=%20,%20psychedelic%20imagery%5Cn%20%20%20%20%20%20%20%20pulp%20magazine%20=%20,%20pulp%20magazine%20look%5Cn%20%20%20%20%20%20%20%20heroic%20proportions%20=%20,%20heroic%20proportions%5Cn%20%20Tintin%20Comic%5Cn%20%20%20%20prompt%20=%20color%20comic%20panel%20in%20the%20style%20of%20Herg%C3%A9%20about%20%5Binput.description%5D,%20by%20Herg%C3%A9,%20tintin%20style,%20french%20comic%20panel,%20franco-belgian%20style,%20masterpiece,%20high-resolution%20Herg%C3%A9%20style%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bvintage:77,%20comic:87,%20cartoon:77%7D)%5D%5Cn%20%20//%20Vintage%20Comic%5Cn%20%20//%20%20%20prompt%20=%20comic%20book%20style%20art%20of%20%5Binput.description%5D,%20drawing%20by%20Jack%20Kirby,%20Steve%20Ditko%20art,%201940's,%201950's,%20closeup,%20color,%20vintage%20masterpiece,%20best%20quality%5Cn%20%20//%20%20%20negative%20=%20%5Binput.negative%5D,%20worst%20quality,%20low%20resolution,%20fuzzy,%20jpeg%20compression%20artifacts,%20blurry,%20low%20quality%5Cn%20%20//%20%20%20meta:tags%20=%20%5B(%7Bvintage:80,%20comic:90,%20cartoon:70%7D)%5D%5Cn%20%20//%2090s%20Comic%5Cn%20%20//%20%20%20prompt%20=%20%5Binput.description%5D,%2090s%20comic%20book%20artwork,%20colored%20comic%20book%20panel,%20classic%2090s%20style,%20masterpiece%5Cn%20%20//%20%20%20negative%20=%20%5Binput.negative%5D,%20bad%20photo,%20greyscale,%20blurry,%20bad%203D%20render,%20crappy%203D%20art,%20barcode,%20logo,%20bad%20photo%5Cn%20%20//%20%20%20meta:tags%20=%20%5B(%7Bvintage:80,%20comic:80%7D)%5D%5Cn%20%20//%2090s%20Superhero%5Cn%20%20//%20%20%20prompt%20=%20%5Binput.description%5D,%2090s%20comic%20book%20artwork,%20colored%20comic%20book%20panel,%20classic%2090s%20style,%20masterpiece,%20art%20by%20Greg%20Capullo,%20art%20by%20Jim%20Lee,%20art%20by%20Todd%20McFarlane%5Cn%20%20//%20%20%20negative%20=%20%5Binput.negative%5D,%20bad%20photo,%20greyscale,%20blurry,%20bad%203D%20render,%20crappy%203D%20art,%20barcode,%20logo,%20bad%20photo%5Cn%20%20//%20%20%20meta:tags%20=%20%5B(%7Bvintage:80,%20comic:80%7D)%5D%5Cn%20%20Medieval%5Cn%20%20%20%20prompt%20=%20medieval%20illuminated%20manuscript%20picture%20of%20%5Binput.description%5D,%20medieval%20illuminated%20manuscript%20art,%20masterpiece%20medieval%20color%20illustration,%2016th%20century,%208k%20high-resolution%20scan%20of%2016th%20century%20illuminated%20manuscript%20painting,%20detailed%20medieval%20masterpiece.%20%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bvintage:80,%20painting:70,%20portrait:40%7D)%5D%5Cn%20%20Pixel%20Art%5Cn%20%20%20%20prompt%20=%20%5Binput.description.length%20%3E%2040%20?%20%5C%22(pixel%20art),%20%5C%22%20:%20%5C%22%5C%22%5D%5Binput.description%5D,%20best%20pixel%20art,%20neo-geo%20graphical%20style,%20retro%20nostalgic%20masterpiece,%20128px,%2016-bit%20pixel%20art%20%5Binput.description.length%20%3C%2010%20?%20%5C%22of%20%5C%22+input.description%20:%20%5C%22%5C%22%5D,%202D%20pixel%20art%20style,%20adventure%20game%20pixel%20art,%20inspired%20by%20the%20art%20style%20of%20hyper%20light%20drifter,%20masterful%20dithering,%20superb%20composition,%20beautiful%20palette,%20exquisite%20pixel%20detail%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D%5Cn%20%20%20%20meta:tags%20=%20%5B(%7BpixelArt:90,%20vintage:70%7D)%5D%5Cn%20%20%20%20//%20randomPrompt%20=%20%7Bmermaid%7Cgoblin%7D%5Cn%20%20Furry%20-%20Oil%5Cn%20%20%20%20prompt%20=%20%5Binput.description%5D,%20crisp%20vibrant%20detailed%20soft%20painterly%20digital%20art,%20volumetric%20lighting,%20natural%20lighting,%20realistic%20lighting,%20vibrant%20colors,%20crisp%20oil%20painting,%20painterly%20realism,%20depth%20of%20field,%20subtle%20soft%20details,%20vivid,%20fresh,%20striking,%20by%20chunie,%20by%20darkgem,%20by%20honovy,%20by%20zaush,%20by%20anhes,%20by%20puinkey,%20by%20caraid,%20by%20dagasi,%20by%20taranfiddler,%20by%20atey%20ghailan,%20by%20MilletGustave,%20by%20Curbet,%20Charlie%20Bowater,%20lol%20art.%5C%5Cn%5C%5CnOverall,%20it's%20a%20world-class%20painterly%20masterpiece.%20It's%20aesthetically%20pleasing%20digitial%20art%20with%20impeccable%20attention%20to%20detail%20and%20impressive%20composition.%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D%5Cn%20%20%20%20meta:tags%20=%20%5B(%7BfurryOil:100,%20furry:100%7D)%5D%5Cn%20%20%20%20modifiers%20=%20%5BfurryModifiers%5D%5Cn%20%20Furry%20-%20Cinematic%5Cn%20%20%20%20prompt%20=%20%5Binput.description%5D,%20cinematic%20shot,%20dynamic%20lighting,%2075mm,%20Technicolor,%20Panavision,%20cinemascope,%20sharp%20focus,%20fine%20details,%208k,%20HDR,%20realism,%20realistic,%20key%20visual,%20film%20still,%20cinematic%20color%20grading,%20depth%20of%20field.%5C%5Cn%5C%5CnOverall,%20it's%20an%20absolute%20world-class%20masterpiece.%20It's%20an%20aesthetically%20pleasing%20image%20with%20impeccable%20attention%20to%20detail%20and%20impressive%20composition.%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bfurry:97,%20photo:60,%20portrait:40,%20render:75,%20cinematic:65%7D)%5D%5Cn%20%20%20%20modifiers%5Cn%20%20%20%20%20%20effect%20=%20%5BfurryModifiers.effect%5D%5Cn%20%20%20%20%20%20shot%20=%20%5BphotoModifiers.shot%5D%5Cn%20%20%20%20%20%20color%20=%20%5BphotoModifiers.color%5D%5Cn%20%20%20%20%20%20photo%20effect%20=%20%5BphotoModifiers.effect%5D%5Cn%20%20Furry%20-%20Painted%5Cn%20%20%20%20prompt%20=%20anthro%20%5Binput.description%5D%20digital%20art,%20masterpiece,%204k,%20fine%20details.%20It's%20an%20absolute%20world-class%20masterpiece%20artwork.%5C%5Cn%5C%5CnOverall,%20it's%20an%20aesthetically%20pleasing%20artwork%20with%20impeccable%20attention%20to%20detail%20and%20impressive%20composition.%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bfurry:96%7D)%5D%5Cn%20%20%20%20modifiers%20=%20%5BfurryModifiers%5D%5Cn%20%20Furry%20-%20Drawn%5Cn%20%20%20%20prompt%20=%20anthro%20%5Binput.description%5D%20illustration,%20hand-drawn,%20bold%20linework,%20anthro%20illustration,%20cel%20shaded,%204k,%20fine%20details,%20masterpiece.%5C%5Cn%5C%5CnOverall,%20it's%20an%20absolute%20world-class%20masterpiece%20artwork.%20It's%20an%20aesthetically%20pleasing%20artwork%20with%20impeccable%20attention%20to%20detail%20and%20impressive%20composition.%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bfurry:95%7D)%5D%5Cn%20%20%20%20modifiers%20=%20%5BfurryModifiers%5D%20%5Cn%20%20Cute%20Figurine%5Cn%20%20%20%20prompt%20=%20%5Binput.description%5D,%20figurine,%20modern%20Disney%20style,%20octane%20render,%20chibi%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bdisney:20,%20emoji:60%7D)%5D%5Cn%20%203D%20Emoji%5Cn%20%20%20%20prompt%20=%20masterpiece%20%5Binput.description%5D%20cartoon%203D%20emoji%20concept%20render,%20close-up,%20facing%20forward,%20matte%20finish,%203D%20emoji%20render,%20app%20icon,%20simple%20design,%20new%20iOS%2018.4%20style%20%5Binput.description%5D%20emoji%20render,%20simple%20background,%20centered,%20world-class%20masterpiece%20work%20of%20art,%20crisp%20render,%20sharp%20focus,%20charmingly%20aesthetic%20design,%204k,%20soft%20lighting,%20masterpiece%20emoji-style%20figurine%203D%20render,%20pure%20white%20background%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bemoji:90%7D)%5D%5Cn%20%20Illustration%5Cn%20%20%20%20prompt%20=%20breathtaking%20illustration%20of%20%5Binput.description%5D,%20illustration,%20masterpiece,%20breathtaking%20illustration.%5C%5Cn%5C%5CnOverall,%20it's%20an%20absolute%20world-class%20masterpiece%20illustration.%20It's%20an%20aesthetically%20pleasing%20illustration%20with%20impeccable%20attention%20to%20detail%20and%20impressive%20composition.%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Billustration:100,%20drawing:75%7D)%5D%5Cn%20%20Cute%20Illustration%20//%20adapted%20from%20a%20nice%20image%20i%20saw%20by%20'%E3%83%AA%E3%83%A5%E3%82%A6%20%F0%9F%94%B5%F0%9F%90%BA':%20https://aigc.uploads.dev/image/765de3e463f307119a339788690c56c35ca53d8bd19364f533e65c672831c357.jpeg%5Cn%20%20%20%20prompt%20=%20A%20cute%20cartoon%20showing%20%5Binput.description%5D,%20in%20a%20soft,%20cute,%20minimalist,%20webcomic-style%20illustration.%20Line%20art%20is%20somewhat%20bold%20but%20gentle,%20with%20clean%20lines,%20and%20subtle%20variation.%20Colors%20are%20soft,%20flat,%20with%20gentle%20pastel%20tones.%20No%20shading%20except%20for%20light%20inner%20shadows%20or%20simple%20highlights.%20The%20background%20is%20plain%20white%20or%20contains%20a%20light%20wash%20of%20color%20with%20subtle%20textured%20style.%20The%20overall%20scene%20is%20wholesome%20and%20endearing%20like%20a%20page%20from%20a%20Liz%20Climo%20comic.%20Composition%20is%20centered%20with%20space%20around%20the%20character,%20evoking%20authentic%20warmth%20through%20the%20wholesome,%20soft,%20web%20comic%20style.%5C%5Cn%5C%5CnIt's%20an%20aesthetically%20pleasing%20masterpiece,%20showing%20high%20skill%20in%20evoking%20an%20authentic%20and%20beautifully%20minimalist%20style.%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Billustration:99,%20drawing:75%7D)%5D%5Cn%20%20Flat%20Illustration%5Cn%20%20%20%20prompt%20=%20%5Binput.description%5D,%20illustration,%20flat,%202D,%20vector%20art,%20masterpiece,%20made%20with%20adobe%20illustrator,%20behance%20competition%20winner,%20trending%20on%20dribble,%204k,%20high%20resolution,%20crisp%20lines.%5C%5Cn%5C%5CnOverall,%20it's%20an%20absolute%20world-class%20masterpiece%20flat-style%20illustration.%20It's%20an%20aesthetically%20pleasing%20flat-style%20illustration%20with%20impeccable%20attention%20to%20detail%20and%20impressive%20composition.%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Billustration:85,%20drawing:40%7D)%5D%5Cn%20%20Watercolor%5Cn%20%20%20%20prompt%20=%20%5Binput.description%5D,%20(watercolor),%20high%20resolution,%20intricate%20details,%204k,%20wallpaper,%20concept%20art,%20watercolor%20on%20textured%20paper.%5C%5Cn%5C%5CnOverall,%20it's%20an%20absolute%20world-class%20masterpiece%20watercolor%20artwork.%20It's%20an%20aesthetically%20pleasing%20watercolor%20artwork%20with%20impeccable%20attention%20to%20detail%20and%20impressive%20composition.%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bpainting:30%7D)%5D%5Cn%20%201990s%20Photo%5Cn%20%20%20%20prompt%20=%20%5Binput.description%5D,%2090s%20home%20video,%20nostalgic%2090s%20photo,%20taken%20with%20kodak%20disposable%20camera%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bvintage:80%7D)%5D%5Cn%20%20%20%20modifiers%5Cn%20%20%20%20%20%20shot%20=%20%5BphotoModifiers.shot%5D%20%5Cn%20%20%20%20%20%20color%20=%20%5BphotoModifiers.color%5D%5Cn%20%20%20%20%20%20effect%20=%20%5BphotoModifiers.effect%5D%5Cn%20%201980s%20Photo%5Cn%20%20%20%20prompt%20=%20famous%20vintage%2080s%20photo,%20%5Binput.description%5D,%20grainy%20photograph,%2080s%20photo%20with%20film%20grain,%20Kodacolor%20II%2080s%20photo%20with%20vignetting,%20retro,%20r/OldSchoolCool,%2080s%20photo%20with%20wear%20and%20tear%20and%20minor%20creasing%20and%20scratches,%20vintage%20color%20photo%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bphoto:30,%20vintage:90,%20portrait:72%7D)%5D%5Cn%20%20%20%20modifiers%5Cn%20%20%20%20%20%20shot%20=%20%5BphotoModifiers.shot%5D%5Cn%20%20%20%20%20%20effect%20=%20%5BphotoModifiers.effect%5D%5Cn%20%201970s%20Photo%5Cn%20%20%20%20prompt%20=%20famous%20vintage%2070s%20photo,%20%5Binput.description%5D,%20grainy%20photograph,%201970s%20photo%20with%20film%20grain,%2070s%20photo%20with%20vignetting,%20retro,%20r/OldSchoolCool,%2070s%20photo,%20vintage%20photo%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bphoto:30,%20vintage:80%7D)%5D%5Cn%20%20%20%20modifiers%5Cn%20%20%20%20%20%20shot%20=%20%5BphotoModifiers.shot%5D%5Cn%20%20%20%20%20%20effect%20=%20%5BphotoModifiers.effect%5D%5Cn%20%201960s%20Photo%5Cn%20%20%20%20prompt%20=%20famous%20vintage%2060s%20photo,%20%5Binput.description%5D,%20grainy%20photograph,%201960s%20photo%20with%20film%20grain,%2060s%20photo%20with%20vignetting,%20retro,%20r/OldSchoolCool,%2060s%20photo,%20vintage%20photo%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bphoto:30,%20vintage:80%7D)%5D%5Cn%20%20%20%20modifiers%5Cn%20%20%20%20%20%20shot%20=%20%5BphotoModifiers.shot%5D%5Cn%20%20%20%20%20%20effect%20=%20%5BphotoModifiers.effect%5D%5Cn%20%201950s%20Photo%5Cn%20%20%20%20prompt%20=%20famous%20vintage%2050s%20photo,%20%5Binput.description%5D,%20grainy%20photograph,%201950s%20photo%20with%20film%20grain,%201950s%20photo%20with%20vignetting,%20retro,%20r/OldSchoolCool,%201950s%20photo,%20vintage%20photo%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bphoto:30,%20vintage:80%7D)%5D%5Cn%20%20%20%20modifiers%5Cn%20%20%20%20%20%20shot%20=%20%5BphotoModifiers.shot%5D%5Cn%20%20%20%20%20%20effect%20=%20%5BphotoModifiers.effect%5D%5Cn%20%201940s%20Photo%5Cn%20%20%20%20prompt%20=%20famous%20vintage%201940s%20photo,%20%5Binput.description%5D,%20grainy%20photograph,%201940s%20photo%20with%20film%20grain,%201940s%20photo%20with%20vignetting,%20retro,%20r/OldSchoolCool,%201940s%20photo,%20vintage%20photo%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bphoto:30,%20vintage:80%7D)%5D%5Cn%20%20%20%20modifiers%5Cn%20%20%20%20%20%20shot%20=%20%5BphotoModifiers.shot%5D%5Cn%20%20%20%20%20%20effect%20=%20%5BphotoModifiers.effect%5D%5Cn%20%201930s%20Photo%5Cn%20%20%20%20prompt%20=%20famous%20vintage%201930s%20photo,%20%5Binput.description%5D,%20grainy%20photograph,%201930s%20photo%20with%20film%20grain,%201930s%20photo%20with%20vignetting,%20retro,%20r/OldSchoolCool,%201930s%20photo,%20vintage%20photo%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bphoto:30,%20vintage:80%7D)%5D%5Cn%20%20%20%20modifiers%5Cn%20%20%20%20%20%20shot%20=%20%5BphotoModifiers.shot%5D%5Cn%20%20%20%20%20%20effect%20=%20%5BphotoModifiers.effect%5D%5Cn%20%201920s%20Photo%5Cn%20%20%20%20prompt%20=%20famous%20vintage%201920s%20photo,%20%5Binput.description%5D,%201920s%20photo,%20restored%20photograph,%20%7Bsepia%7Cblack%20and%20white%7D,%20historical%20archive%20photo%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bphoto:30,%20vintage:80%7D)%5D%5Cn%20%20%20%20modifiers%5Cn%20%20%20%20%20%20shot%20=%20%5BphotoModifiers.shot%5D%5Cn%20%20%20%20%20%20effect%20=%20%5BphotoModifiers.effect%5D%5Cn%20%20Vintage%20Pulp%20Art%5Cn%20%20%20%20prompt%20=%201970s%20vintage%20pulp%20art,%20%5Binput.description%5D,%20vintage%20pulp%20art,%20by%20Earle%20K.%20Bergey,%20by%20Kelly%20Freas,%20by%20Alex%20Schomburg,%20by%20H.%20J.%20Ward,%20glossy%20pulp%20art,%20Amazing%20Stories,%20Weird%20Tales,%208k,%20high%20resolution,%20best%20quality%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bpainting:30,%20poster:30,%20coverArt:50,%20vintage:60,%20comic:40,%20cartoon:50%7D)%5D%5Cn%20%2050s%20Infomercial%20Anime%5Cn%20%20%20%20prompt%20=%20%5Binput.description%5D,%201950s%20infomercial%20style,%20delicate%20linework,%20paprika%20anime%20art%20style,%20chromatic%20aberration%20glow,%202d%20painted%20cel%20animation,%20soft%20focus,%202D%20pixiv%201950s%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bpainting:30,%20anime:50,%20vintage:60,%20cartoon:50%7D)%5D%5Cn%20%203D%20Pokemon%5Cn%20%20%20%20prompt%20=%20An%20incredibly%20perfect%20high-quality%203D%20render%20of%20a%20pokemon%20creature,%20%5Binput.description%5D,%20%5Binput.pokemonType%20?%20input.pokemonType+%5C%22,%20%5C%22%20:%20%5C%22%5C%22%5D8k%20render,%20beautiful%20pokemon%20digital%20art,%20fakemon,%20pokemon%20creature,%20cryptid,%20fakemon,%20masterpiece,%20soft%20focus,%20best%20quality,%20high%20quality.%20Perfect%20soft%20lighting,%20beautiful%20composition.%20It's%20an%20impressive%20CGI%20image%20from%20the%20upcoming%20Pokemon%20Movie%20%5C%5C(2026%5C%5C).%5C%5Cn%5C%5CnOverall,%20it's%20an%20absolute%20world-class%20masterpiece%203D-rendered%20Pokemon-inspired%20creature.%20It's%20an%20aesthetically%20pleasing%203D%20Pokemon-inspired%20piece%20with%20impeccable%20attention%20to%20detail%20and%20impressive%20composition.%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bpokemon:60%7D)%5D%5Cn%20%20Painted%20Pokemon%5Cn%20%20%20%20prompt%20=%20Beautiful,%20very%20high-quality%20painterly%20digital%20concept%20art,%20%5Binput.description%5D,%20%5Binput.pokemonType%20?%20input.pokemonType+%5C%22,%20%5C%22%20:%20%5C%22%5C%22%5D8k%20digital%20painting%20of%20a%20pokemon,%20amazing%20pokemon%20creature%20art%20by%20piperdraws,%20cryptid%20creations%20by%20Piper%20Thibodeau,%20by%20Naoki%20Saito%20and%20%7BTokiya%7CMitsuhiro%20Arita%7D,%20incredible%20composition.%5C%5Cn%5C%5CnOverall,%20it's%20an%20absolute%20world-class%20masterpiece%20painterly%20Pokemon-inspired%20artwork.%20It's%20an%20aesthetically%20pleasing%20painterly%20Pokemon-inspired%20artwork%20with%20impeccable%20attention%20to%20detail%20and%20impressive%20composition.%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bpokemon:50%7D)%5D%5Cn%20%202D%20Pokemon%5Cn%20%20%20%20prompt%20=%20%5Binput.description%5D,%20%5Binput.pokemonType%20?%20input.pokemonType+%5C%22,%20%5C%22%20:%20%5C%22%5C%22%5Dpokemon%20creature%20concept,%20superb%20line%20art,%20beautiful%20colors%20and%20composition,%202D%20art%20style,%20beautiful%20pokemon%20digital%20art,%20fakemon,%20by%20Sowsow,%20pokemon%20creature,%20cryptid,%20fakemon,%20masterpiece,%20by%20Yuu%20Nishida,%204k.%20The%20Pok%C3%A9mon-like%20creature%20is%20centered%20within%20this%20anime-style%202D%20image.%20It's%20from%20the%20upcoming%20Pokemon%20Movie%20%5C%5C(2026%5C%5C)%20which%20has%20the%20classic%202D%20Pokemon%20art%20style.%5C%5Cn%5C%5CnOverall,%20it's%20an%20absolute%20world-class%20masterpiece%202D%20Pokemon-inspired%20artwork.%20It's%20an%20aesthetically%20pleasing%202D%20Pokemon-inspired%20artwork%20with%20impeccable%20attention%20to%20detail%20and%20impressive%20composition.%20Clean,%20perfect%20linework,%20impeccable%20clean%202D%20anime-inspired%20art%20style.%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D,%20messy,%20garbled,%20confusing,%20incoherent,%20unclear%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bpokemon:70,%20drawing:50,%20cartoon:35%7D)%5D%5Cn%20%20Vintage%20Anime%5Cn%20%20%20%20prompt%20=%20%5Binput.description%5D,%201990s%20anime,%20vintage%20anime,%2090's%20anime%20style,%20by%20hajime%20sorayama,%20by%20greg%20tocchini,%20anime%20masterpiece,%20pixiv,%20akira-style%20art,%20akira%20anime%20art,%204k,%20high%20quality.%5C%5Cn%5C%5CnOverall,%20it's%20an%20absolute%20world-class%20masterpiece%20vintage%20anime%20artwork.%20It's%20an%20aesthetically%20pleasing%20vintage%20anime%20artwork%20with%20impeccable%20attention%20to%20detail%20and%20impressive%20composition.%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Banime:40,%20vintage:50,%20drawing:50%7D)%5D%5Cn%20%20Neon%20Vintage%20Anime%5Cn%20%20%20%20prompt%20=%20%5Binput.description%5D,%20neon%20vintage%20anime%20style,%2090's%20anime%20style,%201990s%20anime,%20hajime%20sorayama,%20greg%20tocchini,%20neon%20vintage%20anime%20masterpiece,%20anime%20art,%204k,%20high%20quality.%5C%5Cn%5C%5CnOverall,%20it's%20an%20absolute%20world-class%20masterpiece%20neon%20vintage%20anime%20artwork.%20It's%20an%20aesthetically%20pleasing%20neon%20vintage%20anime%20artwork%20with%20impeccable%20attention%20to%20detail%20and%20impressive%20composition.%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Banime:30,%20vintage:50%7D)%5D%5Cn%20%20Manga%5Cn%20%20%20%20prompt%20=%20%5Binput.description%5D,%20incredible%20hand-drawn%20manga,%20black%20and%20white,%20by%20Takehiko%20Inoue,%20by%20Katsuhiro%20Otomo%20and%20akira%20toriyama%20manga,%20hand-drawn%20art%20by%20rumiko%20takahashi%20and%20Inio%20Asano,%20Ken%20Akamatsu%20manga%20art.%5C%5Cn%5C%5CnOverall,%20it's%20an%20absolute%20world-class%20masterpiece%20black%20and%20white%20manga-style%20artwork.%20It's%20an%20aesthetically%20pleasing%20black%20and%20white%20manga%20artwork%20with%20impeccable%20attention%20to%20detail%20and%20impressive%20composition.%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Banime:40,%20drawing:50,%20manga:100,%20comic:20,%20cartoon:30%7D)%5D%5Cn%20%20Fantasy%20World%20Map%5Cn%20%20%20%20prompt%20=%20beautiful%20fantasy%20map%20of%20%5Binput.description%5D,%20beautiful%20fantasy%20map%20inspired%20by%20middle%20earth%20and%20azeroth%20and%20discworld%20and%20westeros%20and%20essos%20and%20the%20witcher%20world%20and%20tamriel%20and%20faer%C3%BBn%20and%20thedas,%204k,%20beautiful%20colors,%20crisp,%20high-resolution%20artistic%20map,%20topographic%203D%20terrain,%20artistic%20map.%5C%5Cn%5C%5CnOverall,%20it's%20an%20absolute%20world-class%20masterpiece%20fantasy%20world%20map.%20It's%20an%20aesthetically%20pleasing%20fantasy%20world%20map%20artwork%20with%20impeccable%20attention%20to%20detail%20and%20impressive%20composition.%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bmap:90,%20fantasy:20%7D)%5D%5Cn%20%20Fantasy%20City%20Map%5Cn%20%20%20%20prompt%20=%20an%20aerial%20view%20of%20a%20city,%20TTRPG%20city%20map%20showing%20the%20full%20city,%20%5Binput.description%5D,%20fantasy%20art,%20by%20senior%20environment%20artist,%20beautiful%20fantasy%20map.%5C%5Cn%5C%5CnOverall,%20it's%20an%20absolute%20world-class%20masterpiece%20fantasy%20city%20map.%20It's%20an%20aesthetically%20pleasing%20fantasy%20city%20map%20artwork%20with%20impeccable%20attention%20to%20detail%20and%20impressive%20composition.%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bmap:80,%20fantasy:20%7D)%5D%5Cn%20%20Old%20World%20Map%5Cn%20%20%20%20prompt%20=%20fantasy%20world%20map%20of%20%5Binput.description%5D,%20fantasy%20world%20map,%20highly%20detailed%20digital%20painting,%20fantasy%20art,%20map%20illustration,%208k.%5C%5Cn%5C%5CnOverall,%20it's%20an%20absolute%20world-class%20masterpiece%20old%20world%20map.%20It's%20an%20aesthetically%20pleasing%20old%20world%20style%20map%20artwork%20with%20impeccable%20attention%20to%20detail%20and%20impressive%20composition.%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bmap:70,%20fantasy:20%7D)%5D%5Cn%20%203D%20Isometric%20Icon%5Cn%20%20%20%20prompt%20=%20%5Binput.description%5D,%203D%20isometric%20render%20of%20cute%20%5Binput.description%5D,%203D%20app%20icon,%20clean%20isometric%20design,%20beautiful%20design,%20soft%20gradient%20background,%20soft%20colors,%20centered,%203D%20blender%20render,%20masterpiece,%20best%20quality,%20high%20resolution,%208k%20octane%20render,%20beautiful%20color%20scheme,%20soft%20smooth%20lighting,%20physically%20based%20rendering,%20square%20image,%20high%20polycount%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bicon:90,%20emoji:86%7D)%5D%5Cn%20%20Flat%20Style%20Icon%5Cn%20%20%20%20prompt%20=%20%5Binput.description%5D,%20creative%20icon,%20flat%20style%20icon,%20masterpiece,%20high%20resolution,%20crisp,%20beautiful%20composition%20and%20color%20choice,%20beautiful%20flat%20painted%20style,%20behance%20contest-winner,%20award%20winning%20icon%20illustration,%208k,%20best%20quality%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bicon:80%7D)%5D%5Cn%20%20Flat%20Style%20Logo%5Cn%20%20%20%20prompt%20=%20beautiful%20flat-style%20logo%20design%20depicting%20%5Binput.description%5D,%20creative%20flat-style%20logo%20design,%20trending%20on%20dribbble,%20featured%20on%20behance,%20portfolio%20piece,%20minimal%20flat%20design,%20breathtaking%20graphic%20design,%208k,%20high%20resolution%20vector%20logo,%20plain%20background,%20amazingly%20beautiful%20logo%20design,%20winner%20of%20best%20logo%20award%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bicon:80,%20logo:80%7D)%5D%5Cn%20%20Game%20Art%20Icon%5Cn%20%20%20%20prompt%20=%20%5Binput.description%5D,%20a%20concept%20art%20icon%20for%20league%20of%20legends,%20a%20digital%20art%20logo,%20illustration,%20league%20of%20legends%20style%20icon,%20inspired%20by%20wlop%20style,%208k,%20dota%202%20style%20icon,%20fine%20details,%20sharp,%20very%20detailed%20icon,%20high%20resolution%20rpg%20ability/spell/item%20icon%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bicon:70%7D)%5D%5Cn%20%20Digital%20Painting%20Icon%5Cn%20%20%20%20prompt%20=%20%5Binput.description%5D,%20app%20logo%20icon,%20digital%20art%20pictogram%20icon,%20trending%20on%20artstation,%20app%20icon%20by%20atey%20ghailan,%20app%20icon%20by%20greg%20rutkowski,%20app%20icon%20by%20greg%20tocchini,%20app%20icon%20by%20james%20gilleard,%208k,%20high%20resolution,%20best%20quality%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bicon:60%7D)%5D%5Cn%20%20Concept%20Art%20Icon%5Cn%20%20%20%20prompt%20=%20%5Binput.description%5D,%20a%20concept%20art%20icon,%20a%20digital%20art%20logo,%20illustration,%20league%20of%20legends%20style%20concept%20art%20logo%20icon,%20inspired%20by%20wlop%20style,%208k,%20fine%20details,%20sharp,%20very%20detailed,%20high%20resolution%20logo%20icon%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bicon:50%7D)%5D%5Cn%20%20Cute%203D%20Icon%5Cn%20%20%20%20prompt%20=%20%5Binput.description%5D,%20a%20cute%203D%20icon%20of%20%5Binput.description%5D,%20cartoon%203D%20icon,%20very%20cute%20shape,%20stylized%20octane%20render,%208k,%20masterpiece,%20soooo%20cute,%20beautiful%20cute%20perfection,%20beautiful%20soft%20lighting,%20soft%20colors,%20centered,%20high%20resolution,%20%5Binput.description%5D,%20soft%20gradient%20background%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bicon:40%7D)%5D%5Cn%20%20Cute%203D%20Icon%20%F0%9D%97%A6%F0%9D%97%B2%F0%9D%98%81%5Cn%20%20%20%20prompt%20=%20%5Binput.description%5D,%20a%20set%20of%20lovely%20little%203D%20icons,%20cute%203D%20icons,%20very%20cute%20shapes,%20stylized%20octane%20render,%208k,%20masterpiece,%20soooo%20cute,%20beautiful%20cute%20perfection,%20beautiful%20soft%20lighting,%20soft%20colors,%20centered,%20high%20resolution,%20%5Binput.description%5D,%20cute%20icon%20set%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bicon:30%7D)%5D%5Cn%20%20Crayon%20Drawing%5Cn%20%20%20%20prompt%20=%20%5Binput.description%5D,%20crayon%20drawing%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D%5Cn%20%20Pencil%5Cn%20%20%20%20prompt%20=%20black%20and%20white%20pencil%20drawing,%20%5Binput.description%5D,%20black%20and%20white,%20breathtaking%20pencil%20illustration,%20highly%20detailed,%204k,%20textured%20paper,%20pencil%20texture,%20sketch%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bdrawing:45%7D)%5D%5Cn%20%20Tattoo%20Design%5Cn%20%20%20%20prompt%20=%20amazing%20tattoo%20design,%20%5Binput.description%5D,%20breathtaking%20tattoo%20design,%20incredible%20tattoo%20design%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Btattoo:100%7D)%5D%5Cn%20%20Waifu%5Cn%20%20%20%20prompt%20=%20%5Binput.description%5D,%20waifu%20character%20portrait,%201girl,%20very%20high%20resolution,%20semi-realistic%20anime%20art.%20Intricate%20and%20impressive%20anime%20artwork%20with%20stunningly%20beautiful%20composition%20and%20style.%5C%5Cn%5C%5CnOverall,%20it's%20an%20absolute%20world-class%20masterpiece%20anime%20artwork.%20It's%20an%20aesthetically%20pleasing%20waifu%20artwork%20with%20impeccable%20attention%20to%20detail%20and%20impressive%20composition.%20It's%20an%20aesthetically%20pleasing%20character%20portrait.%20It's%20an%20aesthetically%20pleasing%20image.%20It's%20an%20aesthetically%20pleasing%20image.%20It's%20an%20aesthetically%20pleasing%20image.%20It's%20an%20aesthetically%20pleasing%20image.%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Banime:40,%20waifu:100,%20cartoon:20%7D)%5D%5Cn%20%20%20%20modifiers%20=%20%5BanimeModifiers%5D%5Cn%20%20YuGiOh%20Art%5Cn%20%20%20%20prompt%20=%20yugioh%20card%20art%20for%20%5Binput.description%5D,%20art%20by%20genzoman,%20by%20Akina%20Fujiwara,%20by%20rossdraws,%20yugioh%20monster,%20close%20up,%20painterly%20details,%20breathtaking%20art,%20centered,%20masterpiece,%20amazing%20composition,%20%5Binput.description.length%20%3C%2030%20?%20input.description%20:%20%5C%22%5C%22%5D.%5C%5Cn%5C%5CnOverall,%20it's%20an%20absolute%20world-class%20masterpiece%20%5C%22Yu-Gi-Oh!%5C%22-inspired%20artwork.%20It's%20an%20aesthetically%20pleasing%20Yu-Gi-Oh%20inspired%20artwork%20with%20impeccable%20attention%20to%20detail%20and%20impressive%20composition.%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Byugioh:100%7D)%5D%5Cn%20%20Traditional%20Japanese%5Cn%20%20%20%20prompt%20=%20%5Binput.description%5D,%20in%20ukiyo-e%20art%20style,%20traditional%20japanese%20masterpiece%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bjapanese:100,%20vintage:50,%20cartoon:30%7D)%5D%5Cn%20%20Nihonga%20Painting%5Cn%20%20%20%20prompt%20=%20japanese%20nihonga%20painting%20about%20%5Binput.description%5D,%20Nihonga,%20ancient%20japanese%20painting,%20intricate,%20detailed%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bjapanese:95,%20vintage:55,%20comic:70%7D)%5D%5Cn%20%20Claymation%5Cn%20%20%20%20prompt%20=%20%5Binput.description%5D,%20claymation,%20incredible%20claymation%20style,%20kubo%20and%20the%20two%20strings%20style%20art,%20Missing%20Link%202019%20art%20style,%20clay%20texture,%20clay%20animation,%20stop-motion%20clay%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bclaymation:100%7D)%5D%5Cn%20%20Cartoon%5Cn%20%20%20%20prompt%20=%20%5Binput.description%5D,%20cartoon-style%20art,%20superb%20linework,%20nice%20colors%20and%20composition,%20bold%20linework,%20masterpiece,%20cute%20art%20by%20Dana%20Terrace,%20by%20Rebecca%20Sugar,%20by%20ry-spirit,%20amazing%20and%20wholesome%20cartoon-style%20art,%20cute%20art%20style,%20(trending%20on%20artstation)%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bcartoon:95,%20basicCartoon:100%7D)%5D%5Cn%20%20Cursed%20Photo%5Cn%20%20%20%20prompt%20=%20cursed%20photo%20of%20%5Binput.description%5D,%20creepy%20and%20cursed,%20absolutely%20cursed%20photo,%20nope%20nope%20nope%20nope,%20what%20the%20actual%20f,%20unsettling%20photo,%20cursed_thing,%20cursedimages,%20no%20context,%20cursed%20image,%20bad%20photo,%20weird%20photo,%20very%20strange,%20color%20photo,%20creepy%20photo,%20nightmare%20fuel%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bcreepy:100%7D)%5D%5Cn%20%20%20%20modifiers%5Cn%20%20%20%20%20%20modifier%5Cn%20%20%20%20%20%20%20%20found%20footage%20=%20,%20found%20footage%5Cn%20%20%20%20%20%20%20%20cult%20=%20,%20photo%20from%20a%20real%20cult%5Cn%20%20%20%20%20%20%20%201920s%20=%20,%201920s%20photo%5Cn%20%20%20%20%20%20%20%20old%20phone%20=%20,%20old%20cell%20phone%20photo%5Cn%20%20%20%20%20%20%20%20VHS%20=%20,%20old%20VHS%20footage%5Cn%20%20%20%20%20%20%20%20CCTV%20=%20,%20old%20CCTV%20footage,%20high-angle%20CCTV%20image%5Cn%20%20%20%20%20%20%20%20trypophobia%20=%20,%20trypophobia%5Cn%20%20%20%20%20%20%20%20backrooms%20=%20,%20backrooms%5Cn%20%20%20%20%20%20%20%20black%20&%20white%20=%20,%20black%20&%20white%5Cn%20%20%20%20%20%20%20%20grainy%20=%20,%20grainy,%20noisy%20static%20effect%5Cn%20%20%20%20%20%20%20%20extreme%20close-up%20=%20,%20extreme%20close-up%5Cn%20%20%20%20%20%20%20%20low-angle%20=%20,%20low-angle%20shot%5Cn%20%20%20%20%20%20%20%20dramatic%20=%20,%20dramatic%20angle,%20extreme%20angle%20shot%5Cn%5Cn%5Cn%5Cn%5CnphotoModifiers%5Cn%20%20shot%5Cn%20%20%20%20extreme%20close-up%20=%20,%20extreme%20close-up%5Cn%20%20%20%20low-angle%20=%20,%20low-angle%20shot%5Cn%20%20%20%20high-angle%20=%20,%20high-angle%20shot%5Cn%20%20%20%20aerial%20=%20,%20aerial%20shot%5Cn%20%20%20%20close-up%20=%20,%20close-up%20shot%5Cn%20%20%20%20portrait%20=%20,%20close-up%20portrait%5Cn%20%20%20%20macro%20=%20,%20macro%20shot%5Cn%20%20%20%20wide-angle%20=%20,%20wide-angle%20shot%5Cn%20%20%20%20establishing%20=%20,%20establishing%20shot%5Cn%20%20%20%20over-the-shoulder%20=%20,%20over-the-shoulder%20shot%5Cn%20%20%20%20telephoto%20=%20,%20telephoto%20shot%5Cn%20%20%20%20handheld%20=%20,%20handheld%20shot%5Cn%20%20%20%20panoramic%20=%20,%20panoramic%20shot%5Cn%20%20%20%20dramatic%20=%20,%20dramatic%20angle,%20extreme%20angle%20shot%5Cn%20%20color%5Cn%20%20%20%20vibrant%20=%20,%20vibrant%20color%20grading%5Cn%20%20%20%20warm%20=%20,%20warm%20color%20grading%5Cn%20%20%20%20cool%20=%20,%20cool-toned%20color%20grading%5Cn%20%20%20%20pastel%20=%20,%20pastel%20color%20grading%5Cn%20%20%20%20bright%20=%20,%20bright%20color%20grading%5Cn%20%20%20%20muted%20=%20,%20muted%20color%20grading%5Cn%20%20%20%20neon%20=%20,%20neon%20color%20grading%5Cn%20%20%20%20duotone%20=%20,%20duotone%20color%20grading%5Cn%20%20%20%20monochrome%20=%20,%20monochrome%5Cn%20%20%20%20sterile%20=%20,%20cool-toned%20sterile%20colors%5Cn%20%20effect%5Cn%20%20%20%20bokeh%20=%20,%20bokeh%5Cn%20%20%20%20tilt-shift%20=%20,%20tilt-shift%20effect%5Cn%20%20%20%20soft%20focus%20=%20,%20soft%20focus%5Cn%20%20%20%20background%20blur%20=%20,%20shallow%20depth%20of%20field%5Cn%20%20%20%20chromatic%20aberrations%20=%20,%20chromatic%20aberrations%5Cn%20%20%20%20light%20leaks%20=%20,%20light%20leaks%5Cn%20%20%20%20rear%20projection%20=%20,%20rear%20projection%5Cn%20%20%20%20lens%20flare%20=%20,%20lens%20flare%5Cn%20%20%20%20long%20exposure%20=%20,%20long%20exposure%5Cn%20%20%20%20golden%20hour%20=%20,%20golden%20hour%5Cn%20%20%20%20silhouette%20=%20,%20silhouette%5Cn%5CnanimeModifiers%5Cn%20%20style%5Cn%20%20%20%20Ghibli%20=%20,%20Ghibli%20art%20style,%20Spirited%20Away%20art%20style%5Cn%20%20%20%20Your%20Name%20=%20,%20Your%20Name%20art%20style%5Cn%20%20%20%20Paprika%20=%20,%20Paprika%20art%20style%5Cn%20%20%20%20My%20Hero%20Academia%20=%20,%20My%20Hero%20Academia%20art%20style%5Cn%20%20%20%20Hunter%20x%20Hunter%20=%20,%20Hunter%20x%20Hunter%20art%20style%5Cn%20%20%20%20Attack%20on%20Titan%20=%20,%20Attack%20on%20Titan%20art%20style%5Cn%20%20effect%5Cn%20%20%20%20multi-view%20=%20,%20multiple%20views%5Cn%20%20%20%20toon%20=%20,%20cartoon-style%20bold%20line%20work,%20vibrant%20colors,%20cel%20shading%5Cn%20%20%20%20vintage%20=%20,%20cel%20shading,%20vintage%20anime%5Cn%20%20%20%20ethereal%20=%20,%20glow,%20god%20rays,%20ethereal,%20dreamy,%20heavenly,%20otherworldly,%20dream-like,%20breathtaking,%20captivating,%20divine%5Cn%20%20%20%20outline%20=%20,%20outline,%20white%20outline%5Cn%20%20%20%20%5CnfurryModifiers%5Cn%20%20effect%5Cn%20%20%20%20humanoid%20face%20=%20,%20human%20face,%20not%20furry%5Cn%20%20%20%20multi-view%20=%20,%20multiple%20views%5Cn%20%20%20%20toon%20=%20,%20cartoon-style%20bold%20line%20work,%20vibrant%20colors,%20cel%20shading%5Cn%20%20%20%20vintage%20=%20,%20cel%20shading,%20vintage%20anime%5Cn%20%20%20%20ethereal%20=%20,%20glow,%20god%20rays,%20ethereal,%20dreamy,%20heavenly,%20otherworldly,%20dream-like,%20breathtaking,%20captivating,%20divine%5Cn%20%20%20%20outline%20=%20,%20outline,%20white%20outline%5Cn%20%20%5CnlandscapeModifiers%5Cn%20%20shot%5Cn%20%20%20%20aerial%20=%20,%20aerial%20view%5Cn%20%20%20%20low-angle%20=%20,%20low-angle%20view%5Cn%20%20%20%20high-angle%20=%20,%20high-angle%20view%5Cn%20%20%20%20wide-angle%20=%20,%20wide-angle%20view%5Cn%20%20color%5Cn%20%20%20%20vibrant%20=%20,%20vibrant%20color%20tones%5Cn%20%20%20%20warm%20=%20,%20warm-toned%20colors%5Cn%20%20%20%20cool%20=%20,%20cool-toned%20colors%5Cn%20%20%20%20pastel%20=%20,%20pastel%20tones%5Cn%20%20%20%20muted%20=%20,%20muted%20color%20grading%5Cn%20%20%20%20sunset%20=%20,%20sunset%20color%20tones%5Cn%20%20%20%20monochrome%20=%20,%20monochrome%5Cn%20%20effect%5Cn%20%20%20%20tilt-shift%20=%20,%20tilt-shift%20effect%5Cn%20%20%20%20golden%20hour%20=%20,%20golden%20hour%5Cn%20%20%20%20mist%20=%20,%20misty%5Cn%20%20%20%20reflection%20=%20,%20water%20reflection%5Cn%20%20%20%20sun%20flare%20=%20,%20sun%20flare%5Cn%20%20%20%20starburst%20=%20,%20starburst%20effect%5Cn%20%20%20%20light%20trails%20=%20,%20light%20trails%5Cn%20%20%20%20long%20exposure%20=%20,%20long%20exposure%5Cn%20%20%20%20soft%20focus%20=%20,%20soft%20focus%5Cn%20%20%22,%22imports%22:%5B%5D,%22lastEditTime%22:1750513783758,%22found%22:true%7D,%7B%22name%22:%22vionet20-t2i-styles-importable%22,%22modelText%22:%22//%20Note:%20Text%20that%20comes%20after%20%5C%22//%5C%22%20is%20ignored,%20which%20allows%5Cn//%20you%20to%20write%20notes%20-%20like%20the%20one%20you're%20reading%20now!%5Cn%5Cntitle%5Cn%20%20vionet20-t2i-styles-importable%5Cn%5Cnimg%20=%20%7Bimport:text-to-image-plugin%7D%5Cn%5CnimgPrompt%5Cn%20%20guidanceScale%20=%207%5Cn%20%20style%20=%20width:%20100%25;%5Cn%20%20//%20onFinish(data)%20=%3E%5Cn%20%20//%20%20%20let%20iframe%20=%20data.iframe;%5Cn%20%20//%20%20%20let%20img%20=%20document.createElement('img')%5Cn%20%20//%20%20%20img.src%20=%20data.dataUrl%5Cn%20%20//%20%20%20iframe.replaceWith(img);%5Cn%20%20%20%20%5Cnres%5Cn%20%20512x512%5Cn%20%20768x512%5Cn%20%20512x768%5Cn%5CngetStylesObject()%20=%3E%5Cn%20%20let%20tree%20=%20%5Cn%20%20let%20obj%20=%20%7B%7D%5Cn%20%20Object.keys(tree).forEach(a%20=%3E%20%7B%5Cn%20%20%20%20let%20copy%20=%20tree%5Ba%5D.copyPrompt.evaluateItem.replaceAll('%5B',%20'%5C%5C%5C%5C%5C%5C%5C%5C%5C%5C%5C%5C%5B').replaceAll('%5D',%20'%5C%5C%5C%5C%5C%5C%5C%5C%5C%5C%5C%5C%5D')%5Cn%20%20%20%20let%20prompt%20=%20tree%5Ba%5D.prompt.getRawListText.split('%5C%5Cn').slice(2).join('%5C%5Cn').replace('%5Bthis.getParent.copyPrompt%5D',%20copy).trim()%5Cn%20%20%20%20let%20%5Btrailing,%20negative%5D%20=%20tree%5Ba%5D.negative.getRawListText.split('%5C%5Cn').slice(2).join('%5C%5Cn').trim().split('%5Binput.negative%5D')%5Cn%20%20%20%20let%20neg%20=%20negative%20?%20negative.replaceAll('%5B',%20'%5C%5C%5C%5C%5C%5C%5C%5C%5B').replaceAll('%5D',%20'%5C%5C%5C%5C%5C%5C%5C%5C%5D').trim()%20:%20''%5Cn%20%20%20%20obj%5Ba%5D%20=%20%7B%5Cn%20%20%20%20%20%20prompt:%20prompt,%5Cn%20%20%20%20%20%20negative:%20%5C%22%5Binput.negative%5D%5C%22%20+%20neg%5Cn%20%20%20%20%7D%5Cn%20%20%7D)%5Cn%20%20console.log(obj);%5Cn%5Cn%20=%20%7Bimport:vionet20-t2i-styles-importable-v2%7D%5Cn//%20%5Cnlist%5Cn%20%20//%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20createCard(a)).join(%5C%22%5C%22)%5D%5Cn%20%20No%20Style%5Cn%20%20%20%20prompt%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.description%5D,%20%5Bthis.getParent.copyPrompt%5D%5Cn%20%20%20%20copyPrompt%20=%20%5B''%5D%5Cn%20%20%20%20negative%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.negative%5D,%5Cn%20%20Fineline%20Illustration%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Billustration:100,%20drawing:70%7D)%5D%5Cn%20%20%20%20prompt%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.description%5D,%20%5Bthis.getParent.copyPrompt%5D%5Cn%20%20%20%20copyPrompt%5Cn%20%20%20%20%20%20%5C%5C%5B(fineline%20illustration:1.1),%20(0.5mm%20technical%20pen:0.7),%20(by%20Adrian%20Tomine:0.2)::0.05%5C%5C%5D%20%5C%5C%5B%5C%5C%5B(detailed:1.1),%20(intricate:0.9),:0.15%5C%5C%5D::0.5%5C%5C%5D%20%5C%5C%5B%5C%5C%5B%5C%5C%5B%7Cart%7C(illustration:0.3)%5C%5C%5D%20by%20Sachin%20Teng%20%5C%5C%5B%5C%5C%5B,(8k%20uhd:1.1):0.15%5C%5C%5D::0.8%5C%5C%5D:0.1%5C%5C%5D::0.9%5C%5C%5D%5Cn%20%20%20%20negative%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.negative%5D,%20watermark,%20signature,%20text,%20(low%20quality,%20bad%20quality,%20worst%20quality:1.1)%5Cn%20%20%20%20//%20sample_imgs%5Cn%20%20%20%20//%20%20%20//%20*%5Cn%20%20%20%20//%20%20%20//%20%20%20x%20=%20%5Bthis.selectOne%5D%5Cn%20%20%20%20//%20%20%20//%20%20%20prompt%20=%20%5Bthis.x.prompt%5D%5Cn%20%20%20%20//%20%20%20//%20%20%20img%20=%20%5Bthis.x.img%5D%5Cn%20%20%20%20//%20%20%20//%20%20%20size%20=%20%5Bthis.x.size%20%7C%7C%20''%5D%5Cn%20%20%20%20//%20%20%20*%5Cn%20%20%20%20//%20%20%20%20%20prompt%20=%20A%20snobby%20cleric%20waiting%20in%20a%20thriving%20tower,%20Magic%20Realism,%20Lime%20palette,%20Cinematic%20lighting,%20Earnest%5Cn%20%20%20%20//%20%20%20%20%20img%20=%20https://user-uploads.perchance.org/file/9d06387350eb7669c949fa76022461f5.webp%5Cn%20%20%20%20//%20%20%20*%5Cn%20%20%20%20//%20%20%20%20%20prompt%20=%20A%20picturesque%20downs,%20after%20dawn,%20Futuresynth%5Cn%20%20%20%20//%20%20%20%20%20img%20=%20https://user-uploads.perchance.org/file/132cb92af68e157dd6addd09c55bb169.webp%5Cn%20%20%20%20//%20%20%20*%20%5Cn%20%20%20%20//%20%20%20%20%20prompt%20=%20An%20overwhelming%20movie%20frame%20of%20a%20loud%20alien%20planet,%20Zealous%5Cn%20%20%20%20//%20%20%20%20%20img%20=%20https://user-uploads.perchance.org/file/c34a5f84b536a70f5126d6465375a03a.webp%5Cn%20%20%20%20//%20%20%20*%5Cn%20%20%20%20//%20%20%20%20%20prompt%20=%20A%20flashy%20Albanian%20human%20flying%20in%20a%20stunning%20alien%20planet,%20morning,%20Lively%5Cn%20%20%20%20//%20%20%20%20%20img%20=%20https://user-uploads.perchance.org/file/f57a8f5dea478ffe4ff3d1346dd37ac8.webp%5Cn%20%20%20%20//%20%20%20//%20*%5Cn%20%20%20%20//%20%20%20//%20%20%20x%20=%20%5Bthis.selectOne%5D%5Cn%20%20%20%20//%20%20%20//%20%20%20prompt%20=%20%5Bthis.x.prompt%5D%5Cn%20%20%20%20//%20%20%20//%20%20%20img%20=%20%5Bthis.x.img%5D%5Cn%20%20%20%20//%20%20%20//%20%20%20size%20=%20%5Bthis.x.size%20%7C%7C%20''%5D%5Cn%20%20%20%20//%20%20%20*%5Cn%20%20%20%20//%20%20%20%20%20prompt%20=%20A%20careful%20Macedonian%20mercenary%20staring%20at%20you%20in%20a%20dark%20plain,%20Secularism,%20Spotlighting,%20Sympathetic%5Cn%20%20%20%20//%20%20%20%20%20img%20=%20https://user-uploads.perchance.org/file/5a56013dde251358b013893beb1291dd.webp%5Cn%20%20%20%20//%20%20%20%20%20size%20=%20landscape%5Cn%20%20%20%20//%20%20%20*%5Cn%20%20%20%20//%20%20%20%20%20prompt%20=%20An%20overwhelming%20acrylic%20painting%20of%20an%20obscure%20machine%20in%20a%20island,%20midday,%20Hypermodernism,%20Waning%20light,%20Delightful,%20Tilt-Shift%5Cn%20%20%20%20//%20%20%20%20%20img%20=%20https://user-uploads.perchance.org/file/116ee0174fb136b45bdf674368144f8b.webp%5Cn%20%20%20%20//%20%20%20%20%20size%20=%20landscape%5Cn%20%20%20%20//%20%20%20//%20*%5Cn%20%20%20%20//%20%20%20//%20%20%20x%20=%20%5Bthis.selectOne%5D%5Cn%20%20%20%20//%20%20%20//%20%20%20prompt%20=%20%5Bthis.x.prompt%5D%5Cn%20%20%20%20//%20%20%20//%20%20%20img%20=%20%5Bthis.x.img%5D%5Cn%20%20%20%20//%20%20%20//%20%20%20size%20=%20%5Bthis.x.size%20%7C%7C%20''%5D%5Cn%20%20%20%20//%20%20%20*%5Cn%20%20%20%20//%20%20%20%20%20prompt%20=%20A%20deft%20shrew%20fleeing%20in%20an%20unexpected%20quagmire,%20Subtle%20white%20and%20brown%20palette%5Cn%20%20%20%20//%20%20%20%20%20img%20=%20https://user-uploads.perchance.org/file/6e2e3338ca4b63477bb0cf8f3659b3f4.webp%5Cn%20%20%20%20//%20%20%20*%5Cn%20%20%20%20//%20%20%20%20%20prompt%20=%20A%20loud%20road,%20afternoon,%20Furious,%20Cyberpunk%5Cn%20%20%20%20//%20%20%20%20%20img%20=%20https://user-uploads.perchance.org/file/2b8b87a05cfb833836e28bb1b0b0b808.webp%5Cn%20%20%20%20//%20%20%20*%5Cn%20%20%20%20//%20%20%20%20%20prompt%20=%20An%20empty%20shoreline,%20Caustic%20lighting,%20Cheerful%5Cn%20%20%20%20//%20%20%20%20%20img%20=%20https://user-uploads.perchance.org/file/6c1c637f183ebe6341d74e064b4f4fb7.webp%5Cn%20%20%20%20//%20%20%20*%5Cn%20%20%20%20//%20%20%20%20%20prompt%20=%20A%20delightful%20badger%20wandering%20in%20a%20surreal%20village%20in%20a%20plains%5Cn%20%20%20%20//%20%20%20%20%20img%20=%20https://user-uploads.perchance.org/file/ac434c99226d9bae089cde294b26a298.webp%5Cn%20%20%20%20%20%20%20%20%5Cn%5Cn%20%20Flat%20Vector%20Illustration%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Billustration:100,%20logo:70,%20icon:70,%20poster:30%7D)%5D%5Cn%20%20%20%20prompt%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.description%5D,%20%5Bthis.getParent.copyPrompt%5D%5Cn%20%20%20%20copyPrompt%5Cn%20%20%20%20%20%20%5C%5C%5B%5C%5C%5B2d,%20vector%20art,%20flat%20shading,%20cell%20shading,:0.1%5C%5C%5D::0.7%5C%5C%5D%20%5C%5C%5B%5C%5C%5Bsimple,%20minimalistic,%20sharp,%208k%20uhd,:0.1%5C%5C%5D::0.8%5C%5C%5D%20by%20%5C%5C%5BAdrian%20Tomine:Michael%20Deforge:0.4%5C%5C%5D%5Cn%20%20%20%20negative%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.negative%5D,%20monochrome,%20gradient,%20blur,%20textured,%20signature,%20watermark,%20(low%20quality,%20bad%20quality,%20worst%20quality:1.1)%5Cn%5Cn%5Cn%20%20Polygonal%20Illustration%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Billustration:100,%20logo:70,%20icon:70,%20poster:30%7D)%5D%5Cn%20%20%20%20prompt%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.description%5D,%20%5Bthis.getParent.copyPrompt%5D%5Cn%20%20%20%20copyPrompt%5Cn%20%20%20%20%20%20polygonal%20%5C%5C%5Billustration%7Cdrawing%7C%5C%5C%5D,%20low%20poly%20%5C%5C%5Billustration%7Cdrawing%7C%5C%5C%5D,%20by%20%5C%5C%5BSyd%20Mead:Sim%C3%B3n%20Prades:0.4%5C%5C%5D,%20cell%20shaded,%20shaders,%20%5C%5C%5Bby%20Gregory%20Manchess,%20FXAA::0.3%5C%5C%5D%5Cn%20%20%20%20negative%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.negative%5D,%203d%20render,%20painting,%20photo,%20(detailed,%20intricate,:1.2)%20realistic,%20(worst%20quality,%20normal%20quality,%20low%20quality:1.1)%5Cn%20%20Detailed%20Cartoony%20Illustrations%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Billustration:100,cartoon:70,%20ghibli:50,%20digitalPainting:30,%20anime:10%7D)%5D%5Cn%20%20%20%20prompt%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.description%5D,%20%5Bthis.getParent.copyPrompt%5D%5Cn%20%20%20%20copyPrompt%5Cn%20%20%20%20%20%20best%20quality,%20Brian%20Kesinger%20BREAK%20Zac%20Retz,%20illustration,%20print,%20magazine,%20300%20dpi,%20by%20Hayao%20Miyazaki%5Cn%20%20%20%20negative%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.negative%5D,%20signature,%20text,%20anime,%20photograph,%20(eyes,%20hands,%20strabismus,%20low%20quality,%20bad%20quality,%20normal%20quality)%5Cn%20%20%5Cn%20%20Comic/Manga%20Illustration%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Billustration:100,comic:70,%20manga:50,fantasy:%2040,%20anime:40%7D)%5D%5Cn%5Cn%20%20%20%20prompt%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.description%5D,%20%5Bthis.getParent.copyPrompt%5D%5Cn%20%20%20%20copyPrompt%5Cn%20%20%20%20%20%20single,%20best%20quality,%20digital%20art,%20illustration,%20detailed,%20(cel%20shaders:0.5),%20%5C%5C%5B%5C%5C%5Bneal%20adams%7Calex%20toth%7Cjim%20lee%7C%5C%5C%5D%5C%5C%5B,%20siya%20oum,%20ruan%20jia:0.7%5C%5C%5D:0.05%5C%5C%5D%5Cn%20%20%20%20negative%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.negative%5D,%20child,%20nsfw,%20porn,%20nipple,%20nude%20BREAK%20overexposed,%20semi%20real,%20photograph,%20text%20signature,%20hands,%203d%20render,%20computer%20generated,%20sketch,%20(low%20quality,%20bad%20quality,%20normal%20quality)%5Cn%5Cn%20%20Grim%20Dark%20Fantasy%20Illustration%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Billustration:100,comic:70,%20manga:50,fantasy:%2040,%20anime:40,creepy:50%7D)%5D%5Cn%5Cn%20%20%20%20prompt%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.description%5D,%20%5Bthis.getParent.copyPrompt%5D%5Cn%20%20%20%20copyPrompt%5Cn%20%20%20%20%20%20digital%20painting,%20illustration,%20grim%20dark%20fantasy,%20low%20light,%20moody%20lighting,%20%5C%5C%5BZdzis%C5%82aw%20Beksi%C5%84ski:Peder%20Balke:0.4%5C%5C%5D,%20%5C%5C%5BY%C5%8Dji%20Shinkawa:Mike%20Mignola:0.5%5C%5C%5D%5Cn%20%20%20%20negative%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.negative%5D,%20child,%20nsfw,%20porn,%20nipple,%20nude%20BREAK%20overexposed,%20semi%20real,%20photograph,%20text%20signature,%20hands,%203d%20render,%20computer%20generated,%20(low%20quality,%20bad%20quality,%20normal%20quality)%5Cn%20%20Color%20Pop%20Anime%20Illustration%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Billustration:100,anime:70,%20color:50,patterns:%2040%7D)%5D%5Cn%20%20%20%20prompt%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.description%5D,%20%5Bthis.getParent.copyPrompt%5D%5Cn%20%20%20%20copyPrompt%5Cn%20%20%20%20%20%20vibrant%20%5C%5C%5Bflat%7Climited%5C%5C%5D%20coloring,%20in%20anime%20style%20%5C%5C%5Billustration::0.6%5C%5C%5D,%20film%20grain,%20clean%20lines,%201200%20dpi%20%5C%5C%5B%7CBREAK%20Hiroyuki%20Mitsume%20Takahashi%7CBREAK%20Keith%20Negley,%20Peter%20Wileman%7CBREAK%20Anton%20Fadeev,%20Frank%20Hong%5C%5C%5D%5Cn%20%20%20%20negative%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.negative%5D,%20%5C%5C%5Bchild,%20nsfw,%20nude,%20nipples%20BREAK%20(smooth%20transition,%203d,%20render:1.2),%20(outline,%20text,%20semi-realistic,%20bad%20quality,%20border,%20frame,%20sketching:1.1):0.05%5C%5C%5D%5Cn%5Cn%20%20%20%20%5Cn%20%20Colored%20Patterns%20Anime%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Billustration:100,anime:70,%20color:50,pop:%2040%7D)%5D%5Cn%20%20%20%20prompt%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.description%5D,%20%5Bthis.getParent.copyPrompt%5D%5Cn%20%20%20%20copyPrompt%5Cn%20%20%20%20%20%20(%5C%5C%5Banime%20style:photo:0.35%5C%5C%5D:0.3),%20(vector:0.9),%20illustration,%20(cel%20shading:0.5),%20patterns%20(%5C%5C%5B,%20by%20Clovis%20Trouille,%20Ernst%20Wilhelm%20Nay,%20Mike%20Ploog,%20Stanley%20Pinker:0.35%5C%5C%5D:1.3)%5Cn%20%20%20%20negative%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.negative%5D,%20%5C%5C%5Bchild,%20nsfw,%20nude,%20nipples%20BREAK%20(painting,%203d%20render,%20drawing,%20rough%20sketch,%20outline,%20lines:0.9),%20bad%20quality,%20low%20quality:0.15%5C%5C%5D%5Cn%20%20Atmospheric%20Painting%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bpainting:100,%20oilPainting:50,%20cinematic:30%7D)%5D%5Cn%20%20%20%20prompt%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.description%5D,%20%5Bthis.getParent.copyPrompt%5D%5Cn%20%20%20%20copyPrompt%5Cn%20%20%20%20%20%20by%20%5C%5C%5B%5C%5C%5BZao%20Wou-Ki:Karl%20Wilhelm%20Diefenbach:0.3%5C%5C%5D::0.8%5C%5C%5D%20%5C%5C%5B(atmospheric%20%5C%5C%5Bpainting::0.4%5C%5C%5D,%20%5C%5C%5Babstract::0.35%5C%5C%5D%20expressionism,:1.2):0.3%5C%5C%5D::0.5%5C%5C%5D%20%5C%5C%5B%5C%5C%5Bsoft%20strokes,%20detailed,%20masterpiece,:0.3%5C%5C%5D::0.5%5C%5C%5D%20%5C%5C%5B%5C%5C%5Bby%20Gregory%20Manchess:0.25%5C%5C%5D::0.9%5C%5C%5D%5Cn%20%20%20%20negative%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.negative%5D,%20watermark,%20signature,%20text,%20(low%20quality,%20bad%20quality,%20worst%20quality:1.1)%5Cn%20%20%20%20//%20sample_imgs%5Cn%20%20%20%20%20%20//%20*%5Cn%20%20%20%20%20%20//%20%20%20x%20=%20%5Bthis.selectOne%5D%5Cn%20%20%20%20%20%20//%20%20%20prompt%20=%20%5Bthis.x.prompt%5D%5Cn%20%20%20%20%20%20//%20%20%20img%20=%20%5Bthis.x.img%5D%5Cn%20%20%20%20%20%20//%20%20%20size%20=%20%5Bthis.x.size%20%7C%7C%20''%5D%5Cn%20%20%20%20%20%20//%20*%5Cn%20%20%20%20%20%20//%20%20%20prompt%20=%20An%20inventive%20vampire%20in%20a%20stunning%20desolate%20house,%20Anaglyph%20Filter%5Cn%20%20%20%20%20%20//%20%20%20img%20=%20https://user-uploads.perchance.org/file/cc6319acce82178846b4c5187fdaffd4.webp%5Cn%20%20%20%20%20%20//%20*%5Cn%20%20%20%20%20%20//%20%20%20prompt%20=%20An%20intense%20monastery%20in%20a%20islands,%20Indigo%20and%20purple%20palette%5Cn%20%20%20%20%20%20//%20%20%20img%20=%20https://user-uploads.perchance.org/file/f35c71d58e16c475f7107e6bf19ad518.webp%5Cn%20%20%20%20%20%20//%20*%5Cn%20%20%20%20%20%20//%20%20%20prompt%20=%20An%20intricate%20portal%20in%20a%20shopping%20mall,%20in%20the%20golden%20hour,%20Tachisme%5Cn%20%20%20%20%20%20//%20%20%20img%20=%20https://user-uploads.perchance.org/file/d85a5a0079c1df806780eeb3ae95e35d.webp%5Cn%20%20%20%20%20%20//%20*%5Cn%20%20%20%20%20%20//%20%20%20prompt%20=%20A%20loud%20lake,%20dawn,%20Subtle%20orange%20and%20pink%20colour%20scheme,%20Cinematic%20lighting,%20Forestpunk%5Cn%20%20%20%20%20%20//%20%20%20img%20=%20https://user-uploads.perchance.org/file/a5768a5fd90a28ac373f25da2aaa1316.webp%5Cn%20%20%20%20%20%20//%20%20%20size%20=%20landscape%5Cn%20%20%20%20%20%20//%20*%5Cn%20%20%20%20%20%20//%20%20%20prompt%20=%20%5Cn%20%20%20%20%20%20//%20%20%20img%20=%20https://user-uploads.perchance.org/file/cf4d48b40358066d1b1927ab80127fff.webp%5Cn%20%20%20%20%20%20//%20%20%20size%20=%20landscape%5Cn%20%20Brushy%20Paintings%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bpainting:100,%20oilPainting:50,%20portrait:40,%20landscape:40,%20cinematic:30%7D)%5D%5Cn%20%20%20%20prompt%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.description%5D,%20%5Bthis.getParent.copyPrompt%5D%5Cn%20%20%20%20copyPrompt%5Cn%20%20%20%20%20%20%5C%5C%5Blandscape%7C%7C%7Cabstract%5C%5C%5D%20painting%20by%20%5C%5C%5BZao%20Wou%20Ki%7CJohn%20Singer%20Sargent%7C%7CJackson%20Pollock%5C%5C%5D%20BREAK%20%5C%5C%5B%5C%5C%5B%7Crender%7Cart%5C%5C%5D%20by%20Cathleen%20McAllister:0.3%5C%5C%5D%5Cn%20%20%20%20negative%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.negative%5D,%20depth%20of%20field,%20blurry,%20frame,%20photo,%203d%20render,%20cgi,%20watermark,%20signature,%20(normal%20quality,%20bad%20quality,%20low%20quality:1.2)%5Cn%5Cn%20%20Brushy%20Paintings%202%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bpainting:100,%20oilPainting:50,%20portrait:40,%20landscape:40,%20cinematic:30%7D)%5D%5Cn%20%20%20%20prompt%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.description%5D,%20%5Bthis.getParent.copyPrompt%5D%5Cn%20%20%20%20copyPrompt%5Cn%20%20%20%20%20%20painting,%20%5C%5C%5B%7Cshapes,%7Cshapes,%7Cshapes,%5C%5C%5D%20rough%20textured,%20visible%20brush%20strokes%20%5C%5C%5B,%20abstract%20masterpiece::0.3%5C%5C%5D%20%5C%5C%5B(,%20by%20Colin%20Campbell%20Cooper,%20by%20Gy%C3%B6rgy%20Kepes,%20by%20Zou%20Wou-Ki:1.2):0.1%5C%5C%5D%5Cn%20%20%20%20negative%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.negative%5D,%20%5C%5C%5B(frame,%20border,%20outline,%20photograph:1.1),%203d%20render,%20cgi,%20(random,%20chaotic,%20signature,%20trademark,%20text:1.1),%20illustration,%20drawing,%20sketch,%20(drip,%20splat:0.1),%20worst%20quality:0.1%5C%5C%5D%5Cn%20%20Drip/Palette%20Knife%20Paintings%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bpainting:100,%20oilPainting:50,%20portrait:40,%20landscape:40,%20cinematic:30%7D)%5D%5Cn%20%20%20%20prompt%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.description%5D,%20%5Bthis.getParent.copyPrompt%5D%5Cn%20%20%20%20copyPrompt%5Cn%20%20%20%20%20%20%5C%5C%5BPino%20Daeni,:0.3%5C%5C%5D%20palette%20knife%20painting,%20%5C%5C%5B%7Cdrip%20painting%7C%5C%5C%5D%20BREAK%20%5C%5C%5B%5C%5C%5BJackson%20Pollock%7CJackson%20Pollock%7CBill%20Sienkiewicz%5C%5C%5D:0.1%5C%5C%5D%5Cn%20%20%20%20negative%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.negative%5D,%20frame,%20photo,%203d%20render,%20cgi,%20watermark,%20signature,%20(normal%20quality,%20bad%20quality,%20low%20quality:1.2)%5Cn%5Cn%5Cn%20%20Anime-Realism%20Paintings%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Banime:%20100,%20painting:100,%20oilPainting:50,%20portrait:40,%20landscape:40,%20cinematic:30%7D)%5D%5Cn%20%20%20%20prompt%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.description%5D,%20%5Bthis.getParent.copyPrompt%5D%5Cn%20%20%20%20copyPrompt%5Cn%20%20%20%20%20%20raw%20photo,%20soft%20lighting,%20diffused%20lighting,%20rtx,%20uhd,%20very%20realistic,%20detailed,%20digital%20painting,%20ilya%20repin,%20gustave%20courbet,%20anders%20zorn,%20realism%20art%20movement%20%5C%5C%5BBREAK%20featured%20in%20pixiv,%20artgerm,%20wlop,%20ross%20tran:0.8%5C%5C%5D%5Cn%20%20%20%20negative%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.negative%5D,%20%5C%5C%5Bchild,%20low%20contrast,%20cel%20shade,%20whitespace%20BREAK%203d%20render,%20hard%20shadow,%20unclear%20features,%20bad%20drawing,%20poor%20illustration,%20worse%20quality:0.1%5C%5C%5D%5Cn%20%20%20%20%20%20%5Cn%20%20Anime-Impressionism%20Paintings%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Banime:%20100,%20painting:100,%20oilPainting:50,%20portrait:40,%20landscape:40,%20cinematic:30%7D)%5D%5Cn%20%20%20%20prompt%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.description%5D,%20%5Bthis.getParent.copyPrompt%5D%5Cn%20%20%20%20copyPrompt%5Cn%20%20%20%20%20%20raw%20photo,%20soft%20lighting,%20diffused%20lighting,%20rtx,%20uhd,%20very%20realistic,%20detailed,%20digital%20painting,%20(claude%20monet,%20mary%20cassatt,%20james%20mcneill%20whistler),%20color%20contrasts,%20impressionism%20%5C%5C%5BBREAK%20featured%20in%20pixiv,%20ross%20tran,%20artgerm,%20wlop:0.8%5C%5C%5D%5Cn%20%20%20%20negative%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.negative%5D,%20%5C%5C%5Bchild,%20low%20contrast,%20cel%20shade,%20whitespace%20BREAK%203d%20render,%20hard%20shadow,%20unclear%20features,%20bad%20drawing,%20poor%20illustration,%20worse%20quality:0.1%5C%5C%5D%5Cn%20%20%20%20%20%20%5Cn%20%20Vintage%20Anime-Realistic%20Render%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Banime:%20100,%20illustration:100,%20drawing:50,%20portrait:40,%20landscape:40,%20cinematic:30%7D)%5D%5Cn%20%20%20%20prompt%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.description%5D,%20%5Bthis.getParent.copyPrompt%5D%5Cn%20%20%20%20copyPrompt%5Cn%20%20%20%20%20%20%5C%5C%5B%5C%5C%5Bvintage%7C50s%7C80s%7C90s%5C%5C%5D%20photo:%5C%5C%5Bvintage%7C50s%7C80s%7C90s%5C%5C%5D%20anime%20style:0.5%5C%5C%5D,%201200%20dpi%20BREAK%20by%20%5C%5C%5BScott%20Naismith%7C%7CAnton%20Fadeev%7C%5C%5C%5D,%20%5C%5C%5B%7CHajime%20Sorayama%7CHajime%20Sorayama%5C%5C%5D%5Cn%20%20%20%20negative%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.negative%5D,%20%5C%5C%5Bchild,%20nsfw,%20nude,%20nipples%20BREAK%20(3d:0.8),%20(cel%20shading:0.8),%20(bad%20quality,border,outline,%20frame,%20text,%20deformity,%20bad%20anatomy,%20illustration,%20sketching,%20digital:1.1):0.05%5C%5C%5D%5Cn%20%20%5Cn%20%20Wetplate%20Photo%20Look%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bportrait:70,%20photo:70,%20cinematic:50,%20vintage:60,%20creepy:30%7D)%5D%5Cn%5Cn%20%20%20%20prompt%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.description%5D,%20%5Bthis.getParent.copyPrompt%5D%5Cn%20%20%20%20copyPrompt%5Cn%20%20%20%20%20%20from%20time%20capsule,%20grunge%20texture,%20%5C%5C%5Baged%20photo:%20wetplate:0.1%5C%5C%5D,%20undeveloped%20photo%5Cn%20%20%20%20negative%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.negative%5D,%20anime,%20nsfw,%20nude,%20nipples%20BREAK%20frame,%20border,%203d%20render,%20(low%20quality,%20bad%20quality,%20normal%20quality:1.1)%5Cn%20%20B&W%20Portrait%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bportrait:100,%20photo:80,%20cinematic:50,%20vintage:10%7D)%5D%5Cn%20%20%20%20prompt%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.description%5D,%20%5Bthis.getParent.copyPrompt%5D%5Cn%20%20%20%20copyPrompt%5Cn%20%20%20%20%20%20centered%20headshot,%20black%20and%20white,%20monochrome,%20contrast%20lighting,%20by%20David%20Bailey%5Cn%20%20%20%20negative%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.negative%5D,%20signature,%20nsfw,%20nude,%20nipples%20BREAK%20blurry,%20out%20of%20focus,%20depth%20of%20field,%20vignette,%20painting,%20anime,%203d%20render,%20cgi,%20drawing,%20(worst%20quality,%20low%20quality,%20normal%20quality:1.1)%5Cn%20%20*Realistic*%20Portraits%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bportrait:100,%20photo:100,%20casualPhoto:50,%20cinematic:30%7D)%5D%5Cn%20%20%20%20prompt%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.description%5D,%20%5Bthis.getParent.copyPrompt%5D%5Cn%20%20%20%20copyPrompt%5Cn%20%20%20%20%20%20in%20soft%20gaze,%20solocentered,%20candid%20head%20shot,%20raw%20photo,%20in%20focus,%20wearing%20clothes,%20best%20quality%5Cn%20%20%20%20negative%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.negative%5D,%20child,%20nsfw,%20no%20clothes,%20porn,%20perfect,%20vignette%20BREAK%203d%20render,%20computergenerated,%20painting,%20drawing,%20illustration,%20denim,%20overexposed,%20depth%20of%20field,%20crop,%20(jpeg,%20hands,%20strabismus,%20normal%20quality,%20low%20quality,%20bad%20quality)%5Cn%20%20*Realistic*%20Anime%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bphotograph:100,anime:70,realism:%2040%7D)%5D%5Cn%20%20%20%20prompt%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.description%5D,%20%5Bthis.getParent.copyPrompt%5D%5Cn%20%20%20%20copyPrompt%5Cn%20%20%20%20%20%20(anime:0.05),%20(by%20%5C%5C%5BMichael%20Carson%7CCraig%20Davison%7CCasey%20Baugh%7CMike%20Dargas%5C%5C%5D:0.1),%20(raw%20photo,%20film%20shot:0.9)%5Cn%20%20%20%20negative%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.negative%5D,%20%5C%5C%5B(outline,%20frame,%20border:1.2),%20overexposed,%20strabismus,%20hands,%20low%20quality,%20depth%20of%20field:0.15%5C%5C%5D%5Cn%20%20Sims/Runescape%20Graphics%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Brender:100,%20cinematic:50,%20threeDimensional:60,%20fantasy:30%7D)%5D%5Cn%20%20%20%20prompt%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.description%5D,%20%5Bthis.getParent.copyPrompt%5D%5Cn%20%20%20%20copyPrompt%5Cn%20%20%20%20%20%20cgi,%203d%20render,%20the%20sims%204,%20old%20school%20runescape,%20volumetric%20lighting,%20ray%20traced,%20opengl%20%5C%5C%5Bshaders%7C%7Cgraphics%5C%5C%5D,%20by%20Zac%20Retz%5Cn%20%20%20%20negative%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.negative%5D,%20watermark,%20signature,%20semi-realistic,%20anime,%20drawing,%20photograph,%20(low%20quality,%20bad%20quality,%20worst%20quality:1.1)%5Cn%20%20%5Cn%20%20Noisy/Grainy%20Effect%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Brender:100,%20filter:80,%20effects:60%7D)%5D%5Cn%20%20%20%20prompt%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.description%5D,%20%5Bthis.getParent.copyPrompt%5D%5Cn%20%20%20%20copyPrompt%5Cn%20%20%20%20%20%20illustration,%20double%20exposure%20BREAK%20soft,%20dithered,%20%5C%5C%5Bnoise%7Cfilm%20grain%5C%5C%5D%20textured%20background,%20in%20%5C%5C%5B8-bit%20vga:macintosh%20se:0.3%5C%5C%5D%20display%5Cn%20%20%20%20negative%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.negative%5D,%20(worst%20quality,%20low%20quality,%20normal%20quality:1.1)%5Cn%5Cn%20%20Glamrock%20Quilt%20Fashion%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bportrait:50,%20casualPhoto:30%7D)%5D%5Cn%20%20%20%20prompt%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.description%5D,%20%5Bthis.getParent.copyPrompt%5D%5Cn%20%20%20%20copyPrompt%5Cn%20%20%20%20%20%20,%20candid%20headshot,%20photography,%20quilt,%20%5C%5C%5Bquiltglamrock:crazy%20quilt%20textured:0.2%5C%5C%5D%20fashion,%20sfx,%20%5C%5C%5BJohn%20Singer%20Sargent:Anders%20Zorn:0.6%5C%5C%5D%5Cn%20%20%20%20negative%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.negative%5D,%20signature,%20nsfw,%20nude,%20nipples%20BREAK%20blurry,%20out%20of%20focus,%20depth%20of%20field,%20vignette,%20painting,%20anime,%203d%20render,%20cgi,%20drawing,%20(worst%20quality,%20low%20quality,%20normal%20quality:1.1)%5Cn%5Cn%20%20Stained%20Glass%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bpainting:40,%20illustration:30%7D)%5D%5Cn%20%20%20%20prompt%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.description%5D,%20%5Bthis.getParent.copyPrompt%5D%5Cn%20%20%20%20copyPrompt%5Cn%20%20%20%20%20%20%5C%5C%5B2d%20sketch%20illustration,%20fineline%20drawing,::0.2%5C%5C%5D%20%5C%5C%5Bdetailed%7Cintricate%7Ctextured%5C%5C%5D,%20(stained%20glass:1.1),%20stained%20glass%20art,%20stained%20glass%20window%5Cn%20%20%20%20negative%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.negative%5D,%20child,%20nsfw,%20porn,%20nipple,%20nude%20BREAK%20overexposed,%20semi%20real,%20photograph,%20drawing,%20text%20signature,%20hands,%203d%20render,%203d,%20computer%20generated,%20(low%20quality,%20bad%20quality,%20normal%20quality)%5Cn%5Cn%20%20Marble%20Sculpture%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bsculpture:40,%20threeDimensional:30%7D)%5D%5Cn%20%20%20%20prompt%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.description%5D,%20%5Bthis.getParent.copyPrompt%5D%5Cn%20%20%20%20copyPrompt%5Cn%20%20%20%20%20%20%5C%5C%5B3d%20render,::0.1%5C%5C%5D,%20sculpted%20out%20of%20marble,%20realistic,%20%5C%5C%5Bdetailed%7Cintricate%5C%5C%5D%20BREAK%20ambient%20occlusion,%20plaster%20texture,%20high%20resolution,%20best%20quality,%204k%5Cn%20%20%20%20negative%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20child,%20nsfw,%20porn%20BREAK%20overexposed,%20semireal,%203d%20render,%20computer%20generated,%20sketch,%20painting,%20drawing,%20cracks,%20text%20signature,%20hands,%20(low%20quality,%20bad%20quality,%20normal%20quality)%5Cn%5Cn%5Cn%5Cn%5Cn//%20ci%20=%20%7Bimport:create-instance-plugin%7D%5CncreateCard(a)%20=%3E%5Cn%20%20console.log(a.getName)%5Cn%20%20let%20id%20=%20a.getName.replaceAll(/%5C%5CW/g,%20'').replaceAll(%5C%22%20%5C%22,%20%5C%22%5C%22)%5Cn%20%20return%20%60%5Cn%20%20%3Cfieldset%20class=%5C%22style-con%5C%22%3E%5Cn%20%20%20%20%3Csummary%3E%3Ch2%3E$%7Ba.getName%7D%3C/h2%3E%3C/summary%3E%5Cn%20%20%20%20%3Cdiv%20id=%5C%22$%7Bid%7D%5C%22%20class=%5C%22img-con%5C%22%3E%5Cn%20%20%20%20%20%20//%20$%7Bnew%20Array(3).fill(0).map((b,i)%20=%3E%20%7B%5Cn%20%20%20%20%20%20//%20%20%20let%20x%20=%20imgPrompt%5Cn%20%20%20%20%20%20//%20%20%20x.prompt%20=%20a.prompt%5Cn%20%20%20%20%20%20//%20%20%20x.negativePrompt%20=%20a.negative%5Cn%20%20%20%20%20%20//%20%20%20x.resolution%20=%20res.selectAll%5Bi%20%25%203%5D%5Cn%20%20%20%20%20%20//%20%20%20return%20%60%3Cfigure%20%3E$%7Bimg(x)%7D%3Cfigcaption%3E$%7BlastTextToImagePrompt.replaceText('%5B',%20'%5C%5C%5C%5C%5B').replaceText('%5D',%20'%5C%5C%5C%5C%5D').replaceAll(a.copyPrompt.replaceText('%5B',%20'%5C%5C%5C%5C%5B').replaceText('%5D',%20'%5C%5C%5C%5C%5D').trim(),%20'').trim()%7D%3C/figcaption%3E%3C/figure%3E%60%5Cn%20%20%20%20%20%20//%20%7D).join(%5C%22%5C%22)%7D%5Cn%20%20%20%20%3C/div%3E%5Cn%20%20%20%20%3Cpre%3E$%7Ba.copyPrompt.replaceText('%5B',%20'%5C%5C%5C%5C%5B').replaceText('%5D',%20'%5C%5C%5C%5C%5D').trim()%7D%3C/pre%3E%5Cn%20%20%20%20%3Cpre%3E$%7Ba.negative.replaceText('%5B',%20'%5C%5C%5C%5C%5B').replaceText('%5D',%20'%5C%5C%5C%5C%5D').trim()%7D%3C/pre%3E%5Cn%20%20%20%20%3Cbutton%20style=%5C%22position:%20absolute;%20top:%20-1.25rem;%20right:%201.5em;%20border:%20none;%20background:%20white;%20border-radius:%2050%25;%20font-size:%201.75rem;%20z-index:%20999;%5C%22%20onclick=%5C%22$%7Bid%7D.innerHTML%20=%20''%5C%22%20title=%5C%22remove%20images?%5C%22%3E%3Ci%20class=%5C%22bi-trash-fill%5C%22%3E%3C/i%3E%3C/button%3E%5Cn%5Cn%20%20%20%20%3Cbutton%20style=%5C%22position:%20absolute;%20top:%20-1.5rem;%20right:%200;%20border:%20none;%20background:%20white;%20border-radius:%2050%25;%20font-size:%202rem;%20z-index:%20999;%5C%22%20onclick=%5C%22reloadImages('$%7Ba.getName%7D')%5C%22%20title=%5C%22add/reload%20images?%5C%22%3E%3Ci%20class=%5C%22bi-arrow-repeat%5C%22%3E%3C/i%3E%3C/button%3E%5Cn%20%20%3C/fieldset%3E%60%5Cn%5CnreloadImages(style)%20=%3E%5Cn%20%20let%20selectedStyle%20=%20%5Bstyle%5D%5Cn%20%20let%20con%20=%20document.getElementById(style.replaceAll(/%5C%5CW/g,%20'').replaceAll(%5C%22%20%5C%22,%20%5C%22%5C%22));%5Cn%20%20console.log(con);%5Cn%20%20let%20html%20=%20new%20Array(3).fill(0).map((b,i)%20=%3E%20%7B%5Cn%20%20%20%20let%20x%20=%20imgPrompt%5Cn%20%20%20%20x.prompt%20=%20selectedStyle.prompt%5Cn%20%20%20%20x.negativePrompt%20=%20selectedStyle.negative%5Cn%20%20%20%20x.resolution%20=%20res.selectAll%5Bi%20%25%203%5D%5Cn%20%20%20%20return%20%60%3Cfigure%20%3E$%7Bimg(x)%7D%3Cfigcaption%3E$%7BlastTextToImagePrompt.replaceText('%5B',%20'%5C%5C%5C%5C%5B').replaceText('%5D',%20'%5C%5C%5C%5C%5D').replaceAll(selectedStyle.copyPrompt.replaceText('%5B',%20'%5C%5C%5C%5C%5B').replaceText('%5D',%20'%5C%5C%5C%5C%5D').trim(),%20'').trim()%7D%3C/figcaption%3E%3C/figure%3E%60%5Cn%20%20%7D).join(%5C%22%5C%22)%5Cn%20%20con.innerHTML%20=%20html;%5Cn%5CngetPromptObj()%20=%3E%5Cn%20%20let%20obj%20=%20Object.entries(%7B...%7D)%5Cn%20%20obj.forEach((a,i,arr)%20=%3E%20arr%5Bi%5D%20=%20%5Ba%5B0%5D,%20Object.entries(a%5B1%5D)%5D)%5Cn%20%20obj.forEach((a,i,arr)%20=%3E%20arr%5Bi%5D%20=%20%5Ba%5B0%5D,%20a%5B1%5D.map((b,ib,barr)%20=%3E%20barr%5Bib%5D%20=%20%5Bb%5B0%5D,%20(x%20=%20b%5B1%5D.getRawListText.split('%5C%5Cn'),%20%20x%20=%20x.getLength%20%3E%202%20?%20x.slice(2).join('%5C%5Cn')%20:%20x.slice(1).join('%5C%5Cn'),%20x.toString().trim())%5D)%5D)%5Cn%20%20obj.forEach((a,i,arr)%20=%3E%20arr%5Bi%5D%20=%20%5Ba%5B0%5D,%20Object.fromEntries(%5B...a%5B1%5D%5D)%5D)%5Cn%20%20obj.forEach((a,i,arr)%20=%3E%20arr%5Bi%5D%20=%20%5Ba%5B0%5D,%20(a%5B1%5D.prompt%20=%20a%5B1%5D.prompt.replace('%5Bthis.getParent.copyPrompt%5D',%20a%5B1%5D.copyPrompt).replaceAll('%5C%5C%5C%5C%5B',%20'%5C%5C%5C%5C%5C%5C%5C%5C%5C%5C%5C%5C%5B').replaceAll('%5C%5C%5C%5C%5D',%20'%5C%5C%5C%5C%5C%5C%5C%5C%5C%5C%5C%5C%5D'),delete%20a%5B1%5D.copyPrompt,%20a%5B1%5D)%5D)%5Cn%20%20//%20console.log(obj);%5Cn%20%20console.log(Object.fromEntries(obj));%5Cn%20%20//%20obj%20=%20obj.map(a%20=%3E%20Object.fromEntries(%5Ba%5B0%5D,%20a%5B1%5D%5Cn%20%20%5Cn%20%20%5Cn%20%20return%20''%5Cn%5CnrandomDescription%5Cn%20%20%7Benigmatic%7Cmysterious%7D%20%7Bdemon%7Cangel%7Cghost%7D%20%7Bqueen%7Cking%7Cprince%7Cprincess%7Cemperor%7D%20%7Bsitting%20on%7Cstanding%20beside%7D%20%7Btheir%20throne%7Ca%20cosmic%20altar%7D,%20%7Ba%20horde%20of%20minions%7Can%20array%20of%20celestial%20servants%7Ca%20legion%20of%20spectral%20beings%7D%20%7Bbehind%7Cin%20front%20of%7D%20then,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20portrait%20of%20%7Ba%7D%20%7Bimport:animal%7D-%7Bman%7Cwoman%7D,%20%7Bservant%7Cgod%7Cpriest%7Cwarrior%7Cgardener%7Ckeeper%7D%20of%20%7Bthe%20underworld%7Cthe%20seven%20worlds%7Clight%7Cdarkness%7Cjungle%20world%7Ccybercrystal%7Cblue%20fire%7Celectrical%20storms%7Cthe%20deep%20heart%7Cthe%20overworld%7Cluxury%7Cdragonkind%7D%5Cn%20%20%7Ba%7D%20%7Bcute%20%7C%5E3%7D%7Bimport:animal%7D%20x%20%7Bimport:animal%7D%20hybrid,%20pokemon-like%20creature%5Cn%20%20%7Bcyborg%7Csteampunk%7Cmagical%7D%20%7Bmermaid%7Cmerman%7Cdolphin%7D%20exploring%20%7Ba%20coral%20reef%7Can%20underwater%20city%7Cunderwater%20dunes%7D%5Cn%20%20%7Bsteampunk%7Cfuturistic%7Cancient%7D%20explorer%20with%20%7Ban%20airship%7Ca%20hoverbike%7Ca%20time-traveling%20artifact%7D%5Cn%20%20%7Bgraceful%7Cagile%7Cmysterious%7D%20%7Balien%7Chuman%7Crobotic%7D%20dancer%20performing%20%7Bon%20stage%7Cin%20a%20street%7Cin%20moonlight%7D%5Cn%20%20%7Bneon%7Csunset%7Cmoonlit%7D%20cityscape%20during%20%7Ba%20rainstorm%7Ca%20snowfall%7Ca%20meteor%20shower%7D%5Cn%20%20%7Bmagical%7Cenchanted%7Ccursed%7D%20forest%20guarded%20by%20%7Bgiant%20mushrooms%7Csentient%20trees%7Cwhimsical%20spirits%7D%5Cn%20%20%7Blonely%7Cbrave%7Ccurious%7D%20lighthouse%20keeper%20with%20%7Ba%20ghostly%7Can%20animal%7Ca%20supernatural%7D%20companion%5Cn%20%20%7Bhaunted%7Cabandoned%7Cancient%7D%20mansion%20inhabited%20by%20%7Bquirky%7Ccreepy%7Ckind%7D%20spirits%5Cn%20%20%7Bfuturistic%7Cold-fashioned%7Cmagical%7D%20train%20racing%20through%20%7Ba%20desert%7Ca%20tundra%7Ca%20jungle%7D%20landscape%5Cn%20%20%7Bunderwater%7Csky%7Cspace%7D%20pirate%20captain%20with%20%7Ba%20submarine%7Can%20airship%7Ca%20spaceship%7D%20ship%5Cn%20%20%7Btime-traveling%7Cinterdimensional%7Csupernatural%7D%20detective%20with%20%7Ba%20pet%20dinosaur%7Ca%20ghostly%20sidekick%7Ca%20shape-shifting%20familiar%7D%5Cn%20%20%7Brobotic%7Cmedieval%7Cfantasy%7D%20knight%20jousting%20on%20%7Ba%20mechanical%7Ca%20fire-breathing%7Ca%20spectral%7D%20horse%5Cn%20%20%7Bethereal%7Cancient%7Ccosmic%7D%20space%20goddess%20floating%20among%20%7Bstars%7Cnebulae%7Cgalaxies%7D%5Cn%20%20%7Bwise%7Cancient%7Cintelligent%7D%20%7Btree%7Crock%7Ccloud%7D%20spirit%20with%20%7Ba%20magical%20staff%7Ca%20crystal%20orb%7Can%20enchanted%20flute%7D%5Cn%20%20%7Bsuperhero%7Cvillain%7Cantihero%7D%20with%20the%20ability%20to%20control%20%7Bplants%7Cweather%7Cfire%7D%5Cn%20%20%7Bflying%7Chovering%7Csubmersible%7D%20car%20chase%20through%20%7Ba%20futuristic%7Can%20underwater%7Ca%20post-apocalyptic%7D%20city%5Cn%20%20%7Bunderwater%7Cfloating%7Chidden%7D%20cityscape%20lit%20by%20%7Bbioluminescent%20plants%7Cancient%20crystals%7Cmagical%20torches%7D%5Cn%20%20%7Bmystical%7Ccursed%7Cprehistoric%7D%20cave%20with%20%7Bglowing%20crystal%7Cshimmering%20ice%7Cluminescent%20fungus%7D%20formations%5Cn%20%20%7Bpost-apocalyptic%7Cfuturistic%7Cancient%7D%20wanderer%20with%20%7Ba%20pet%20robot%7Ca%20loyal%20animal%20companion%7Ca%20supernatural%20guide%7D%5Cn%20%20%7Bmasked%7Carmored%7Cstealthy%7D%20vigilante%20perched%20%7Bon%20a%20skyscraper%7Cin%20a%20tree%7Catop%20a%20cliff%7D%5Cn%20%20%7Bsorceress%7Cwitch%7Calchemist%7D%20brewing%20%7Ba%20potion%7Ca%20spell%7Ca%20concoction%7D%20in%20%7Bher%20hidden%20lair%7Ca%20secret%20cave%7Can%20enchanted%20laboratory%7D%5Cn%20%20%7Bsteampunk%7Ccyberpunk%7Cfantasy%7D%20inventor%20with%20%7Ba%20mechanical%7Ca%20magical%7Ca%20sentient%7D%20companion%5Cn%20%20%7Bcyberpunk%7Cinterstellar%7Cparanormal%7D%20hacker%20in%20%7Ba%20digital%20world%7Ca%20secret%20network%7Can%20alternate%20reality%7D%5Cn%20%20%7Benchanted%7Cfairy-tale%7Csecret%7D%20garden%20filled%20with%20%7Bmythical%7Cunusual%7Cmagical%7D%20creatures%5Cn%20%20%7Bcute%7Cfierce%7Cfriendly%7D%20monster%20family%20%7Bgoing%20on%20a%20picnic%7Cexploring%20a%20forest%7Cvisiting%20a%20village%7D%5Cn%20%20%7Bastronaut%7Calien%7Ctime-traveler%7D%20discovering%20%7Ban%20alien%20oasis%7Ca%20hidden%20planet%7Ca%20realm%20beyond%20time%7D%5Cn%20%20%7Bold-fashioned%7Cmodern%7Cmagical%7D%20%7Bice%20cream%7Ccandy%7Cdessert%7D%20parlour%20with%20%7Bmagical%7Cunusual%7Cdangerous%7D%20flavors%5Cn%20%20%7Babandoned%7Chaunted%7Cenchanted%7D%20amusement%20park%20%7Breclaimed%20by%20nature%7Cinhabited%20by%20spirits%7Cguarded%20by%20creatures%7D%5Cn%20%20%7Bwarrior%7Csorceress%7Cqueen%7D%20riding%20%7Ba%20mythical%7Ca%20giant%7Can%20elemental%7D%20beast%5Cn%20%20%7Bvintage%7Cmodern%7Cotherworldly%7D%20circus%20with%20%7Bsupernatural%7Cmagical%7Cdangerous%7D%20performers%5Cn%20%20%7Botherworldly%7Cmajestic%7Cmysterious%7D%20library%20filled%20with%20%7Bancient%7Cenchanted%7Cforbidden%7D%20tomes%5Cn%20%20%7Bintrepid%7Cfearless%7Cdaring%7D%20explorer%20navigating%20%7Ba%20perilous%7Ca%20mysterious%7Can%20enchanted%7D%20jungle%5Cn%20%20%7Bcozy%7Cremote%7Cenchanted%7D%20cottage%20in%20%7Bthe%20mountains%7Ca%20forest%7Ca%20magical%20realm%7D%20with%20%7Bmagical%7Csupernatural%7Cancient%7D%20neighbors%5Cn%20%20%7Bstreet%7Cstage%7Ctelevised%7D%20magician%20performing%20%7Ba%20jaw-dropping%7Ca%20dangerous%7Can%20enchanting%7D%20illusion%5Cn%20%20%7Bmighty%7Cancient%7Cwinged%7D%20dragon%20%7Bslumbering%7Cguarding%7Chiding%7D%20atop%20%7Ba%20hoard%20of%20treasure%7Cenchanted%20crystals%7Ccursed%20artifacts%7D%5Cn%20%20%7Bchibi-style%7Ccartoon%7Crealistic%7D%20superheroes%20%7Bsaving%20the%20day%7Cbattling%20villains%7Cprotecting%20a%20city%7D%5Cn%20%20%7Bwhimsical%7Cindustrial%7Csupernatural%7D%20factory%20where%20%7Bdreams%7Cnightmares%7Cwishes%7D%20are%20manufactured%5Cn%20%20%7Bspace%7Cintergalactic%7Ctime-traveling%7D%20cowboy%20hunting%20%7Bintergalactic%20outlaws%7Cancient%20threats%7Csupernatural%20foes%7D%5Cn%20%20%7Bnecromancer%7Csummoner%7Cwitch%7D%20raising%20%7Ban%20army%20of%20the%20undead%7Celemental%20creatures%7Cmagical%20beings%7D%5Cn%20%20%7Bbrave%7Ccursed%7Clegendary%7D%20warrior%20with%20%7Ba%20haunted%7Can%20enchanted%7Ca%20sentient%7D%20weapon%5Cn%20%20%7Binterdimensional%7Ccosmic%7Cparanormal%7D%20%7Bcoffee%7Ctea%7Cdessert%7D%20shop%20frequented%20by%20%7Bodd%7Cmagical%7Calien%7D%20patrons%5Cn%20%20%7Benchanted%7Cbewitched%7Csacred%7D%20forest%20populated%20by%20%7Bsentient%7Cmagical%7Ccursed%7D%20trees%5Cn%20%20%7Bcybernetic%7Csupernatural%7Cmystical%7D%20musician%20creating%20%7Botherworldly%7Chaunting%7Chypnotic%7D%20tunes%5Cn%20%20%7Balien%7Clost%7Cancient%7D%20civilization%20thriving%20on%20%7Ba%20floating%20island%7Ca%20hidden%20continent%7Can%20undiscovered%20planet%7D%5Cn%20%20woman,%20at%20a%20%7Bmarket%7Cgrocery%20store%7D,%20%7Bchoosing%20fruits%7Cselecting%20produce%7D,%20sunny%20smile,%20close-up%5Cn%20%20man,%20at%20a%20%7Bzoo%7Csafari%7D,%20%7Bfeeding%20giraffe%7Cwatching%20elephants%7D,%20laughing,%20close-up%5Cn%20%20girl%20at%20a%20%7Bplayground%7Cpark%7D,%20on%20swings,%20%7Bskyward%7Cforward%7D,%20joyous,%20close-up%5Cn%20%20%7Bdj%7Cmusician%7D,%20%7Bmixing%7Cperforming%7D,%20at%20a%20club,%20crowd,%20excited,%20close-up%5Cn%20%20woman,%20in%20a%20%7Byoga%20pose%7Ctai%20chi%20stance%7D,%20%7Bpeaceful%20garden%7Czen%20studio%7D,%20serene,%20close-up%5Cn%20%20chef,%20at%20a%20%7Bfood%20truck%7Cdiner%7D,%20serving%20%7Btacos%7Cburgers%7D,%20friendly%20wink,%20close-up%5Cn%20%20%7Bgirl%7Cboy%7D,%20in%20a%20%7Bsnowy%20landscape%7Crainy%20city%7D,%20%7Bcatching%20snowflakes%7Cjumping%20in%20puddles%7D,%20amused,%20close-up%5Cn%20%20sailor,%20in%20a%20%7Bboat%7Cdock%7D,%20%7Bsea%7Clake%7D,%20%7Bstormy%20weather%7Ccalm%20waters%7D,%20determined,%20close-up%5Cn%20%20woman,%20at%20a%20%7Bvineyard%7Cbrewery%7D,%20%7Btasting%20wine%7Csampling%20beer%7D,%20indulgent%20smile,%20close-up%5Cn%20%20%7Bman%7Cwoman%7D,%20hiking,%20%7Bforest%7Cdesert%7Cmountain%7D,%20close-up%5Cn%20%20girl,%20at%20a%20%7Bmusic%20store%7Ccomic%20shop%7D,%20%7Bflipping%20through%20vinyl%20records%7Cbrowsing%20graphic%20novels%7D,%20nostalgic,%20close-up%5Cn%20%20%7Bman%7Cwoman%7D,%20in%20a%20lab,%20%7Bmicroscope%7Ctest%20tubes%7D,%20%7Bdiscovery%7Cexperiment%7D,%20astonished,%20close-up%5Cn%20%20%7Bbeautiful%20%7C%7Dwoman,%20at%20a%20%7Bcafe%7Cco-working%20space%7D,%20%7Blaptop%7Cnotepad%7D,%20deep%20in%20work,%20focused,%20close-up%5Cn%20%20soldier,%20in%20%7Buniform%7Ccamouflage%7D,%20%7Bsaluting%7Cat%20attention%7D,%20proud,%20close-up%5Cn%20%20%7Bbeautiful%20%7C%7Dwoman,%20in%20a%20%7Bgreenhouse%7Cbotanical%20garden%7D,%20%7Bsurrounded%20by%20plants%7Cstudying%20foliage%7D,%20peaceful,%20close-up%5Cn%20%20man,%20at%20a%20%7Bpottery%20wheel%7Cloom%7D,%20%7Bmolding%20clay%7Cweaving%20fabric%7D,%20concentrated,%20close-up%5Cn%20%20%7Bgirl%7Cboy%7D,%20at%20a%20%7Brooftop%7Cpenthouse%7D,%20%7Blooking%20at%20stars%7Cwatching%20the%20city%7D,%20thoughtful,%20close-up%5Cn%20%20%7Bman%7Cwoman%7D,%20in%20a%20tattoo%20parlor,%20%7Bgetting%20inked%7Cchoosing%20designs%7D,%20excited,%20close-up%5Cn%20%20woman,%20at%20a%20%7Bbasketball%20game%7Csoccer%20match%7D,%20cheering,%20exuberant,%20close-up%5Cn%20%20%7Btailor%7Cdressmaker%7D,%20%7Bfitting%20a%20suit%7Cadjusting%20a%20dress%7D,%20%7Bmeasuring%20tape%7Cpins%7D,%20focused,%20close-up%5Cn%20%20%7Bbeautiful%20%7C%7Dwoman,%20at%20a%20%7Blake%7Cpond%7D,%20%7Bskipping%20stones%7Crowing%20a%20boat%7D,%20playful%20grin,%20close-up%5Cn%20%20hawaiian%20%7Bwoman%7Cman%7D,%20%7Bbeach%7Cgarden%7D%20selfie,%20%7Bflower%20crown%7Cleis%7D,%20%7Bsmiling%7Cgoofy%7D%20expression%5Cn%20%20%7Bbeautiful%20%7Ccute%20%7C%7D%7Bnorwegian%7Cswedish%7D%20college%20girl,%20selfie%20on%20the%20couch,%20%7Bbraided%20hair%7Cponytail%7D,%20puckered%20lips%5Cn%20%20%7Bbeautiful%20%7Ccute%20%7C%7Dindian%20%7Bman%7Cwoman%7D,%20%7Bstudy%7Chome%20office%7D%20selfie,%20%7Bspectacles%7Cheadphones%7D,%20amused%5Cn%20%20%7Bbeautiful%20%7Ccute%20%7C%7D%7Bjapanese%7Ckorean%7D%20%7Bman%7Cwoman%7D,%20%7Bbathroom%7Cbedroom%7D%20selfie,%20%7Bcasual%20wear%7Cpajamas%7D,%20dimpled%20grin%5Cn%20%20%7Bbeautiful%20%7Ccute%20%7C%7Dafrican%20%7Bwoman%7Cman%7D,%20%7Bbalcony%7Cterrace%7D%20full-body%20selfie,%20%7Bsundress%7Cshorts%7D,%20%7Bbarefoot%7Csandaled%7D%20with%20a%20%7Blaid-back%7Ccheery%7D%20smile%5Cn%20%20%7Bbeautiful%20%7Ccute%20%7C%7D%7Bpolish%7Cukrainian%7D%20girl,%20%7Bbedroom%7Cliving%20room%7D%20mirror%20selfie,%20%7Btracksuit%7Cleisure%20wear%7D,%20%7Btied%20up%20hair%7Ccap%7D,%20%7Bcasual%7Crelaxed%7D%20look%5Cn%20%20%7Bbeautiful%20%7Ccute%20%7C%7D%7Bmexican%7Cspanish%7D%20%7Bman%7Cwoman%7D,%20%7Bcouch%7Cgarden%7D%20selfie,%20%7Bbook%7Ccoffee%7D%20in%20hand,%20%7Bglasses%7Cbeanie%7D,%20%7Bcontent%7Cabsorbed%7D%20expression%5Cn%20%20%7Bbeautiful%20%7Ccute%20%7C%7Dchinese%20%7Bwoman%7Cman%7D,%20%7Bkitchen%7Cdining%20room%7D%20selfie,%20%7Bapron%7Cchef%E2%80%99s%20hat%7D,%20%7Bcooking%7Cbaking%7D,%20%7Bpleased%7Cexcited%7D%20grin%5Cn%20%20%7Bbeautiful%20%7Ccute%20%7C%7D%7Bitalian%7Cfrench%7D%20%7Bwoman%7Cman%7D,%20%7Bbedroom%7Chome%20studio%7D%20mirror%20selfie,%20%7Bpaint-stained%20jeans%7Csmudged%20shirt%7D,%20%7Bbrush%7Cpalette%7D%20in%20hand,%20%7Bcreative%7Cinspired%7D%20look%5Cn%20%20%7Bbeautiful%20%7Ccute%20%7C%7D%7Bcanadian%7Camerican%7D%20%7Bman%7Cwoman%7D,%20%7Bbackyard%7Cfront%20porch%7D%20full-body%20selfie,%20%7Bplaid%20shirt%7Cdenim%20jacket%7D,%20%7Bbaseball%20cap%7Csunglasses%7D,%20%7Bgrinning%7Cwinking%7D%20expression%5Cn%20%20%7Bmountain%7CMediterranean%7D%20vista,%20%7Bsunrise%7Csunset%7D,%20%7Bforested%7Cclear%7D%20landscape,%20%7Bmisty%7Cclear%7D%20view%5Cn%20%20cityscape,%20%7Bnight%7Cdawn%7D,%20%7Bskyscrapers%7Chistoric%20buildings%7D,%20%7Bglistening%7Csoft%7D%20lights%5Cn%20%20%7Bsafari%7Cgrassland%7D,%20%7Blion%7Celephant%7D,%20%7Bprowling%7Cgrazing%7D,%20%7Bhot%20midday%7Ccool%20dusk%7D%5Cn%20%20%7Bceltic%7Cscottish%7Cirish%7D%20man,%20early%20%7B30s%7C40s%7D,%20%7Bred%7Cauburn%7Cginger%7D%20hair,%20wearing%20a%20%7Btartan%7Cwoolen%7Cclan%7D%20kilt,%20on%20a%20%7Bwindy%7Cgrass-covered%7Crolling%7D%20hill,%20%7Bbagpipes%7Cflute%7D%20in%20the%20background,%20close%20up%5Cn%20%20%7Bhawaiian%7Cpolynesian%7Ctahitian%7D%20woman,%20late%20%7Bteens%7Cearly%2020s%7D,%20%7Blong%7Ccurly%7Cflowing%7D%20hair,%20wearing%20a%20%7Bgrass%7Cleaf%7Cfloral%7D%20skirt,%20on%20the%20%7Bbeach%7Cseashore%7D,%20%7Bhula%7Ctraditional%7D%20dance,%20close%20up%5Cn%20%20%7Bmexican%7Ctexan%7Cnew%20mexican%7D%20man,%20mid%20%7B40s%7C50s%7D,%20%7Bmustache%7Cbeard%7D,%20wearing%20a%20%7Bsombrero%7Cwide-brimmed%20hat%7D,%20%7Bzarape%7Cponcho%7D,%20in%20a%20%7Bsleepy%7Chumble%7Cquiet%7D%20village,%20%7Bsiesta%20time%7Cafternoon%20nap%7D,%20close%20up%5Cn%20%20%7Bindonesian%7Cjavanesian%7Cbalinese%7D%20woman,%20early%20%7B30s%7C40s%7D,%20%7Bbatik%7Cfloral%7Ctraditional%7D%20headscarf,%20in%20a%20%7Brice%20paddy%7Cgreen%20field%7D,%20%7Bdistant%20volcano%7Cmountain%20range%7D,%20%7Bsunset%7Cdusk%7D,%20close%20up%5Cn%20%20%7Baustralian%7Caussie%7Coutback%7D%20man,%20late%20%7B20s%7C30s%7D,%20%7Bsun-bleached%7Clight%20brown%7Csandy%7D%20hair,%20wearing%20a%20%7Bbush%7Cleather%7Coutback%7D%20hat,%20in%20a%20%7Bdusty%20outback%7Crugged%20wilderness%7D,%20%7Bkangaroo%7Chopping%20kangaroo%7Cwildlife%7D%20hopping%20by,%20close%20up%5Cn%20%20%7Bcambodian%7Ckhmer%7Csouth%20asian%7D%20woman,%20mid%20%7B20s%7C30s%7D,%20%7Bsleek%7Cdark%7Clong%7D%20hair,%20wearing%20a%20%7Bsampot%7Ctraditional%20dress%7D,%20in%20a%20%7Btemple%7Cancient%20ruin%7D,%20%7Bincense%7Ccandle%7D%20smoke,%20close%20up%5Cn%20%20%7Bargentinian%7Cchilean%7Csouth%20american%7D%20man,%20early%20%7B30s%7C40s%7D,%20%7Bslicked-back%7Cneat%7Ctidy%7D%20hair,%20wearing%20a%20%7Bgaucho%7Ccowboy%7D%20outfit,%20on%20a%20%7Branch%7Cfarm%7D,%20%7Bhorses%7Clivestock%7D%20grazing,%20close%20up%5Cn%20%20%7Becuadorian%7Cperuvian%7Candes%7D%20woman,%20late%20%7Bteens%7Cearly%2020s%7D,%20wearing%20a%20%7Bcolorful%7Cvibrant%7Cwoolen%7D%20poncho,%20in%20a%20%7Bflower%7Coutdoor%7D%20market,%20%7BAndean%7Cmountainous%7D%20mountains,%20close%20up%5Cn%20%20%7Bromanian%7Ctransylvanian%7Ceast%20european%7D%20woman,%20early%20%7B40s%7C30s%7D,%20%7Bbraided%7Cwoven%7Clong%7D%20hair,%20wearing%20a%20%7Bpeasant%20blouse%7Ctraditional%20top%7D,%20in%20a%20%7Bfortified%20church%7Cancient%20chapel%7D,%20%7Bmedieval%7Crustic%7D%20atmosphere,%20close%20up%5Cn%20%20%7Bsamoan%7Cpolynesian%7Cpacific%7D%20man,%20early%20%7B30s%7C40s%7D,%20%7Bmuscular%7Cstrong%7Cwell-built%7D,%20wearing%20a%20%7Blava-lava%7Ctraditional%20cloth%7D,%20on%20a%20%7Bbeach%7Cshore%7D,%20%7BPacific%20Ocean%7Clagoon%7D,%20%7Bsunset%7Cdusk%7D,%20close%20up%5Cn%20%20%7Bscottish%7Chighland%7Cceltic%7D%20woman,%20late%20%7B20s%7Cearly%2030s%7D,%20%7Bred%7Cstrawberry%20blonde%7Cauburn%7D%20curls,%20wearing%20a%20%7Btartan%7Cwoolen%7Cplaid%7D%20shawl,%20on%20a%20%7Bwindy%7Clonely%7Cbare%7D%20moor,%20%7Bbagpipes%7Clonely%20music%7D%20in%20the%20distance,%20close%20up%5Cn%20%20%7Bperuvian%7Candes%7Csouth%20american%7D%20man,%20late%20%7B40s%7C50s%7D,%20wearing%20a%20%7Bchullo%7Cwoolen%20cap%7D,%20in%20a%20%7Bmarket%7Cbazaar%7D,%20%7Bllamas%7Calpacas%7D%20grazing,%20close%20up%5Cn%20%20%7Bvietnamese%7Csoutheast%20asian%7Casiatic%7D%20woman,%20%7B20s%7Clate%20teens%7D,%20%7Blong%7Cflowing%7Cblack%7D%20hair,%20wearing%20an%20%7Bao%20dai%7Ctraditional%20dress%7D,%20in%20a%20%7Blantern-lit%7Cmoonlit%7D%20street,%20%7BTet%20celebration%7CNew%20Year%20celebration%7D,%20close%20up%5Cn%20%20%7Bcyberpunk%7Cfuturistic%7Cpunk%7D%20girl,%20%7Bneon%7Cflaming%7Cluminous%7D%20hair,%20%7Baugmented%20reality%20glasses%7Cholographic%20visor%7Claser%20monocle%7D,%20in%20a%20%7Btechnopolis%7Cmegacity%7Celectron%20city%7D,%20%7Bneon%20lights%7Claser%20beams%7Cholographic%20billboards%7D,%20%7Bgraffiti%7Cposter-covered%7CLED%7D%20walls,%20close%20up%5Cn%20%20%7Bninja%7Csamurai%7Cassassin%7D,%20%7Bmasked%7Chooded%7Chooded%20and%20masked%7D,%20%7Bdarting%7Cpiercing%7Calert%7D%20eyes,%20%7Bshuriken%7Ckunai%7Cninja%20stars%7D%20on%20belt,%20lurking%20in%20the%20%7Bshadows%7Cdarkness%7Cunderbrush%7D,%20%7Bbamboo%7Cpine%7Csakura%7D%20forest,%20%7Bfull%7Ccrescent%7Cnew%7D%20moon,%20close%20up%5Cn%20%20%7Bsuccubus%7Cdemoness%7Cfiend%7D,%20%7Bcrimson%7Cobsidian%7Craven%7D%20hair,%20%7Bblack%7Cdark%7Cshadowy%7D%20wings,%20%7Brevealing%7Csculpted%7Cintricate%7D%20black%20dress,%20in%20a%20%7Bgothic%7Cancient%7Cforbidding%7D%20castle,%20%7Bflickering%7Cdim%7Csputtering%7D%20candles%5Cn%20%20%7Bgreek%7Croman%7Cmythical%7D%20goddess,%20%7Bflowing%7Cdraping%7Cbillowing%7D%20white%20robes,%20%7Bgolden%7Csilver%7Cbronze%7D%20laurel%20crown,%20in%20an%20%7Bancient%7Cmarble%7Cstone%7D%20temple,%20%7Bolive%7Ccypress%7Cpalm%7D%20trees,%20%7Bsetting%7Crising%7Cmidday%7D%20sun,%20close%20up%5Cn%20%20%7Bsteampunk%7Cvintage%7Cretro%7D%20woman,%20%7Bgoggles%7Cmonocle%7Cspectacles%7D,%20%7Bcorset%7Cbodice%7Cvest%7D,%20in%20a%20%7BVictorian%7Cindustrial-era%7Cold-world%7D%20cityscape,%20%7Bsteam-powered%7Cgear-driven%7Cclockwork%7D%20machines,%20%7Bcobblestone%7Cbrick-paved%7Cgravel%7D%20streets,%20close%20up%5Cn%20%20%7Bmuscular%7Ctowering%7Cburly%7D%20tauren,%20%7Btribal%7Cancient%7Cspiritual%7D%20tattoos,%20wearing%20a%20%7Bfur%20kilt%7Cleather%20loincloth%7Chide%20pants%7D,%20in%20a%20%7Bgrassy%20knoll%7Csacred%20site%7Cprairie%7D,%20%7Btowering%7Ccarved%7Cancient%7D%20totem%20poles,%20%7Bsunset%7Cdawn%7Ctwilight%7D%5Cn%20%20%7Battractive%7Cmysterious%7Calluring%7D%20vampire,%20%7Bpale%7Cmoonlit%7Ctranslucent%7D%20skin,%20%7Bslicked%20back%7Cmessy%7Ccurly%7D%20hair,%20%7Bpiercing%7Cglowing%7Cshimmering%7D%20red%20eyes,%20in%20a%20%7BEuropean%7Cmedieval%7Cancient%7D%20castle,%20%7Bfull%7Ccrescent%7Ccloud-covered%7D%20moon,%20close%20up%5Cn%20%20%7Bviking%7Cnorse%7Cwarrior%7D%20warrior,%20%7Bburly%7Cmuscular%7Cbattle-hardened%7D,%20%7Bspear%7Caxe%7Csword%7D,%20wearing%20a%20%7Bfur%20cloak%7Cleather%20armor%7Cwolf%20pelt%7D,%20in%20a%20%7Blongboat%7Cdrakkar%7Cship%7D,%20%7Bicy%20fjord%7Cchurning%20sea%7Ccalm%20lake%7D,%20%7Bnorthern%20lights%7Cstarry%20sky%7Cmisty%20skies%7D,%20close%20up%5Cn%20%20%7Btiefling%7Cdemonic%7Chellborn%7D%20priestess,%20%7Bdark%20purple%7Cburgundy%7Cdeep%20blue%7D%20skin,%20%7Blong%7Ccurved%7Ctwisted%7D%20horns,%20wearing%20a%20%7Bceremonial%7Csacred%7Cornate%7D%20robe,%20in%20a%20%7Bdarkened%7Cshadowy%7Csilent%7D%20chapel,%20%7Bstained%20glass%7Cmosaic%7Cetched%7D%20windows%5Cn%20%20%7Bogre%7Cgiant%7Cbrute%7D,%20%7Blarge%7Cimposing%7Ctowering%7D,%20wearing%20%7Brough%20hide%7Cpatchwork%20leather%7Cthick%20fur%7D%20armor,%20in%20a%20%7Bdank%7Cmurky%7Cfetid%7D%20swamp,%20%7Bbuzzing%7Cswarming%7D%20mosquitoes%5Cn%20%20%7Bfairy%7Cfae%7Cpixie%7D,%20%7Biridescent%7Cshimmering%7Ctranslucent%7D%20wings,%20%7Blong%20wavy%7Ccurly%7Cpixie%20cut%7D%20hair,%20in%20a%20%7Bmushroom%7Cfairy%7Cflower%7D%20ring,%20%7Bforest%7Cglen%7Cmeadow%7D%20glade,%20%7Bfireflies%7Cglow%20worms%7Cmoonbeams%7D%20around,%20close%20up%5Cn%20%20%7Bmermaid%7Csiren%7D,%20%7Bshimmering%7Csparkling%7Cradiant%7D%20tail,%20%7Bflowing%7Ccurly%7Cwavy%7D%20red%20hair,%20%7Bsunning%7Clounging%7Cresting%7D%20on%20a%20rock,%20%7Bazure%7Ccrystal-clear%7Cturquoise%7D%20sea,%20%7Bseagulls%7Calbatrosses%7Cpelicans%7D%20soaring,%20close%20up%5Cn%20%20%7Bdragonborn%7Cdraconian%7Cdrake-blooded%7D,%20%7Bscales%7Cspines%7Cridged%20armor%7D,%20wearing%20a%20%7Bplate%7Cchainmail%7Cscale%7D%20armor,%20in%20a%20%7Bcavern%7Cmountain%20lair%7Chidden%20den%7D,%20hoard%20of%20%7Btreasure%7Cgold%7Cjewels%7D,%20%7Bflickering%7Cblazing%7Cguttering%7D%20torchlight,%20close%20up%5Cn%20%20%7Belven%7Csylvan%7Cwoodland%7D%20ranger,%20%7Blongbow%7Cshortbow%7Ccrossbow%7D,%20%7Bgreen%7Cbrown%7Cforest%7D%20cloak,%20in%20a%20%7Bdense%7Clush%7Cdeep%7D%20forest,%20%7Bancient%7Cmajestic%7Ctowering%7D%20trees,%20%7Brustling%7Cwhispering%7Cswaying%7D%20leaves,%20close%20up%5Cn%20%20%7Bgnome%7Cdwarf%7Chalfling%7D%20tinkerer,%20%7Bgoggles%7Cspectacles%7Cmonocle%7D,%20%7Boveralls%7Cworkwear%7Capron%7D,%20in%20a%20%7Bcluttered%7Cchaotic%7Cbustling%7D%20workshop,%20%7Bgears%20and%20springs%7Ccogs%20and%20wheels%7Cparts%20and%20pieces%7D,%20%7Bsparks%7Cflames%7Cembers%7D%20flying,%20close%20up%5Cn%20%20%7Bamazonian%7Cwarrior%7Cjungle%7D%20warrior,%20%7Btall%7Cstatuesque%7Cmighty%7D%20and%20muscular,%20wearing%20a%20%7Bleather%20cuirass%7Cscale%20armor%7Ccloth%20wrap%7D,%20in%20a%20%7Bjungle%7Crainforest%7Ccanopy%7D%20clearing,%20%7Bparrots%7Cmacaws%7Ctoucans%7D%20squawking,%20close%20up%5Cn%20%20%7Bcybernetic%7Cfuturistic%7Ctechno%7D%20samurai,%20%7Bkatana%7Claser%20sword%7Cmonomolecular%20blade%7D,%20in%20a%20%7Bneo-Tokyo%7Cdystopian%7Cfuturistic%7D%20cityscape,%20%7Bneon%20signs%7Cholo%20ads%7CLED%20billboards%7D,%20%7Brain-soaked%7Cneon-lit%7Cfoggy%7D%20streets,%20close%20up%5Cn%20%20%7Bsorceress%7Cmage%7Cwitch%7D,%20%7Bstaff%7Cwand%7Corb%7D,%20in%20a%20%7Bspellbound%7Cenchanted%7Carcane%7D%20tower,%20%7Bfloating%7Clevitating%7Chovering%7D%20books,%20%7Barcane%7Cmystic%7Cancient%7D%20symbols,%20close%20up%5Cn%5Cn%5Cn//%20t2i_tags%5Cn//%20%20%20anime%5Cn//%20%20%20painting%5Cn//%20%20%20paintedAnime%5Cn//%20%20%20drawing%5Cn//%20%20%20cartoon%5Cn//%20%20%20photo%5Cn//%20%20%20casualPhoto%5Cn//%20%20%20portrait%5Cn//%20%20%20render%5Cn//%20%20%20cinematic%5Cn//%20%20%20landscape%5Cn//%20%20%20digitalPainting%5Cn//%20%20%20disney%5Cn//%20%20%20comic%5Cn//%20%20%20sketch%5Cn//%20%20%20oilPainting%5Cn//%20%20%20basicAnime%5Cn//%20%20%20drawnAnime%5Cn//%20%20%20cuteAnime%5Cn//%20%20%20fantasy%5Cn//%20%20%20poster%5Cn//%20%20%20coverArt%5Cn//%20%20%20vintage%5Cn//%20%20%20fantasyPortrait%5Cn//%20%20%20ghibli%5Cn//%20%20%20pixelArt%5Cn//%20%20%20furryOil%5Cn//%20%20%20furry%5Cn//%20%20%20emoji%5Cn//%20%20%20illustration%5Cn//%20%20%20pokemon%5Cn//%20%20%20manga%5Cn//%20%20%20map%5Cn//%20%20%20icon%5Cn//%20%20%20logo%5Cn//%20%20%20tattoo%5Cn//%20%20%20waifu%5Cn//%20%20%20yugioh%5Cn//%20%20%20japanese%5Cn//%20%20%20claymation%5Cn//%20%20%20basicCartoon%5Cn//%20%20%20creepy%20%20%22,%22imports%22:%5B%22animal%22,%22text-to-image-plugin%22,%22vionet20-t2i-styles-importable-v2%22%5D,%22lastEditTime%22:1747641269971,%22found%22:true%7D,%7B%22name%22:%22x-xx-styles-andothersv1%22,%22modelText%22:%22//%20note%20that%20%60input%60%20is%20a%20global%20variable%20(i.e.%20%60input%60%20is%20%60window.input%60),%20which%20is%20created%20by%20t2i-framework-plugin%5Cn//%20see%20here%20for%20an%20example%20generator%20that%20imports%20these%20styles:%20https://perchance.org/ai-character-generator#edit%5Cn//%20style%20tester:%20https://perchance.org/prompt-style-tester%5Cn%5Cn//%20This%20is%20a%20list%20of%20styles%20that%20i%20copypast%20from%20the%20generator:%20https://perchance.org/text2image-generator%5Cn//%20I%20made%20the%20necessary%20adjustments%20to%20my%20own%20generator,%20this%20should%20also%20work%20on%20any%20normal%20generator%20that%20uses%20t2i-framework-plugin-v%5Cn%5Cn%5Cn%5Cn%20%20%20%20%5Cn%20%20%E3%80%8BAnti-NSFW%5Cn%20%20%20%20prompt%20=%20%5Binput.description%5D,%20SFW%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D,%20NSFW,%20inappropriate,%20nudity,%2018+%20content,%20naked,%20nude,%20censored%5Cn%20%20%E3%80%8BManga%5Cn%20%20%20%20prompt%20=%20%5Binput.description%5D,%20manga,%20Japanese%20manga,%20hand%20drawn%20art%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D,%20photo%20%20%20%20%5Cn%20%20%E3%80%8BClassic%20anime%5Cn%20%20%20%20prompt%20=%20%5Binput.description%5D,%20anime%20style,%20painted%20anime,%20classic%20anime%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D,%20bad%20art,%20deformed%5Cn%20%20%E3%80%8BModern%20anime%5Cn%20%20%20%20prompt%20=%20%5Binput.description%5D,%20anime%20style,%20art%20by%20Pixiv,%20modern%20anime,%20soft%20lighting%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D,%20bad%20art,%20deformed%5Cn%20%20%E3%80%8BRealistic%20anime%5Cn%20%20%20%20prompt%20=%20Anime%20art%20of%20%5Binput.description%5D,%20full%20body%20shot,%20(real%20eyes%20and%20face),%20detailed%20photo,%20anime%20style,%20real%20hair,%20hyperrealistic%20surroundings,%20realistic%20background,%20detailed,%20real%20photo,%20realistic%20lighting,%208k%20UHD,%20proper%20shading%20and%20shadows,%20realistic%20face%20and%20fingers,%20proper%20body,%20in%20frame,%20high%20quality%20photo,%20proper%20fingers%20and%20face%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D,%20bad%20quality,%20deformed,%20drawn,%20painted,%20blurry,%20computer%20generated,%20unnatural,%20bad%20image,%20bad%20anatomy%5Cn%20%20%E3%80%8BAbstract%20art%5Cn%20%20%20%20prompt%20=%20%5Binput.description%5D,%20abstract%20art,%20colorful%20image,%20smooth%20colors,%20bright%20image,%20vibrant,%20smooth%20coloring%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D,%20bad%20quality,%20sharp%20edges%5Cn%20%20%E3%80%8BBorderlands%20art%5Cn%20%20%20%20prompt%20=%20%5Binput.description%5D,%20((3D)),%20CGI,%20Borderlands:1.25,%20Borderlands%20Style%20Artwork,%20Borderlands%20Characters:1.25,%203D%20Cell%20Shading,%20Comic-Style%20Outlines,%20Fine%20Details,%20Intricate%20Details,%20Detailed%20Shading,%20Sharp%20Thick%20Outlines,%203D%20Environment,%208k,%20HDR,%20Detailed%20Faces:1.3,%20Detailed%20Body:1.25%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D,%20(((face%20paint:0.25))),%20depth%20of%20field,%20watercolor%20background,%20blurry,%20fuzzy,%20hazy,%20low%20poly,%20(((face%20masks:0.25))),%20people%20in%20background,%20(((Glowing%20eyes:0.25))),%20Poorly%20Drawn%20Faces,%20Poorly%20Drawn%20Body%5Cn%20%20%E3%80%8BCinematic%5Cn%20%20%20%20prompt%20=%20%5Binput.description%5D,%20Professional%20photo,%20hyperrealistic%20lighting%20and%20features,%20UHD,%20RTX,%20%20dynamic%20lighting,%2075mm,%20Technicolor,%20Panavision,%20Cinemascope,%20depth%20of%20field%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D,%20bad%20lighting,%20low-quality,%20deformed,%20text,%20poorly%20drawn,%20holding%20camera,%20bad%20image,%20bad%20angle,%20low-resolution,%20worst%20quality,%20bad%20composition,%20disfigured%5Cn%20%20%E3%80%8BConcept%20art%5Cn%20%20%20%20prompt%20=%20%5Binput.description%5D,%20concept%20art,%20sketch,%20detailed,%20illustration%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D,%20low%20quality,%20blurry,%20deformed%5Cn%20%20%E3%80%8BPixel%20art%5Cn%20%20%20%20prompt%20=%20%5Binput.description%5D,%20pixel%20art,%20pixelated,%2016-bit%20pixel%20art%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D,%20photo%5Cn%20%20%E3%80%8BPlanet%20art%5Cn%20%20%20%20prompt%20=%20Space%20art%20of%20%5Binput.description%5D,%20planet%20art,%20outer%20space,%20space,%20stars,%20detailed,%20realistic,%20accurate%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D,%20bad%20quality%5Cn%20%20%E3%80%8BCasual%20photo%5Cn%20%20%20%20prompt%20=%20%5Binput.description%5D,%20casual%20photo%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D,%20bad%20photo,%20bad%20lighting,%20unnatural%20studio%20lighting,%20commercial%20photoshoot,%20photoshopped,%20bad%20photo,%20deformed,%20disfigured,%20popular%20model%5Cn%20%20%E3%80%8BRealistic%20images%5Cn%20%20%20%20prompt%20=%20%5Binput.description%5D,%20high%20quality%20image,%204k,%208k,%20HD,%20UHD,%20Sharp%20Focus,%20In%20Frame,%20AMD%20graphics,%20RTX%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D,%20low%20quality,%20deformed,%20blurry,%20bad%20art,%20drawing,%20painting,%20horrible%20resolutions,%20low%20DPI,%20low%20PPI,%20blurry,%20glitch,%20error%5Cn%20%20%E3%80%8BRealistic%20humans%5Cn%20%20%20%20prompt%20=%20%5Binput.description%5D,%20high%20quality%20image,%204k,%208k,%20HD,%20UHD,%20realistic%20face,%20realistic%20fingers,%20sharp%20focus,%20in%20frame,%20real%20image,%20AMD%20graphics,%20RTX%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D,%20low%20quality,%20deformed,%20blurry,%20bad%20art,%20drawing,%20painting,%20incorrect%20anatomy,%20ugliness,%20ugly,%20horrible%20resolutions,%20low%20DPI,%20low%20PPI,%20bad%20character%20positioning,%20absurd%20anatomy,%20tiling,%20pixelization,%20low%20pixel%20count,%20blurry,%20low-res%20face,%20low%20poly,%20Poorly%20Drawn%20Characters,%20Badly%20Drawn%20Eyes,%20Badly%20Drawn%20Mouth,%20Badly%20Drawn%20Ears,%20Badly%20Drawn%20Nose,%20Badly%20Drawn%20Hands,%20Badly%20Drawn%20Feet,%20Badly%20Drawn%20Legs,%20Badly%20Drawn%20Hair,%20Badly%20Drawn%20Clothing,%20bad%20anatomy,%20(ugly),%20missing%20arms,%20bad%20proportions,%20tiling,%20missing%20legs,%20blurry,%20(poorly%20drawn%20feet),%20morbid,%20cloned%20face,%20((extra%20limbs)),%20(mutated%20hands),%20cropped,%20(disfigured),%20mutation,%20deformed,%20(mutilated),%20dehydrated,%20body%20out%20of%20frame,%20out%20of%20frame,%20(disfigured),%20((bad%20anatomy)),%20(poorly%20drawn%20face),%20duplicate,%20cut%20off,%20(poorly%20drawn%20hands),%20error,%20low%20contrast,%20signature,%20(extra%20arms),%20underexposed,%20text,%20(extra%20fingers),%20overexposed,%20(too%20many%20fingers),%20(extra%20legs),%20bad%20art,%20ugly,%20(extra%20limbs),%20beginner,%20username,%20(fused%20fingers),%20amateur,%20watermark,%20(distorted%20face),%20worst%20quality,%20jpeg%20artifacts,%20low%20quality,%20(malformed%20limbs),%20long%20neck,%20low-res,%20(poorly%20Rendered%20face),%20low%20resolution,%20low%20saturation,%20(bad%20composition),%20Images%20cut%20out%20at%20the%20top,%20left,%20right,%20bottom,%20(deformed%20body%20features),%20(poorly%20rendered%20hands)%5Cn%5Cn//%EF%BC%BB%EF%BC%BD%20%5Cn%5Cn%5Cn%20%20%20%20%20%20%20%20%20%20%5Cn%20%20%5Cn%22,%22imports%22:%5B%5D,%22lastEditTime%22:1721789467708,%22found%22:true%7D,%7B%22name%22:%22ai-text-plugin%22,%22modelText%22:%22(inputData)%20=%3E%5Cn%5Cn%20%20const%20serverOrigin%20=%20%5C%22https://text-generation.perchance.org%5C%22;%5Cn%20%20%5Cn%20%20let%20iframe;%20%20%5Cn%20%20if(!window.__alreadyAddedAiTextPluginStuff8492739)%20%7B%5Cn%20%20%20%20iframe%20=%20document.createElement(%5C%22iframe%5C%22);%20%5Cn%20%20%20%20iframe.src%20=%20%60$%7BserverOrigin%7D/embed%60;%5Cn%20%20%20%20iframe.style.cssText%20=%20%5C%22display:none;%20position:fixed;%20top:0.5rem;%20right:0.5rem;%20height:3rem;%20width:11rem;%20background:#333;%20border:none;%20border-radius:3px;%20box-shadow:0px%202px%204px%200px%20#00000066;%20z-index:10000%5C%22;%5Cn%20%20%20%20iframe.id%20=%20%5C%22aiTextPluginEmbedIframe%5C%22;%5Cn%20%20%20%20%5Cn%20%20%20%20setTimeout(()%20=%3E%20%7B%5Cn%20%20%20%20%20%20if(!window.__aiTextIframeEmbedIsReady)%20%7B%5Cn%20%20%20%20%20%20%20%20iframe.src%20=%20%60$%7BserverOrigin%7D/embed?__cacheBust=$%7BMath.random()%7D%60;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%7D,%2015*1000);%5Cn%20%20%20%20%5Cn%20%20%20%20const%20style%20=%20document.createElement(%5C%22style%5C%22);%5Cn%20%20%20%20style.textContent%20=%20%60%5Cn%20%20%20%20%20%20@keyframes%20ai-text-plugin-blink%20%7B%2050%25%20%7B%20fill:%20transparent%20%7D%7D%20.ai-text-plugin-dot%20%7B%20animation:%201s%20ai-text-plugin-blink%20infinite;%20fill:%20grey;%20%7D%20.ai-text-plugin-dot:nth-child(2)%20%7B%20animation-delay:%20250ms%20%7D%20.ai-text-plugin-dot:nth-child(3)%20%7B%20animation-delay:%20500ms%20%7D%20.ai-text-plugin-loader%20%7B%20background-color:%20#f1f1f1;%20color:%20grey;%20%7D%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20.ai-text-response-end-buttons-ctn:before%20%7B%5Cn%20%20%20%20%20%20%20%20content:%20%5C%22+%5C%22;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20.ai-text-response-end-buttons-ctn%20%7B%5Cn%20%20%20%20%20%20%20%20position:relative;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20.ai-text-response-buttons-wrapper%20%7B%5Cn%20%20%20%20%20%20%20%20display:none;%5Cn%20%20%20%20%20%20%20%20position:absolute;%5Cn%20%20%20%20%20%20%20%20width:%20max-content;%5Cn%20%20%20%20%20%20%20%20bottom:%200;%5Cn%20%20%20%20%20%20%20%20min-height:%202.5rem;%5Cn%20%20%20%20%20%20%20%20pointer-events:none;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20@media%20screen%20and%20(max-width:%20600px)%20%7B%5Cn%20%20%20%20%20%20%20%20.ai-text-response-buttons-wrapper%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20min-height:%203.5rem;%20/*%20buttons%20should%20be%20further%20apart%20on%20mobile%20-%20else%20'hover'%20click%20triggers%20the%20buttons%20themselves%20*/%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20.ai-text-response-end-buttons-ctn:hover%20.ai-text-response-buttons-wrapper%20%7B%5Cn%20%20%20%20%20%20%20%20display:flex;%5Cn%20%20%20%20%20%20%20%20pointer-events:auto;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%60;%5Cn%20%20%20%20document.head.appendChild(style);%5Cn%20%20%20%20%5Cn%20%20%20%20window.addEventListener('message',%20(event)%20=%3E%20%7B%5Cn%20%20%20%20%20%20if(event.source%20!==%20iframe.contentWindow)%20return;%5Cn%20%20%20%20%20%20if(event.origin%20!==%20serverOrigin)%20return;%5Cn%5Cn%20%20%20%20%20%20if(event.data.type%20===%20%5C%22embedIsReady%5C%22)%20%7B%20%20%20%5Cn%20%20%20%20%20%20%20%20window.__aiTextIframeEmbedIsReady%20=%20true;%5Cn%20%20%20%20%20%20%20%20//%20console.debug(%5C%22got%20embedIsReady,%20sent%20verifyUser%5C%22);%5Cn%20%20%20%20%20%20%20%20if(!window.__alreadyTriggeredAiTextPluginPreload8492739)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20iframe.contentWindow.postMessage(%7Btype:%5C%22verifyUser%5C%22%7D,%20serverOrigin);%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20if(event.data.type%20===%20%5C%22verified%5C%22)%20%7B%5Cn%20%20%20%20%20%20%20%20iframe.style.display%20=%20%5C%22none%5C%22;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20if(event.data.type%20===%20%5C%22verifying%5C%22)%20%7B%5Cn%20%20%20%20%20%20%20%20iframe.style.display%20=%20%5C%22%5C%22;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%7D);%5Cn%20%20%20%20document.body.appendChild(iframe);%5Cn%20%20%20%20%5Cn%20%20%20%20window.__alreadyAddedAiTextPluginStuff8492739%20=%20true;%5Cn%20%20%7D%20else%20%7B%5Cn%20%20%20%20iframe%20=%20document.querySelector(%5C%22#aiTextPluginEmbedIframe%5C%22);%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20if(inputData%20&&%20inputData.preload%20===%20true)%20%7B%5Cn%20%20%20%20if(!window.__alreadyTriggeredAiTextPluginPreload8492739)%20%7B%5Cn%20%20%20%20%20%20(async%20function()%20%7B%5Cn%20%20%20%20%20%20%20%20while(!window.__aiTextIframeEmbedIsReady)%20await%20new%20Promise(r%20=%3E%20setTimeout(r,%20500));%5Cn%20%20%20%20%20%20%20%20await%20new%20Promise(r%20=%3E%20setTimeout(r,%20500));%5Cn%20%20%20%20%20%20%20%20iframe.contentWindow.postMessage(%7Btype:%5C%22preload%5C%22%7D,%20serverOrigin);%5Cn%20%20%20%20%20%20%7D)();%5Cn%20%20%20%20%20%20window.__alreadyTriggeredAiTextPluginPreload8492739%20=%20true;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20return%20%5C%22%5C%22;%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20if(inputData%20&&%20inputData.getMetaObject===true)%20%7B%5Cn%20%20%20%20return%20%7B%5Cn%20%20%20%20%20%20countTokens:%20function(text)%20%7B%5Cn%20%20%20%20%20%20%20%20return%20Math.ceil(text.length/3.6);%20//%20TODO:%20just%20an%20approximation%20for%20now%20-%20this%20approx%20will%20not%20work%20well%20with%20non-english%20characters.%20will%20update%20during%20next%20model%20upgrade.%5Cn%20%20%20%20%20%20%7D,%5Cn%20%20%20%20%20%20idealMaxContextTokens:%206000,%20//%20this%20is%20just%20a%20recommendation%20-%20not%20a%20fundamental%20limit.%20and%20it%20will%20increase%20over%20time.%5Cn%20%20%20%20%7D;%5Cn%20%20%7D%5Cn%20%20//%20console.debug(%5C%22inputData:%5C%22,%20inputData);%5Cn%20%20if(!inputData)%20return%20%5C%22(Error:%20No%20input%20data%20given%20to%20the%20ai%20text%20plugin.)%5C%22;%5Cn%20%20if(inputData.instructions)%20%7B%5Cn%20%20%20%20if(inputData.outputTo)%20%7B%5Cn%20%20%20%20%20%20inputData.outputTo.value%20=%20%5C%22(Error:%20Looks%20like%20you%20wrote%20'instructions%20=%20...'%20instead%20of%20'instruction%20=%20...'%20in%20your%20ai-text-plugin%20prompt%20data?)%5C%22;%5Cn%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20return%20%5C%22(Error:%20Looks%20like%20you%20wrote%20'instructions%20=%20...'%20instead%20of%20'instruction%20=%20...'%20in%20your%20ai-text-plugin%20prompt%20data?)%5C%22;%5Cn%20%20%20%20%7D%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20if(typeof%20inputData%20===%20%5C%22string%5C%22%20%7C%7C%20inputData%20instanceof%20String)%20%7B%5Cn%20%20%20%20inputData%20=%20%7Binstruction:inputData+%5C%22%5C%22%7D%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20//%20REMEMBER:%20if%20you%20add%20more%20inputs,%20you%20need%20to%20also%20update%20%60window.__continueAiTextResponseClickHandler%60%5Cn%20%20let%20hideStartWith%20=%20inputData.hideStartWith;%20//%20get%20the%20'concrete'%20value%20in%20case%20it%20was%20dynamic%20like%20%60hideStartWith%20=%20%5B%20...%20%5D%60%20-%20this%20is%20important%20because%20the%20condition%20in%20the%20square%20brackets%20could%20change%20later%5Cn%20%20%5Cn%20%20let%20instruction%20=%20inputData.instruction;%5Cn%20%20if(typeof%20instruction%20===%20%5C%22function%5C%22)%20%7B%5Cn%20%20%20%20instruction%20=%20instruction(%7B%7D);%20//%20this%20is%20useful%20as%20a%20way%20to%20give%20a%20string%20that%20should%20not%20be%20evaluated%20-%20since%20e.g.%20instruction%20=%20%5BtextareaEl.value%5D%20will%20actually%20evaluate%20the%20text%20when%20we%20call%20inputData.instruction%5Cn%20%20%20%20if(typeof%20instruction%20!==%20%5C%22string%5C%22)%20instruction%20=%20instruction.toString();%5Cn%20%20%7D%20else%20if(instruction)%20%7B%5Cn%20%20%20%20if(typeof%20instruction%20!==%20%5C%22string%5C%22)%20%7B%5Cn%20%20%20%20%20%20instruction%20=%20instruction.evaluateItem;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20instruction%20=%20instruction.toString();%5Cn%20%20%7D%20else%20%7B%5Cn%20%20%20%20instruction%20=%20%5C%22Write%20something.%5C%22;%20//%20default%20instruction%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20let%20startWith%20=%20inputData.startWith;%5Cn%20%20if(typeof%20startWith%20===%20%5C%22function%5C%22)%20%7B%5Cn%20%20%20%20startWith%20=%20startWith(%7B%7D);%20//%20this%20is%20useful%20as%20a%20way%20to%20give%20a%20string%20that%20should%20not%20be%20evaluated%20-%20since%20e.g.%20startWith%20=%20%5BtextareaEl.value%5D%20will%20actually%20evaluate%20the%20text%20when%20we%20call%20inputData.startWith%5Cn%20%20%20%20if(typeof%20startWith%20!==%20%5C%22string%5C%22)%20startWith%20=%20startWith.toString();%5Cn%20%20%7D%20else%20if(startWith)%20%7B%5Cn%20%20%20%20if(typeof%20startWith%20!==%20%5C%22string%5C%22)%20%7B%5Cn%20%20%20%20%20%20startWith%20=%20startWith.evaluateItem;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20startWith%20=%20startWith.toString();%5Cn%20%20%20%20//%20We%20trim%20whitespace%20off%20the%20end%20due%20to%20the%20classic%20tokenizer%20problem%20(most%20word%20tokens%20start%20with%20a%20space%20as%20of%202023%20tokenizers).%5Cn%20%20%20%20//%20This%20of%20course%20does%20mean%20that%20you%20can't%20%5C%22force%5C%22%20the%20model%20to%20start%20with%20a%20space%20after%20a%20word,%20but%20it's%20worth%20that%20trade-off%20until%20we%20get%20models%20with%20better%20tokenizers.%5Cn%20%20%20%20startWith%20=%20startWith.replace(/%20+$/g,%20%5C%22%5C%22);%20//%20CAUTION:%20Don't%20trim%20newlines%20-%20only%20spaces.%20Because%20e.g.%20the%20story%20writer%20demo%20relies%20on%20being%20able%20to%20start%20with%202%20new%20lines%20before%20the%20paragraph%20that%20the%20AI%20is%20about%20to%20generate,%20since%20if%20the%20AI%20generates%20them,%20it'll%20trigger%20the%20stop%20sequence%20before%20it%20even%20gets%20to%20start%20writing%20the%20new%20paragraph%5Cn%20%20%7D%20else%20%7B%5Cn%20%20%20%20startWith%20=%20%5C%22%5C%22;%5Cn%20%20%7D%5Cn%5Cn%20%20let%20stopSequences%20=%20inputData.stopSequences;%5Cn%20%20if(typeof%20stopSequences%20===%20%5C%22function%5C%22)%20%7B%5Cn%20%20%20%20stopSequences%20=%20stopSequences(%7B%7D);%5Cn%20%20%7D%20else%20if(stopSequences)%20%7B%5Cn%20%20%20%20if(!Array.isArray(stopSequences))%20%7B%5Cn%20%20%20%20%20%20stopSequences%20=%20stopSequences.selectAll.map(n%20=%3E%20n.evaluateItem);%5Cn%20%20%20%20%7D%5Cn%20%20%7D%20else%20%7B%5Cn%20%20%20%20stopSequences%20=%20%5B%5D;%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20let%20textareaLoadingIndicatorHandler;%5Cn%20%20%5Cn%20%20//%20REMEMBER:%20if%20you%20add%20more%20inputs,%20you%20need%20to%20also%20update%20%60window.__continueAiTextResponseClickHandler%60%5Cn%20%20%5Cn%20%20let%20concreteInputs%20=%20%7BstartWith,%20instruction,%20stopSequences%7D;%20%20//%20%3C--%20CAUTION:%20the%20startWith%20property%20of%20this%20is%20set%20to%20the%20full%20startWith+generatedText%20after%20generation,%20and%20the%20startWith%20can%20be%20changed%20after%20generation%20for%20the%20%60editAiTextResponseClickHandler%60%20feature%20-%20ctrl+f%20for%20%60concreteInputs.startWith%20=%60.%20Use%20%60originalConcreteInputs%60%20for%20original%20inputs.%5Cn%20%20const%20originalConcreteInputs%20=%20Object.freeze(JSON.parse(JSON.stringify(concreteInputs)));%5Cn%5Cn%20%20let%20placeholderEl;%5Cn%20%20let%20placeholderElDidInitiallyExist%20=%20false;%20//%20this%20is%20for%20keepalive%20stuff%20-%20so%20we%20can%20cancel%20a%20queued%20up%20generation%20if%20the%20placeholder%20is%20removed%5Cn%20%20let%20userStoppedGeneration%20=%20false;%5Cn%20%20%5Cn%20%20let%20textStreamController;%5Cn%20%20const%20textStream%20=%20new%20ReadableStream(%7B%5Cn%20%20%20%20start(c)%20%7B%5Cn%20%20%20%20%20%20textStreamController%20=%20c;%5Cn%20%20%20%20%7D%5Cn%20%20%7D);%5Cn%20%20%5Cn%20%20let%20darkModeEnabled%20=%20window.matchMedia%20&&%20window.matchMedia('(prefers-color-scheme:%20dark)').matches;%5Cn%20%20const%20animatedLoadingSvg%20=%20%60%3Csvg%20style=%5C%22$%7BdarkModeEnabled%20?%20%5C%22filter:invert(0.85);%5C%22%20:%20%5C%22%5C%22%7D%20height:1rem;%20width:2rem;%20overflow:hidden;%20border-radius:3px;%20vertical-align:top;%20position:relative;%20top:0.07rem;%20margin-left:0.125rem;%5C%22%20height=%5C%221rem%5C%22%20width=%5C%222rem%5C%22%20class=%5C%22ai-text-plugin-loader%5C%22%3E%20%3Ccircle%20class=%5C%22ai-text-plugin-dot%5C%22%20cx=%5C%220.5em%5C%22%20cy=%5C%220.5em%5C%22%20r=%5C%220.2em%5C%22%20style=%5C%22fill:grey;%5C%22%3E%3C/circle%3E%20%3Ccircle%20class=%5C%22ai-text-plugin-dot%5C%22%20cx=%5C%221em%5C%22%20cy=%5C%220.5em%5C%22%20r=%5C%220.2em%5C%22%20style=%5C%22fill:grey;%5C%22%3E%3C/circle%3E%20%3Ccircle%20class=%5C%22ai-text-plugin-dot%5C%22%20cx=%5C%221.5em%5C%22%20cy=%5C%220.5em%5C%22%20r=%5C%220.2em%5C%22%20style=%5C%22fill:grey;%5C%22%3E%3C/circle%3E%20%3C/svg%3E%60;%5Cn%20%20%5Cn%20%20let%20generatedText%20=%20%5C%22%5C%22;%5Cn%20%20let%20finishedGenerating%20=%20false;%5Cn%20%20let%20thereWasAnErrorDuringGeneration%20=%20false;%5Cn%20%20%5Cn%20%20let%20onFinishPromiseResolver;%5Cn%20%20let%20onFinishPromiseRejecter;%5Cn%20%20let%20onFinishPromise%20=%20new%20Promise((resolve,%20reject)%20=%3E%20%7B%5Cn%20%20%20%20onFinishPromiseResolver%20=%20resolve;%5Cn%20%20%20%20onFinishPromiseRejecter%20=%20reject;%5Cn%20%20%7D);%5Cn%20%20%5Cn%20%20let%20completionId%20=%20%5C%22aiTextCompletion%5C%22+Math.random().toString().replace(%5C%22.%5C%22,%20%5C%22%5C%22);%5Cn%20%20let%20lastGeneratedChunkReceivedTime%20=%20null;%5Cn%5Cn%20%20async%20function%20streamTextFromIframe(chunkCallback)%20%7B%20%5Cn%20%20%20%20let%20postData%20=%20%7B%7D;%5Cn%20%20%20%20postData.instruction%20=%20concreteInputs.instruction%20%7C%7C%20%5C%22%5C%22;%5Cn%20%20%20%20postData.startWith%20=%20concreteInputs.startWith%20%7C%7C%20%5C%22%5C%22;%5Cn%20%20%20%20postData.stopSequences%20=%20concreteInputs.stopSequences%20%7C%7C%20%5B%5D;%5Cn%20%20%20%20postData.generatorName%20=%20window.generatorName;%5Cn%20%20%20%20%5Cn%20%20%20%20let%20url%20=%20%60$%7BserverOrigin%7D/api/generate%60;%5Cn%20%20%20%20let%20haveReceivedFirstTextChunk%20=%20false;%5Cn%20%20%20%20let%20haveReceivedLastTextChunk%20=%20false;%5Cn%20%20%20%20function%20messageHandler(event)%20%7B%5Cn%20%20%20%20%20%20if(event.data.requestId%20!==%20completionId)%20return;%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20//%20console.debug(%5C%22streamTextFromIframe%20messageHandler:%5C%22,%20event.data);%5Cn%20%20%20%20%20%20if(event.data.type%20===%20%5C%22streamData%5C%22)%20%7B%5Cn%20%20%20%20%20%20%20%20lastGeneratedChunkReceivedTime%20=%20Date.now();%5Cn%20%20%20%20%20%20%20%20let%20text%20=%20event.data.value.text;%5Cn%20%20%20%20%20%20%20%20let%20data%20=%20%7Btext%7D;%5Cn%20%20%20%20%20%20%20%20if(event.data.value.stopReason)%20data.stopReason%20=%20event.data.value.stopReason;%5Cn%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20//%20console.debug(%5C%22event.data.value:%5C%22,%20event.data.value);%5Cn%20%20%20%20%20%20%20%20if(!haveReceivedFirstTextChunk)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20data.isFirstChunk%20=%20true;%5Cn%20%20%20%20%20%20%20%20%20%20haveReceivedFirstTextChunk%20=%20true;%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20if(haveReceivedLastTextChunk)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20console.error(%5C%22haveReceivedLastTextChunk%20but%20about%20to%20send%20another%20chunk???%20maybe%20recieving%20streamEnd%20before%20it's%20actually%20finished??%5C%22);%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20if(event.data.value.final)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20data.isLastChunk%20=%20true;%20//%20remember,%20a%20chunk%20can%20be%20both%20the%20first%20*and*%20last%20chunk%5Cn%20%20%20%20%20%20%20%20%20%20haveReceivedLastTextChunk%20=%20true;%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20chunkCallback(data);%5Cn%20%20%20%20%20%20%7D%20else%20if%20(event.data.type%20===%20%5C%22streamEnd%5C%22)%20%7B%5Cn%20%20%20%20%20%20%20%20//%20console.debug(%60ai-text-plugin%20Received%20'streamEnd'%20for%20$%7BcompletionId%7D%60);%5Cn%20%20%20%20%20%20%20%20window.removeEventListener(%5C%22message%5C%22,%20messageHandler);%5Cn%20%20%20%20%20%20%20%20if(!haveReceivedLastTextChunk)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20//%20this%20can%20happen%20if%20stream%20is%20aborted,%20or%20if%20.stop()%20was%20called%20in%20userland,%20and%20perhaps%20for%20other%20reasons,%20so%20we%20send%20a%20last%20%5C%22dummy%5C%22%20chunk%5Cn%20%20%20%20%20%20%20%20%20%20chunkCallback(%7Btext:%5C%22%5C%22,%20stopReason:%5C%22user%5C%22,%20isLastChunk:true,%20isFirstChunk:!haveReceivedFirstTextChunk%7D);%5Cn%20%20%20%20%20%20%20%20%20%20haveReceivedLastTextChunk%20=%20true;%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%7D%20else%20if%20(event.data.type%20===%20%5C%22streamError%5C%22)%20%7B%5Cn%20%20%20%20%20%20%20%20if(userStoppedGeneration%20&&%20event.data.status%20===%20%5C%22stale%5C%22)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20//%20this%20is%20not%20actually%20an%20error,%20but%20iframe%20embed%20can't%20know%20that,%20so%20it%20sends%20us%20this,%20which%20we%20just%20ignore.%5Cn%20%20%20%20%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20if(!finishedGenerating)%20%7B%20//%20%3C--%20just%20to%20guard%20against%20weird%20timing%20stuff%5Cn%20%20%20%20%20%20%20%20%20%20%20%20thereWasAnErrorDuringGeneration%20=%20true;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20chunkCallback(%7Btext:%5C%22%5C%22,%20error:true,%20isLastChunk:!haveReceivedLastTextChunk,%20isFirstChunk:!haveReceivedFirstTextChunk%7D);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20let%20div%20=%20document.createElement(%5C%22div%5C%22);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20div.innerHTML%20=%20%60%3Cdiv%20style=%5C%22z-index:1000;%20position:%20fixed;%20bottom:%201rem;%20width:%20100%25;%20pointer-events:none;%5C%22%3E%3Cspan%20style=%5C%22%20padding:%200.5rem;%20background:%20#ac2c2c;%20border-radius:%203px;%20color:%20white;%20pointer-events:auto;%5C%22%3Eerror:%20$%7Bevent.data.status.replaceAll(%5C%22_%5C%22,%20%5C%22%20%5C%22)%7D%3C/span%3E%3C/div%3E%60;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20div%20=%20div.firstElementChild;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20document.body.appendChild(div);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20setTimeout(()%20=%3E%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20div.remove();%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%7D,%201000*5);%5Cn%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20window.removeEventListener(%5C%22message%5C%22,%20messageHandler);%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20window.addEventListener(%5C%22message%5C%22,%20messageHandler);%5Cn%20%20%20%20%5Cn%20%20%20%20while(!window.__aiTextIframeEmbedIsReady)%20%7B%5Cn%20%20%20%20%20%20await%20new%20Promise(r%20=%3E%20setTimeout(r,%20100));%5Cn%20%20%20%20%7D%5Cn%20%20%20%20if(inputData._debug)%20postData._debug%20=%20JSON.parse(JSON.stringify(inputData._debug));%5Cn%20%20%20%20iframe.contentWindow.postMessage(%7B%20type:%20%5C%22startStream%5C%22,%20url,%20postData,%20requestId:completionId,%20perchanceGeneratorOrigin:window.location.origin%20%7D,%20serverOrigin);%5Cn%20%20%20%20//%20console.debug(%5C%22sent%20startStream%20request%20to%20iframe%5C%22);%5Cn%20%20%7D%5Cn%5Cn%20%20async%20function%20editAiTextResponseClickHandler(el)%20%7B%20%20%20%20%5Cn%20%20%20%20let%20saveButton%20=%20document.createElement(%5C%22button%5C%22);%5Cn%20%20%20%20saveButton.style.cssText%20=%20%5C%22position:fixed;%20z-index:501;%5C%22;%5Cn%20%20%20%20saveButton.textContent%20=%20%5C%22%F0%9F%92%BE%5C%22;%5Cn%20%20%20%20document.body.append(saveButton);%5Cn%5Cn%20%20%20%20let%20textarea%20=%20document.createElement(%5C%22textarea%5C%22);%5Cn%20%20%20%20textarea.style.cssText%20=%20%5C%22z-index:500;%20display:block;%20position:fixed;%20min-height:2rem;%20min-width:10rem;%5C%22;%5Cn%20%20%20%20textarea.value%20=%20concreteInputs.startWith;%5Cn%20%20%20%20document.body.append(textarea);%5Cn%20%20%20%20let%20updateCoverPosition%20=%20()%20=%3E%20%7B%5Cn%20%20%20%20%20%20let%20rect%20=%20el.getBoundingClientRect();%5Cn%20%20%20%20%20%20textarea.style.left%20=%20%60$%7Brect.left%7Dpx%60;%5Cn%20%20%20%20%20%20textarea.style.top%20=%20%60$%7Brect.top%7Dpx%60;%5Cn%20%20%20%20%20%20textarea.style.width%20=%20%60$%7Brect.width%7Dpx%60;%5Cn%20%20%20%20%20%20textarea.style.height%20=%20%60$%7Brect.height+10%7Dpx%60;%5Cn%5Cn%20%20%20%20%20%20let%20textareaRect%20=%20textarea.getBoundingClientRect();%20//%20Use%20coverElement's%20dimensions%5Cn%20%20%20%20%20%20saveButton.style.left%20=%20%60$%7BtextareaRect.right-saveButton.offsetWidth%7Dpx%60;%5Cn%20%20%20%20%20%20saveButton.style.top%20=%20%60$%7BtextareaRect.bottom%7Dpx%60;%5Cn%20%20%20%20%7D;%5Cn%20%20%20%20updateCoverPosition();%5Cn%20%20%20%20window.addEventListener('scroll',%20updateCoverPosition);%5Cn%20%20%20%20window.addEventListener('resize',%20updateCoverPosition);%5Cn%20%20%20%20%5Cn%20%20%20%20const%20observer%20=%20new%20MutationObserver((mutationsList)%20=%3E%20%7B%5Cn%20%20%20%20%20%20for(let%20mutation%20of%20mutationsList)%20%7B%5Cn%20%20%20%20%20%20%20%20for(let%20node%20of%20mutation.removedNodes)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20if(node.contains(el))%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20textarea.remove();%5Cn%20%20%20%20%20%20%20%20%20%20%20%20saveButton.remove();%5Cn%20%20%20%20%20%20%20%20%20%20%20%20window.removeEventListener('scroll',%20updateCoverPosition);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20window.removeEventListener('resize',%20updateCoverPosition);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20observer.disconnect();%5Cn%20%20%20%20%20%20%20%20%20%20%20%20return;%5Cn%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%7D);%5Cn%20%20%20%20observer.observe(document.body,%20%7B%20childList:%20true,%20subtree:%20true%20%7D);%5Cn%5Cn%20%20%20%20await%20new%20Promise(r%20=%3E%20saveButton.onclick=r);%20%5Cn%5Cn%20%20%20%20let%20endButtonsCtn%20=%20el.querySelector(%5C%22.ai-text-response-end-buttons-ctn%5C%22);%5Cn%20%20%20%20endButtonsCtn.remove();%5Cn%5Cn%20%20%20%20concreteInputs.startWith%20=%20textarea.value;%5Cn%20%20%20%20%5Cn%20%20%20%20//%20we%20do%20this%20because%20the%20onFinishPromise%20is%20actually%20the%20return%20value%20of%20this%20function,%20but%20it%20also%20serves%20as%20an%20object%20with%20a%20bunch%20of%20handy%20properties%20like%20.liveResponseText,%20.stop(),%20etc.%5Cn%20%20%20%20onFinishPromise.liveResponseText%20=%20textarea.value;%5Cn%20%20%20%20%5Cn%20%20%20%20//%20el.innerHTML%20=%20textarea.value;%5Cn%20%20%20%20//%20el.appendChild(endButtonsCtn);%5Cn%20%20%20%20renderResponseTextIntoContainer(textarea.value,%20%7BaddEndButtons:true,%20isFinalRender:true%7D);%5Cn%5Cn%20%20%20%20window.removeEventListener('scroll',%20updateCoverPosition);%5Cn%20%20%20%20window.removeEventListener('resize',%20updateCoverPosition);%5Cn%20%20%20%20textarea.remove();%5Cn%20%20%20%20saveButton.remove();%5Cn%20%20%7D;%5Cn%20%20%5Cn%20%20async%20function%20continueAiTextResponseClickHandler(el,%20opts=%7B%7D)%20%7B%20%20%20%20%5Cn%20%20%20%20let%20instruction%20=%20concreteInputs.instruction;%5Cn%20%20%20%20let%20startWith%20=%20concreteInputs.startWith;%5Cn%20%20%20%20let%20stopSequences%20=%20concreteInputs.stopSequences;%5Cn%20%20%20%20%5Cn%20%20%20%20if(opts.appendContinuationSuffix)%20startWith%20+=%20%5C%22%5C%5Cn%5C%22;%5Cn%20%20%20%20%5Cn%20%20%20%20responseEndButtonsCtn.remove();%5Cn%20%20%20%20let%20obj%20=%20(%7Binstruction,%20startWith,%20stopSequences,%20style:inputData.style,%20outputTo:el,%20render:inputData.render,%20onFinish:inputData.onFinish,%20onChunk:inputData.onChunk%7D);%5Cn%20%20%20%20el.innerHTML%20+=%20obj.loadingIndicatorHtml;%5Cn%20%20%20%20let%20result%20=%20await%20obj;%5Cn%20%20%20%20if(!opts.appendContinuationSuffix%20&&%20result.generatedText%20===%20%5C%22%5C%22%20&&%20!result.text.endsWith(%5C%22%5C%5Cn%5C%5Cn%5C%22))%20%7B%5Cn%20%20%20%20%20%20//%20no%20text%20was%20generated,%20so%20try%20again%20with%20a%20suffix%20that's%20likely%20to%20trigger%20more%20text.%5Cn%20%20%20%20%20%20//%20TODO:%20maybe%20check%20stopReason%20here%20too?%5Cn%20%20%20%20%20%20continueAiTextResponseClickHandler(el,%20%7BappendContinuationSuffix:true%7D)%5Cn%20%20%20%20%7D%5Cn%20%20%7D;%5Cn%20%20%5Cn%20%20let%20responseEndButtonsCtn;%5Cn%20%20%7B%5Cn%20%20%20%20let%20buttonGap%20=%20%5C%220.25rem%5C%22;%5Cn%20%20%20%20if(window.innerWidth%20%3C%20600)%20buttonGap%20=%20%5C%221.5rem%5C%22;%5Cn%20%20%20%20%5Cn%20%20%20%20let%20darkModeEnabled%20=%20window.matchMedia%20&&%20window.matchMedia('(prefers-color-scheme:%20dark)').matches;%5Cn%20%20%20%20let%20responseEndButtonsHtml%20=%20%60%3Cspan%20class=%5C%22ai-text-response-end-buttons-ctn%5C%22%20style=%5C%22display:%20inline-flex;background:$%7BdarkModeEnabled%20?%20%5C%22#666666%5C%22%20:%20%5C%22#f1f1f1%5C%22%7D;color:%20$%7BdarkModeEnabled%20?%20%5C%22#d5d5d5%5C%22%20:%20%5C%22grey%5C%22%7D;height:%201rem;width:%201rem;border-radius:%203px;vertical-align:%20top;position:%20relative;top:%200.07rem;margin-left:%200.125rem;align-items:%20center;justify-content:%20center;cursor:%20pointer;%20font-size:80%25%5C%22%3E%5Cn%20%20%20%20%20%20%3Cdiv%20class=%5C%22ai-text-response-buttons-wrapper%5C%22%3E%5Cn%20%20%20%20%20%20%20%20%3Cbutton%20class=%5C%22ai-text-continue-button%5C%22%20style=%5C%22height:min-content;%5C%22%3E%E2%96%B6%EF%B8%8F%3C/button%3E%5Cn%20%20%20%20%20%20%20%20%3Cbutton%20class=%5C%22ai-text-edit-button%5C%22%20style=%5C%22height:min-content;%20margin-left:$%7BbuttonGap%7D%5C%22%3E%E2%9C%8F%EF%B8%8F%3C/button%3E%5Cn%20%20%20%20%20%20%3C/div%3E%5Cn%20%20%20%20%3C/span%3E%60;%5Cn%20%20%20%20responseEndButtonsCtn%20=%20document.createElement(%5C%22div%5C%22);%5Cn%20%20%20%20responseEndButtonsCtn.innerHTML%20=%20responseEndButtonsHtml;%5Cn%20%20%20%20responseEndButtonsCtn%20=%20responseEndButtonsCtn.firstElementChild;%5Cn%20%20%20%20if(inputData.endButtons?.evaluateItem%20===%20%5C%22none%5C%22)%20%7B%5Cn%20%20%20%20%20%20responseEndButtonsCtn.style.display%20=%20%5C%22none%5C%22;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20responseEndButtonsCtn.querySelector(%5C%22.ai-text-continue-button%5C%22).onclick%20=%20function()%20%7B%5Cn%20%20%20%20%20%20//%20console.debug(%5C%22wrapper%20display:%5C%22,%20this.closest('.ai-text-response-buttons-wrapper').style.display);%5Cn%20%20%20%20%20%20let%20responseCtn%20=%20this.closest(%5C%22.ai-text-response-end-buttons-ctn%5C%22).__aiTextResponseCtn%20%7C%7C%20this.closest('.ai-text-response-ctn');%5Cn%20%20%20%20%20%20continueAiTextResponseClickHandler(responseCtn);%5Cn%20%20%20%20%7D;%5Cn%20%20%20%20responseEndButtonsCtn.querySelector(%5C%22.ai-text-edit-button%5C%22).onclick%20=%20function()%20%7B%5Cn%20%20%20%20%20%20//%20console.debug(%5C%22wrapper%20display:%5C%22,%20this.closest('.ai-text-response-buttons-wrapper').style.display);%5Cn%20%20%20%20%20%20let%20responseCtn%20=%20this.closest(%5C%22.ai-text-response-end-buttons-ctn%5C%22).__aiTextResponseCtn%20%7C%7C%20this.closest('.ai-text-response-ctn');%5Cn%20%20%20%20%20%20editAiTextResponseClickHandler(responseCtn);%5Cn%20%20%20%20%7D;%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20function%20escapeRegExp(text)%20%7B%5Cn%20%20%20%20return%20text.replace(/%5B-%5B%5C%5C%5D%7B%7D()*+?.,%5C%5C%5C%5C%5E$%7C#%5C%5Cs%5D/g,%20'%5C%5C%5C%5C$&');%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20let%20startWithRegex;%5Cn%20%20%5Cn%20%20function%20renderResponseTextIntoContainer(response,%20opts=%7B%7D)%20%7B%5Cn%20%20%20%20if(!inputData.outputTo%20&&%20!placeholderEl)%20return;%20//%20%3C--%20indicates%20that%20they're%20doing%20things%20manually%20with%20e.g.%20onFinishPromise/onChunk/etc.%5Cn%20%20%20%20%5Cn%20%20%20%20if(hideStartWith)%20%7B%20//%20note%20that%20%60hideStartWith%60%20is%20purely%20'visual'%20-%20it's%20just%20a%20handy%20helper%20for%20a%20common%20case%20(that%20could%20otherwise%20be%20solved%20with%20%60render%60)%5Cn%20%20%20%20%20%20if(!startWithRegex)%20startWithRegex%20=%20new%20RegExp(%5C%22%5E%5C%22+escapeRegExp(concreteInputs.startWith));%5Cn%20%20%20%20%20%20response%20=%20response.replace(startWithRegex,%20%5C%22%5C%22);%5Cn%20%20%20%20%7D%5Cn%20%20%20%20if(inputData.render)%20%7B%5Cn%20%20%20%20%20%20response%20=%20inputData.render(%7Btext:response,%20isPartial:!opts.isFinalRender%7D);%5Cn%20%20%20%20%7D%5Cn%20%20%20%20if(inputData.outputTo)%20%7B%5Cn%20%20%20%20%20%20if(typeof%20inputData.outputTo.value%20==%20%5C%22string%5C%22)%20%7B%20//%20textarea,%20input,%20or%20user's%20custom%20object%20with%20string%20%60.value%60%20property%5Cn%20%20%20%20%20%20%20%20inputData.outputTo.value%20=%20response;%5Cn%20%20%20%20%20%20%20%20if(inputData.outputTo.tagName%20===%20%5C%22TEXTAREA%5C%22)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20if(inputData.outputTo.scrollTop%20%3E%20(inputData.outputTo.scrollHeight%20-%20inputData.outputTo.offsetHeight)-30)%20%7B%20//%20%3C--%20if%20the%20text%20box%20is%20already%20scrolled%20near%20the%20end%20of%20the%20text%5Cn%20%20%20%20%20%20%20%20%20%20%20%20inputData.outputTo.scrollTop%20=%209999999999;%20//%20scroll%20down%20to%20bottom%20of%20text%20box%5Cn%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20%20%20inputData.outputTo.innerHTML%20=%20response;%5Cn%20%20%20%20%20%20%20%20if(opts.addEndButtons)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20responseEndButtonsCtn.title%20=%20%60Inputs%20that%20were%20used:%5C%5Cn%5C%5Cninstruction=$%7BconcreteInputs.instruction%7D%5C%5Cn%5C%5CnstartWith=$%7BconcreteInputs.startWith%7D%60;%5Cn%20%20%20%20%20%20%20%20%20%20responseEndButtonsCtn.__aiTextResponseCtn%20=%20inputData.outputTo;%5Cn%20%20%20%20%20%20%20%20%20%20inputData.outputTo.append(responseEndButtonsCtn);%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20if(typeof%20placeholderEl.value%20==%20%5C%22string%5C%22)%20%7B%20//%20textarea,%20input,%20or%20user's%20custom%20object%20with%20string%20%60.value%60%20property%5Cn%20%20%20%20%20%20%20%20placeholderEl.value%20=%20response;%5Cn%20%20%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20%20%20placeholderEl.innerHTML%20=%20response;%5Cn%20%20%20%20%20%20%20%20if(opts.addEndButtons)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20responseEndButtonsCtn.title%20=%20%60Inputs%20that%20were%20used:%5C%5Cn%5C%5Cninstruction=$%7BconcreteInputs.instruction%7D%5C%5Cn%5C%5CnstartWith=$%7BconcreteInputs.startWith%7D%60;%5Cn%20%20%20%20%20%20%20%20%20%20placeholderEl.append(responseEndButtonsCtn);%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%7D%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20let%20gotFirstChunk%20=%20false;%5Cn%20%20let%20chunks%20=%20%5B%5D;%5Cn%20%20let%20generatedChunks%20=%20%5B%5D;%20//%20difference%20from%20%60chunks%60%20is%20that%20this%20doesn't%20include%20the%20user-specified%20%60startWith%60%20text%5Cn%20%20let%20alreadyDoneOnFinishStuff%20=%20false;%20//%20just%20as%20an%20extra%20guard%20against%20bugs%5Cn%20%20%5Cn%20%20function%20doOnFinishStuff(%7BstopReason%7D)%20%7B%5Cn%20%20%20%20if(alreadyDoneOnFinishStuff)%20return;%20//%20this%20is%20possible%20because%20e.g.%20userland%20onChunk%20can%20synchronously%20call%20.stop(),%20so%20it%20gets%20executed%20after%20last%20chunk%20arrival%20via%20stopFn(),%20but%20before%20'normal'%20doOnFinishStuff%20call%5Cn%20%20%20%20alreadyDoneOnFinishStuff%20=%20true;%5Cn%5Cn%20%20%20%20console.debug(%5C%22FINISHED%20STREAMING.%5C%22);%5Cn%5Cn%20%20%20%20let%20finishData%20=%20new%20String(chunks.join(%5C%22%5C%22));%5Cn%20%20%20%20finishData.text%20=%20chunks.join(%5C%22%5C%22);%5Cn%20%20%20%20finishData.generatedText%20=%20generatedChunks.join(%5C%22%5C%22);%5Cn%20%20%20%20finishData.stopReason%20=%20stopReason;%5Cn%5Cn%20%20%20%20if(inputData.onFinish)%20%7B%5Cn%20%20%20%20%20%20try%20%7B%20inputData.onFinish(finishData);%20%7D%20catch(e)%20%7B%20console.error(%5C%22error%20in%20onFinish:%5C%22,%20e);%20%7D%5Cn%20%20%20%20%7D%5Cn%20%20%20%20onFinishPromiseResolver(finishData);%5Cn%20%20%20%20generatedText%20=%20generatedChunks.join(%5C%22%5C%22);%5Cn%5Cn%20%20%20%20if(textareaLoadingIndicatorHandler)%20textareaLoadingIndicatorHandler.stop();%5Cn%20%20%20%20try%20%7B%20textStreamController.close();%20%7D%20catch(e)%20%7B%20console.error(e);%20%7D%5Cn%20%20%7D%5Cn%20%20function%20stopFn()%20%7B%5Cn%20%20%20%20if(finishedGenerating)%20return;%5Cn%20%20%20%20finishedGenerating%20=%20true;%5Cn%5Cn%20%20%20%20if(!gotFirstChunk%20&&%20placeholderEl)%20placeholderEl.innerHTML%20=%20%5C%22%5C%22;%20//%20clear%20the%20svg%20'loading'%20dots%5Cn%5Cn%20%20%20%20doOnFinishStuff(%7BstopReason:%5C%22user%5C%22%7D);%5Cn%20%20%7D%5Cn%5Cn%20%20async%20function%20startStreamingResponse()%20%7B%5Cn%20%20%20%20try%20%7B%5Cn%20%20%20%20%20%20(async%20function()%20%7B%5Cn%20%20%20%20%20%20%20%20await%20new%20Promise(r%20=%3E%20setTimeout(r,%20500));%5Cn%20%20%20%20%20%20%20%20while(true)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20if(userStoppedGeneration)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20console.debug(%5C%22stopping%20keepalives%20due%20to%20%60userStoppedGeneration%60%5C%22);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20break;%5Cn%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20if(finishedGenerating)%20%7B%20console.debug(%5C%22stopping%20keepalives%20due%20to%20%60finishedGenerating%60%5C%22);%20break;%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20if(placeholderElDidInitiallyExist%20&&%20!document.querySelector(%60#$%7BcompletionId%7D%60))%20%7B%20console.debug(%5C%22stopping%20keepalives%20due%20to%20%60placeholderEl%60%5C%22);%20break;%20%7D%20//%20placeholderEl%20no%20longer%20exists%20in%20the%20DOM,%20so%20user%20probably%20clicked%20'randomize'%20or%20whatever%20while%20previous%20one%20was%20still%20loading,%20hence%20we%20abort%20previous%20one%20by%20stopping%20the%20keepalives,%20which%20drops%20it%20from%20the%20queue%5Cn%20%20%20%20%20%20%20%20%20%20if(inputData.outputTo%20&&%20(!document.body.contains(inputData.outputTo)%20%7C%7C%20inputData.outputTo.dataset.aiTextCompletionId%20!==%20completionId))%20%20%7B%20console.debug(%5C%22stopping%20keepalives%20due%20to%20%60outputTo%60%5C%22);%20break;%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20//%20if(lastGeneratedChunkReceivedTime%20!==%20null%20&&%20Date.now()-lastGeneratedChunkReceivedTime%20%3E%201000*20)%20%20%7B%20console.debug(%5C%22stopping%20keepalives%20due%20to%20generation%20having%20started%20but%20no%20new%20chunks%20Received%20in%2020%20seconds%5C%22);%20break;%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20%20%20iframe.contentWindow.postMessage(%7B%20type:%20%5C%22streamKeepAlive%5C%22,%20requestId:completionId%20%7D,%20serverOrigin);%5Cn%20%20%20%20%20%20%20%20%20%20console.debug(%5C%22streamKeepAlive%20sent%5C%22);%5Cn%20%20%20%20%20%20%20%20%20%20await%20new%20Promise(r%20=%3E%20setTimeout(r,%20800));%5Cn%20%20%20%20%20%20%20%20%20%20//%20if(window.devTest98375290385)%20await%20new%20Promise(r%20=%3E%20setTimeout(r,%2010000000000));%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20try%20%7B%20stopFn();%20%7D%20catch(e)%20%7B%20console.error(e);%20%7D;%20//%20need%20to%20call%20stopFn()%20here%20(and%20not%20just%20wait%20for%20it%20to%20be%20called%20in%20streamTextFromIframe)%20because%20otherwise%20it%20only%20gets%20called%20if%20streamTextFromIframe%20gets%20called%20again,%20which%20it%20*might%20not*%5Cn%20%20%20%20%20%20%20%20try%20%7B%20iframe.contentWindow.postMessage(%7B%20type:%20%5C%22stopStream%5C%22,%20requestId:completionId%20%7D,%20serverOrigin);%20%7D%20catch(e)%20%7B%20console.error(e);%20%7D;%5Cn%20%20%20%20%20%20%7D)();%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20streamTextFromIframe(function(data)%20%7B%5Cn%20%20%20%20%20%20%20%20if(userStoppedGeneration)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20if(!finishedGenerating)%20stopFn();%5Cn%20%20%20%20%20%20%20%20%20%20return;%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20if(placeholderElDidInitiallyExist%20&&%20!document.querySelector(%60#$%7BcompletionId%7D%60))%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20if(!finishedGenerating)%20stopFn();%5Cn%20%20%20%20%20%20%20%20%20%20return;%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20if(inputData.outputTo%20&&%20(!document.body.contains(inputData.outputTo)%20%7C%7C%20inputData.outputTo.dataset.aiTextCompletionId%20!==%20completionId))%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20if(!finishedGenerating)%20stopFn();%5Cn%20%20%20%20%20%20%20%20%20%20return;%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20if(finishedGenerating)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20thereWasAnErrorDuringGeneration%20=%20true;%5Cn%20%20%20%20%20%20%20%20%20%20console.error(%5C%22We%20received%20a%20chunk%20of%20text%20even%20though%20we've%20already%20finishedGenerating?%5C%22);%5Cn%20%20%20%20%20%20%20%20%20%20return;%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20//%20add%20the%20startWith%20chunk%20before%20the%20first%20'real'%20chunk:%5Cn%20%20%20%20%20%20%20%20if(data.isFirstChunk%20&&%20concreteInputs.startWith%20&&%20!hideStartWith)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20chunks.push(concreteInputs.startWith);%5Cn%20%20%20%20%20%20%20%20%20%20textStreamController.enqueue(concreteInputs.startWith);%5Cn%20%20%20%20%20%20%20%20%20%20if(inputData.onChunk)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20inputData.onChunk(%7BfullTextSoFar:chunks.join(%5C%22%5C%22),%20textChunk:concreteInputs.startWith,%20isFromStartWith:true%7D);%5Cn%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20if(data.error)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20let%20allChunksJoined%20=%20chunks.join(%5C%22%5C%22);%5Cn%20%20%20%20%20%20%20%20%20%20thereWasAnErrorDuringGeneration%20=%20true;%5Cn%20%20%20%20%20%20%20%20%20%20finishedGenerating%20=%20true;%5Cn%20%20%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20%20%20concreteInputs.startWith%20=%20allChunksJoined;%5Cn%20%20%20%20%20%20%20%20%20%20renderResponseTextIntoContainer(allChunksJoined,%20%7BaddEndButtons:true,%20isFinalRender:true%7D);%5Cn%20%20%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20%20%20doOnFinishStuff(%7BstopReason:%5C%22error%5C%22%7D);%5Cn%20%20%20%20%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20generationLastKnownToBeWorkingAt%20=%20Date.now();%5Cn%20%20%20%20%20%20%20%20%20%20if(data.isFirstChunk)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20gotFirstChunk%20=%20true;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20if(placeholderEl)%20placeholderEl.innerHTML%20=%20%5C%22%5C%22;%20//%20clear%20the%20svg%20'loading'%20dots%5Cn%20%20%20%20%20%20%20%20%20%20%20%20if(inputData.beforeFirstChunk)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20inputData.beforeFirstChunk(%7B%7D);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20%20%20generatedChunks.push(data.text);%5Cn%20%20%20%20%20%20%20%20%20%20chunks.push(data.text);%5Cn%20%20%20%20%20%20%20%20%20%20textStreamController.enqueue(data.text);%5Cn%20%20%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20%20%20if(inputData.onChunk)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20try%20%7B%20//%20user-land%20handler%20may%20throw%20error%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20inputData.onChunk(%7BfullTextSoFar:chunks.join(%5C%22%5C%22),%20textChunk:data.text%7D);%20//%20%60data.text%60%20is%20the%20full%20text%20so%20far%20(like%20in%20onFinish,%20render,%20etc.),%20and%20%60data.chunk%60%20is%20the%20most%20recent%20chunk%20(the%20one%20that%20triggered%20this%20call%20to%20onChunk)%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%7D%20catch(e)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20console.error(%5C%22Error%20in%20onChunk:%5C%22,%20e);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%7D%20%5Cn%20%20%20%20%20%20%20%20%20%20%7D%5Cn%5Cn%20%20%20%20%20%20%20%20%20%20onFinishPromise.liveResponseText%20=%20chunks.join(%5C%22%5C%22);%5Cn%20%20%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20%20%20renderResponseTextIntoContainer(chunks.join(%5C%22%5C%22),%20%7BaddEndButtons:!!data.isLastChunk,%20isFinalRender:!!data.isLastChunk%7D);%5Cn%20%20%20%20%20%20%20%20%20%20if(data.isLastChunk)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20concreteInputs.startWith%20=%20chunks.join(%5C%22%5C%22);%20//%20update%20the%20startWith%20for%20'continue'%20and%20'edit'%20button%20use%5Cn%20%20%20%20%20%20%20%20%20%20%20%20finishedGenerating%20=%20true;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20doOnFinishStuff(%7BstopReason:data.stopReason%7D);%5Cn%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%7D);%20%20%20%20%5Cn%5Cn%20%20%20%20%7D%20catch(e)%20%7B%5Cn%20%20%20%20%20%20thereWasAnErrorDuringGeneration%20=%20true;%5Cn%20%20%20%20%20%20finishedGenerating%20=%20true;%5Cn%20%20%20%20%20%20//%20onFinishPromiseRejecter();%5Cn%20%20%20%20%20%20doOnFinishStuff(%7BstopReason:%5C%22error%5C%22%7D);%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20console.error(e);%5Cn%20%20%20%20%20%20await%20new%20Promise(r%20=%3E%20setTimeout(r,%201000));%5Cn%20%20%20%20%20%20iframe.contentWindow.postMessage(%7Btype:%5C%22verifyUser%5C%22%7D,%20serverOrigin);%20//%20probably%20not%20necessary,%20but%20just%20in%20case%20(it'll%20only%20re-verify%20if%20it's%20actually%20needed%20anyway)%5Cn%20%20%20%20%7D%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20function%20onVisible(element,%20callback)%20%7B%5Cn%20%20%20%20new%20IntersectionObserver((entries,%20observer)%20=%3E%20%7B%5Cn%20%20%20%20%20%20entries.forEach(entry%20=%3E%20%7B%5Cn%20%20%20%20%20%20%20%20if(entry.intersectionRatio%20%3E%200)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20callback(element);%5Cn%20%20%20%20%20%20%20%20%20%20observer.disconnect();%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%7D);%5Cn%20%20%20%20%7D).observe(element);%5Cn%20%20%20%20if(!callback)%20return%20new%20Promise(r%20=%3E%20callback=r);%5Cn%20%20%7D%5Cn%20%20%20%20%5Cn%20%20setTimeout(async%20()%20=%3E%20%7B%5Cn%20%20%20%20//%20give%20placeholderEl%20a%20chance%20to%20be%20put%20into%20the%20DOM%5Cn%20%20%20%20placeholderEl%20=%20document.querySelector(%60#$%7BcompletionId%7D%60);%20//%20this%20will%20be%20null%20if%20they're%20using%20outputTo%20or%20are%20just%20doing%20things%20fully%20manually%20onFinishPromise/onChunk/etc.%5Cn%20%20%20%20if(placeholderEl)%20placeholderElDidInitiallyExist%20=%20true;%5Cn%20%20%20%20//%20wait%20for%20placeholderEl%20to%20become%20visible:%5Cn%20%20%20%20if(placeholderElDidInitiallyExist%20&&%20!inputData.outputTo)%20%7B%5Cn%20%20%20%20%20%20await%20onVisible(placeholderEl);%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20if(inputData.onStart)%20%7B%5Cn%20%20%20%20%20%20inputData.onStart(onFinishPromise);%20//%20note%20that%20%60onFinishPromise%60%20has%20all%20the%20data%20attached,%20like%20%60inputs%60,%20%60liveResponseText%60,%20etc.%20-%20see%20below%5Cn%20%20%20%20%20%20if(inputData.outputTo%20&&%20inputData.outputTo.tagName%20===%20%5C%22TEXTAREA%5C%22)%20%7B%5Cn%20%20%20%20%20%20%20%20try%20%7B%20textareaLoadingIndicatorHandler%20=%20addTextareaLoadingIndicator(inputData.outputTo);%20%7D%20catch(e)%20%7B%20console.error(e);%20%7D%20//%20try/catch%20because%20new%20code%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%7D%5Cn%20%20%20%20startStreamingResponse();%20%5Cn%20%20%7D,%20100);%5Cn%20%20%5Cn%20%20let%20beforeLoaderHtml%20=%20%5C%22%5C%22;%5Cn%20%20if(!inputData.outputTo%20&&%20!hideStartWith)%20%7B%5Cn%20%20%20%20beforeLoaderHtml%20=%20inputData.render%20?%20inputData.render(%7Btext:concreteInputs.startWith,%20isPartial:true%7D)%20:%20concreteInputs.startWith;%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20if(inputData.outputTo)%20%7B%5Cn%20%20%20%20inputData.outputTo.dataset.aiTextCompletionId%20=%20completionId;%20//%20this%20is%20used%20for%20keepalive%20stuff%20-%20if%20a%20queued%20request%20is%20going%20to%20output%20to%20an%20outputTo%20element,%20but%20that%20element%20no%20longer%20has%20the%20correct%20%60dataset.aiTextCompletionId%60%20then%20we%20drop%20it%20from%20the%20queue%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20onFinishPromise.inputs%20=%20originalConcreteInputs;%5Cn%20%20onFinishPromise.liveResponseText%20=%20concreteInputs.startWith;%20//%20this%20is%20full%20text%20(including%20startWith,%20which%20is%20why%20this%20property%20isn't%20called%20liveGeneratedText,%20or%20liveOutputText)%20and%20is%20live-updated%20as%20chunks%20come%20in.%20and%20note%20that%20it%20can%20also%20be%20edited%20by%20the%20user%20using%20the%20end%20buttons%5Cn%20%20onFinishPromise.textStream%20=%20textStream;%5Cn%20%20onFinishPromise.onFinishPromise%20=%20onFinishPromise;%20//%20backwards-compat%20with%20old%20return%20object%5Cn%20%20onFinishPromise.stop%20=%20()%20=%3E%20%7B%5Cn%20%20%20%20userStoppedGeneration%20=%20true;%5Cn%20%20%20%20try%20%7B%20stopFn();%20%7D%20catch(e)%20%7B%20console.error(e);%20%7D;%5Cn%20%20%20%20try%20%7B%20iframe.contentWindow.postMessage(%7B%20type:%20%5C%22stopStream%5C%22,%20requestId:completionId%20%7D,%20serverOrigin);%20%7D%20catch(e)%20%7B%20console.error(e);%20%7D;%5Cn%20%20%20%20return%20onFinishPromise;%20//%20%3C--%20so%20.stop()%20returns%20the%20output%20data%5Cn%20%20%7D;%5Cn%20%20onFinishPromise.id%20=%20completionId;%5Cn%20%20onFinishPromise.loadingIndicatorHtml%20=%20animatedLoadingSvg;%20//%20%3C--%20just%20a%20littler%20helper%20for%20people%20who%20are%20e.g.%20using%20onFinishPromise/onChunk/etc.%20but%20want%20to%20add%20a%20loading%20indicator%20to%20the%20page%20manually%5Cn%20%20onFinishPromise.toString%20=%20function()%20%7B%20//%20this%20object%20stringifies%20into%20the%20default%20placeholder%20element%5Cn%20%20%20%20return%20%60%3Cspan%20class=%5C%22ai-text-response-ctn%5C%22%20id=%5C%22$%7BcompletionId%7D%5C%22%20style=%5C%22white-space:pre-wrap;%20$%7BinputData.style%20?%20inputData.style%20:%20%5C%22%5C%22%7D%5C%22%3E$%7BbeforeLoaderHtml%7D$%7BanimatedLoadingSvg%7D%3C/span%3E%60;%5Cn%20%20%7D;%5Cn%20%20onFinishPromise.submitUserRating%20=%20async%20(%7Bscore,%20reason%7D)%20=%3E%20%7B%5Cn%20%20%20%20if(!finishedGenerating%20%7C%7C%20thereWasAnErrorDuringGeneration)%20%7B%5Cn%20%20%20%20%20%20console.error(thereWasAnErrorDuringGeneration%20?%20%5C%22cannot%20rate%20because%20there%20was%20an%20error%20during%20generation%5C%22%20:%20%5C%22cannot%20rate%20because%20it%20hasn't%20finished%20generating%20yet%5C%22);%5Cn%20%20%20%20%20%20return;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20if(isNaN(Number(score))%20%7C%7C%20Number(score)%20%3E%201%20%7C%7C%20Number(score)%20%3C%200)%20return%20alert(%60User%20rating%20should%20be%20a%20value%20between%200%20(bad)%20and%201%20(good).%20Like%200.4%20or%200.8,%20for%20example.%60);%5Cn%20%20%20%20score%20=%20Number(score);%5Cn%20%20%20%20if(!reason)%20reason%20=%20%5C%22%5C%22;%5Cn%20%20%20%20iframe.contentWindow.postMessage(%7B%20type:%20%5C%22rateGeneratedText%5C%22,%20instruction,%20startWith,%20generatedText,%20generatorName:window.generatorName,%20score,%20reason%20%7D,%20serverOrigin);%5Cn%20%20%7D;%5Cn%20%20return%20onFinishPromise;%5Cn%20%20%5Cn%5Cn%5Cn%5Cn%5Cn//%20this%20was%20causing%20user-agent%20styles%20(specifically%20background%20color)%20to%20be%20removed%20in%20dark%20mode%20in%20chrome%20for%20some%20reason.%5Cn//%20it's%20a%20little%20too%20obtrusive%20anyway%20-%20ideally%20it%20would%20just%20be%20a%20%5C%22sliding%20line%5C%22%20that's%20only%20at%20the%20bottom%20of%20the%20textarea.%5Cn//%20or%20maybe%20a%20transparent%20loading%20indicator%20in%20the%20top-right%20of%20the%20textarea.%5CnaddTextareaLoadingIndicator(el)%20=%3E%5Cn%20%20//%20const%20computedStyle%20=%20getComputedStyle(el);%5Cn%20%20//%20const%20borderColor%20=%20computedStyle.borderColor;%5Cn%20%20//%20//%20Convert%20border%20color%20to%20rgba%20with%2030%25%20opacity%5Cn%20%20//%20const%20rgbaColor%20=%20borderColor.replace(/rgb%5C%5C((%5C%5Cd+),%5C%5Cs*(%5C%5Cd+),%5C%5Cs*(%5C%5Cd+)%5C%5C)/,%20'rgba(,%20,%20,%200.3)');%5Cn%20%20//%20const%20className%20=%20'blink-'%20+%20Math.random().toString(36).substring(2,%2015);%5Cn%20%20//%20const%20style%20=%20document.createElement('style');%5Cn%20%20//%20style.innerHTML%20=%20%60%5Cn%20%20//%20%20%20@keyframes%20$%7BclassName%7D-blink%20%7B%5Cn%20%20//%20%20%20%20%200%25,%20100%25%20%7B%5Cn%20%20//%20%20%20%20%20%20%20border-color:%20$%7BborderColor%7D;%5Cn%20%20//%20%20%20%20%20%7D%5Cn%20%20//%20%20%20%20%2050%25%20%7B%5Cn%20%20//%20%20%20%20%20%20%20border-color:%20$%7BrgbaColor%7D;%5Cn%20%20//%20%20%20%20%20%7D%5Cn%20%20//%20%20%20%7D%5Cn%20%20//%20%20%20.$%7BclassName%7D%20%7B%5Cn%20%20//%20%20%20%20%20animation:%20$%7BclassName%7D-blink%201s%20infinite;%5Cn%20%20//%20%20%20%20%20border-color:%20$%7BborderColor%7D;%20/*%20must%20add%20this%20explicitly,%20since%20user-agent-only%20borders%20don't%20trigger%20the%20animation%20*/%5Cn%20%20//%20%20%20%7D%5Cn%20%20//%20%60;%5Cn%20%20//%20document.head.appendChild(style);%5Cn%20%20//%20el.classList.add(className);%5Cn%20%20return%20%7B%5Cn%20%20%20%20stop:%20function()%20%7B%5Cn%20%20%20%20%20%20//%20el.classList.remove(className);%5Cn%20%20%20%20%20%20//%20document.head.removeChild(style);%5Cn%20%20%20%20%7D,%5Cn%20%20%7D;%5Cn%5Cn%5Cn%5Cn%5Cn%5Cn%5Cn%5Cn%5Cncharacter%5Cn%20%20%7Bmech%7Cdemon%7Ccyberpunk%7D%20%7Bwarrior%7Cminion%7Csamurai%7D%5Cn%5Cnplace%5Cn%20%20a%20retropunk%20distopia%5Cn%20%20a%20small%20village%5Cn%20%20a%20mountainous%20region%5Cn%20%20an%20underwater%20cavern%5Cn%20%20a%20=%2010%5Cn%5Cnseason%5Cn%20%20winter%5Cn%20%20summer%5Cn%20%20%5CnpoemPrompt%5Cn%20%20instruction%20=%20Write%20a%20haiku%20about%20a%20%5Bcharacter%5D%20in%20%5Bplace%5D%20during%20%5Bseason%5D.%5Cn%5Cn%5Cn%5Cn%22,%22imports%22:%5B%5D,%22lastEditTime%22:1741770056107,%22found%22:true%7D,%7B%22name%22:%22comments-plugin%22,%22modelText%22:%22(opts)%20=%3E%5Cn%20%20if(!opts)%20opts%20=%20%7B%7D;%5Cn%20%20let%20width%20=%20opts.width;%5Cn%20%20let%20height%20=%20opts.height;%5Cn%20%20if(!width)%20width%20=%20%5C%22300px%5C%22;%5Cn%20%20if(!height)%20height%20=%20%5C%22250px%5C%22;%20%5Cn%20%20if(typeof%20width%20===%20%5C%22number%5C%22)%20width%20+=%20%5C%22px%5C%22;%20%20%20%20%5Cn%20%20if(typeof%20height%20===%20%5C%22number%5C%22)%20height%20+=%20%5C%22px%5C%22;%5Cn%20%20let%20containerStyle%20=%20opts.containerStyle%20%7C%7C%20opts.style%20%7C%7C%20%60width:$%7Bwidth%7D;%20height:$%7Bheight%7D;%60;%5Cn%20%20%5Cn%20%20let%20iframeUniqueId%20=%20%5C%22id%5C%22+Math.random().toString().replaceAll(%5C%22.%5C%22,%20%5C%22%5C%22)+%20Math.random().toString().replaceAll(%5C%22.%5C%22,%20%5C%22%5C%22);%5Cn%20%20let%20ctx%20=%20%7B%7D;%5Cn%20%20ctx.currentInputElText%20=%20%5C%22%5C%22;%5Cn%20%20ctx.iframeUniqueId%20=%20iframeUniqueId;%5Cn%20%20%5Cn%20%20console.debug(%5C%22comments-plugin%201%5C%22);%5Cn%20%20%5Cn%20%20function%20addMethodsToReturnValue(stringObj)%20%7B%5Cn%20%20%20%20stringObj.submit%20=%20async%20function(optionalText,%20opts=%7B%7D)%20%7B%5Cn%20%20%20%20%20%20//%20Note:%20if%20optionalText%20is%20specified,%20that%20text%20will%20be%20submitted%20instead%20of%20what's%20currently%20in%20the%20text%20box,%20and%20the%20text%20box%20will%20not%20be%20cleared%20after%20submission.%5Cn%20%20%20%20%20%20if(optionalText)%20optionalText%20=%20optionalText.toString();%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20let%20nickname%20=%20opts.nickname%20?%20opts.nickname.toString()%20:%20null;%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20let%20resolver;%5Cn%20%20%20%20%20%20let%20promise%20=%20new%20Promise(r%20=%3E%20resolver=r);%5Cn%20%20%20%20%20%20let%20requestId%20=%20Math.random().toString()+Math.random().toString();%5Cn%20%20%20%20%20%20async%20function%20messageHandler(e)%20%7B%5Cn%20%20%20%20%20%20%20%20if(e.origin%20!==%20%5C%22https://comments-plugin.perchance.org%5C%22)%20return;%5Cn%20%20%20%20%20%20%20%20if(e.data.iframeUniqueId%20!==%20ctx.iframeUniqueId)%20return;%5Cn%20%20%20%20%20%20%20%20if(e.data.requestId%20!==%20requestId)%20return;%5Cn%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20if(e.data.type%20===%20%5C%22message_submit_response%5C%22)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20console.debug(%60parent%20frame%20got%20message_submit_response:%60,%20e.data.success);%5Cn%20%20%20%20%20%20%20%20%20%20resolver(%7Bsuccess:e.data.success%7D);%5Cn%20%20%20%20%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20console.warn(%5C%22Invalid%20event%20type%20for%20this%20requestId?%5C%22);%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20window.removeEventListener(%5C%22message%5C%22,%20messageHandler);%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20window.addEventListener(%5C%22message%5C%22,%20messageHandler);%5Cn%20%20%20%20%20%20while(!ctx.finishedLoading)%20%7B%20console.debug(%5C%22Waiting%20for%20comments-plugin%20iframe%20to%20load%20before%20sending%20.submit()%20postMessage%5C%22);%20await%20new%20Promise(r%20=%3E%20setTimeout(r,%20500));%20%7D%5Cn%20%20%20%20%20%20ctx.iframeContentWindow.postMessage(%7Btype:%5C%22trigger_programmatic_submit%5C%22,%20text:optionalText,%20nickname,%20channel:ctx.urlHashData.channel,%20requestId%7D,%20%5C%22https://comments-plugin.perchance.org%5C%22);%5Cn%20%20%20%20%20%20return%20promise;%5Cn%20%20%20%20%7D;%5Cn%20%20%20%20%5Cn%20%20%20%20Object.defineProperty(stringObj,%20'inputText',%20%7B%5Cn%20%20%20%20%20%20get:%20function()%20%7B%5Cn%20%20%20%20%20%20%20%20return%20ctx.currentInputElText;%5Cn%20%20%20%20%20%20%7D,%5Cn%20%20%20%20%20%20set:%20function(value)%20%7B%5Cn%20%20%20%20%20%20%20%20ctx.currentInputElText%20=%20value;%5Cn%20%20%20%20%20%20%20%20ctx.iframeContentWindow.postMessage(%7Btype:%5C%22set_input_el_text%5C%22,%20channel:ctx.urlHashData.channel,%20text:value%7D,%20%5C%22https://comments-plugin.perchance.org%5C%22);%5Cn%20%20%20%20%20%20%7D,%5Cn%20%20%20%20%7D);%5Cn%20%20%20%20%5Cn%20%20%20%20stringObj.setNicknameForNextComment%20=%20async%20function(nickname)%20%7B%5Cn%20%20%20%20%20%20ctx.iframeContentWindow.postMessage(%7Btype:%5C%22set_next_submit_nickname%5C%22,%20channel:ctx.urlHashData.channel,%20nickname:nickname%7D,%20%5C%22https://comments-plugin.perchance.org%5C%22);%5Cn%20%20%20%20%7D;%5Cn%20%20%20%20stringObj.setAvatarUrlForNextComment%20=%20async%20function(avatarUrl)%20%7B%5Cn%20%20%20%20%20%20ctx.iframeContentWindow.postMessage(%7Btype:%5C%22set_next_submit_avatar_url%5C%22,%20channel:ctx.urlHashData.channel,%20nickname:avatarUrl%7D,%20%5C%22https://comments-plugin.perchance.org%5C%22);%5Cn%20%20%20%20%7D;%5Cn%5Cn%20%20%20%20let%20queuedUserBans%20=%20%5B%5D;%5Cn%20%20%20%20let%20queuedUserUnbans%20=%20%5B%5D;%5Cn%20%20%20%20function%20processQueuedDynamicBans()%20%7B%5Cn%20%20%20%20%20%20for(let%20userId%20of%20queuedUserBans)%20ctx.iframeContentWindow.postMessage(%7Btype:%5C%22ban_user%5C%22,%20channel:ctx.urlHashData.channel,%20userId%7D,%20%5C%22https://comments-plugin.perchance.org%5C%22);%5Cn%20%20%20%20%20%20queuedUserBans%20=%20%5B%5D;%5Cn%20%20%20%20%20%20for(let%20userId%20of%20queuedUserUnbans)%20ctx.iframeContentWindow.postMessage(%7Btype:%5C%22unban_user%5C%22,%20channel:ctx.urlHashData.channel,%20userId%7D,%20%5C%22https://comments-plugin.perchance.org%5C%22);%5Cn%20%20%20%20%20%20queuedUserUnbans%20=%20%5B%5D;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20ctx.finishedLoadingHandlers.push(processQueuedDynamicBans);%5Cn%20%20%20%20%5Cn%20%20%20%20stringObj.banUser%20=%20async%20function(userId)%20%7B%5Cn%20%20%20%20%20%20userId%20=%20userId.evaluateItem.split(%5C%22-%5C%22).pop();%5Cn%20%20%20%20%20%20if(ctx.finishedLoading)%20%7B%5Cn%20%20%20%20%20%20%20%20ctx.iframeContentWindow.postMessage(%7Btype:%5C%22ban_user%5C%22,%20channel:ctx.urlHashData.channel,%20userId%7D,%20%5C%22https://comments-plugin.perchance.org%5C%22);%5Cn%20%20%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20%20%20queuedUserBans.push(userId);%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%7D;%5Cn%20%20%20%20%5Cn%20%20%20%20stringObj.unbanUser%20=%20async%20function(userId)%20%7B%5Cn%20%20%20%20%20%20userId%20=%20userId.evaluateItem.split(%5C%22-%5C%22).pop();%5Cn%20%20%20%20%20%20if(ctx.finishedLoading)%20%7B%5Cn%20%20%20%20%20%20%20%20ctx.iframeContentWindow.postMessage(%7Btype:%5C%22unban_user%5C%22,%20channel:ctx.urlHashData.channel,%20userId%7D,%20%5C%22https://comments-plugin.perchance.org%5C%22);%5Cn%20%20%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20%20%20queuedUserUnbans.push(userId);%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%7D;%5Cn%20%20%20%20%5Cn%20%20%20%20Object.defineProperty(stringObj,%20'comments',%20%7B%20get:%20()%20=%3E%20ctx.allComments.slice(0)%20%7D);%5Cn%20%20%20%20Object.defineProperty(stringObj,%20'channel',%20%7B%20get:%20()%20=%3E%20ctx.urlHashData.channel%20%7D);%5Cn%20%20%20%20%5Cn%20%20%20%20return%20stringObj;%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20let%20queryParams%20=%20%7B%7D;%5Cn%20%20if(opts.adminPasswordHash)%20queryParams.adminPasswordHash%20=%20opts.adminPasswordHash.evaluateItem;%5Cn%20%20%5Cn%20%20let%20urlHashData%20=%20%7B%7D;%5Cn%20%20urlHashData.iframeUniqueId%20=%20iframeUniqueId;%5Cn%20%20if(opts.adminPasswordHash)%20urlHashData.adminPasswordHash%20=%20opts.adminPasswordHash;%5Cn%20%20if(opts.bannedWords)%20%7B%5Cn%20%20%20%20if(typeof%20opts.bannedWords%20===%20%5C%22string%5C%22)%20%7B%5Cn%20%20%20%20%20%20urlHashData.bannedWords%20=%20opts.bannedWords.trim().split(%5C%22,%5C%22).map(w%20=%3E%20w.trim()).filter(w%20=%3E%20w);%5Cn%20%20%20%20%7D%20else%20if(!opts.bannedWords.getLength%20&&%20opts.getPropertyNames%20&&%20opts.getPropertyNames.includes(%5C%22bannedWords%5C%22))%20%7B%5Cn%20%20%20%20%20%20urlHashData.bannedWords%20=%20opts.bannedWords.getRawListText.split(%5C%22=%5C%22).slice(1).join(%5C%22=%5C%22).trim().split(%5C%22,%5C%22).map(w%20=%3E%20w.trim()).filter(w%20=%3E%20w);%5Cn%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20urlHashData.bannedWords%20=%20opts.bannedWords.selectAll.map(item%20=%3E%20item.getRawListText.replace(%5C%22/%5C%5C%5C%5C%5E%5C%22,%20%5C%22/%5E%5C%22));%5Cn%20%20%20%20%7D%5Cn%20%20%7D%5Cn%5Cn%20%20if(opts.commentPlaceholderText)%20urlHashData.commentPlaceholderText%20=%20opts.commentPlaceholderText.evaluateItem;%5Cn%20%20if(opts.submitButtonText)%20urlHashData.submitButtonText%20=%20opts.submitButtonText.evaluateItem;%5Cn%20%20if(opts.submitButtonSuccessText)%20urlHashData.submitButtonSuccessText%20=%20opts.submitButtonSuccessText.evaluateItem;%5Cn%20%20if(opts.hideComments)%20urlHashData.hideComments%20=%20opts.hideComments;%5Cn%20%20if(opts.hideDates)%20urlHashData.hideDates%20=%20opts.hideDates;%5Cn%20%20if(opts.hideCommentsBeforeDate)%20urlHashData.hideCommentsBeforeDate%20=%20opts.hideCommentsBeforeDate;%5Cn%20%20%5Cn%20%20if(opts.hideSettingsButton)%20urlHashData.hideSettingsButton%20=%20opts.hideSettingsButton;%5Cn%20%20if(opts.hideFullscreenButton)%20urlHashData.hideFullscreenButton%20=%20opts.hideFullscreenButton;%5Cn%20%20if(opts.submitButtonStyle)%20urlHashData.submitButtonStyle%20=%20opts.submitButtonStyle.evaluateItem;%5Cn%20%20if(opts.settingsButtonStyle)%20urlHashData.settingsButtonStyle%20=%20opts.settingsButtonStyle.evaluateItem;%5Cn%20%20if(opts.fullscreenButtonStyle)%20urlHashData.fullscreenButtonStyle%20=%20opts.fullscreenButtonStyle.evaluateItem;%5Cn%20%20if(opts.messageBubbleStyle)%20urlHashData.messageBubbleStyle%20=%20opts.messageBubbleStyle.evaluateItem;%5Cn%20%20if(opts.messageFeedStyle)%20urlHashData.messageFeedStyle%20=%20opts.messageFeedStyle.evaluateItem;%5Cn%20%20if(opts.inputAreaStyle)%20urlHashData.inputAreaStyle%20=%20opts.inputAreaStyle.evaluateItem;%5Cn%20%20if(opts.loadFonts)%20urlHashData.loadFonts%20=%20opts.loadFonts.evaluateItem;%5Cn%20%20if(opts.forceColorScheme)%20urlHashData.forceColorScheme%20=%20opts.forceColorScheme.evaluateItem;%5Cn%20%20%5Cn%20%20try%20%7B%20urlHashData.transparentBackground%20=%20/(%5E%7C%5C%5Cs)background(%7C-color):%20*(transparent%7Cnone%20transparent)/.test(containerStyle);%20%7D%20catch(e)%20%7B%20console.log(e);%20%7D%5Cn%20%20%5Cn%20%20if(opts.channelLabel)%20urlHashData.channelLabel%20=%20opts.channelLabel.evaluateItem;%5Cn%20%20%5Cn%20%20%5Cn%20%20if(opts.adminFlair)%20urlHashData.adminFlair%20=%20opts.adminFlair.evaluateItem;%5Cn%20%20if(opts.deleteButtonIcon)%20urlHashData.deleteButtonIcon%20=%20opts.deleteButtonIcon.evaluateItem;%5Cn%20%20if(opts.bannedUsers)%20urlHashData.bannedUsers%20=%20opts.bannedUsers.selectAll.map(l%20=%3E%20l.evaluateItem.split(%5C%22-%5C%22).slice(-1)%5B0%5D).joinItems(%5C%22,%5C%22);%5Cn%20%20if(opts.rateLimits)%20urlHashData.rateLimits%20=%20opts.rateLimits;%5Cn%20%20if(opts.slashCommands)%20urlHashData.slashCommands%20=%20encodeURIComponent(JSON.stringify(opts.slashCommands));%5Cn%20%20if(opts.beforeSubmit)%20urlHashData.beforeSubmitHandlerEnabled%20=%20%5C%22true%5C%22;%5Cn%20%20if(opts.customEmojiSize)%20urlHashData.customEmojiSize%20=%20opts.customEmojiSize;%5Cn%20%20if(opts.loneCustomEmojiSizeMultiplier)%20urlHashData.loneCustomEmojiSizeMultiplier%20=%20opts.loneCustomEmojiSizeMultiplier;%5Cn%20%20if(opts.customEmojis)%20%7B%20%20%5Cn%20%20%20%20if(typeof%20opts.customEmojis%20===%20%5C%22string%5C%22%20&&%20(opts.customEmojis.startsWith(%5C%22https://user-uploads.perchance.org%5C%22)%20%7C%7C%20opts.customEmojis.startsWith(%5C%22https://user.uploads.dev%5C%22)))%20%7B%5Cn%20%20%20%20%20%20urlHashData.customEmojis%20=%20opts.customEmojis.trim();%5Cn%20%20%20%20%7D%20else%20%7B%20%5Cn%20%20%20%20%20%20let%20text%20=%20opts.customEmojis.getRawListText;%5Cn%20%20%20%20%20%20text%20=%20text.slice(text.indexOf(%5C%22%5C%5Cn%5C%22)).trim();%20//%20remove%20list%20name%5Cn%20%20%20%20%20%20//%20note:%20no%20need%20to%20remove%20indentation%20-%20parsing%20code%20in%20embed%20does%20that%20performantly%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20//%20we%20need%20to%20evaluateItem%20for%20things%20like%20%60@import%20=%20%7Bimport:my-emoji-list-url%7D%5Cn%20%20%20%20%20%20urlHashData.customEmojis%20=%20/@import%5C%5Cs*=%5C%5Cs*%5B%5B%7B%5D/.test(text)%20?%20text.replace(/@import%5C%5Cs*=%5C%5Cs*%5B%5B%7B%5D.+/,%20m=%3Em.evaluateItem)%20:%20text;%5Cn%20%20%20%20%7D%5Cn%20%20%7D%5Cn%20%20urlHashData.channel%20=%20opts.channel%20?%20opts.channel.evaluateItem%20:%20%5C%22%5C%22;%5Cn%20%20%5Cn%20%20if(!window.___commentsPluginSlashCommandsByChannel12321)%20window.___commentsPluginSlashCommandsByChannel12321%20=%20%7B%7D;%5Cn%20%20window.___commentsPluginSlashCommandsByChannel12321%5BurlHashData.channel%5D%20=%20opts.slashCommands;%20%20%20%20%5Cn%20%20%5Cn%20%20let%20folderName%20=%20window.generatorName;%20%5Cn%20%20if(opts.channel)%20%7B%5Cn%20%20%20%20let%20channel%20=%20opts.channel.evaluateItem.toString();%5Cn%20%20%20%20if(!/%5E%5Ba-z0-9%5C%5C-%5D+(%7C%5C%5C+u:%5Ba-z0-9%7C%5D+)$/.test(channel)%20%7C%7C%20channel.includes(%5C%22%7C%7C%5C%22)%20%7C%7C%20channel.includes(%5C%22:%7C%5C%22)%20%7C%7C%20channel.endsWith(%5C%22%7C%5C%22))%20return%20%60(ERROR:%20You%20gave%20a%20channel%20name%20of%20'$%7Bchannel%7D'%20to%20the%20comments%20plugin,%20but%20channel%20names%20can%20only%20contain%20lower-case%20letters,%20numbers,%20and%20hyphens,%20like%20'my-cool-channel-33',%20and%20can%20additionally%20contain%20rules%20like%20%5C%22+u:username1%7Cusername2%5C%22%20at%20the%20end.)%60;%5Cn%20%20%20%20folderName%20+=%20%60+$%7Bchannel%7D%60;%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20//%20I've%20deprecated%20%60reverseCommentOrder%60,%20but%20it%20won't%20hurt%20existing%20implementations%20because%20the%20%5C%22reversed%5C%22%20order%20(new%20comments%20at%20bottom)%20is%20now%20default.%5Cn%20%20//%20if(opts.reverseCommentOrder)%20urlHashData.reverseCommentOrder%20=%20opts.reverseCommentOrder;%5Cn%20%20urlHashData.reverseCommentOrder%20=%20true;%5Cn%20%20if(opts.newestCommentsAtTop)%20urlHashData.reverseCommentOrder%20=%20false;%20%5Cn%20%20%5Cn%20%20let%20queryString%20=%20new%20URLSearchParams(queryParams).toString();%5Cn%20%20%5Cn%20%20let%20loadMoreButton%20=%20document.createElement(%5C%22button%5C%22);%5Cn%20%20let%20originalLoadMoreButtonTextContent%20=%20%5C%22load%20more%5C%22;%5Cn%20%20let%20postMessageSource%20=%20null;%5Cn%20%20loadMoreButton.innerHTML%20=%20originalLoadMoreButtonTextContent;%5Cn%20%20loadMoreButton.style.cssText%20=%20%5C%22display:none;%20margin:0.5rem%20auto;%5C%22;%5Cn%20%20loadMoreButton.addEventListener(%5C%22click%5C%22,%20function()%20%7B%5Cn%20%20%20%20originalLoadMoreButtonTextContent%20=%20loadMoreButton.textContent;%5Cn%20%20%20%20loadMoreButton.textContent%20=%20%5C%22loading...%5C%22;%5Cn%20%20%20%20loadMoreButton.disabled%20=%20true;%5Cn%20%20%20%20document.querySelector(%60.$%7BiframeUniqueId%7D%60).contentWindow.postMessage(%7BiframeUniqueId,%20loadMoreButtonClick:true%7D,%20%5C%22*%5C%22);%5Cn%20%20%7D);%5Cn%20%20%5Cn%20%20ctx.loadMoreButton%20=%20loadMoreButton;%5Cn%20%20ctx.opts%20=%20opts;%5Cn%20%20ctx.urlHashData%20=%20urlHashData;%5Cn%20%20ctx.allComments%20=%20%5B%5D;%5Cn%20%20ctx.onLoadAlreadyFired%20=%20false;%5Cn%20%20ctx.alreadyGotCommentIds%20=%20new%20Set();%5Cn%20%20ctx.finishedLoadingHandlers%20=%20%5B%5D;%5Cn%20%20%5Cn%20%20if(!window.___alreadyAddedCommentsPluginStuff43211234)%20%7B%5Cn%20%20%5Cn%20%20%20%20window.___commentsPluginIframeUniqueIdToContext%20=%20new%20Map();%5Cn%20%20%20%20%5Cn%20%20%20%20//%20the%20iframe%20send%20us%20a%20message%20when%20it%20is%20finished%20loading%20(this%20is%20to%20get%20around%20Glitch's%20uncustomizable%20loading%20screens)%5Cn%20%20%20%20window.addEventListener(%5C%22message%5C%22,%20async%20function(e)%20%7B%5Cn%20%20%20%20%20%20if(e.origin%20!==%20%5C%22https://comments-plugin.perchance.org%5C%22)%20return;%5Cn%20%20%20%20%20%20if(!e.data.iframeUniqueId)%20return;%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20//%20May%20need%20to%20wait%20a%20moment%20for%20the%20replacedDuringUpdate%20iframes%20to%20be%20'tracked'%20since%20my%20current%20code%20hackily%20does%20that%20with%20a%20'polling'%20method.%5Cn%20%20%20%20%20%20while(!window.___commentsPluginIframeUniqueIdToContext.get(e.data.iframeUniqueId))%20%7B%20console.debug(%5C%22Waiting%20for%20comments-plugin%20iframe%20to%20be%20tracked.%5C%22);%20await%20new%20Promise(r%20=%3E%20setTimeout(r,%20500));%20%7D%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20let%20ctx%20=%20window.___commentsPluginIframeUniqueIdToContext.get(e.data.iframeUniqueId)%5Cn%20%20%20%20%20%20let%20opts%20=%20ctx.opts%5Cn%20%20%20%20%20%20let%20loadMoreButton%20=%20ctx.loadMoreButton;%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20//%20if(e.data.type%20===%20%5C%22perchance_comments_new_message_added%5C%22)%20%7B%5Cn%20%20%20%20%20%20//%20%20%20console.debug(%5C%22new%20message:%5C%22,%20e.data.messageData);%5Cn%20%20%20%20%20%20//%20%20%20console.debug(%5C%22event:%5C%22,%20e);%5Cn%20%20%20%20%20%20//%20%20%20console.debug(%5C%22window.___commentsPluginIframeContentWindowToContext:%5C%22,%20window.___commentsPluginIframeUniqueIdToContext);%5Cn%20%20%20%20%20%20//%20%20%20console.debug(%5C%22ctx:%5C%22,%20ctx);%5Cn%20%20%20%20%20%20//%20%20%20console.debug(%5C%22opts:%5C%22,%20opts);%5Cn%20%20%20%20%20%20//%20%7D%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20if(e.data.type%20===%20%5C%22perchance_comments_new_message_added%5C%22)%20%7B%5Cn%20%20%20%20%20%20%20%20if(!ctx.alreadyGotCommentIds.has(e.data.messageData.id))%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20ctx.allComments.push(e.data.messageData);%5Cn%20%20%20%20%20%20%20%20%20%20ctx.alreadyGotCommentIds.add(e.data.messageData.id);%5Cn%20%20%20%20%20%20%20%20%20%20ctx.allComments.sort((a,b)%20=%3E%20a.time-b.time);%5Cn%20%20%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20%20%20if(opts.onComment)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20opts.onComment(e.data.messageData);%5Cn%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%7D%20else%20if(e.data.type%20===%20%5C%22input_el_text_change%5C%22)%20%7B%5Cn%20%20%20%20%20%20%20%20console.debug(%60parent%20frame%20got%20input_el_text_change:%60,%20e.data.text);%5Cn%20%20%20%20%20%20%20%20ctx.currentInputElText%20=%20e.data.text;%5Cn%20%20%20%20%20%20%20%20if(opts.onInputTextChange)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20opts.onInputTextChange(e.data.text);%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%7D%20else%20if(e.data.type%20===%20%5C%22perchance_comments_on_load_data%5C%22)%20%7B%5Cn%20%20%20%20%20%20%20%20let%20newComments%20=%20e.data.onLoadData.comments.filter(c%20=%3E%20!ctx.alreadyGotCommentIds.has(c.id));%5Cn%20%20%20%20%20%20%20%20for(let%20c%20of%20newComments)%20ctx.alreadyGotCommentIds.add(c.id);%5Cn%20%20%20%20%20%20%20%20ctx.allComments.push(...newComments);%5Cn%20%20%20%20%20%20%20%20ctx.allComments.sort((a,b)%20=%3E%20a.time-b.time);%5Cn%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20if(ctx.onLoadAlreadyFired)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20//%20the%20comments%20plugin%20sometimes%20self-reloads%20atm,%20which%20is%20not%20ideal,%20but%20it's%20fine%20so%20long%20as%20we%20don't%20count%20it%20as%20an%20actual%20reload.%5Cn%20%20%20%20%20%20%20%20%20%20//%20instead,%20we%20trigger%20onComment%20for%20any%20new%20comments,%20and%20that's%20it.%5Cn%20%20%20%20%20%20%20%20%20%20for(let%20comment%20of%20newComments)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20opts.onComment(comment);%5Cn%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20return;%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20ctx.onLoadAlreadyFired%20=%20true;%5Cn%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20postMessageSource%20=%20e.source;%5Cn%20%20%20%20%20%20%20%20if(opts.onLoad)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20if(e.data.onLoadData.comments.length%20%3E%200)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20loadMoreButton.style.display%20=%20%5C%22block%5C%22;%5Cn%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20if(e.data.noMoreCommentsBeforeThis)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20loadMoreButton.style.display%20=%20%5C%22none%5C%22;%5Cn%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20opts.onLoad(e.data.onLoadData.comments,%20%7BloadMoreButton%7D);%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%7D%20else%20if(e.data.type%20===%20%5C%22perchance_comments_on_load_more%5C%22)%20%7B%5Cn%20%20%20%20%20%20%20%20let%20newComments%20=%20e.data.onLoadMoreData.comments.filter(c%20=%3E%20!ctx.alreadyGotCommentIds.has(c.id));%5Cn%20%20%20%20%20%20%20%20for(let%20c%20of%20newComments)%20ctx.alreadyGotCommentIds.add(c.id);%5Cn%20%20%20%20%20%20%20%20ctx.allComments.push(...newComments);%5Cn%20%20%20%20%20%20%20%20ctx.allComments.sort((a,b)%20=%3E%20a.time-b.time);%5Cn%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20if(e.data.onLoadMoreData.comments.length%20%3E%200)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20loadMoreButton.disabled%20=%20false;%5Cn%20%20%20%20%20%20%20%20%20%20loadMoreButton.textContent%20=%20originalLoadMoreButtonTextContent;%5Cn%20%20%20%20%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20loadMoreButton.style.display%20=%20%5C%22none%5C%22;%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20if(e.data.noMoreCommentsBeforeThis)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20loadMoreButton.style.display%20=%20%5C%22none%5C%22;%5Cn%20%20%20%20%20%20%20%20%20%20loadMoreButton.disabled%20=%20true;%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20if(opts.onLoadMore)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20opts.onLoadMore(e.data.onLoadMoreData.comments);%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%7D%20else%20if(e.data.type%20===%20%5C%22perchance_comments_load_more_no_more%5C%22)%20%7B%5Cn%20%20%20%20%20%20%20%20loadMoreButton.style.display%20=%20%5C%22none%5C%22;%5Cn%20%20%20%20%20%20%7D%20else%20if(e.data.type%20===%20%5C%22perchance_comments_finished_loading%5C%22)%20%7B%5Cn%20%20%20%20%20%20%20%20ctx.finishedLoading%20=%20true;%5Cn%20%20%20%20%20%20%20%20for(let%20handler%20of%20ctx.finishedLoadingHandlers)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20try%20%7B%20handler()%20%7D%20catch(e)%20%7B%20console.error(e);%20%7D%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20//%20hide%20the%20loader%20of%20the%20iframe:%5Cn%20%20%20%20%20%20%20%20let%20ctn%20=%20document.querySelector(%60.$%7Be.data.iframeUniqueId%7D%60).closest(%5C%22.comments-plugin-ctn%5C%22);%5Cn%20%20%20%20%20%20%20%20//%20have%20to%20check%20if%20exists%20because%20i%20think%20with%20fullscreen%20button%20it's%20not%20in%20the%20ctn%20anymore:%5Cn%20%20%20%20%20%20%20%20if(ctn)%20ctn.querySelector(%5C%22.__perchance-comments-loading-facade-12345%5C%22).style.display%20=%20%5C%22none%5C%22;%5Cn%20%20%20%20%20%20%20%20//%20and%20then%20tell%20it%20its%20parent%20origin:%5Cn%20%20%20%20%20%20%20%20e.source.postMessage(%7BparentOrigin:window.origin%7D,%20e.origin);%5Cn%20%20%20%20%20%20%7D%20else%20if(e.data.type%20===%20%5C%22evaluateText%5C%22)%20%7B%5Cn%20%20%20%20%20%20%20%20let%20result%20=%20e.data.text.evaluateItem;%5Cn%20%20%20%20%20%20%20%20e.source.postMessage(%7BrequestId:e.data.requestId,%20result%7D,%20e.origin);%5Cn%20%20%20%20%20%20%7D%20else%20if(e.data.type%20===%20%5C%22before_submit_handler_call%5C%22)%20%7B%5Cn%20%20%20%20%20%20%20%20let%20result;%5Cn%20%20%20%20%20%20%20%20if(opts.beforeSubmit)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20try%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20result%20=%20await%20opts.beforeSubmit(%7BinputText:e.data.inputText%7D);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20if(result%20!==%20undefined)%20result%20=%20JSON.parse(JSON.stringify(result));%5Cn%20%20%20%20%20%20%20%20%20%20%7D%20catch(e)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20result%20=%20null;%20//%20IMPORTANT:%20return%20null%20if%20it%20fails,%20which%20cancels%20the%20submission.%20Important%20for%20cases%20like:%20perchance.org/send-me-a-secret-message%20where%20continue-submission-on-error%20is%20'dangerous'%5Cn%20%20%20%20%20%20%20%20%20%20%20%20alert(%60beforeSubmit%20function%20failed%20with%20error:%20$%7Be.message%7D%60);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20console.error(e);%5Cn%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20await%20new%20Promise(r%20=%3E%20setTimeout(r,%2050));%20//%20important:%20allow%20e.g.%20set_input_el_text%20to%20be%20sent%20before%20this%20submit%20handler%20call%20is%20considered%20%5C%22done%5C%22%5Cn%20%20%20%20%20%20%20%20e.source.postMessage(%7BrequestId:e.data.requestId,%20result%7D,%20e.origin);%5Cn%20%20%20%20%20%20%7D%20else%20if(e.data.type%20===%20%5C%22slash_command%5C%22)%20%7B%5Cn%20%20%20%20%20%20%20%20let%20commandName%20=%20e.data.commandName;%5Cn%20%20%20%20%20%20%20%20let%20argText%20=%20e.data.argText;%5Cn%20%20%20%20%20%20%20%20let%20slashCommands%20=%20window.___commentsPluginSlashCommandsByChannel12321%5Be.data.channel%5D;%5Cn%20%20%20%20%20%20%20%20if(slashCommands%5BcommandName%5D%20===%20undefined)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20alert(%5C%22Please%20refresh%20the%20page%20before%20testing%20newly-added%20commands.%5C%22);%5Cn%20%20%20%20%20%20%20%20%20%20return%20%5C%22%5C%22;%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20slashCommands%5BcommandName%5D.input%20=%20argText;%5Cn%20%20%20%20%20%20%20%20let%20resultText%20=%20slashCommands%5BcommandName%5D.output.evaluateItem;%5Cn%20%20%20%20%20%20%20%20e.source.postMessage(%7BrequestId:e.data.requestId,%20resultText%7D,%20e.origin);%5Cn%20%20%20%20%20%20%7D%20else%20if(e.data.type%20===%20%5C%22toggle_fullscreen%5C%22)%20%7B%5Cn%20%20%20%20%20%20%20%20let%20iframe%20=%20document.querySelector(%60.$%7Be.data.iframeUniqueId%7D%60);%5Cn%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20//%20If%20iframe%20is%20currently%20fullscreen,%20then%20it's%20not%20in%20a%20%60ctn%60,%20so%20we%20use%20the%20pre-assigned%20data-comments-ctn-id%20to%20find%20the%20iframe's%20ctn%20so%20we%20can%20put%20it%20back%20in:%5Cn%20%20%20%20%20%20%20%20let%20ctn%20=%20iframe.closest(%5C%22.comments-plugin-ctn%5C%22)%20%7C%7C%20document.querySelector(%60%5Bdata-comments-ctn-id=%5C%22$%7Biframe.dataset.commentsCtnId%7D%5C%22%5D%60);%5Cn%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20if(ctn.dataset.isFullscreen%20===%20%5C%22no%5C%22)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20document.body.appendChild(iframe);%5Cn%20%20%20%20%20%20%20%20%20%20iframe.style.position%20=%20%5C%22fixed%5C%22;%5Cn%20%20%20%20%20%20%20%20%20%20iframe.style.zIndex%20=%20%5C%22999999999%5C%22;%20//%20%3C--%20caution:%20don't%20lower%20this%5Cn%20%20%20%20%20%20%20%20%20%20iframe.style.top%20=%20%5C%220%5C%22;%20iframe.style.left%20=%20%5C%220%5C%22;%5Cn%20%20%20%20%20%20%20%20%20%20document.scrollingElement.style.overflow%20=%20%5C%22hidden%5C%22;%5Cn%20%20%20%20%20%20%20%20%20%20ctn.dataset.isFullscreen%20=%20%5C%22yes%5C%22;%5Cn%20%20%20%20%20%20%20%20%20%20//%20link%20the%20iframe%20and%20ctn%20with%20an%20id%20so%20we%20can%20get%20the%20ctn,%20given%20the%20id%20from%20the%20iframe%20that%20sent%20the%20%5C%22toggle_fullscreen%5C%22%20message:%5Cn%20%20%20%20%20%20%20%20%20%20let%20commentsCtnId%20=%20Math.random();%5Cn%20%20%20%20%20%20%20%20%20%20ctn.dataset.commentsCtnId%20=%20commentsCtnId;%5Cn%20%20%20%20%20%20%20%20%20%20iframe.dataset.commentsCtnId%20=%20commentsCtnId;%5Cn%20%20%20%20%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20ctn.appendChild(iframe);%5Cn%20%20%20%20%20%20%20%20%20%20iframe.style.position%20=%20%5C%22%5C%22;%5Cn%20%20%20%20%20%20%20%20%20%20iframe.style.zIndex%20=%20%5C%22%5C%22;%5Cn%20%20%20%20%20%20%20%20%20%20iframe.style.top%20=%20%5C%22%5C%22;%20iframe.style.left%20=%20%5C%22%5C%22;%20%5Cn%20%20%20%20%20%20%20%20%20%20document.scrollingElement.style.overflow%20=%20%5C%22%5C%22;%5Cn%20%20%20%20%20%20%20%20%20%20ctn.dataset.isFullscreen%20=%20%5C%22no%5C%22;%5Cn%20%20%20%20%20%20%20%20%7D%5Cn//%20%20%20%20%20%20%20%20%20if(ctn.dataset.isFullscreen%20===%20%5C%22no%5C%22)%20%7B%5Cn//%20%20%20%20%20%20%20%20%20%20%20ctn.dataset.originalCssHeight%20=%20ctn.style.height;%5Cn//%20%20%20%20%20%20%20%20%20%20%20ctn.dataset.originalCssWidth%20=%20ctn.style.width;%5Cn//%20%20%20%20%20%20%20%20%20%20%20ctn.dataset.originalCssPosition%20=%20ctn.style.position;%5Cn//%20%20%20%20%20%20%20%20%20%20%20ctn.dataset.originalCssZIndex%20=%20ctn.style.zIndex;%5Cn%20%20%20%20%20%20%20%20%20%20%5Cn//%20%20%20%20%20%20%20%20%20%20%20//%20we%20need%20to%20change%20the%20ancestor%20z%20indices%20too:%5Cn//%20%20%20%20%20%20%20%20%20%20%20let%20ancestorEls%20=%20%5B%5D;%5Cn//%20%20%20%20%20%20%20%20%20%20%20let%20aEl%20=%20ctn.parentElement;%5Cn//%20%20%20%20%20%20%20%20%20%20%20while(aEl%20!==%20document.body)%20%7B%5Cn//%20%20%20%20%20%20%20%20%20%20%20%20%20ancestorEls.push(aEl);%5Cn//%20%20%20%20%20%20%20%20%20%20%20%20%20aEl%20=%20aEl.parentElement;%5Cn//%20%20%20%20%20%20%20%20%20%20%20%7D%5Cn//%20%20%20%20%20%20%20%20%20%20%20let%20ancestorZIndices%20=%20ancestorEls.map(el%20=%3E%20el.style.zIndex);%5Cn//%20%20%20%20%20%20%20%20%20%20%20ctn.dataset.originalAncestorZIndices%20=%20JSON.stringify(ancestorZIndices);%5Cn//%20%20%20%20%20%20%20%20%20%20%20ancestorEls.forEach(el%20=%3E%20el.style.zIndex=%5C%2263829472%5C%22);%5Cn%20%20%20%20%20%20%20%20%20%20%5Cn//%20%20%20%20%20%20%20%20%20%20%20ctn.style.height%20=%20%5C%22%5C%22;%5Cn//%20%20%20%20%20%20%20%20%20%20%20ctn.style.width%20=%20%5C%22%5C%22;%5Cn//%20%20%20%20%20%20%20%20%20%20%20ctn.style.position%20=%20%5C%22fixed%5C%22;%5Cn//%20%20%20%20%20%20%20%20%20%20%20ctn.style.zIndex%20=%20%5C%2263829472%5C%22;%5Cn//%20%20%20%20%20%20%20%20%20%20%20ctn.style.top%20=%20%5C%220%5C%22;%20ctn.style.left%20=%20%5C%220%5C%22;%20ctn.style.right%20=%20%5C%220%5C%22;%20ctn.style.bottom%20=%20%5C%220%5C%22;%5Cn//%20%20%20%20%20%20%20%20%20%20%20document.scrollingElement.style.overflow%20=%20%5C%22hidden%5C%22;%5Cn//%20%20%20%20%20%20%20%20%20%20%20ctn.dataset.isFullscreen%20=%20%5C%22yes%5C%22;%5Cn//%20%20%20%20%20%20%20%20%20%7D%20else%20if(ctn.dataset.isFullscreen%20===%20%5C%22yes%5C%22)%20%7B%5Cn//%20%20%20%20%20%20%20%20%20%20%20ctn.style.height%20=%20ctn.dataset.originalCssHeight;%5Cn//%20%20%20%20%20%20%20%20%20%20%20ctn.style.width%20=%20ctn.dataset.originalCssWidth;%5Cn//%20%20%20%20%20%20%20%20%20%20%20ctn.style.position%20=%20ctn.dataset.originalCssPosition;%5Cn//%20%20%20%20%20%20%20%20%20%20%20ctn.style.zIndex%20=%20ctn.dataset.originalCssZIndex;%5Cn%20%20%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20%20%20%5Cn//%20%20%20%20%20%20%20%20%20%20%20let%20ancestorEls%20=%20%5B%5D;%5Cn//%20%20%20%20%20%20%20%20%20%20%20let%20aEl%20=%20ctn.parentElement;%5Cn//%20%20%20%20%20%20%20%20%20%20%20while(aEl%20!==%20document.body)%20%7B%5Cn//%20%20%20%20%20%20%20%20%20%20%20%20%20ancestorEls.push(aEl);%5Cn//%20%20%20%20%20%20%20%20%20%20%20%20%20aEl%20=%20aEl.parentElement;%5Cn//%20%20%20%20%20%20%20%20%20%20%20%7D%5Cn//%20%20%20%20%20%20%20%20%20%20%20let%20originalAncestorZIndices%20=%20JSON.parse(ctn.dataset.originalAncestorZIndices);%5Cn//%20%20%20%20%20%20%20%20%20%20%20ancestorEls.forEach((el,%20i)%20=%3E%20el.style.zIndex=originalAncestorZIndices%5Bi%5D);%5Cn%20%20%20%20%20%20%20%20%20%20%5Cn//%20%20%20%20%20%20%20%20%20%20%20ctn.style.top%20=%20%5C%22%5C%22;%20ctn.style.left%20=%20%5C%22%5C%22;%20ctn.style.right%20=%20%5C%22%5C%22;%20ctn.style.bottom%20=%20%5C%22%5C%22;%5Cn//%20%20%20%20%20%20%20%20%20%20%20document.scrollingElement.style.overflow%20=%20%5C%22%5C%22;%5Cn//%20%20%20%20%20%20%20%20%20%20%20ctn.dataset.isFullscreen%20=%20%5C%22no%5C%22;%5Cn//%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%7D,%20false);%5Cn%20%20%5Cn%20%20%20%20let%20cssText%20=%20%60%5Cn%20%20%20%20.comments-plugin-ctn%20%7B%5Cn%20%20%20%20%20%20position:relative;%5Cn%20%20%20%20%20%20display:inline-block;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20.loading-spinner-434142%20%7B%20%5Cn%20%20%20%20%20%20border:%204px%20solid%20#f3f3f3;%5Cn%20%20%20%20%20%20border-top:%204px%20solid%20#5d5d5d;%5Cn%20%20%20%20%20%20border-radius:%2050%25;%5Cn%20%20%20%20%20%20width:%2030px;%5Cn%20%20%20%20%20%20height:%2030px;%5Cn%20%20%20%20%20%20animation:%20spin%200.9s%20linear%20infinite;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20@keyframes%20spin%20%7B%5Cn%20%20%20%20%20%200%25%20%7B%20transform:%20rotate(0deg);%20%7D%5Cn%20%20%20%20%20%20100%25%20%7B%20transform:%20rotate(360deg);%20%7D%5Cn%20%20%20%20%7D%60;%5Cn%20%20%20%20let%20styleEl%20=%20document.createElement('style');%5Cn%20%20%20%20styleEl.appendChild(document.createTextNode(cssText));%5Cn%20%20%20%20document.head.appendChild(styleEl);%5Cn%20%20%20%20%5Cn%20%20%20%20//%20let%20addCommentsPluginInterval%20=%20setInterval(()%20=%3E%20%7B%5Cn%20%20%20%20//%20%20%20document.querySelectorAll(%5C%22.___perchance-comments-plugin-marker%5C%22).forEach(markerEl%20=%3E%20%7B%5Cn%20%20%20%20//%20%20%20%20%20//%20detect%20if%20a%20comments%20section%20has%20been%20injected%20after%20it%20yet%20(edit:%20for%20some%20reason%20it's%20injected%20before%20it?):%5Cn%20%20%20%20//%20%20%20%20%20if((!markerEl.nextElementSibling%20%7C%7C%20markerEl.nextElementSibling.dataset.isCommentsSection%20!==%20%5C%22true%5C%22)%20&&%20(!markerEl.previousElementSibling%20%7C%7C%20markerEl.previousElementSibling.dataset.isCommentsSection%20!==%20%5C%22true%5C%22))%20%7B%5Cn%20%20%20%20//%20%20%20%20%20%20%20let%20div%20=%20document.createElement(%5C%22div%5C%22);%5Cn%20%20%20%20//%20%20%20%20%20%20%20let%20containerStyle%20=%20markerEl.dataset.containerStyle;%5Cn%20%20%20%20//%20%20%20%20%20%20%20let%20queryString%20=%20markerEl.dataset.queryString;%5Cn%20%20%20%20//%20%20%20%20%20%20%20let%20folderName%20=%20markerEl.dataset.folderName;%5Cn%20%20%20%20//%20%20%20%20%20%20%20div.innerHTML%20=%20%60%3Cdiv%20class=%5C%22comments-plugin-ctn%5C%22%20data-is-comments-section=%5C%22true%5C%22%20style=%5C%22position:relative;%20display:inline-block;%20$%7BcontainerStyle%7D%5C%22%3E%5Cn%20%20%20%20//%20%20%20%20%20%20%20%20%20%3Cdiv%20class=%5C%22__perchance-comments-loading-facade-12345%5C%22%20style=%5C%22position:absolute;%20top:0;%20left:0;%20right:0;%20bottom:0;%20display:flex;%20align-items:center;%20justify-content:center;%20background:white;%20border:1px%20solid%20rgba(0,0,0,0.25);%20border-radius:2px;%5C%22%3E%3Cdiv%20class=%5C%22loading-spinner-434142%5C%22%3E%3C/div%3E%3C/div%3E%5Cn%20%20%20%20//%20%20%20%20%20%20%20%20%20%3Ciframe%20class=%5C%22___perchance-comments-plugin-iframe-12345%5C%22%20src=%5C%22https://comments-plugin.perchance.org/embed/$%7BfolderName%7D?$%7BqueryString%7D%5C%22%20style=%5C%22border:0;%20width:100%25;%20height:100%25;%5C%22%3E%3C/iframe%3E%5Cn%20%20%20%20//%20%20%20%20%20%20%20%3C/div%3E%60;%5Cn%20%20%20%20//%20%20%20%20%20%20%20let%20iframeContainer%20=%20div.firstElementChild;%5Cn%20%20%20%20//%20%20%20%20%20%20%20//debugger;%5Cn%20%20%20%20//%20%20%20%20%20%20%20markerEl.after(iframeContainer);%5Cn%20%20%20%20//%20%20%20%20%20%20%20clearInterval(addCommentsPluginInterval);%5Cn%20%20%20%20//%20%20%20%20%20%7D%5Cn%20%20%20%20//%20%20%20%7D);%5Cn%20%20%20%20//%20%7D,%20200);%5Cn%20%20%20%20%5Cn%20%20%20%20window.___alreadyAddedCommentsPluginStuff43211234%20=%20true;%5Cn%20%20%7D%5Cn%5Cn%20%20let%20colorScheme%20=%20window.matchMedia%20&&%20window.matchMedia('(prefers-color-scheme:%20dark)').matches%20?%20%5C%22dark%5C%22%20:%20%5C%22light%5C%22;%5Cn%20%20if(opts.forceColorScheme)%20colorScheme%20=%20opts.forceColorScheme.evaluateItem;%5Cn%20%20%5Cn%20%20function%20lazyLoadIframe(%7BurlHashDataEncoded%7D)%20%7B%5Cn%20%20%20%20let%20commentsCtn%20=%20document.querySelector(%60%5Bdata-comments-section-folder-name=%5C%22$%7BfolderName%7D%5C%22%5D:not(.already-added-intersection-observer-to-this-comments-plugin-ctn)%60);%20//%20get%20the%20first%20one%20that%20we%20haven't%20added%20an%20intersection%20observer%20for%20yet%20-%20this%20is%20needed%20because%20they%20could%20have%20multiple%20instances%20of%20the%20same%20channel%20on%20the%20page,%20and%20we%20don't%20want%20to%20add%20all%20the%20intersection%20observers%20to%20the%20first%20one%5Cn%20%20%20%20if(!commentsCtn)%20return;%20//%20i%20think%20this%20happens%20sometimes%20due%20to%20timing/race%20condition%20where%20iframe%20is%20deleted%20in%20a%20very%20small%20time%20window%5Cn%20%20%20%20commentsCtn.classList.add(%5C%22already-added-intersection-observer-to-this-comments-plugin-ctn%5C%22);%5Cn%5Cn%20%20%20%20let%20observer1,%20observer2;%5Cn%20%20%20%20//%20lazyload%20the%20iframe,%20because%20some%20generator%20pages%20have%20literally%20dozens%20of%20different%20channels.%5Cn%20%20%20%20//%20I'm%20adding%20multiple%20observers%20because%20the%20default%20%60root%60%20is%20the%20browser%20viewport,%20and%20margin%20doesn't%20make%20sense%20for%20that,%20since%20it's%20not%20scrollable,%20but%20we%20still%20want%20it%20in%20case%20of%20the%20comments%20being%20in%20weird%20non-documentElement%20scrollable%20area%20or%20something.%20Note%20really%20sure%20how%20it%20works.%5Cn%20%20%20%20const%20observerFn%20=%20entries%20=%3E%20%7B%5Cn%20%20%20%20%20%20if(entries%5B0%5D.isIntersecting)%20%7B%5Cn%20%20%20%20%20%20%20%20observer1.disconnect();%5Cn%20%20%20%20%20%20%20%20observer2.disconnect();%5Cn%20%20%20%20%20%20%20%20console.debug(%5C%22comments%20ctn:%20Visible%5C%22);%5Cn%20%20%20%20%20%20%20%20let%20placeholder%20=%20commentsCtn.querySelector(%5C%22.__perchance-comments-iframe-placeholder-el-12345%5C%22);%5Cn%20%20%20%20%20%20%20%20if(placeholder)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20let%20iframeHtml%20=%20%60%3Ciframe%20class=%5C%22$%7BiframeUniqueId%7D%20___perchance-comments-plugin-iframe-12345%5C%22%20src=%5C%22https://comments-plugin.perchance.org/embed/$%7BfolderName%7D?$%7BqueryString%7D#$%7BurlHashDataEncoded%7D%5C%22%20style=%5C%22border:0;%20width:100%25;%20height:100%25;%20user-select:none;%5C%22%20$%7BurlHashData.transparentBackground%20?%20%60allowtransparency=%5C%22true%5C%22%60%20:%20%5C%22%5C%22%7D%3E%3C/iframe%3E%60;%5Cn%20%20%20%20%20%20%20%20%20%20placeholder.outerHTML%20=%20iframeHtml;%5Cn%20%20%20%20%20%20%20%20%20%20ctx.iframeContentWindow%20=%20document.querySelector(%5C%22.%5C%22+iframeUniqueId).contentWindow;%5Cn%20%20%20%20%20%20%20%20%20%20window.___commentsPluginIframeUniqueIdToContext.set(iframeUniqueId,%20ctx);%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%7D;%5Cn%20%20%20%20setTimeout(()%20=%3E%20%7B%20//%20slight%20delay%20in%20case%20of%20e.g.%20tabs%20being%20rendered%20in%20such%20a%20way%20that%20they're%20all%20momentarily%20visible%20(we%20don't%20wnat%20to%20load%20them%20all%20at%20once%20-%20only%20the%20active%20tab)%5Cn%20%20%20%20%20%20observer1%20=%20new%20IntersectionObserver(observerFn,%20%7B%5Cn%20%20%20%20%20%20%20%20rootMargin:%20%5C%226000px%5C%22,%20//%20we%20basically%20want%20to%20trigger%20~all%20visible%20elements%20anyway%20-%20just%20not%20stuff%20hidden%20within%20e.g.%20tabs%20plugin%20or%20whatever.%5Cn%20%20%20%20%20%20%7D);%5Cn%20%20%20%20%20%20observer1.observe(commentsCtn);%5Cn%20%20%20%20%20%20observer2%20=%20new%20IntersectionObserver(observerFn,%20%7B%5Cn%20%20%20%20%20%20%20%20root:%20document.documentElement,%5Cn%20%20%20%20%20%20%20%20rootMargin:%20%5C%226000px%5C%22,%20//%20we%20basically%20want%20to%20trigger%20~all%20visible%20elements%20anyway%20-%20just%20not%20stuff%20hidden%20within%20e.g.%20tabs%20plugin%20or%20whatever.%5Cn%20%20%20%20%20%20%7D);%5Cn%20%20%20%20%20%20observer2.observe(commentsCtn);%5Cn%20%20%20%20%7D,%205);%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20let%20containerHtml%20=%20%60%3Cdiv%20data-is-fullscreen=%5C%22no%5C%22%20data-comments-section-folder-name=%5C%22$%7BfolderName%7D%5C%22%20class=%5C%22comments-plugin-ctn%5C%22%20data-is-comments-section=%5C%22true%5C%22%20style=%5C%22$%7BcontainerStyle%7D%5C%22%3E%5Cn%20%20%20%20%3Cdiv%20class=%5C%22__perchance-comments-loading-facade-12345%5C%22%20style=%5C%22position:absolute;%20top:0;%20left:0;%20right:0;%20bottom:0;%20display:flex;%20align-items:center;%20justify-content:center;%20background:$%7BcolorScheme%20===%20%5C%22light%5C%22%20?%20%5C%22white%5C%22%20:%20%5C%22#131516%5C%22%7D;%20border:1px%20solid%20rgba(0,0,0,0.25);%20border-radius:2px;%5C%22%3E%3Cdiv%20class=%5C%22loading-spinner-434142%5C%22%3E%3C/div%3E%3C/div%3E%5Cn%20%20%20%20%3Cspan%20class=%5C%22__perchance-comments-iframe-placeholder-el-12345%5C%22%3E%3C/span%3E%5Cn%20%20%3C/div%3E%60;%5Cn%20%20%5Cn%20%20if(opts.replacedDuringUpdate)%20%7B%5Cn%20%20%20%20//%20setTimeout(async%20()%20=%3E%20%7B%5Cn%20%20%20%20//%20%20%20while(!document.querySelector(%5C%22.%5C%22+iframeUniqueId))%20%7B%5Cn%20%20%20%20//%20%20%20%20%20console.debug(%5C%22Waiting%20for%20comments-plugin%20iframe%20to%20appear%20in%20document.%5C%22);%5Cn%20%20%20%20//%20%20%20%20%20await%20new%20Promise(r%20=%3E%20setTimeout(r,%20500));%5Cn%20%20%20%20//%20%20%20%7D%5Cn%20%20%20%20//%20%20%20ctx.iframeContentWindow%20=%20document.querySelector(%5C%22.%5C%22+iframeUniqueId).contentWindow;%5Cn%20%20%20%20//%20%20%20window.___commentsPluginIframeUniqueIdToContext.set(iframeUniqueId,%20ctx);%5Cn%20%20%20%20//%20%7D,%2010);%5Cn%20%20%20%20//%20return%20addMethodsToReturnValue(new%20String(%60%3Cdiv%20data-is-fullscreen=%5C%22no%5C%22%20data-comments-section-folder-name=%5C%22$%7BfolderName%7D%5C%22%20class=%5C%22comments-plugin-ctn%5C%22%20data-is-comments-section=%5C%22true%5C%22%20style=%5C%22$%7BcontainerStyle%7D%5C%22%3E%5Cn%20%20%20%20//%20%20%20%3Cdiv%20class=%5C%22__perchance-comments-loading-facade-12345%5C%22%20style=%5C%22position:absolute;%20top:0;%20left:0;%20right:0;%20bottom:0;%20display:flex;%20align-items:center;%20justify-content:center;%20background:$%7BcolorScheme%20===%20%5C%22light%5C%22%20?%20%5C%22white%5C%22%20:%20%5C%22#131516%5C%22%7D;%20border:1px%20solid%20rgba(0,0,0,0.25);%20border-radius:2px;%5C%22%3E%3Cdiv%20class=%5C%22loading-spinner-434142%5C%22%3E%3C/div%3E%3C/div%3E%5Cn%20%20%20%20//%20%20%20%3Ciframe%20loading=%5C%22lazy%5C%22%20class=%5C%22$%7BiframeUniqueId%7D%20___perchance-comments-plugin-iframe-12345%5C%22%20src=%5C%22https://comments-plugin.perchance.org/embed/$%7BfolderName%7D?$%7BqueryString%7D#$%7BencodeURIComponent(JSON.stringify(urlHashData))%7D%5C%22%20style=%5C%22border:0;%20width:100%25;%20height:100%25;%5C%22%3E%3C/iframe%3E%5Cn%20%20%20%20//%20%3C/div%3E%60));%5Cn%20%20%20%20setTimeout(async%20()%20=%3E%20%7B%5Cn%20%20%20%20%20%20let%20urlHashDataEncoded%20=%20encodeURIComponent(JSON.stringify(urlHashData));%5Cn%20%20%20%20%20%20lazyLoadIframe(%7BurlHashDataEncoded%7D)%5Cn%20%20%20%20%7D,%2010);%5Cn%20%20%20%20return%20addMethodsToReturnValue(new%20String(containerHtml));%5Cn%20%20%7D%5Cn%20%20%20%20%5Cn%20%20if(!document.querySelector(%60%5Bdata-comments-section-folder-name=%5C%22$%7BfolderName%7D%5C%22%5D%60))%20%7B%5Cn%5Cn%20%20%20%20function%20swapMarkerElForRealEl()%20%7B%5Cn%20%20%20%20%20%20let%20markerEl%20=%20document.querySelector(%60%5Bdata-marker-tag=%5C%22temporaryMarkerElForCommentsPlugin84738932-folderName-$%7BfolderName%7D%5C%22%5D%60);%5Cn%20%20%20%20%20%20if(!markerEl)%20return;%5Cn%20%20%20%20%20%20let%20containerStyle%20=%20markerEl.dataset.containerStyle;%5Cn%20%20%20%20%20%20let%20queryString%20=%20markerEl.dataset.queryString;%5Cn%20%20%20%20%20%20let%20urlHashDataEncoded%20=%20markerEl.dataset.urlHashDataEncoded;%5Cn%20%20%20%20%20%20//%20let%20folderName%20=%20markerEl.dataset.folderName;%5Cn%5Cn%20%20%20%20%20%20//%20NOTE:%20we%20don't%20use%20replaceWith%20here%20because%20that%20approach%20would%20mean%20that%20this%20would%20get%20updated%20during%20update()%20calls%5Cn%20%20%20%20%20%20markerEl.outerHTML%20=%20containerHtml;%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20lazyLoadIframe(%7BurlHashDataEncoded%7D);%5Cn%20%20%20%20%7D%5Cn%5Cn%20%20%20%20//%20setTimeout(swapMarkerElForRealEl,%2050);%5Cn%5Cn%20%20%20%20//%20the%20above%20commented-out%20setTimeout%20one-liner%20was%20the%20previous%20approach.%20the%20below%20MutationObserver-based%20monstrosity%20is%20a%20bit%20better%20because%20it%20ensures%20the%20swap%20happens%20*the%20moment*%20that%20the%20marker%20is%20added%20to%20the%20page,%20and%20we%20can%20wait%20a%20long%20time%20without%20the%20need%20for%20polling%5Cn%20%20%20%20let%20markerEl%20=%20document.querySelector(%60%5Bdata-marker-tag=%5C%22temporaryMarkerElForCommentsPlugin84738932-folderName-$%7BfolderName%7D%5C%22%5D%60);%5Cn%20%20%20%20if(markerEl)%20%7B%5Cn%20%20%20%20%20%20swapMarkerElForRealEl();%5Cn%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20//%20they%20generated%20the%20comments%20HTML,%20but%20haven't%20put%20it%20in%20the%20page%20yet,%20so%20we%20wait%20for%20it%20using%20a%20mutation%20observer:%5Cn%20%20%20%20%20%20let%20foundElement%20=%20false;%5Cn%20%20%20%20%20%20let%20markerTagValue%20=%20%60temporaryMarkerElForCommentsPlugin84738932-folderName-$%7BfolderName%7D%60;%5Cn%20%20%20%20%20%20let%20observer%20=%20new%20MutationObserver((mutations)%20=%3E%20%7B%5Cn%20%20%20%20%20%20%20%20for(let%20mutation%20of%20mutations)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20for(let%20node%20of%20mutation.addedNodes)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20if(node.dataset%20&&%20node.dataset.markerTag%20===%20markerTagValue)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20foundElement%20=%20true;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20if(node.querySelector)%20%7B%20//%20skip%20#text,%20#comment,%20etc.%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20since%20mutation%20observers%20don't%20trigger%20for%20all%20subnodes%20-%20only%20the%20highest-level%20nodes%20in%20a%20mutation%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20let%20markerEl%20=%20node.querySelector(%60%5Bdata-marker-tag=%5C%22temporaryMarkerElForCommentsPlugin84738932-folderName-$%7BfolderName%7D%5C%22%5D%60);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20if(markerEl)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20foundElement%20=%20true;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20%20%20if(foundElement)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20observer.disconnect();%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20swapMarkerElForRealEl();%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20return;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%7D);%5Cn%20%20%20%20%20%20observer.observe(document.body,%20%7B%20childList:%20true,%20subtree:%20true%20%7D);%5Cn%20%20%20%20%20%20setTimeout(()%20=%3E%20%7B%5Cn%20%20%20%20%20%20%20%20if(!foundElement)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20console.error(%5C%22Couldn't%20find%20marker%20element%20for%20comments%20plugin?%5C%22);%5Cn%20%20%20%20%20%20%20%20%20%20observer.disconnect();%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%7D,%2010000);%5Cn%20%20%20%20%7D%5Cn%5Cn%20%20%20%20return%20addMethodsToReturnValue(new%20String(%60%3Cspan%20data-marker-tag=%5C%22temporaryMarkerElForCommentsPlugin84738932-folderName-$%7BfolderName%7D%5C%22%20data-folder-name=%5C%22$%7BfolderName%7D%5C%22%20data-container-style=%5C%22$%7BcontainerStyle%7D%5C%22%20data-query-string=%5C%22$%7BqueryString%7D%5C%22%20data-url-hash-data-encoded=%5C%22$%7BencodeURIComponent(JSON.stringify(urlHashData))%7D%5C%22%3E%3C/span%3E%60));%5Cn%20%20%7D%20else%20%7B%5Cn%20%20%20%20return%20%5C%22%5C%22;%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20%5Cn%5Cn%5Cn//%20%20%20//%20This%20is%20a%20temporary%20fix%20because%20editing%20the%20text%20next%20to%20where%20the%20plugin%20is%20placed%20(within%20the%20same%20HTML%20%5C%22node%5C%22?)%20will%20cause%20the%5Cn//%20%20%20//%20comments%20section%20to%20disappear%20which%20causes%20users%20to%20think%20that%20they%20can't%20edit%20the%20positioning%20of%20the%20comments.%20So%20we%20tell%20them%20to%5Cn//%20%20%20//%20refresh%20the%20page.%20Ideally%20I'd%20fix%20this%20like%20I%20did%20with%20the%20text-to-image-plugin%20gallery%20-%20I%20just%20return/create%20a%20%5C%22fresh%5C%22%20one%20whenever%5Cn//%20%20%20//%20the%20old%20one%20isn't%20detected%20with%20querySelector.%5Cn//%20%20%20setTimeout(()%20=%3E%20%7B%5Cn//%20%20%20%20%20if(document.querySelectorAll(%5C%22.___perchance-comments-plugin-marker%5C%22).length%20!==%20document.querySelectorAll(%5C%22.comments-plugin-ctn%5C%22).length)%20%7B%5Cn//%20%20%20%20%20%20%20document.querySelectorAll(%5C%22.___perchance-comments-plugin-marker%5C%22).forEach(markerEl%20=%3E%20%7B%5Cn//%20%20%20%20%20%20%20%20%20markerEl.style.cssText%20=%20%60display:inline-block;%20border:1px%20solid%20grey;%20$%7BmarkerEl.dataset.containerStyle%7D%60;%5Cn//%20%20%20%20%20%20%20%20%20markerEl.innerHTML%20=%20%60%3Cdiv%20style=%5C%22height:100%25;%20display:flex;%20align-items:center;%20justify-content:center;%5C%22%3E%3Cspan%20style=%5C%22opacity:0.6;%20padding:1rem;%5C%22%3EPlease%20save%20your%20generator%20and%20refresh%20the%20page%20to%20reload%20the%20comments%20plugin.%3C/span%3E%3C/div%3E%60;%5Cn//%20%20%20%20%20%20%20%7D);%5Cn//%20%20%20%20%20%7D%5Cn//%20%20%20%7D,%20600);%5Cn%5Ct%5Cn//%20%5Ct//%20can't%20just%20inject%20the%20iframe%20directly%20otherwise%20it%20gets%20reloaded%20every%20time%20update()%20is%20called.%20So%20we%20need%20the%20setInterval%20monstrosity%20above.%5Cn//%20%5Ctreturn%20%60%3Cspan%20class=%5C%22___perchance-comments-plugin-marker%5C%22%20data-folder-name=%5C%22$%7BfolderName%7D%5C%22%20data-container-style=%5C%22$%7BcontainerStyle%7D%5C%22%20data-query-string=%5C%22$%7BqueryString%7D%5C%22%3E%3C/span%3E%60;%5Cn%20%20%5Cn%20%20%5Cn%20%20%5Cn%20%20%5Cn%20%20%5Cn%20%20%5Cn%20%20%5Cn%20%20%22,%22imports%22:%5B%5D,%22lastEditTime%22:1750480036442,%22found%22:true%7D,%7B%22name%22:%22create-media-gallery-plugin%22,%22modelText%22:%22kv%20=%20%7Bimport:kv-plugin%7D%5CnsuperFetch%20=%20%7Bimport:super-fetch-plugin%7D%20//%20for%20URL-based%20media%20imports%20(see%20gallery%20menu)%5Cn%5CncreateMediaGallery%20=%20%5B%5D%20//%20just%20for%20the%20demo%20in%20the%20HTML%20panel%5Cn%5Cn(name)%20=%3E%5Cn%20%20if(!name)%20name%20=%20%5C%22%5C%22;%5Cn%20%20if(!/%5E%5Ba-zA-Z0-9_%5D*$/.test(name))%20throw%20new%20Error(%5C%22Gallery%20name%20must%20be%20alphanumeric%20(underscores%20are%20also%20allowed)%5C%22);%5Cn%20%20/*%20%E2%94%80%E2%94%80%20prefix%20to%20avoid%20collisions%20%E2%94%80%E2%94%80%20*/%5Cn%20%20const%20pre%20=%20%60localMediaGallery_$%7Bname%7D.%60;%5Cn%20%20const%20galleriesKey%20=%20pre%20+%20%5C%22names%5C%22;%5Cn%20%20const%20defaultGallery%20=%20%5C%22general%5C%22;%5Cn%20%20let%20activeGalleryName%20=%20localStorage%5Bpre%20+%20%5C%22activeGalleryName%5C%22%5D%20%7C%7C%20defaultGallery;%5Cn%5Cn%20%20/*%20helper%20to%20coerce%20any%20info%20object%20into%20%7B%20%5Bk:string%5D:string%20%7D%20*/%5Cn%20%20const%20cleanInfo%20=%20i%20=%3E%20%7B%5Cn%20%20%20%20if%20(!i%20%7C%7C%20typeof%20i%20!==%20%5C%22object%5C%22)%20i%20=%20%7B%7D;%5Cn%20%20%20%20const%20o%20=%20%7B%7D;%5Cn%20%20%20%20for%20(const%20%5Bk,%20v%5D%20of%20Object.entries(i))%20o%5Bk%5D%20=%20String(v);%5Cn%20%20%20%20return%20o;%5Cn%20%20%7D;%5Cn%5Cn%20%20/*%20global%20dark-mode%20+%20btn-visibility%20vars%20(once)%20*/%5Cn%20%20if%20(!document.getElementById(%5C%22localMediaGalleryGlobalStyles%5C%22))%20%7B%5Cn%20%20%20%20const%20s%20=%20document.createElement(%5C%22style%5C%22);%5Cn%20%20%20%20s.id%20=%20%5C%22localMediaGalleryGlobalStyles%5C%22;%5Cn%20%20%20%20s.textContent%20=%20%60%5Cn%20%20%20%20%20%20html%7Bcolor-scheme:light%20dark;%7D%5Cn%20%20%20%20%20%20:root%20%20%7B--localMediaGalleryBtnsDisplay:flex;%7D%5Cn%20%20%20%20%20%20@media%20(hover:hover)%20and%20(pointer:fine)%20%7B%5Cn%20%20%20%20%20%20%20%20%5Bdata-local-media-gallery-item%5D%20%5Bdata-local-media-gallery-bar%5D%7Bopacity:0;pointer-events:none;transition:opacity%20.15s;%7D%5Cn%20%20%20%20%20%20%20%20%5Bdata-local-media-gallery-item%5D:hover%20%5Bdata-local-media-gallery-bar%5D%7Bopacity:.85;pointer-events:auto;%7D%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%60;%5Cn%20%20%20%20document.head.appendChild(s);%5Cn%20%20%7D%5Cn%5Cn%20%20const%20getGalleryNames%20%20=%20()%20=%3E%20JSON.parse(localStorage.getItem(galleriesKey)%20%7C%7C%20%60%5B%5C%22$%7BdefaultGallery%7D%5C%22%5D%60);%5Cn%20%20const%20saveGalleryNames%20=%20a%20=%3E%20localStorage.setItem(galleriesKey,%20JSON.stringify(%5B...new%20Set(a)%5D));%5Cn%5Cn%20%20const%20$%20=%20(t,p=%7B%7D,...k)=%3E%7B%5Cn%20%20%20%20const%20el=document.createElement(t);%5Cn%20%20%20%20for(const%20%5Bk2,v%5D%20of%20Object.entries(p))%7B%5Cn%20%20%20%20%20%20if(k2===%5C%22style%5C%22)el.style.cssText=v;%5Cn%20%20%20%20%20%20else%20if(k2===%5C%22dataset%5C%22)Object.assign(el.dataset,v);%5Cn%20%20%20%20%20%20else%20el%5Bk2%5D=v;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20k.forEach(c=%3Ec&&el.appendChild(c));%5Cn%20%20%20%20return%20el;%5Cn%20%20%7D;%5Cn%5Cn%20%20const%20dims%20=%20b=%3Enew%20Promise(r=%3E%7B%5Cn%20%20%20%20if%20(b.type.startsWith(%5C%22image/%5C%22))%20%7B%5Cn%20%20%20%20%20%20const%20i=new%20Image();i.onload=()=%3Er(%7Bw:i.width,h:i.height%7D);i.src=URL.createObjectURL(b);%5Cn%20%20%20%20%7D%20else%20if(b.type.startsWith(%5C%22video/%5C%22))%20%7B%5Cn%20%20%20%20%20%20const%20v=document.createElement(%5C%22video%5C%22);v.onloadedmetadata=()=%3Er(%7Bw:v.videoWidth%7C%7C300,h:v.videoHeight%7C%7C300%7D);v.src=URL.createObjectURL(b);%5Cn%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20r(%7Bw:300,h:300%7D);%5Cn%20%20%20%20%7D%5Cn%20%20%7D);%5Cn%20%20const%20blobs%20=%20kv%5Bpre+%5C%22blobs%5C%22%5D;%20//%20blob%20store%5Cn%5Cn%20%20/*%20%E2%94%80%E2%94%80%E2%94%80%E2%94%80%E2%94%80%E2%94%80%E2%94%80%E2%94%80%E2%94%80%E2%94%80%E2%94%80%E2%94%80%E2%94%80%E2%94%80%E2%94%80%E2%94%80%E2%94%80%E2%94%80%E2%94%80%E2%94%80%E2%94%80%E2%94%80%E2%94%80%E2%94%80%E2%94%80%E2%94%80%E2%94%80%E2%94%80%E2%94%80%20JSZip%20loader%20*/%5Cn%20%20let%20jszipMod=null;%5Cn%20%20const%20getJSZip=()=%3EjszipMod?jszipMod:import(%5C%22https://cdn.jsdelivr.net/npm/jszip@3.10.1/+esm%5C%22).then(m=%3E(jszipMod=m.default%7C%7Cm));%5Cn%5Cn%20%20/*%20%E2%94%80%E2%94%80%E2%94%80%E2%94%80%E2%94%80%E2%94%80%E2%94%80%E2%94%80%E2%94%80%E2%94%80%E2%94%80%E2%94%80%E2%94%80%E2%94%80%E2%94%80%E2%94%80%E2%94%80%E2%94%80%E2%94%80%E2%94%80%E2%94%80%E2%94%80%E2%94%80%E2%94%80%E2%94%80%E2%94%80%E2%94%80%E2%94%80%E2%94%80%20backup%20/%20restore%20(ZIP)%20*/%5Cn%20%20async%20function%20saveBackup()%7B%5Cn%20%20%20%20if(!confirm(%5C%22This%20will%20download%20a%20.zip%20backup%20of%20all%20galleries%20to%20your%20device.%20Proceed?%5C%22))return;%5Cn%20%20%20%20const%20files=%5B%5D;%5Cn%20%20%20%20for(const%20g%20of%20getGalleryNames())%7B%5Cn%20%20%20%20%20%20const%20items%20=%20await%20kv%5Bpre+g%5D.values();%5Cn%20%20%20%20%20%20for(const%20m%20of%20items)%7B%5Cn%20%20%20%20%20%20%20%20const%20rec%20=%20await%20blobs.get(m.id);%5Cn%20%20%20%20%20%20%20%20const%20b%20%20%20=%20rec?.blob%7C%7Crec;%5Cn%20%20%20%20%20%20%20%20const%20ext%20=%20(b.type.split(%5C%22/%5C%22)%5B1%5D%7C%7C%5C%22bin%5C%22).replace(/%5B%5E%5C%5Cw.-%5D/g,'');%5Cn%20%20%20%20%20%20%20%20files.push(%7Bname:%60galleries/$%7Bg%7D/$%7Bm.id%7D.$%7Bext%7D%60,blob:b%7D);%5Cn%20%20%20%20%20%20%20%20files.push(%7Bname:%60galleries/$%7Bg%7D/$%7Bm.id%7D.info.json%60,blob:new%20Blob(%5BJSON.stringify(%7Bmeta:m,info:rec?.info%7C%7Cnull,mime:b.type%7D,null,2)%5D,%7Btype:%5C%22application/json%5C%22%7D)%7D);%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%7D%5Cn%20%20%20%20const%20JSZip%20%20%20=%20await%20getJSZip();%5Cn%20%20%20%20const%20zip%20%20%20%20%20=%20new%20JSZip();%5Cn%20%20%20%20files.forEach(f=%3Ezip.file(f.name,f.blob));%5Cn%20%20%20%20const%20zipBlob%20=%20await%20zip.generateAsync(%7Btype:%5C%22blob%5C%22%7D);%5Cn%20%20%20%20const%20a=$(%5C%22a%5C%22,%7Bhref:URL.createObjectURL(zipBlob),download:%60media_gallery_backup_$%7Bnew%20Date().toISOString().replace(/%5B:%5D/g,'-').slice(0,19)%7D.zip%60%7D);%5Cn%20%20%20%20a.click();URL.revokeObjectURL(a.href);%5Cn%20%20%7D%5Cn%5Cn%20%20async%20function%20loadBackup()%7B%5Cn%20%20%20%20return%20new%20Promise(resolve%20=%3E%20%7B%5Cn%20%20%20%20%20%20const%20inp=$(%5C%22input%5C%22,%7Btype:%5C%22file%5C%22,accept:%5C%22.zip%5C%22,style:%5C%22display:none%5C%22%7D);%5Cn%20%20%20%20%20%20inp.onchange=async()=%3E%7B%5Cn%20%20%20%20%20%20%20%20try%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20const%20file=inp.files%5B0%5D;%5Cn%20%20%20%20%20%20%20%20%20%20if(!file)%20return;%5Cn%20%20%20%20%20%20%20%20%20%20if(!confirm(%5C%22Importing%20will%20MERGE%20the%20backup%20into%20your%20current%20galleries%20(existing%20items%20are%20kept).%20Continue?%5C%22))%20return;%5Cn%20%20%20%20%20%20%20%20%20%20const%20JSZip%20=%20await%20getJSZip();%5Cn%20%20%20%20%20%20%20%20%20%20const%20zip%20=%20await%20JSZip.loadAsync(file);%5Cn%20%20%20%20%20%20%20%20%20%20const%20entries%20=%20%5B%5D;%5Cn%20%20%20%20%20%20%20%20%20%20await%20Promise.all(Object.values(zip.files).map(async%20z%20=%3E%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20if(z.dir)return;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20entries.push(%7Bname:z.name,blob:await%20z.async(%5C%22blob%5C%22)%7D);%5Cn%20%20%20%20%20%20%20%20%20%20%7D));%5Cn%20%20%20%20%20%20%20%20%20%20const%20infoMap%20=%20Object.create(null);%5Cn%20%20%20%20%20%20%20%20%20%20const%20mediaMap%20=%20Object.create(null);%5Cn%20%20%20%20%20%20%20%20%20%20for(const%20e%20of%20entries)%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20if(e.name.endsWith(%5C%22.info.json%5C%22))%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20const%20m%20=%20/%5Egalleries%5C%5C/(%5B%5E%5C%5C/%5D+)%5C%5C/(%5B%5E%5C%5C/%5D+)%5C%5C.info%5C%5C.json$/.exec(e.name);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20if(!m)continue;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20const%20%5B%20,%20gal,%20id%20%5D%20=%20m;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20infoMap%5Bgal%5D??=%7B%7D;%20infoMap%5Bgal%5D%5Bid%5D=JSON.parse(await%20e.blob.text());%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%7Delse%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20const%20m%20=%20/%5Egalleries%5C%5C/(%5B%5E%5C%5C/%5D+)%5C%5C/(%5B%5E%5C%5C/%5D+)$/.exec(e.name);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20if(!m)%20continue;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20const%20%5B%20,%20gal,%20fn%20%5D%20=%20m;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20const%20id%20=%20fn.replace(/%5C%5C.%5B%5E.%5D+$/,'');%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20mediaMap%5Bgal%5D%20??=%20%7B%7D;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20mediaMap%5Bgal%5D%5Bid%5D%20=%20e.blob;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20for(const%20%5Bgal,objs%5D%20of%20Object.entries(mediaMap))%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20const%20current%20=%20getGalleryNames();%5Cn%20%20%20%20%20%20%20%20%20%20%20%20if(!current.includes(gal))%20saveGalleryNames(%5B...current,gal%5D);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20for(const%20%5Bid,%20blob%5D%20of%20Object.entries(objs))%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20const%20skip%20=%20await%20blobs.get(id);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20if(skip)%20continue;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20const%20inf%20=%20infoMap%5Bgal%5D?.%5Bid%5D%7C%7C%7B%7D;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20let%20b%20=%20blob;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20if(!b.type%20&&%20inf.mime)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20b%20=%20new%20Blob(%5Bawait%20blob.arrayBuffer()%5D,%20%7Btype:inf.mime%7D);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20const%20%7Bw,h%7D=await%20dims(b);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20await%20blobs.set(id,%7Bblob:b,info:cleanInfo(inf.info%7C%7Cnull)%7D);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20await%20kv%5Bpre+gal%5D.set(id,%7Bid,date:inf.meta?.date%7C%7CDate.now(),rating:inf.meta?.rating%7C%7C0,w,h%7D);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%7D%20finally%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20resolve();%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%7D;%5Cn%20%20%20%20%20%20document.body.appendChild(inp);%5Cn%20%20%20%20%20%20inp.click();%5Cn%20%20%20%20%20%20inp.remove();%5Cn%20%20%20%20%7D);%5Cn%20%20%7D%5Cn%5Cn%20%20async%20function%20add(blob,%20opts=%7B%7D)%20%7B%5Cn%20%20%20%20let%20folder%20=%20opts.folder%20??%20activeGalleryName%5Cn%20%20%20%20let%20info%20=%20opts.info%20??%20null;%5Cn%20%20%20%20info%20=%20cleanInfo(info);%5Cn%20%20%20%20const%20id%20=%20Date.now().toString(36)%20+%20Math.random().toString(36).slice(2,%208);%5Cn%20%20%20%20const%20%7Bw,%20h%7D%20=%20await%20dims(blob);%5Cn%20%20%20%20await%20blobs.set(id,%20%7Bblob,%20info%7D);%5Cn%20%20%20%20await%20kv%5Bpre+folder%5D.set(id,%20%7Bid,%20date:Date.now(),%20rating:0,%20w,%20h%7D);%5Cn%20%20%20%20const%20names=getGalleryNames();%5Cn%20%20%20%20if(!names.includes(folder))%20saveGalleryNames(%5B...names,%20folder%5D);%5Cn%20%20%20%20return%20id;%5Cn%20%20%7D%5Cn%5Cn%20%20async%20function%20clearAllData()%7B%5Cn%20%20%20%20if(prompt('Type%20%5C%22yes%5C%22%20to%20permanently%20delete%20ALL%20gallery%20data:')!==%5C%22yes%5C%22)return;%5Cn%20%20%20%20for(const%20n%20of%20getGalleryNames())%20await%20kv%5Bpre+n%5D.clear();%5Cn%20%20%20%20await%20blobs.clear();%5Cn%20%20%20%20saveGalleryNames(%5BdefaultGallery%5D);%5Cn%20%20%20%20activeGalleryName%20=%20defaultGallery;%5Cn%20%20%20%20localStorage.removeItem(pre+%5C%22activeGalleryName%5C%22);%5Cn%20%20%20%20localStorage.removeItem(pre+%5C%22seenPersistenceWarning%5C%22);%5Cn%20%20%7D%5Cn%5Cn%20%20//%20show%20fullscreen%20gallery%5Cn%20%20async%20function%20show()%20%7B%5Cn%20%20%20%20const%20isMobile%20=%20window.matchMedia(%5C%22(pointer:%20coarse)%5C%22).matches%20&&%20window.innerWidth%20%3C%20500;%5Cn%20%20%20%20document.getElementById(%5C%22localMediaGallery_root%5C%22)?.remove();%5Cn%20%20%20%20const%20prevHtmlOv%20=%20document.documentElement.style.overflow;%5Cn%20%20%20%20const%20prevBodyOv%20=%20document.body.style.overflow;%5Cn%20%20%20%20document.documentElement.style.overflow%20=%20document.body.style.overflow%20=%20%5C%22hidden%5C%22;%5Cn%5Cn%20%20%20%20const%20root=$(%5C%22div%5C%22,%7Bid:%5C%22localMediaGallery_root%5C%22,%20style:%5C%22position:fixed;inset:0;display:flex;flex-direction:column;background:light-dark(#fff,#000);z-index:9999;font:14px%20system-ui,sans-serif;%5C%22%7D);%5Cn%20%20%20%20document.body.appendChild(root);%5Cn%5Cn%20%20%20%20//%20close%20gallery%20on%20Esc%20(unless%20a%20lightbox%20is%20up)%5Cn%20%20%20%20const%20closeGallery%20=%20()%20=%3E%20%7B%5Cn%20%20%20%20%20%20document.removeEventListener(%5C%22keydown%5C%22,%20onKeyGallery);%5Cn%20%20%20%20%20%20document.documentElement.style.overflow%20=%20prevHtmlOv;%5Cn%20%20%20%20%20%20document.body.style.overflow%20=%20prevBodyOv;%5Cn%20%20%20%20%20%20root.remove();%5Cn%20%20%20%20%7D;%5Cn%20%20%20%20const%20onKeyGallery%20=%20e%20=%3E%20%7B%5Cn%20%20%20%20%20%20if%20(e.key%20===%20%5C%22Escape%5C%22%20&&%20!document.querySelector(%5C%22%5Bdata-local-media-gallery-lightbox%5D%5C%22))%20closeGallery();%5Cn%20%20%20%20%7D;%5Cn%20%20%20%20document.addEventListener(%5C%22keydown%5C%22,%20onKeyGallery);%5Cn%5Cn%20%20%20%20if(!localStorage%5Bpre+%5C%22seenPersistenceWarning%5C%22%5D)%7B%5Cn%20%20%20%20%20%20root.appendChild(%5Cn%20%20%20%20%20%20%20%20$(%5C%22div%5C%22,%5Cn%20%20%20%20%20%20%20%20%20%20%7Bstyle:%5C%22background:light-dark(rgb(255%20226%20151),rgb(110%2076%200));padding:4px;display:flex;gap:4px;flex-wrap:wrap;justify-content:center;align-items:center;%5C%22%7D,%5Cn%20%20%20%20%20%20%20%20%20%20document.createTextNode(%60This%20gallery%20is%20stored%20privately%20on%20your%20device%20only.%20Your%20browser%20may%20delete%20it%20if%20you%20clear%20your%20cache%20or%20if%20your%20device's%20storage%20is%20low%20-%20%F0%9D%97%AF%F0%9D%97%AE%F0%9D%97%B0%F0%9D%97%B8%F0%9D%98%82%F0%9D%97%BD%20%F0%9D%97%BF%F0%9D%97%B2%F0%9D%97%B4%F0%9D%98%82%F0%9D%97%B9%F0%9D%97%AE%F0%9D%97%BF%F0%9D%97%B9%F0%9D%98%86%20via%20the%20menu!%60),%5Cn%20%20%20%20%20%20%20%20%20%20$(%5C%22button%5C%22,%7BtextContent:%5C%22%E2%9C%85%20Understood%5C%22,%20onclick:e=%3E%7BlocalStorage%5Bpre+%5C%22seenPersistenceWarning%5C%22%5D=1;e.target.parentNode.remove();%7D%7D)%5Cn%20%20%20%20%20%20%20%20)%5Cn%20%20%20%20%20%20);%5Cn%20%20%20%20%7D%5Cn%5Cn%20%20%20%20const%20headerBarEl%20=%20root.appendChild($(%5C%22div%5C%22,%7Bstyle:%5C%22padding:4px;display:flex;flex-wrap:wrap;gap:4px;align-items:center;border-bottom:1px%20solid%20light-dark(#ccc,#333);%5C%22%7D));%5Cn%5Cn%20%20%20%20/*%20menu%20picker%20*/%5Cn%20%20%20%20const%20selMenu%20=%20$(%5C%22select%5C%22,%20%7Bstyle:%5C%22max-width:90px;%5C%22%7D);%5Cn%20%20%20%20const%20menuOpts%20=%20()%20=%3E%20%5B%5Cn%20%20%20%20%20%20%7Bv:%5C%22%5C%22,%20%20%20%20%20%20%20%20%20%20%20t:%5C%22%E2%98%B0%20menu%5C%22%7D,%5Cn%20%20%20%20%20%20%7Bv:%5C%22saveBackup%5C%22,%20t:%5C%22%F0%9F%92%BE%20save%20full%20backup%5C%22%7D,%5Cn%20%20%20%20%20%20%7Bv:%5C%22loadBackup%5C%22,%20t:%5C%22%F0%9F%93%82%20load%20full%20backup%5C%22%7D,%5Cn%20%20%20%20%20%20%7Bv:%5C%22importLocal%5C%22,t:%5C%22%F0%9F%93%A4%20import%20local%20file%5C%22%7D,%5Cn%20%20%20%20%20%20%7Bv:%5C%22importURL%5C%22,%20%20t:%5C%22%F0%9F%8C%90%20import%20from%20URL%5C%22%7D,%5Cn%20%20%20%20%20%20%7Bv:%5C%22toggleBtns%5C%22,%20t:(getComputedStyle(document.documentElement).getPropertyValue(%5C%22--localMediaGalleryBtnsDisplay%5C%22)!==%5C%22none%5C%22?%5C%22%F0%9F%94%98%20hide%20buttons%5C%22:%5C%22%F0%9F%94%98%20show%20buttons%5C%22)%7D,%5Cn%20%20%20%20%20%20%7Bv:%5C%22storageInfo%5C%22,t:%5C%22%F0%9F%92%BD%20storage%20info%5C%22%7D,%5Cn%20%20%20%20%20%20%7Bv:%5C%22%5C%22,t:%5C%22%E2%80%94%5C%22,%20disabled:true%7D,%5Cn%20%20%20%20%20%20%7Bv:%5C%22clearAll%5C%22,%20%20%20t:%5C%22%F0%9F%92%A3%20clear%20ALL%20data%5C%22%7D,%5Cn%20%20%20%20%5D;%5Cn%20%20%20%20const%20refreshMenu=()=%3E%7B%20selMenu.innerHTML=%5C%22%5C%22;%20menuOpts().forEach(o=%3EselMenu.appendChild($(%5C%22option%5C%22,%7Bvalue:o.v,textContent:o.t,%20disabled:!!o.disabled%7D)))%20%7D;%5Cn%20%20%20%20refreshMenu();%5Cn%20%20%20%20headerBarEl.appendChild(selMenu);%5Cn%20%20%20%20%5Cn%20%20%20%20/*%20folder%20picker%20*/%5Cn%20%20%20%20const%20selGallery%20=%20$(%5C%22select%5C%22,%20%7Bstyle:%5C%22max-width:90px;%5C%22%7D);%5Cn%20%20%20%20const%20refreshOpts%20=%20()%20=%3E%20%7B%5Cn%20%20%20%20%20%20selGallery.innerHTML%20=%20%5C%22%5C%22;%5Cn%20%20%20%20%20%20getGalleryNames().forEach(n%20=%3E%20selGallery.appendChild($(%5C%22option%5C%22,%20%7Bvalue:n,%20textContent:n%7D)));%5Cn%20%20%20%20%20%20selGallery.appendChild($(%5C%22option%5C%22,%20%7Bvalue:%5C%22__new__%5C%22,%20textContent:%5C%22%E2%9E%95%20%F0%9D%97%AE%F0%9D%97%B1%F0%9D%97%B1%20%F0%9D%97%BB%F0%9D%97%B2%F0%9D%98%84%20%F0%9D%97%B3%F0%9D%97%BC%F0%9D%97%B9%F0%9D%97%B1%F0%9D%97%B2%F0%9D%97%BF%5C%22%7D));%5Cn%20%20%20%20%20%20selGallery.appendChild($(%5C%22option%5C%22,%20%7Bvalue:%5C%22__del__%5C%22,%20textContent:%5C%22%F0%9F%97%91%EF%B8%8F%20%F0%9D%97%B1%F0%9D%97%B2%F0%9D%97%B9%F0%9D%97%B2%F0%9D%98%81%F0%9D%97%B2%20%F0%9D%97%AE%20%F0%9D%97%B3%F0%9D%97%BC%F0%9D%97%B9%F0%9D%97%B1%F0%9D%97%B2%F0%9D%97%BF%5C%22%7D));%5Cn%20%20%20%20%20%20selGallery.value%20=%20activeGalleryName;%5Cn%20%20%20%20%7D;%5Cn%20%20%20%20refreshOpts();%5Cn%20%20%20%20headerBarEl.appendChild(selGallery);%5Cn%5Cn%20%20%20%20/*%20sort%20picker%20*/%5Cn%20%20%20%20const%20selSort%20=%20$(%5C%22select%5C%22,%20%7B%5Cn%20%20%20%20%20%20innerHTML:%20'%3Coption%20value=%5C%22dateDesc%5C%22%3E%F0%9F%86%95%20newest%3C/option%3E%3Coption%20value=%5C%22dateAsc%5C%22%3E%F0%9F%93%9C%20oldest%3C/option%3E%3Coption%20value=%5C%22ratingDesc%5C%22%3E%E2%AD%90%20best%3C/option%3E%3Coption%20value=%5C%22ratingAsc%5C%22%3E%F0%9F%92%94%20worst%3C/option%3E',%5Cn%20%20%20%20%20%20style:%20%5C%22max-width:90px;%5C%22%5Cn%20%20%20%20%7D);%5Cn%20%20%20%20headerBarEl.appendChild(selSort);%5Cn%5Cn%20%20%20%20/*%20close%20*/%5Cn%20%20%20%20headerBarEl.appendChild($(%5C%22button%5C%22,%7BtextContent:%5C%22%E2%9C%96%EF%B8%8F%5C%22,%20title:%5C%22Esc%5C%22,%20style:%5C%22margin-left:auto;background:none;border:none;font-size:18px;%5C%22,%20onclick:closeGallery%7D));%5Cn%5Cn%20%20%20%20/*%20grid%20*/%5Cn%20%20%20%20const%20grid=root.appendChild($(%5C%22div%5C%22,%7Bstyle:%5C%22flex:1;overflow:auto;display:flex;flex-wrap:wrap;gap:4px;padding:4px;align-content:flex-start;justify-content:center;%5C%22%7D));%5Cn%5Cn%20%20%20%20/*%20lazy%20loader%20*/%5Cn%20%20%20%20let%20io;%5Cn%20%20%20%20const%20observe=()=%3E%7B%5Cn%20%20%20%20%20%20io?.disconnect();%5Cn%20%20%20%20%20%20io=new%20IntersectionObserver(es%20=%3E%20es.forEach(async%20en%20=%3E%20%7B%5Cn%20%20%20%20%20%20%20%20if(en.isIntersecting&&!en.target.dataset.loaded)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20en.target.dataset.loaded%20=%201;%5Cn%20%20%20%20%20%20%20%20%20%20const%20rec%20=%20await%20blobs.get(en.target.dataset.id);%5Cn%20%20%20%20%20%20%20%20%20%20const%20b%20=%20rec?.blob%7C%7Crec;%5Cn%20%20%20%20%20%20%20%20%20%20if(!b)%20return;%5Cn%20%20%20%20%20%20%20%20%20%20if(b.type.startsWith(%5C%22image/%5C%22))%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20en.target.appendChild($(%5C%22img%5C%22,%7Bsrc:URL.createObjectURL(b),style:%5C%22width:100%25;height:100%25;%5C%22,onclick:()=%3Elightbox(en.target.dataset.id)%7D));%5Cn%20%20%20%20%20%20%20%20%20%20%7D%20else%20if(b.type.startsWith(%5C%22video/%5C%22))%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20en.target.appendChild($(%5C%22video%5C%22,%7Bsrc:URL.createObjectURL(b),style:%5C%22width:100%25;height:100%25;%5C%22,muted:true,loop:true,autoplay:true,playsInline:true,onclick:()=%3Elightbox(en.target.dataset.id)%7D));%5Cn%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20en.target.appendChild($(%5C%22div%5C%22,%7Bstyle:%5C%22width:100%25;height:100%25;display:flex;align-items:center;justify-content:center;font-size:32px;background:#222;color:#fff;min-height:150px;%5C%22,onclick:()=%3Elightbox(en.target.dataset.id)%7D,document.createTextNode(%5C%22%F0%9F%8E%B5%5C%22)));%5Cn%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%7D),%20%7Broot:grid,rootMargin:%5C%22300px%5C%22%7D);%5Cn%20%20%20%20%20%20%5B...grid.children%5D.forEach(c=%3Eio.observe(c));%5Cn%20%20%20%20%7D;%5Cn%5Cn%20%20%20%20/*%20lightbox%20*/%5Cn%20%20%20%20const%20lightbox%20=%20id0%20=%3E%20%7B%5Cn%20%20%20%20%20%20let%20idx%20=%20mediaArr.findIndex(m%20=%3E%20m.id===id0);%5Cn%20%20%20%20%20%20const%20ov%20=%20$(%5C%22div%5C%22,%7Bdataset:%7BlocalMediaGalleryLightbox:1%7D,%20style:%5C%22position:fixed;inset:0;background:rgba(0,0,0,.85);display:flex;align-items:center;justify-content:center;z-index:10000;%5C%22,%20onclick:e=%3Ee.target===ov&&close()%7D);%5Cn%20%20%20%20%20%20const%20holder%20=%20$(%5C%22div%5C%22);%5Cn%20%20%20%20%20%20const%20onKey%20=%20e%20=%3E%20%7B%5Cn%20%20%20%20%20%20%20%20if(e.key===%5C%22ArrowLeft%5C%22%20%20&&%20idx%3E0)%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7B%20idx--;%20load();%20%7D%5Cn%20%20%20%20%20%20%20%20else%20if(e.key===%5C%22ArrowRight%5C%22%20&&%20idx%3CmediaArr.length-1)%20%7B%20idx++;%20load();%20%7D%5Cn%20%20%20%20%20%20%20%20else%20if(e.key===%5C%22Escape%5C%22)%20close();%5Cn%20%20%20%20%20%20%7D;%5Cn%20%20%20%20%20%20const%20close%20=%20()=%3E%7B%20document.removeEventListener(%5C%22keydown%5C%22,onKey);%20ov.remove();%20%7D;%5Cn%20%20%20%20%20%20document.addEventListener(%5C%22keydown%5C%22,%20onKey);%5Cn%20%20%20%20%20%20const%20load%20=%20async()%20=%3E%20%7B%5Cn%20%20%20%20%20%20%20%20holder.innerHTML%20=%20%5C%22%5C%22;%5Cn%20%20%20%20%20%20%20%20const%20rec%20=%20await%20blobs.get(mediaArr%5Bidx%5D.id);const%20b=rec?.blob%7C%7Crec;%5Cn%20%20%20%20%20%20%20%20let%20el;%5Cn%20%20%20%20%20%20%20%20if(b.type.startsWith(%5C%22image/%5C%22))%20el%20=%20$(%5C%22img%5C%22,%7Bsrc:URL.createObjectURL(b),style:%5C%22max-width:90vw;max-height:90vh;object-fit:contain;%5C%22%7D);%5Cn%20%20%20%20%20%20%20%20else%20if(b.type.startsWith(%5C%22video/%5C%22))%20el%20=%20$(%5C%22video%5C%22,%7Bsrc:URL.createObjectURL(b),style:%5C%22max-width:90vw;max-height:90vh;object-fit:contain;%5C%22,controls:true,autoplay:true%7D);%5Cn%20%20%20%20%20%20%20%20else%20el%20=%20$(%5C%22audio%5C%22,%20%7Bsrc:URL.createObjectURL(b),controls:true%7D);%5Cn%20%20%20%20%20%20%20%20holder.appendChild(el);%5Cn%20%20%20%20%20%20%20%20btnPrev.style.opacity%20=%20idx===0?.3:1;%5Cn%20%20%20%20%20%20%20%20btnNext.style.opacity%20=%20idx===mediaArr.length-1?.3:1;%5Cn%20%20%20%20%20%20%7D;%5Cn%20%20%20%20%20%20const%20nav=(txt,d,side)%20=%3E%20ov.appendChild($(%5C%22button%5C%22,%7BtextContent:txt,style:%60position:absolute;$%7Bside%7D:10px;top:50%25;transform:translateY(-50%25);font-size:32px;background:none;border:none;color:#fff;%60,onclick:e=%3E%7B%5Cn%20%20%20%20%20%20%20%20e.stopPropagation();%5Cn%20%20%20%20%20%20%20%20if(idx+d%20%3C%200%20%7C%7C%20idx+d%20%3E=%20mediaArr.length)%20return;%5Cn%20%20%20%20%20%20%20%20idx%20+=%20d;%5Cn%20%20%20%20%20%20%20%20load();%5Cn%20%20%20%20%20%20%7D%7D));%5Cn%20%20%20%20%20%20const%20btnPrev=nav(%5C%22%E2%AC%85%EF%B8%8F%5C%22,-1,%5C%22left%5C%22);%5Cn%20%20%20%20%20%20ov.appendChild(holder);%5Cn%20%20%20%20%20%20const%20btnNext=nav(%5C%22%E2%9E%A1%EF%B8%8F%5C%22,1,%5C%22right%5C%22);%5Cn%20%20%20%20%20%20ov.appendChild($(%5C%22button%5C%22,%7BtextContent:%5C%22%E2%9C%96%EF%B8%8F%5C%22,style:%5C%22position:absolute;top:10px;right:10px;font-size:24px;background:none;border:none;color:#fff;%5C%22,onclick:close%7D));%5Cn%20%20%20%20%20%20document.body.appendChild(ov);load();%5Cn%20%20%20%20%7D;%5Cn%5Cn%20%20%20%20/*%20info%20editor%20modal%20*/%5Cn%20%20%20%20async%20function%20openInfoEditor(m)%7B%5Cn%20%20%20%20%20%20const%20rec%20=%20await%20blobs.get(m.id);%5Cn%20%20%20%20%20%20if(!rec)%20return;%5Cn%20%20%20%20%20%20const%20infoOrig%20=%20cleanInfo(rec.info%7C%7C%7B%7D);%5Cn%20%20%20%20%20%20const%20origStr%20=%20JSON.stringify(infoOrig);%5Cn%5Cn%20%20%20%20%20%20const%20overlay=$(%5C%22div%5C%22,%7Bstyle:%5C%22position:fixed;inset:0;background:rgba(0,0,0,.8);display:flex;align-items:center;justify-content:center;z-index:10001;%5C%22%7D);%5Cn%20%20%20%20%20%20const%20modal=$(%5C%22div%5C%22,%7Bstyle:%5C%22position:relative;background:light-dark(#fff,#222);color:light-dark(#000,#fff);padding:8px;border-radius:8px;width:500px;max-width:90vw;max-height:80vh;min-height:100px;display:flex;flex-direction:column;%5C%22%7D);%5Cn%20%20%20%20%20%20const%20list=$(%5C%22div%5C%22,%7Bstyle:%5C%22flex:1;overflow:auto;display:flex;flex-direction:column;gap:8px;justify-content:center;%5C%22%7D);%5Cn%20%20%20%20%20%20modal.appendChild(list);%5Cn%5Cn%20%20%20%20%20%20const%20plusBtn=$(%5C%22button%5C%22,%7BtextContent:%5C%22%E2%9E%95%20add%20entry%5C%22,style:%5C%22align-self:center;%5C%22,onclick:()=%3EaddRow(%5C%22%5C%22,%5C%22%5C%22)%7D);%5Cn%20%20%20%20%20%20list.appendChild(plusBtn);%5Cn%5Cn%20%20%20%20%20%20const%20rows=%5B%5D;%5Cn%20%20%20%20%20%20const%20addRow=(k=%5C%22%5C%22,v=%5C%22%5C%22)=%3E%7B%5Cn%20%20%20%20%20%20%20%20const%20keyInp=$(%5C%22input%5C%22,%7Bvalue:k,style:%5C%22width:100%25;padding:4px;%5C%22,placeholder:%5C%22entry%20name%5C%22%7D);%5Cn%20%20%20%20%20%20%20%20const%20valArea=$(%5C%22textarea%5C%22,%7Bvalue:v,style:%5C%22width:100%25;flex:1;padding:4px;height:60px;resize:vertical;%5C%22,placeholder:%5C%22entry%20content%5C%22%7D);%5Cn%20%20%20%20%20%20%20%20const%20row=$(%5C%22div%5C%22,%7Bstyle:%5C%22display:flex;gap:4px;flex-direction:column;background:light-dark(#dedede,#3a3a3a);padding:0.25rem;border-radius:2px;%5C%22%7D,keyInp,valArea);%5Cn%20%20%20%20%20%20%20%20rows.push(%7BkeyInp,valArea%7D);%5Cn%20%20%20%20%20%20%20%20list.insertBefore(row,plusBtn);%5Cn%20%20%20%20%20%20%7D;%5Cn%20%20%20%20%20%20for(const%20%5Bk,v%5D%20of%20Object.entries(infoOrig))%20addRow(k,v);%5Cn%5Cn%20%20%20%20%20%20const%20titleEl=$(%5C%22div%5C%22,%7BtextContent:%5C%22%E2%84%B9%EF%B8%8F%20file%20info%5C%22,style:%5C%22position:absolute;top:-30px;width:100%25;text-align:center;opacity:0.9;%5C%22%7D);%5Cn%20%20%20%20%20%20modal.appendChild(titleEl);%5Cn%20%20%20%20%20%20const%20saveBtn=$(%5C%22button%5C%22,%7BtextContent:%5C%22%F0%9F%92%BE%20save%5C%22,style:%5C%22position:absolute;bottom:8px;right:8px;%5C%22%7D);%5Cn%20%20%20%20%20%20modal.appendChild(saveBtn);%5Cn%20%20%20%20%20%20const%20closeBtn=$(%5C%22button%5C%22,%7BtextContent:%5C%22%E2%9C%96%EF%B8%8F%5C%22,style:%5C%22position:absolute;top:-10px;right:-14px;background:none;border:none;font-size:18px;%5C%22%7D);%5Cn%20%20%20%20%20%20modal.appendChild(closeBtn);%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20overlay.appendChild(modal);%5Cn%20%20%20%20%20%20document.body.appendChild(overlay);%5Cn%5Cn%20%20%20%20%20%20const%20gather=()=%3E%7B%5Cn%20%20%20%20%20%20%20%20const%20o%20=%20%7B%7D;%5Cn%20%20%20%20%20%20%20%20rows.forEach((%7BkeyInp,valArea%7D)%20=%3E%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20const%20k%20=%20keyInp.value.trim();%5Cn%20%20%20%20%20%20%20%20%20%20if(k)%20o%5Bk%5D%20=%20String(valArea.value);%5Cn%20%20%20%20%20%20%20%20%7D);%5Cn%20%20%20%20%20%20%20%20return%20o;%5Cn%20%20%20%20%20%20%7D;%5Cn%20%20%20%20%20%20const%20maybeClose%20=%20()%20=%3E%20%7B%5Cn%20%20%20%20%20%20%20%20if(JSON.stringify(gather())%20!==%20origStr)%7B%5Cn%20%20%20%20%20%20%20%20%20%20if(!confirm(%5C%22Discard%20unsaved%20changes?%5C%22))%20return%20false;%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20overlay.remove();%5Cn%20%20%20%20%20%20%20%20return%20true;%5Cn%20%20%20%20%20%20%7D;%5Cn%20%20%20%20%20%20overlay.onclick=e=%3E%7Bif(e.target===overlay)maybeClose();%7D;%5Cn%20%20%20%20%20%20closeBtn.onclick=e=%3E%7Be.stopPropagation();maybeClose();%7D;%5Cn%20%20%20%20%20%20saveBtn.onclick=async%20e=%3E%7B%5Cn%20%20%20%20%20%20%20%20let%20keys%20=%20rows.map((%7BkeyInp%7D)%20=%3E%20keyInp.value.trim()).filter(k%20=%3E%20k);%5Cn%20%20%20%20%20%20%20%20if(keys.length%20!==%20new%20Set(keys).size)%20return%20alert(%5C%22Entry%20names%20must%20be%20unique.%5C%22);%5Cn%20%20%20%20%20%20%20%20e.stopPropagation();%5Cn%20%20%20%20%20%20%20%20await%20blobs.set(m.id,%7Bblob:rec.blob%7C%7Crec,info:gather()%7D);%5Cn%20%20%20%20%20%20%20%20overlay.remove();%5Cn%20%20%20%20%20%20%7D;%5Cn%20%20%20%20%7D%5Cn%5Cn%20%20%20%20/*%20item%20controls%20*/%5Cn%20%20%20%20const%20controls%20=%20(m,ph)%20=%3E%20%7B%5Cn%20%20%20%20%20%20const%20bar%20=%20$(%5C%22div%5C%22,%7B%5Cn%20%20%20%20%20%20%20%20dataset:%7BlocalMediaGalleryBar:1%7D,%5Cn%20%20%20%20%20%20%20%20style:%60position:absolute;bottom:4px;left:4px;right:4px;display:var(--localMediaGalleryBtnsDisplay,flex);justify-content:center;gap:16px;$%7BisMobile?%5C%22opacity:.85;%5C%22:%5C%22%5C%22%7D%60%5Cn%20%20%20%20%20%20%7D);%5Cn%20%20%20%20%20%20/*%20delete%20*/%5Cn%20%20%20%20%20%20bar.appendChild($(%5C%22button%5C%22,%7Btitle:%5C%22Delete%20item%5C%22,textContent:%5C%22%F0%9F%97%91%EF%B8%8F%5C%22,onclick:async%20e=%3E%7B%5Cn%20%20%20%20%20%20%20%20e.stopPropagation();%5Cn%20%20%20%20%20%20%20%20if(!confirm(%5C%22Delete%20this%20item?%5C%22))return;%5Cn%20%20%20%20%20%20%20%20await%20blobs.delete(m.id);%5Cn%20%20%20%20%20%20%20%20await%20kv%5Bpre+activeGalleryName%5D.delete(m.id);%5Cn%20%20%20%20%20%20%20%20mediaArr=mediaArr.filter(x%20=%3E%20x.id%20!==%20m.id);%5Cn%20%20%20%20%20%20%20%20ph.remove();%5Cn%20%20%20%20%20%20%7D%7D));%5Cn%20%20%20%20%20%20/*%20move%20*/%5Cn%20%20%20%20%20%20let%20lastMoveFolderName;%5Cn%20%20%20%20%20%20bar.appendChild($(%5C%22button%5C%22,%7Btitle:%5C%22move%20to%20another%20folder%5C%22,textContent:%5C%22%F0%9F%93%81%5C%22,onclick:async%20e=%3E%7B%5Cn%20%20%20%20%20%20%20%20e.stopPropagation();%5Cn%20%20%20%20%20%20%20%20const%20t%20=%20prompt(%5C%22Move%20to%20folder:%5C%22,lastMoveFolderName??activeGalleryName);%5Cn%20%20%20%20%20%20%20%20if(!t%20%7C%7C%20t%20===%20activeGalleryName)return;%5Cn%20%20%20%20%20%20%20%20lastMoveFolderName%20=%20t;%5Cn%20%20%20%20%20%20%20%20await%20kv%5Bpre+t%5D.set(m.id,%20m);%5Cn%20%20%20%20%20%20%20%20await%20kv%5Bpre+activeGalleryName%5D.delete(m.id);%5Cn%20%20%20%20%20%20%20%20saveGalleryNames(%5B...getGalleryNames(),%20t%5D);%5Cn%20%20%20%20%20%20%20%20refreshOpts();%5Cn%20%20%20%20%20%20%20%20loadGallery();%5Cn%20%20%20%20%20%20%7D%7D));%5Cn%20%20%20%20%20%20/*%20rate%20*/%5Cn%20%20%20%20%20%20bar.appendChild($(%5C%22button%5C%22,%7Btitle:%5C%22rate%20item%5C%22,textContent:%5C%22%E2%AD%90%5C%22,onclick:async%20e=%3E%7B%5Cn%20%20%20%20%20%20%20%20e.stopPropagation();%5Cn%20%20%20%20%20%20%20%20const%20v%20=%20prompt(%5C%22You%20can%20add%20a%20numeric%20rating/score%20for%20sorting:%5C%22,%20m.rating);%5Cn%20%20%20%20%20%20%20%20if(v==null)%20return;%5Cn%20%20%20%20%20%20%20%20m.rating%20=%20Number(v);%5Cn%20%20%20%20%20%20%20%20if(isNaN(m.rating))%20m.rating%20=%200;%5Cn%20%20%20%20%20%20%20%20await%20kv%5Bpre+activeGalleryName%5D.set(m.id,%20m);%5Cn%20%20%20%20%20%20%20%20render();%5Cn%20%20%20%20%20%20%7D%7D));%5Cn%20%20%20%20%20%20/*%20download%20*/%5Cn%20%20%20%20%20%20bar.appendChild($(%5C%22button%5C%22,%7Btitle:%5C%22download%20item%5C%22,%20textContent:%5C%22%F0%9F%93%A5%5C%22,onclick:async%20e%20=%3E%20%7B%5Cn%20%20%20%20%20%20%20%20e.stopPropagation();%5Cn%20%20%20%20%20%20%20%20const%20rec%20=%20await%20blobs.get(m.id);%5Cn%20%20%20%20%20%20%20%20const%20b%20=%20rec?.blob%20%7C%7C%20rec;%5Cn%20%20%20%20%20%20%20%20const%20a%20=%20$(%5C%22a%5C%22,%20%7Bhref:URL.createObjectURL(b),%20download:%60$%7Bm.id%7D.$%7B(b.type.split(%5C%22/%5C%22)%5B1%5D%7C%7C%5C%22bin%5C%22)%7D%60%7D);%5Cn%20%20%20%20%20%20%20%20a.click();%5Cn%20%20%20%20%20%20%20%20URL.revokeObjectURL(a.href);%5Cn%20%20%20%20%20%20%7D%7D));%5Cn%20%20%20%20%20%20/*%20info%20editor%20*/%5Cn%20%20%20%20%20%20bar.appendChild($(%5C%22button%5C%22,%7Btitle:%5C%22edit%20info%5C%22,textContent:%5C%22%E2%84%B9%EF%B8%8F%5C%22,onclick:async%20e=%3E%7B%5Cn%20%20%20%20%20%20%20%20e.stopPropagation();%5Cn%20%20%20%20%20%20%20%20openInfoEditor(m);%5Cn%20%20%20%20%20%20%7D%7D));%5Cn%20%20%20%20%20%20return%20bar;%5Cn%20%20%20%20%7D;%5Cn%5Cn%20%20%20%20const%20sortFn=()=%3E%7B%5Cn%20%20%20%20%20%20switch(selSort.value)%7B%5Cn%20%20%20%20%20%20%20%20case%5C%22dateAsc%5C%22:%20%20%20%20return%20(a,b)%20=%3E%20a.date-b.date;%5Cn%20%20%20%20%20%20%20%20case%5C%22ratingDesc%5C%22:%20return%20(a,b)%20=%3E%20b.rating-a.rating;%5Cn%20%20%20%20%20%20%20%20case%5C%22ratingAsc%5C%22:%20%20return%20(a,b)%20=%3E%20a.rating-b.rating;%5Cn%20%20%20%20%20%20%20%20default:%20%20%20%20%20%20%20%20%20%20return%20(a,b)%20=%3E%20b.date-a.date;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%7D;%5Cn%5Cn%20%20%20%20/*%20render%20*/%5Cn%20%20%20%20let%20mediaArr=%5B%5D;%5Cn%20%20%20%20const%20rowH=300;%5Cn%20%20%20%20const%20render%20=%20()%20=%3E%20%7B%5Cn%20%20%20%20%20%20grid.innerHTML%20=%20%5C%22%5C%22;%5Cn%20%20%20%20%20%20const%20h%20=%20rowH;%5Cn%20%20%20%20%20%20mediaArr.sort(sortFn()).forEach(m%20=%3E%20%7B%5Cn%20%20%20%20%20%20%20%20let%20w=m.w?(m.w/m.h)*h:h;%5Cn%20%20%20%20%20%20%20%20if(isMobile)%20w=Math.min(w,window.innerWidth-12);%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20/*%20%E2%86%90%20mobile%20clamp%20*/%5Cn%20%20%20%20%20%20%20%20const%20ph=$(%5C%22div%5C%22,%20%7Bdataset:%7Bid:m.id,%20localMediaGalleryItem:1%7D,%20style:%60flex:0%200%20$%7Bw%7Dpx;max-height:$%7Bh%7Dpx;background:light-dark(#ddd,#444);position:relative;max-width:100%25;%60%7D);%5Cn%20%20%20%20%20%20%20%20ph.appendChild(controls(m,%20ph));%5Cn%20%20%20%20%20%20%20%20grid.appendChild(ph);%5Cn%20%20%20%20%20%20%7D);%5Cn%20%20%20%20%20%20observe();%5Cn%20%20%20%20%7D;%5Cn%5Cn%20%20%20%20/*%20load%20gallery%20*/%5Cn%20%20%20%20const%20loadGallery%20=%20async()=%3E%7B%20mediaArr=await%20kv%5Bpre+activeGalleryName%5D.values();%20render();%20%7D;%5Cn%20%20%20%20loadGallery();%5Cn%5Cn%20%20%20%20/*%20events%20*/%5Cn%20%20%20%20selGallery.onchange=async()=%3E%7B%5Cn%20%20%20%20%20%20if(selGallery.value%20===%20%5C%22__new__%5C%22)%20%7B%5Cn%20%20%20%20%20%20%20%20const%20n=prompt(%5C%22Gallery%20name:%5C%22);%5Cn%20%20%20%20%20%20%20%20if(!n)%7B%20selGallery.value=activeGalleryName;%20return;%20%7D%5Cn%20%20%20%20%20%20%20%20saveGalleryNames(%20%5B...getGalleryNames(),n%5D%20);%5Cn%20%20%20%20%20%20%20%20activeGalleryName=n;%5Cn%20%20%20%20%20%20%20%20localStorage%5Bpre+%5C%22activeGalleryName%5C%22%5D=n;%5Cn%20%20%20%20%20%20%20%20refreshOpts();%5Cn%20%20%20%20%20%20%20%20selGallery.value=n;%5Cn%20%20%20%20%20%20%7D%20else%20if(selGallery.value%20===%20%5C%22__del__%5C%22)%20%7B%5Cn%20%20%20%20%20%20%20%20const%20n=prompt(%5C%22Type%20the%20exact%20gallery%20name%20to%20delete:%5C%22);%5Cn%20%20%20%20%20%20%20%20if(!n%7C%7Cn===defaultGallery%7C%7C!getGalleryNames().includes(n))%20%7B%20selGallery.value=activeGalleryName;%20return;%20%7D%5Cn%20%20%20%20%20%20%20%20if(!confirm(%60Delete%20gallery%20%5C%22$%7Bn%7D%5C%22?%20This%20cannot%20be%20undone.%60))%20%7B%20selGallery.value=activeGalleryName;%20return;%20%7D%5Cn%20%20%20%20%20%20%20%20await%20kv%5Bpre+n%5D.clear();%5Cn%20%20%20%20%20%20%20%20saveGalleryNames(%20getGalleryNames().filter(x=%3Ex!==n)%20);%5Cn%20%20%20%20%20%20%20%20if(activeGalleryName===n)%7B%20activeGalleryName=defaultGallery;%20localStorage%5Bpre+%5C%22activeGalleryName%5C%22%5D=activeGalleryName;%20%7D%5Cn%20%20%20%20%20%20%20%20refreshOpts();%5Cn%20%20%20%20%20%20%20%20selGallery.value%20=%20activeGalleryName;%5Cn%20%20%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20%20%20activeGalleryName%20=%20selGallery.value;%5Cn%20%20%20%20%20%20%20%20localStorage%5Bpre+%5C%22activeGalleryName%5C%22%5D%20=%20activeGalleryName;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20loadGallery();%5Cn%20%20%20%20%7D;%5Cn%20%20%20%20selSort.onchange=render;%5Cn%20%20%20%20%5Cn%20%20%20%20selMenu.onchange=async()=%3E%7B%5Cn%20%20%20%20%20%20if(selMenu.value===%5C%22saveBackup%5C%22)%7B%20await%20saveBackup();%20%7D%5Cn%20%20%20%20%20%20else%20if(selMenu.value===%5C%22loadBackup%5C%22)%7B%20await%20loadBackup();%20refreshOpts();%20await%20loadGallery();%20%7D%5Cn%20%20%20%20%20%20else%20if(selMenu.value===%5C%22importLocal%5C%22)%7B%5Cn%20%20%20%20%20%20%20%20const%20inp=$(%5C%22input%5C%22,%7Btype:%5C%22file%5C%22,multiple:true,style:%5C%22display:none%5C%22%7D);%5Cn%20%20%20%20%20%20%20%20inp.onchange=async()=%3E%7B%5Cn%20%20%20%20%20%20%20%20%20%20for(const%20f%20of%20inp.files)%20await%20add(f);%5Cn%20%20%20%20%20%20%20%20%20%20await%20loadGallery();%5Cn%20%20%20%20%20%20%20%20%7D;%5Cn%20%20%20%20%20%20%20%20document.body.appendChild(inp);inp.click();inp.remove();%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20else%20if(selMenu.value===%5C%22importURL%5C%22)%7B%5Cn%20%20%20%20%20%20%20%20const%20u=prompt(%5C%22Enter%20a%20URL%20to%20import:%5C%22);%5Cn%20%20%20%20%20%20%20%20if(u)%7B%5Cn%20%20%20%20%20%20%20%20%20%20try%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20const%20resp=await%20superFetch(u);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20if(!resp.ok)%20throw%20new%20Error(%60HTTP%20$%7Bresp.status%7D%60);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20const%20b=await%20resp.blob();%5Cn%20%20%20%20%20%20%20%20%20%20%20%20await%20add(b);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20await%20loadGallery();%5Cn%20%20%20%20%20%20%20%20%20%20%7Dcatch(e)%7B%20alert(%5C%22Failed%20to%20import:%20%5C%22+e.message);%20%7D%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20else%20if(selMenu.value===%5C%22toggleBtns%5C%22)%7B%5Cn%20%20%20%20%20%20%20%20const%20cur=getComputedStyle(document.documentElement).getPropertyValue(%5C%22--localMediaGalleryBtnsDisplay%5C%22).trim();%5Cn%20%20%20%20%20%20%20%20document.documentElement.style.setProperty(%5C%22--localMediaGalleryBtnsDisplay%5C%22,cur===%5C%22none%5C%22?%5C%22flex%5C%22:%5C%22none%5C%22);%5Cn%20%20%20%20%20%20%20%20refreshMenu();render();%5Cn%20%20%20%20%20%20%7Delse%20if(selMenu.value===%5C%22storageInfo%5C%22)%7B%5Cn%20%20%20%20%20%20%20%20const%20%7Busage,quota%7D=await%20navigator.storage.estimate();%5Cn%20%20%20%20%20%20%20%20const%20persisted=await%20navigator.storage.persisted();%5Cn%20%20%20%20%20%20%20%20alert(%60You're%20using%20$%7B(usage/1024**3).toFixed(1)%7D%20out%20of%20$%7B(quota/1024**3).toFixed(1)%7D%20GB.%5C%5Cn%5C%5CnYour%20browser%20has%20indicated%20that%20this%20storage%20is%20$%7Bpersisted?%60%F0%9D%97%BD%F0%9D%97%B2%F0%9D%97%BF%F0%9D%97%BA%F0%9D%97%AE%F0%9D%97%BB%F0%9D%97%B2%F0%9D%97%BB%F0%9D%98%81,%20but%20you%20should%20still%20backup%20regularly%60:%5C%22%F0%9D%98%81%F0%9D%97%B2%F0%9D%97%BA%F0%9D%97%BD%F0%9D%97%BC%F0%9D%97%BF%F0%9D%97%AE%F0%9D%97%BF%F0%9D%98%86,%20possibly%20because%20you%20haven't%20used%20this%20site%20often,%20or%20you're%20in%20incognito%20mode,%20or%20you're%20low%20on%20device%20storage%20space.%5C%22%7D.%60);%5Cn%20%20%20%20%20%20%7D%20else%20if(selMenu.value===%5C%22clearAll%5C%22)%7B%5Cn%20%20%20%20%20%20%20%20await%20clearAllData();%5Cn%20%20%20%20%20%20%20%20refreshOpts();%5Cn%20%20%20%20%20%20%20%20loadGallery();%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20selMenu.value=%5C%22%5C%22;%5Cn%20%20%20%20%7D;%5Cn%20%20%7D%5Cn%5Cn%20%20return%20%7Badd,show,getActiveFolderName:()=%3EactiveGalleryName,clearAllData%7D;%5Cn%22,%22imports%22:%5B%22kv-plugin%22,%22super-fetch-plugin%22%5D,%22lastEditTime%22:1748539140486,%22found%22:true%7D,%7B%22name%22:%22fullscreen-button-plugin%22,%22modelText%22:%22(text,%20exitText,%20style)%20=%3E%20%5Cn%20%20if(!window.addedFullscreenEventListenerForPlugin39492749374)%20%7B%5Cn%20%20%20%20window.addEventListener(%5C%22fullscreenchange%5C%22,%20function(event)%20%7B%5Cn%20%20%20%20%20%20if(document.fullscreenElement)%20%7B%5Cn%20%20%20%20%20%20%20%20for(let%20btn%20of%20%5B...document.querySelectorAll(%5C%22.fullscreenButtonPluginButton938479832938%5C%22)%5D)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20btn.innerHTML%20=%20btn.dataset.exitText;%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20%20%20for(let%20btn%20of%20%5B...document.querySelectorAll(%5C%22.fullscreenButtonPluginButton938479832938%5C%22)%5D)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20btn.innerHTML%20=%20btn.dataset.text;%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%7D);%5Cn%20%20%20%20window.addedFullscreenEventListenerForPlugin39492749374%20=%20true;%5Cn%20%20%7D%5Cn%20%20if(!document.documentElement.requestFullscreen)%20document.documentElement.requestFullscreen%20=%20document.documentElement.webkitRequestFullscreen%20%7C%7C%20document.documentElement.mozRequestFullScreen%20%7C%7C%20document.documentElement.msRequestFullscreen;%5Cn%20%20if(!document.exitFullscreen)%20document.exitFullscreen%20=%20document.webkitExitFullscreen%20%7C%7C%20document.mozCancelFullScreen%20%7C%7C%20document.msExitFullscreen;%5Cn%20%20if(!document.documentElement.requestFullscreen)%20%7B%5Cn%20%20%20%20document.documentElement.requestFullscreen%20=%20function()%20%7B%5Cn%20%20%20%20%20%20alert(%5C%22The%20browser/device%20you're%20using%20doesn't%20support%20fullscreen%20mode.%5C%22);%5Cn%20%20%20%20%7D;%5Cn%20%20%7D%5Cn%20%20if(!document.exitFullscreen)%20%7B%5Cn%20%20%20%20document.exitFullscreen%20=%20function()%20%7B%5Cn%20%20%20%20%20%20alert(%5C%22The%20browser/device%20you're%20using%20doesn't%20support%20fullscreen%20mode.%5C%22);%5Cn%20%20%20%20%7D;%5Cn%20%20%7D%5Cn%20%20return%20%60%3Cbutton%20class=%5C%22fullscreenButtonPluginButton938479832938%5C%22%20data-text=%5C%22$%7Btext%20%7C%7C%20%5C%22Fullscreen%5C%22%7D%5C%22%20data-exit-text=%5C%22$%7BexitText%20%7C%7C%20%5C%22Exit%20Fullscreen%5C%22%7D%5C%22%20onclick=%5C%22(!document.fullscreenElement%20&&%20!document.webkitFullscreenElement%20&&%20!document.mozFullScreenElement%20&&%20!document.msFullscreenElement)%20?%20(document.documentElement.requestFullscreen(),%20this.innerHTML=this.dataset.exitText)%20:%20(document.exitFullscreen(),%20this.innerHTML=this.dataset.text)%5C%22%20style=%5C%22line-height:1.2rem;%20$%7Bstyle%20%7C%7C%20%5C%22%5C%22%7D%5C%22%3E$%7Btext%20%7C%7C%20%5C%22Fullscreen%5C%22%7D%3C/button%3E%60;%5Cn%5Ct%22,%22imports%22:%5B%5D,%22lastEditTime%22:1699845831991,%22found%22:true%7D,%7B%22name%22:%22prompt2-plugin%22,%22modelText%22:%22async%20(specs,%20opts)%20=%3E%5Cn%20%20if(!opts)%20opts%20=%20%7B%7D;%5Cn%20%20opts%20=%20JSON.parse(JSON.stringify(opts));%20//%20so%20we%20can%20edit%20below%20without%20mutating%20inputs.%5Cn%20%20%5Cn%20%20let%20specEntries%20=%20Object.entries(specs);%5Cn%20%20specEntries%20=%20specEntries.filter(e%20=%3E%20e%5B1%5D);%5Cn%20%20specs%20=%20Object.fromEntries(specEntries);%20//%20so%20'null'%20can%20be%20specified%20as%20a%20value%20in%20the%20specs%20object,%20which%20means%20it%20gets%20entirely%20skipped%5Cn%20%20%5Cn%20%20let%20colorScheme%20=%20opts.colorScheme;%5Cn%20%20if(!colorScheme)%20colorScheme%20=%20localStorage.forceColorScheme%20!==%20undefined%20?%20localStorage.forceColorScheme%20:%20window.matchMedia%20&&%20window.matchMedia('(prefers-color-scheme:%20dark)').matches%20?%20%5C%22dark%5C%22%20:%20%5C%22light%5C%22;%5Cn%5Cn%20%20if(!opts.backgroundColor)%20opts.backgroundColor%20=%20colorScheme==%5C%22light%5C%22%20?%20%5C%22#e8e8e8%5C%22%20:%20%5C%22#151515%5C%22;%5Cn%20%20if(!opts.borderColor)%20opts.borderColor%20=%20colorScheme==%5C%22light%5C%22%20?%20%5C%22#c8c8c8%5C%22%20:%20%5C%22#333%5C%22;%5Cn%20%20if(!opts.borderRadius)%20opts.borderRadius%20=%20%5C%223px%5C%22;%5Cn%20%20%5Cn%20%20function%20sanitizeHtml(text)%20%7B%5Cn%20%20%20%20if(text%20===%20undefined)%20text%20=%20%5C%22%5C%22;%5Cn%20%20%20%20text%20=%20text+%5C%22%5C%22;%5Cn%20%20%20%20return%20text.replace(/&/g,%20%5C%22&amp;%5C%22).replace(/%3C/g,%20%5C%22&lt;%5C%22).replace(/%3E/g,%20%5C%22&gt;%5C%22).replace(/%5C%22/g,%20%5C%22&quot;%5C%22).replace(/'/g,%20%5C%22&#039;%5C%22);%5Cn%20%20%7D%5Cn%5Cn%20%20let%20ctn%20=%20document.createElement(%5C%22div%5C%22);%5Cn%20%20let%20sections%20=%20%5C%22%5C%22;%5Cn%20%20let%20structuredSectionsI%20=%200;%5Cn%20%20let%20i%20=%200;%5Cn%20%20for(let%20%5Bkey,%20spec%5D%20of%20Object.entries(specs))%20%7B%5Cn%20%20%20%20if(spec.type%20==%20%5C%22select%5C%22)%20%7B%5Cn%20%20%20%20%20%20sections%20+=%20%60%5Cn%20%20%20%20%20%20%20%20%3Csection%20class=%5C%22structuredInputSection%5C%22%20data-is-hidden-extra=%5C%22$%7Bspec.hidden%20===%20true%20?%20%5C%22yes%5C%22%20:%20%5C%22no%5C%22%7D%5C%22%20style=%5C%22$%7Bspec.hidden%20===%20true%20?%20%5C%22display:none%5C%22%20:%20%5C%22%5C%22%7D;%5C%22%3E%5Cn%20%20%20%20%20%20%20%20%20%20%3Cdiv%20class=%5C%22sectionLabel%5C%22%20style=%5C%22$%7BstructuredSectionsI%20===%200%20?%20%5C%22margin-top:0;%5C%22%20:%20%5C%22%5C%22%7D%5C%22%3E$%7Bspec.label%7D$%7Bspec.infoTooltip%20?%20%60%20%3Cspan%20title=%5C%22$%7BsanitizeHtml(spec.infoTooltip)%7D%5C%22%20style=%5C%22cursor:pointer;%5C%22%20onclick=%5C%22alert(this.title)%5C%22%3E%E2%84%B9%EF%B8%8F%3C/span%3E%60%20:%20%5C%22%5C%22%7D%3C/div%3E%5Cn%20%20%20%20%20%20%20%20%20%20%3Cdiv%20style=%5C%22display:flex;%5C%22%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20style=%5C%22flex-grow:1;%5C%22%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cselect%20data-spec-key=%5C%22$%7BsanitizeHtml(key)%7D%5C%22%20value=%5C%22$%7BsanitizeHtml(spec.defaultValue)%7D%5C%22%20$%7Bspec.disabled%20===%20true%20?%20%5C%22disabled%5C%22%20:%20%5C%22%5C%22%7D%20style=%5C%22width:100%25;height:100%25;%20padding:0.25rem;%5C%22%3E$%7Bspec.options.map(o%20=%3E%20%60%3Coption%20value=%5C%22$%7BsanitizeHtml(o.value)%7D%5C%22%20$%7Bo.value%20===%20spec.defaultValue%20?%20%5C%22selected%5C%22%20:%5C%22%5C%22%7D%3E$%7BsanitizeHtml(o.content)%20%7C%7C%20sanitizeHtml(o.value)%7D%3C/option%3E%60).join(%5C%22%5C%22)%7D%3C/select%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%3C/div%3E%5Cn%20%20%20%20%20%20%20%20%20%20%3C/div%3E%5Cn%20%20%20%20%20%20%20%20%3C/section%3E%60;%5Cn%20%20%20%20%20%20structuredSectionsI++;%5Cn%20%20%20%20%7D%20else%20if(spec.type%20==%20%5C%22textLine%5C%22)%20%7B%5Cn%20%20%20%20%20%20sections%20+=%20%60%5Cn%20%20%20%20%20%20%20%20%3Csection%20class=%5C%22structuredInputSection%5C%22%20data-is-hidden-extra=%5C%22$%7Bspec.hidden%20===%20true%20?%20%5C%22yes%5C%22%20:%20%5C%22no%5C%22%7D%5C%22%20style=%5C%22$%7Bspec.hidden%20===%20true%20?%20%5C%22display:none%5C%22%20:%20%5C%22%5C%22%7D;%5C%22%3E%5Cn%20%20%20%20%20%20%20%20%20%20%3Cdiv%20class=%5C%22sectionLabel%5C%22%20style=%5C%22$%7BstructuredSectionsI%20===%200%20?%20%5C%22margin-top:0;%5C%22%20:%20%5C%22%5C%22%7D%5C%22%3E$%7Bspec.label%7D$%7Bspec.infoTooltip%20?%20%60%20%3Cspan%20title=%5C%22$%7BsanitizeHtml(spec.infoTooltip)%7D%5C%22%20style=%5C%22cursor:pointer;%5C%22%20onclick=%5C%22alert(this.title)%5C%22%3E%E2%84%B9%EF%B8%8F%3C/span%3E%60%20:%20%5C%22%5C%22%7D%3C/div%3E%5Cn%20%20%20%20%20%20%20%20%20%20%3Cdiv%20style=%5C%22display:flex;%5C%22%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20style=%5C%22flex-grow:1;%5C%22%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cinput%20data-initial-focus=%5C%22$%7Bspec.focus%20===%20true%20?%20%5C%22yes%5C%22%20:%20%5C%22no%5C%22%7D%5C%22%20data-spec-key=%5C%22$%7BsanitizeHtml(key)%7D%5C%22%20$%7Bspec.disabled%20===%20true%20?%20%5C%22disabled%5C%22%20:%20%5C%22%5C%22%7D%20value=%5C%22$%7BsanitizeHtml(spec.defaultValue)%7D%5C%22%20style=%5C%22width:100%25;height:100%25;%20padding:%200.25rem;%20$%7Bspec.cssText%20%7C%7C%20%5C%22%5C%22%7D;%5C%22%20type=%5C%22text%5C%22%20placeholder=%5C%22$%7BsanitizeHtml(spec.placeholder)%7D%5C%22%20$%7Bspec.validationPattern%20?%20%60pattern=%5C%22$%7BsanitizeHtml(spec.validationPattern)%7D%5C%22%60%20:%20%5C%22%5C%22%7D%20$%7Bspec.disableSpellCheck%20?%20%60spellcheck=%5C%22false%5C%22%60%20:%20%60%60%7D%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%3C/div%3E%5Cn%20%20%20%20%20%20%20%20%20%20%3C/div%3E%5Cn%20%20%20%20%20%20%20%20%3C/section%3E%60;%5Cn%20%20%20%20%20%20structuredSectionsI++;%5Cn%20%20%20%20%7D%20else%20if(spec.type%20==%20%5C%22text%5C%22)%20%7B%5Cn%20%20%20%20%20%20sections%20+=%20%60%5Cn%20%20%20%20%20%20%20%20%3Csection%20class=%5C%22structuredInputSection%5C%22%20data-is-hidden-extra=%5C%22$%7Bspec.hidden%20===%20true%20?%20%5C%22yes%5C%22%20:%20%5C%22no%5C%22%7D%5C%22%20style=%5C%22$%7Bspec.hidden%20===%20true%20?%20%5C%22display:none%5C%22%20:%20%5C%22%5C%22%7D;%5C%22%3E%5Cn%20%20%20%20%20%20%20%20%20%20%3Cdiv%20class=%5C%22sectionLabel%5C%22%20style=%5C%22$%7BstructuredSectionsI%20===%200%20?%20%5C%22margin-top:0;%5C%22%20:%20%5C%22%5C%22%7D%5C%22%3E$%7Bspec.label%7D$%7Bspec.infoTooltip%20?%20%60%20%3Cspan%20title=%5C%22$%7BsanitizeHtml(spec.infoTooltip)%7D%5C%22%20style=%5C%22cursor:pointer;%5C%22%20onclick=%5C%22alert(this.title)%5C%22%3E%E2%84%B9%EF%B8%8F%3C/span%3E%60%20:%20%5C%22%5C%22%7D%3C/div%3E%5Cn%20%20%20%20%20%20%20%20%20%20%3Cdiv%20style=%5C%22display:flex;%5C%22%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20style=%5C%22flex-grow:1;%5C%22%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Ctextarea%20data-initial-focus=%5C%22$%7Bspec.focus%20===%20true%20?%20%5C%22yes%5C%22%20:%20%5C%22no%5C%22%7D%5C%22%20data-spec-key=%5C%22$%7BsanitizeHtml(key)%7D%5C%22%20$%7Bspec.height%20===%20%5C%22fit-content%5C%22%20?%20%60data-height=%5C%22fit-content%5C%22%60%20:%20%60%60%7D%20$%7Bspec.disabled%20===%20true%20?%20%5C%22disabled%5C%22%20:%20%5C%22%5C%22%7D%20style=%5C%22width:100%25;%20$%7Bspec.height%20===%20%5C%22fit-content%5C%22%20?%20%5C%22%5C%22%20:%20%60height:$%7BsanitizeHtml(spec.height)%7D%60%7D;%20min-height:$%7Bspec.minHeight%20??%20%5C%224rem%5C%22%7D;%20max-height:$%7Bspec.maxHeight%20??%20%5C%2250vh%5C%22%7D;%20padding:0.25rem;%20$%7Bspec.cssText%20%7C%7C%20%5C%22%5C%22%7D;%5C%22%20type=%5C%22text%5C%22%20placeholder=%5C%22$%7BsanitizeHtml(spec.placeholder)%7D%5C%22%20$%7Bspec.disableSpellCheck%20?%20%60spellcheck=%5C%22false%5C%22%60%20:%20%60%60%7D%3E$%7BsanitizeHtml(spec.defaultValue)%7D%3C/textarea%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%3C/div%3E%5Cn%20%20%20%20%20%20%20%20%20%20%3C/div%3E%5Cn%20%20%20%20%20%20%20%20%3C/section%3E%60;%5Cn%20%20%20%20%20%20structuredSectionsI++;%5Cn%20%20%20%20%7D%20else%20if(spec.type%20==%20%5C%22buttons%5C%22)%20%7B%5Cn%20%20%20%20%20%20sections%20+=%20%60%5Cn%20%20%20%20%20%20%20%20%3Csection%20data-spec-key=%5C%22$%7BsanitizeHtml(key)%7D%5C%22%20class=%5C%22structuredInputSection%5C%22%20data-is-hidden-extra=%5C%22$%7Bspec.hidden%20===%20true%20?%20%5C%22yes%5C%22%20:%20%5C%22no%5C%22%7D%5C%22%20style=%5C%22$%7Bspec.hidden%20===%20true%20?%20%5C%22display:none%5C%22%20:%20%5C%22%5C%22%7D;%5C%22%3E%5Cn%20%20%20%20%20%20%20%20%20%20%3Cdiv%20class=%5C%22sectionLabel%5C%22%20style=%5C%22$%7BstructuredSectionsI%20===%200%20?%20%5C%22margin-top:0;%5C%22%20:%20%5C%22%5C%22%7D%5C%22%3E$%7Bspec.label%20??%20%5C%22%5C%22%7D$%7Bspec.infoTooltip%20?%20%60%20%3Cspan%20title=%5C%22$%7BsanitizeHtml(spec.infoTooltip)%7D%5C%22%20style=%5C%22cursor:pointer;%5C%22%20onclick=%5C%22alert(this.title)%5C%22%3E%E2%84%B9%EF%B8%8F%3C/span%3E%60%20:%20%5C%22%5C%22%7D%3C/div%3E%5Cn%20%20%20%20%20%20%20%20%20%20%3Cdiv%20style=%5C%22display:flex;%5C%22%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20style=%5C%22flex-grow:1;%20display:%20grid;%20grid-template-columns:%20repeat(auto-fit,%20minmax(90px,%20200px));%20gap:%201rem;%20justify-content:center;%5C%22%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20$%7Bspec.buttons.map(b%20=%3E%20%60%3Cbutton%20$%7Bb.disabled%20===%20true%20?%20%5C%22disabled%5C%22%20:%20%5C%22%5C%22%7D%20style=%5C%22width:max-content;%20justify-self:center;%20align-self:center;%20border:%201px%20solid%20lightgrey;%20border-radius:%203px;%20padding:0.25rem;%20$%7Bb.cssText%20%7C%7C%20%5C%22%5C%22%7D;%5C%22%3E$%7Bb.text%7D%3C/button%3E%60).join(%5C%22%20%5C%22)%7D%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%3C/div%3E%5Cn%20%20%20%20%20%20%20%20%20%20%3C/div%3E%5Cn%20%20%20%20%20%20%20%20%3C/section%3E%60;%5Cn%20%20%20%20%20%20structuredSectionsI++;%5Cn%20%20%20%20%7D%20else%20if(spec.type%20==%20%5C%22none%5C%22)%20%7B%5Cn%20%20%20%20%20%20sections%20+=%20%60%5Cn%20%20%20%20%20%20%20%20%3Csection%20data-spec-key=%5C%22$%7BsanitizeHtml(key)%7D%5C%22%20data-is-hidden-extra=%5C%22$%7Bspec.hidden%20===%20true%20?%20%5C%22yes%5C%22%20:%20%5C%22no%5C%22%7D%5C%22%20data-requires-element-insert=%5C%22$%7Btypeof%20spec.html%20===%20%5C%22string%5C%22%20?%20%5C%22no%5C%22%20:%20%5C%22yes%5C%22%7D%5C%22%20style=%5C%22$%7Bspec.hidden%20===%20true%20?%20%5C%22display:none%5C%22%20:%20%5C%22%5C%22%7D;%5C%22%3E%5Cn%20%20%20%20%20%20%20%20%20%20$%7Btypeof%20spec.html%20===%20%5C%22string%5C%22%20?%20spec.html%20:%20%5C%22%5C%22%7D%5Cn%20%20%20%20%20%20%20%20%3C/section%3E%60;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20i++;%5Cn%20%20%7D%5Cn%20%20ctn.innerHTML%20=%20%60%5Cn%20%20%20%20%3Cdiv%20class=%5C%22promptModalInnerContainer%5C%22%20style=%5C%22background:rgba(0,0,0,0.7);%20position:fixed;%20top:0;%20left:0;%20right:0;%20bottom:0;%20z-index:9999999;%20display:flex;%20justify-content:center;%20$%7Bopts.verticallyCenter%20?%20%5C%22align-items:center;%5C%22%20:%20%5C%22%5C%22%7D%20color:inherit;%20color-scheme:$%7BcolorScheme%7D;%20$%7BcolorScheme===%5C%22light%5C%22%20?%20%5C%22color:black%5C%22%20:%20%5C%22color:#e7e7e7%5C%22%7D;%20font:inherit;%20padding:0.5rem;%20text-align:left;%5C%22%3E%5Cn%20%20%20%20%20%20%3Cdiv%20style=%5C%22width:600px;%20max-width:100%25;%20background:$%7BsanitizeHtml(opts.backgroundColor)%7D;%20height:%20min-content;%20padding:1rem;%20border:1px%20solid%20$%7Bopts.borderColor%7D;%20border-radius:$%7Bopts.borderRadius%7D;%20box-shadow:%200px%201px%2010px%203px%20rgb(130%20130%20130%20/%2024%25);%20max-height:%20calc(100%25%20-%201rem);display:%20flex;%20flex-direction:%20column;%5C%22%3E%5Cn%20%20%20%20%20%20%20%20%3Cdiv%20class=%5C%22sectionsContainer%5C%22%20style=%5C%22overflow:auto;%5C%22%3E%5Cn%20%20%20%20%20%20%20%20%20%20$%7Bsections%7D%5Cn%20%20%20%20%20%20%20%20%20%20$%7BObject.values(specs).find(s%20=%3E%20s.hidden%20===%20true)%20?%20%60%5Cn%20%20%20%20%20%20%20%20%20%20%3Cdiv%20style=%5C%22text-align:center;%20margin-top:1rem;%20display:flex;%20justify-content:center;%5C%22%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%3Cbutton%20class=%5C%22showHidden%5C%22%20style=%5C%22padding:%200.25rem;%5C%22%3E$%7Bopts.showHiddenInputsText%20%7C%7C%20%5C%22Show%20hidden%20inputs%5C%22%7D%3C/button%3E%5Cn%20%20%20%20%20%20%20%20%20%20%3C/div%3E%5Cn%20%20%20%20%20%20%20%20%20%20%60%20:%20%5C%22%5C%22%7D%5Cn%20%20%20%20%20%20%20%20%3C/div%3E%5Cn%20%20%20%20%20%20%20%20%3Cdiv%20style=%5C%22text-align:center;%20margin-top:1rem;%20$%7Bopts.cancelButtonText%20===%20null%20?%20%5C%22%5C%22%20:%20%60display:flex;%20justify-content:space-between;%60%7D%5C%22%3E%5Cn%20%20%20%20%20%20%20%20%20%20$%7Bopts.cancelButtonText%20===%20null%20?%20%5C%22%5C%22%20:%20%60%3Cbutton%20class=%5C%22cancel%5C%22%20style=%5C%22padding:%200.25rem;%5C%22%3E$%7Bopts.cancelButtonText%20??%20%5C%22cancel%5C%22%7D%3C/button%3E%60%7D%5Cn%20%20%20%20%20%20%20%20%20%20%3Cbutton%20class=%5C%22submit%5C%22%20style=%5C%22padding:%200.25rem;%20$%7Bopts.submitButtonCssText%20%7C%7C%20''%7D;%5C%22%3E$%7Bopts.submitButtonText%20%7C%7C%20%5C%22submit%5C%22%7D%3C/button%3E%5Cn%20%20%20%20%20%20%20%20%3C/div%3E%5Cn%20%20%20%20%20%20%3C/div%3E%5Cn%20%20%20%20%20%20%3Cstyle%3E%5Cn%20%20%20%20%20%20%20%20.promptModalInnerContainer%20.sectionsContainer%20%3E%20section%20.sectionLabel%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20margin:0.125rem%200;%5Cn%20%20%20%20%20%20%20%20%20%20margin-top:%201rem;%5Cn%20%20%20%20%20%20%20%20%20%20font-size:85%25;%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20.promptModalInnerContainer%20.sectionsContainer%20input:invalid%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20background-color:%20lightpink;%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20.promptModalInnerContainer%20.sectionsContainer%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20-ms-overflow-style:%20none;%20%20/*%20Internet%20Explorer%2010+%20*/%5Cn%20%20%20%20%20%20%20%20%20%20scrollbar-width:%20none;%20%20/*%20Firefox%20*/%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20.promptModalInnerContainer%20.sectionsContainer::-webkit-scrollbar%20%7B%20%5Cn%20%20%20%20%20%20%20%20%20%20display:%20none;%20%20/*%20Safari%20and%20Chrome%20*/%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20.promptModalInnerContainer%20.sectionsContainer.scrollFade%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20padding-bottom:%2030px;%5Cn%20%20%20%20%20%20%20%20%20%20-webkit-mask-image:%20linear-gradient(to%20bottom,%20black%20calc(100%25%20-%2030px),%20#ffffff00%20100%25);%5Cn%20%20%20%20%20%20%20%20%20%20mask-image:%20linear-gradient(to%20bottom,%20black%20calc(100%25%20-%2030px),%20#ffffff00%20100%25);%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20.promptModalInnerContainer%20*%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20box-sizing:%20border-box;%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%3C/style%3E%5Cn%20%20%20%20%3C/div%3E%5Cn%20%20%60;%5Cn%20%20document.body.appendChild(ctn);%5Cn%20%20%5Cn%20%20function%20updateFitHeights()%20%7B%20//%20settimeout%20to%20ensure%20rendered%5Cn%20%20%20%20ctn.querySelectorAll(%5C%22textarea%5Bdata-height=fit-content%5D%5C%22).forEach(el%20=%3E%20%7B%5Cn%20%20%20%20%20%20let%20minHeight%20=%20el.offsetHeight;%20//%20textareas%20will%20always%20have%20min-height%20set,%20so%20we%20can%20use%20that%20via%20offsetHeight%5Cn%20%20%20%20%20%20el.style.height%20=%20Math.max(minHeight,%20(el.scrollHeight+10))%20+%20%5C%22px%5C%22;%5Cn%20%20%20%20%7D);%5Cn%20%20%7D%5Cn%5Cn%20%20setTimeout(updateFitHeights,%205);%5Cn%5Cn%20%20if(ctn.querySelector(%5C%22button.showHidden%5C%22))%20%7B%5Cn%20%20%20%20ctn.querySelector(%5C%22button.showHidden%5C%22).onclick%20=%20()%20=%3E%20%7B%5Cn%20%20%20%20%20%20ctn.querySelectorAll('.sectionsContainer%20%5Bdata-is-hidden-extra=yes%5D').forEach(el%20=%3E%20%7B%5Cn%20%20%20%20%20%20%20%20el.style.display='';%5Cn%20%20%20%20%20%20%20%20el.dataset.isHiddenExtra%20=%20%5C%22no%5C%22;%5Cn%20%20%20%20%20%20%7D);%5Cn%20%20%20%20%20%20ctn.querySelector(%5C%22button.showHidden%5C%22).remove();%5Cn%20%20%20%20%20%20updateFitHeights();%5Cn%20%20%20%20%20%20updateInputVisibilies();%5Cn%20%20%20%20%7D;%5Cn%20%20%7D%5Cn%5Cn%20%20//%20insert%20non-string%20HTML%20elements%20for%20type==html%20specs%5Cn%20%20let%20elementObjects%20=%20Object.values(specs).filter(s%20=%3E%20s.html%20&&%20typeof%20s.html%20!==%20%5C%22string%5C%22).map(s%20=%3E%20s.html);%5Cn%20%20ctn.querySelectorAll('.sectionsContainer%20%5Bdata-requires-element-insert=yes%5D').forEach((el,%20i)%20=%3E%20%7B%5Cn%20%20%20%20el.append(elementObjects%5Bi%5D);%5Cn%20%20%7D);%5Cn%5Cn%20%20//%20add%20onclick%20handlers%20for%20type==button%20specs%5Cn%20%20let%20buttonSpecKeys%20=%20Object.entries(specs).filter((%5Bkey,%20spec%5D)%20=%3E%20spec.type%20===%20%5C%22buttons%5C%22).map((%5Bkey,%20spec%5D)%20=%3E%20key);%5Cn%20%20for(let%20key%20of%20buttonSpecKeys)%20%7B%5Cn%20%20%20%20ctn.querySelectorAll(%60.sectionsContainer%20%5Bdata-spec-key=$%7Bkey%7D%5D%60).forEach(el%20=%3E%20%7B%5Cn%20%20%20%20%20%20let%20buttonEls%20=%20%5B...el.querySelectorAll(%5C%22button%5C%22)%5D;%5Cn%20%20%20%20%20%20for(let%20i%20=%200;%20i%20%3C%20buttonEls.length;%20i++)%20%7B%5Cn%20%20%20%20%20%20%20%20buttonEls%5Bi%5D.onclick%20=%20specs%5Bkey%5D.buttons%5Bi%5D.onClick;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%7D);%5Cn%20%20%7D%5Cn%5Cn%20%20setTimeout(()%20=%3E%20%7B%5Cn%20%20%20%20//%20add%20scrollFade%20if%20sectionsContainer%20has%20scroll%5Cn%20%20%20%20let%20sectionsContainerEl%20=%20ctn.querySelector(%5C%22.promptModalInnerContainer%20.sectionsContainer%5C%22);%5Cn%20%20%20%20if(sectionsContainerEl.scrollHeight%20%3E%20sectionsContainerEl.offsetHeight)%20%7B%5Cn%20%20%20%20%20%20sectionsContainerEl.classList.add(%5C%22scrollFade%5C%22);%5Cn%20%20%20%20%7D%5Cn%20%20%20%20//%20focus%5Cn%20%20%20%20let%20focusEl%20=%20ctn.querySelector(%5C%22.promptModalInnerContainer%20.sectionsContainer%20%5Bdata-initial-focus=yes%5D%5C%22);%5Cn%20%20%20%20if(!focusEl)%20focusEl%20=%20%5B...ctn.querySelectorAll(%5C%22.promptModalInnerContainer%20input,%20.promptModalInnerContainer%20textarea%5C%22)%5D%5B0%5D;%5Cn%20%20%20%20if(focusEl)%20%7B%5Cn%20%20%20%20%20%20focusEl.focus();%5Cn%20%20%20%20%20%20focusEl.selectionStart%20=%20focusEl.value.length;%5Cn%20%20%20%20%7D%5Cn%20%20%7D,%205);%5Cn%20%20%5Cn%20%20function%20getAllValues()%20%7B%5Cn%20%20%20%20let%20values%20=%20%7B%7D;%5Cn%20%20%20%20for(let%20el%20of%20%5B...ctn.querySelectorAll(%5C%22%5Bdata-spec-key%5D%5C%22)%5D)%20%7B%5Cn%20%20%20%20%20%20if(el.tagName%20===%20%5C%22INPUT%5C%22)%20%7B%5Cn%20%20%20%20%20%20%20%20if(el.type%20==%20%5C%22file%5C%22)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20values%5Bel.dataset.specKey%5D%20=%20el.files;%5Cn%20%20%20%20%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20values%5Bel.dataset.specKey%5D%20=%20el.value;%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%7D%20else%20if(el.tagName%20===%20%5C%22TEXTAREA%5C%22)%20%7B%5Cn%20%20%20%20%20%20%20%20values%5Bel.dataset.specKey%5D%20=%20el.value;%5Cn%20%20%20%20%20%20%7D%20else%20if(el.tagName%20===%20%5C%22SELECT%5C%22)%20%7B%5Cn%20%20%20%20%20%20%20%20values%5Bel.dataset.specKey%5D%20=%20el.value;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%7D%5Cn%20%20%20%20return%20values;%5Cn%20%20%7D%5Cn%5Cn%20%20//%20a%20spec%20can%20have%20a%20%60show%60%20function%20which%20determines%20whether%20it's%20shown%20based%20on%20the%20values%20of%20the%20other%20inputs%5Cn%20%20function%20updateInputVisibilies()%20%7B%5Cn%20%20%20%20const%20values%20=%20getAllValues();%5Cn%20%20%20%20for(const%20el%20of%20%5B...ctn.querySelectorAll(%5C%22%5Bdata-spec-key%5D%5C%22)%5D)%20%7B%5Cn%20%20%20%20%20%20const%20showFn%20=%20specs%5Bel.dataset.specKey%5D.show;%5Cn%20%20%20%20%20%20if(!showFn)%20continue;%5Cn%20%20%20%20%20%20if(showFn(values))%20%7B%5Cn%20%20%20%20%20%20%20%20el.closest('section').style.display%20=%20%5C%22%5C%22;%5Cn%20%20%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20%20%20el.closest('section').style.display%20=%20%5C%22none%5C%22;%5Cn%20%20%20%20%20%20%7D%5Cn%5Cn%20%20%20%20%20%20//%20the%20%5C%22show%20advanced%5C%22%20hidden-ness%20overrides%20the%20show()%20function%5Cn%20%20%20%20%20%20if(el.closest(%5C%22section%5C%22).dataset.isHiddenExtra%20===%20%5C%22yes%5C%22)%20%7B%5Cn%20%20%20%20%20%20%20%20el.closest(%5C%22section%5C%22).style.display%20=%20%5C%22none%5C%22;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%7D%5Cn%20%20%7D%5Cn%20%20updateInputVisibilies();%5Cn%20%20for(const%20el%20of%20%5B...ctn.querySelectorAll(%5C%22%5Bdata-spec-key%5D%5C%22)%5D)%20%7B%5Cn%20%20%20%20el.addEventListener(%5C%22input%5C%22,%20updateInputVisibilies);%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20//%20add%20onChange%20handlers,%20if%20any:%5Cn%20%20try%20%7B%5Cn%20%20%20%20for(let%20%5Bkey,%20value%5D%20of%20Object.entries(specs))%20%7B%5Cn%20%20%20%20%20%20if(value.type%20===%20%5C%22select%5C%22%20&&%20typeof%20value.onChange%20===%20%5C%22function%5C%22)%20%7B%5Cn%20%20%20%20%20%20%20%20ctn.querySelector(%60.sectionsContainer%20%5Bdata-spec-key=$%7Bkey%7D%5D%60).addEventListener(%5C%22change%5C%22,%20function()%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20let%20data%20=%20getAllValues();%5Cn%20%20%20%20%20%20%20%20%20%20let%20originalData%20=%20JSON.parse(JSON.stringify(data));%5Cn%20%20%20%20%20%20%20%20%20%20value.onChange(data);%20//%20if%20this%20handler%20edits%20the%20data,%20then%20we%20propagate%20those%20edits%20to%20the%20actual%20inputs%5Cn%20%20%20%20%20%20%20%20%20%20let%20thereWereDataChanges%20=%20false;%5Cn%20%20%20%20%20%20%20%20%20%20for(let%20k%20in%20originalData)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20if(data%5Bk%5D%20!==%20originalData%5Bk%5D)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20todo:%20propagate%20change%20events?%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20ctn.querySelector(%60.sectionsContainer%20%5Bdata-spec-key=$%7Bk%7D%5D%60).value%20=%20data%5Bk%5D;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20thereWereDataChanges%20=%20true;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20if(thereWereDataChanges)%20updateInputVisibilies();%5Cn%20%20%20%20%20%20%20%20%7D);%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%7D%5Cn%20%20%7D%20catch(e)%20%7B%20console.error(e);%20%7D%20//%20try/catch%20because%20it's%20new%20code%5Cn%5Cn%20%20let%20promptResolver;%5Cn%5Cn%20%20if(opts.controls)%20%7B%5Cn%20%20%20%20//%20add%20a%20proxy%20to%20the%20controls%20object%20so%20that%20we%20can%20read%20and%20write%20spec%20values%20from%20the%20outside%5Cn%20%20%20%20opts.controls.data%20=%20new%20Proxy(%7B%7D,%20%7B%5Cn%20%20%20%20%20%20set:%20function(obj,%20prop,%20value)%20%7B%5Cn%20%20%20%20%20%20%20%20let%20el%20=%20ctn.querySelector(%60%5Bdata-spec-key=$%7Bprop%7D%5D%60);%5Cn%20%20%20%20%20%20%20%20if(!el)%20return%20true;%5Cn%20%20%20%20%20%20%20%20el.value%20=%20value;%5Cn%20%20%20%20%20%20%20%20updateInputVisibilies();%5Cn%20%20%20%20%20%20%20%20return%20true;%5Cn%20%20%20%20%20%20%7D,%5Cn%20%20%20%20%20%20get:%20function(obj,%20prop)%20%7B%5Cn%20%20%20%20%20%20%20%20let%20el%20=%20ctn.querySelector(%60%5Bdata-spec-key=$%7Bprop%7D%5D%60);%5Cn%20%20%20%20%20%20%20%20if(!el)%20return%20undefined;%5Cn%20%20%20%20%20%20%20%20return%20el.value;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%7D);%5Cn%20%20%20%20opts.controls.submit%20=%20function()%20%7B%5Cn%20%20%20%20%20%20ctn.querySelector(%5C%22button.submit%5C%22).click();%5Cn%20%20%20%20%7D;%5Cn%20%20%20%20opts.controls.cancel%20=%20function()%20%7B%5Cn%20%20%20%20%20%20promptResolver(null);%5Cn%20%20%20%20%7D;%5Cn%20%20%7D%5Cn%5Cn%20%20let%20values%20=%20await%20new%20Promise((resolve)%20=%3E%20%7B%5Cn%20%20%20%20promptResolver%20=%20resolve;%5Cn%20%20%20%20ctn.querySelector(%5C%22button.submit%5C%22).onclick%20=%20()%20=%3E%20%7B%5Cn%20%20%20%20%20%20let%20values%20=%20getAllValues();%5Cn%20%20%20%20%20%20resolve(values);%5Cn%20%20%20%20%7D;%5Cn%20%20%20%20if(ctn.querySelector(%5C%22button.cancel%5C%22))%20%7B%5Cn%20%20%20%20%20%20ctn.querySelector(%5C%22button.cancel%5C%22).onclick%20=%20()%20=%3E%20%7B%5Cn%20%20%20%20%20%20%20%20resolve(null);%5Cn%20%20%20%20%20%20%7D;%5Cn%20%20%20%20%7D%5Cn%20%20%7D);%5Cn%20%20ctn.remove();%5Cn%20%20return%20values;%22,%22imports%22:%5B%5D,%22lastEditTime%22:1729755725684,%22found%22:true%7D,%7B%22name%22:%22select-leaf-plugin%22,%22modelText%22:%22//%20This%20is%20the%20JavaScript%20function%20that%20powers%20this%20plugin:%5Cn%20(list)%20=%3E%5Cn%20%20if(!list)%20return%20%5C%22(no%20list%20given%20to%20selectLeaf%20plugin)%5C%22;%5Cn%5Ctlet%20leaf%20=%20list;%5Cn%5Ctlet%20i%20=%200;%5Cn%5Ctlet%20result;%5Cn%5Ctwhile(1)%20%7B%5Cn%5Ct%5Cti++;%5Cn%5Ct%5Ctif(i%20%3E%2010000)%20%7B%5Cn%20%20%20%20%20%20return%20%5C%22(error%20in%20select-leaf-plugin:%20infinite%20loop%20encountered?)%5C%22;%5Cn%20%20%20%20%7D%5Cn%5Ct%5Ctresult%20=%20leaf.selectOne;%5Cn%5Ct%5Ctif(typeof%20result%20===%20%5C%22string%5C%22%20%7C%7C%20Object.keys(result).length%20===%200)%20%7B%20//%20typeof%20result%20===%20%5C%22string%5C%22%20is%20for%20case%20where%20input%20list%20was%20actually%20just%20a%20'property'%20like%20foo=%7Ba%7Cb%7Cc%7D%5Cn%5Ct%5Ct%5Ct//if(!result)%20debugger;%5Cn%5Ct%5Ct%5Ctreturn%20result;%5Cn%5Ct%5Ct%7D%5Cn%5Ct%5Ctleaf%20=%20result;%5Cn%5Ct%7D%5Cn%5Ct%5Cn//%20You%20can%20learn%20JavaScript%20here:%5Cn//%20https://www.codecademy.com/learn/javascript%22,%22imports%22:%5B%5D,%22lastEditTime%22:1691554935487,%22found%22:true%7D,%7B%22name%22:%22tabbed-comments-plugin-v1%22,%22modelText%22:%22commentsPlugin%20=%20%7Bimport:comments-plugin%7D%5CngenerateText%20=%20%7Bimport:ai-text-plugin%7D%5CndefaultCustomEmojis%20=%20%7Bimport:huge-emoji-list%7D%5Cn%5Cn//%20See%20exampleOptions%20below%20for%20an%20example%20of%20these%20options:%5Cn//%20%20%20channels:%20(A%20list%20of%20channel%20names,%20optionally%20with%20the%20comment%20options%20under%20each%20channel%20name)%5Cn//%20%20%20allowBots:%20true/false%20(Default%20is%20true,%20except%20on%20default%20channel%20and%20'general'%20channel.%20You%20can%20also%20disable/enable%20bots%20on%20a%20per-channel%20basis%20by%20setting%20allowBots%20to%20true/false%20under%20the%20channel%20name.)%5Cn//%20%20%20defaultCommentsOptions:%20(See%20perchance.org/comments-plugin%20for%20all%20options)%5Cn//%20%20%20fillHeight:%20true/value%20(By%20default%20its%20height%20is%20based%20on%20the%20screen%20height.%20set%20this%20option%20to%20true%20to%20make%20it%20expand%20to%20full%20height%20of%20its%20container)%5Cn%5CnexampleOptions%5Cn%20%20defaultCommentsOptions%20//%20see%20perchance.org/comments-plugin%20for%20all%20available%20options%5Cn%20%20%20%20adminFlair%20=%20%F0%9F%92%8EOWNER%F0%9F%92%8E%20//%20this%20option%20will%20get%20applied%20to%20*all*%20channels%20below.%5Cn%20%20channels%20%5Cn%20%20%20%20general%5Cn%20%20%20%20%20%20label%20=%20General%5Cn%20%20%20%20chat1%20//%20i've%20set%20messageBubbleStyle%20here%20to%20give%20an%20example%20showing%20that%20each%20channel%20can%20have%20any%20of%20the%20channel%20options%20that%20are%20explained%20in%20perchance.org/comments-plugin%5Cn%20%20%20%20%20%20label%20=%20Room%201%5Cn%20%20%20%20%20%20messageBubbleStyle%20=%20background:pink;%20border:2px%20dotted%20red;%20color:black;%5Cn%20%20%20%20chat2%5Cn%20%20%20%20%20%20label%20=%20Room%202%5Cn%20%20%20%20%20%20allowBots%20=%20false%20//%20disallows%20'speak%20via%20character'%20for%20this%20channel%5Cn%20%20%20%20test3%5Cn%20%20%20%20test4%5Cn%5Cn%5Cn%5Cn%5Cn%5Cn%5Cn%5Cn%5CntabbedCommentsPlugin%20=%20%5B%5D%5Cn%5Cn(opts)%20=%3E%5Cn%20%20let%20commentsChannels%20=%20opts.channels;%5Cn%20%20let%20defaultChannelOptions%20=%20opts.defaultChannelOptions%20%7C%7C%20%7B%7D;%5Cn%20%20let%20outerCtn%20=%20document.createElement(%5C%22div%5C%22);%5Cn%20%20%5Cn%20%20let%20globalFnsId%20=%20%5C%22a%5C%22+Math.random().toString(16).slice(2);%5Cn%20%20%5Cn%20%20let%20minHeight%20=%20defaultChannelOptions.height;%5Cn%20%20if(!minHeight)%20minHeight%20=%20300;%5Cn%20%20if(typeof%20minHeight%20===%20%5C%22number%5C%22)%20minHeight%20+=%20%5C%22px%5C%22;%5Cn%20%20%5Cn%20%20%5Cn%20%20outerCtn.className%20=%20%5C%22tabbed-comments-plugin-outer-ctn%5C%22;%5Cn%20%20outerCtn.style.cssText%20=%20%60text-align:center;%20$%7Bopts.fillHeight%20?%20%5C%22height:100%25;%5C%22%20:%20%5C%22%5C%22%7D;%20container-type:inline-size;%60;%5Cn%20%20outerCtn.innerHTML%20=%20%60%3Cdiv%20style=%5C%22display:flex;%20justify-content:center;%20align-items:center;%20$%7Bopts.fillHeight%20?%20%5C%22height:100%25;%5C%22%20:%20%5C%22%5C%22%7D%5C%22%3E%5Cn%20%20%20%20%3Cdiv%20class=%5C%22tabbed-comments-ctn-left%20tabbed-comments-plugin-ctn%5C%22%20style=%5C%22height:min(70vh,%20600px);%20min-height:$%7BminHeight%7D;%20justify-content:center;%20align-items:center;%20flex-grow:1;%20min-width:%200;%20$%7Bopts.fillHeight%20?%20%5C%22height:100%25;max-height:100%25;min-height:100%25;%5C%22%20:%20%5C%22%5C%22%7D%5C%22%3E%3C/div%3E%5Cn%20%20%20%20%3Cdiv%20class=%5C%22tabbed-comments-ctn-middle%20tabbed-comments-plugin-ctn%5C%22%20style=%5C%22height:min(70vh,%20600px);%20min-height:$%7BminHeight%7D;%20width:100%25;%20max-width:min(800px,%20100vw);%20flex-grow:%201;%20min-width:%200;%20$%7Bopts.fillHeight%20?%20%5C%22height:100%25;max-height:100%25;min-height:100%25;%5C%22%20:%20%5C%22%5C%22%7D%5C%22%3E%3C/div%3E%5Cn%20%20%20%20%3Cdiv%20class=%5C%22tabbed-comments-ctn-right%20tabbed-comments-plugin-ctn%5C%22%20style=%5C%22height:min(70vh,%20600px);%20min-height:$%7BminHeight%7D;%20justify-content:center;%20align-items:center;%20flex-grow:1;%20min-width:%200;%20$%7Bopts.fillHeight%20?%20%5C%22height:100%25;max-height:100%25;min-height:100%25;%5C%22%20:%20%5C%22%5C%22%7D%5C%22%3E%3C/div%3E%5Cn%20%20%3C/div%3E%5Cn%20%20%3Cbutton%20onclick=%5C%22this.closest('.tabbed-comments-plugin-outer-ctn').querySelector('.tabbed-comments-auto-comment-ctn').style.display='flex';%20this.style.display='none';%5C%22%20class=%5C%22tabbed-comments-show-auto-comment-area-btn%5C%22%20style=%5C%22font-size:80%25;%20margin-top:0.75rem;%5C%22%3E%F0%9F%A7%9D%20speak%20via%20character%3C/button%3E%5Cn%20%20%3Cdiv%20class=%5C%22tabbed-comments-auto-comment-ctn%5C%22%20style=%5C%22display:none;%20flex-direction:column;%20border:1px%20solid%20grey;%20border-radius:2px;%20width:400px;%20max-width:98%25;%20margin:0%20auto;%20margin-top:1.5rem;%5C%22%3E%5Cn%20%20%20%20%3Cdiv%20style=%5C%22display:%20flex;%20align-items:%20center;%20justify-content:%20center;%20padding:0.25rem;%20width:100%25;%5C%22%3E%5Cn%20%20%20%20%20%20%3Cdiv%20style=%5C%22%20display:%20flex;%20align-items:%20center;%20justify-content:%20center;%20flex-direction:%20column;%20gap:0.25rem;%20width:100%25;%5C%22%3E%5Cn%20%20%20%20%20%20%20%20%3Cdiv%20style=%5C%22display:flex;%20gap:0.25rem;%20width:100%25;%5C%22%3E%5Cn%20%20%20%20%20%20%20%20%20%20%3Cbutton%20class=%5C%22tabbed-comments-auto-comment-char-btn%5C%22%20onclick=%5C%22window.__$%7BglobalFnsId%7D_tabbedCommentsPluginAutoComment(%7Bname:this.closest('.tabbed-comments-plugin-outer-ctn').querySelector('.tabbed-comments-auto-comment-char-name').value,%20description:this.closest('.tabbed-comments-plugin-outer-ctn').querySelector('.tabbed-comments-auto-comment-char-description').value%7D)%5C%22%20style=%5C%22flex-grow:1;%20min-width:max-content;%5C%22%3E%F0%9F%A7%9D%20write%20as%20character%3C/button%3E%5Cn%20%20%20%20%20%20%20%20%20%20%3Cselect%20class=%5C%22tabbed-comments-auto-comment-char-select%5C%22%20onchange=%5C%22window.__$%7BglobalFnsId%7D_tabbedCommentsPluginSwitchToAutoCommentCharByIndex(this.value)%5C%22%20style=%5C%22max-width:90px;%5C%22%3E%3C/select%3E%5Cn%20%20%20%20%20%20%20%20%3C/div%3E%5Cn%20%20%20%20%20%20%20%20%3Cinput%20class=%5C%22tabbed-comments-auto-comment-char-name%5C%22%20oninput=%5C%22window.__$%7BglobalFnsId%7D_tabbedCommentsPluginSaveAutoCommentCharInfo()%5C%22%20placeholder=%5C%22Character%20name...%5C%22%20style=%5C%22width:100%25;%5C%22%3E%5Cn%20%20%20%20%20%20%20%20%3Ctextarea%20class=%5C%22tabbed-comments-auto-comment-char-description%5C%22%20oninput=%5C%22window.__$%7BglobalFnsId%7D_tabbedCommentsPluginSaveAutoCommentCharInfo()%5C%22%20placeholder=%5C%22Character%20description...%5C%22%20style=%5C%22width:100%25;%20height:100px;%20z-index:5;%5C%22%3E%3C/textarea%3E%5Cn%20%20%20%20%20%20%3C/div%3E%5Cn%20%20%20%20%3C/div%3E%5Cn%20%20%20%20%3Cdiv%20style=%5C%22display:flex;%20justify-content:center;%20align-items:center;%20border-top:1px%20solid%20grey;%20padding:0.25rem;%5C%22%3E%5Cn%20%20%20%20%20%20%3Cinput%20class=%5C%22tabbed-comments-auto-comment-auto-send-checkbox%5C%22%20onchange=%5C%22localStorage.__tabbedCommentsAutoCommentAutoSendCheckboxValue=this.checked?'1':'';%20%5C%22%20style=%5C%22cursor:pointer;%5C%22%20type=%5C%22checkbox%5C%22%3E%5Cn%20%20%20%20%20%20%3Cdiv%20onclick=%5C%22this.closest('.tabbed-comments-plugin-outer-ctn').querySelector('.tabbed-comments-auto-comment-auto-send-checkbox').click()%5C%22%20style=%5C%22margin-left:0.25rem;%20cursor:pointer;%20user-select:none;%5C%22%3Eauto-send?%3C/div%3E%5Cn%20%20%20%20%3C/div%3E%5Cn%20%20%3C/div%3E%60;%5Cn%20%20%5Cn%20%20let%20rightCtn%20=%20outerCtn.querySelector('.tabbed-comments-ctn-right');%5Cn%20%20let%20middleCtn%20=%20outerCtn.querySelector('.tabbed-comments-ctn-middle');%5Cn%20%20let%20leftCtn%20=%20outerCtn.querySelector('.tabbed-comments-ctn-left');%5Cn%20%20%5Cn%20%20let%20showAutoCommentAreaBtn%20=%20outerCtn.querySelector('.tabbed-comments-show-auto-comment-area-btn');%5Cn%20%20let%20autoCommentCtn%20=%20outerCtn.querySelector('.tabbed-comments-auto-comment-ctn');%5Cn%20%20let%20autoCommentCharBtn%20=%20outerCtn.querySelector('.tabbed-comments-auto-comment-char-btn');%5Cn%20%20let%20autoCommentCharSelectEl%20=%20outerCtn.querySelector('.tabbed-comments-auto-comment-char-select');%5Cn%20%20let%20autoCommentCharNameEl%20=%20outerCtn.querySelector('.tabbed-comments-auto-comment-char-name');%5Cn%20%20let%20autoCommentCharNameDescriptionEl%20=%20outerCtn.querySelector('.tabbed-comments-auto-comment-char-description');%5Cn%20%20let%20autoCommentAutoSendCheckboxEl%20=%20outerCtn.querySelector('.tabbed-comments-auto-comment-auto-send-checkbox');%5Cn%20%20%5Cn%20%20let%20middleCtnCurrentlyShownCommentsChannelName;%5Cn%20%20%5Cn%20%20let%20sidePanelObjs%20=%20new%20Set();%5Cn%20%20let%20middlePanelObj;%5Cn%20%20let%20middleCtnChannelNameToObj%20=%20%7B%7D;%5Cn%20%20%5Cn%20%20function%20updateColorScheme()%20%7B%5Cn%20%20%20%20let%20systemColorScheme%20=%20window.matchMedia%20&&%20window.matchMedia('(prefers-color-scheme:%20dark)').matches%20?%20%5C%22dark%5C%22%20:%20%5C%22light%5C%22;%5Cn%20%20%20%20if(localStorage.forceColorScheme%20===%20%5C%22dark%5C%22%20%7C%7C%20(!localStorage.forceColorScheme%20&&%20systemColorScheme%20===%20%5C%22dark%5C%22))%20%7B%5Cn%20%20%20%20%20%20outerCtn.style.setProperty('--tabbed-comments-plugin-text-color',%20'#efefef');%5Cn%20%20%20%20%20%20outerCtn.style.setProperty('--tabbed-comments-plugin-box-color',%20'#2a2a2a');%5Cn%20%20%20%20%20%20outerCtn.style.setProperty('--tabbed-comments-plugin-active-comment-channel-tab-color',%20'#3f3f3f');%5Cn%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20outerCtn.style.setProperty('--tabbed-comments-plugin-text-color',%20'#222');%5Cn%20%20%20%20%20%20outerCtn.style.setProperty('--tabbed-comments-plugin-box-color',%20'#ebebeb');%5Cn%20%20%20%20%20%20outerCtn.style.setProperty('--tabbed-comments-plugin-active-comment-channel-tab-color',%20'#c6c6c6');%5Cn%20%20%20%20%7D%5Cn%20%20%20%20outerCtn.querySelectorAll(%5C%22%5Bdata-tabbed-comments-direct-parent-of-comments-plugin-putput='1'%5D%5C%22).forEach(el%20=%3E%20%7B%5Cn%20%20%20%20%20%20let%20commentOptions%20=%20el.__commentOptionsUsed;%5Cn%20%20%20%20%20%20commentOptions.forceColorScheme%20=%20defaultChannelOptions.forceColorScheme%20??%20localStorage.forceColorScheme%20??%20null%5Cn%20%20%20%20%20%20el.innerHTML%20=%20commentsPlugin(commentOptions);%5Cn%20%20%20%20%7D);%5Cn%20%20%7D%5Cn%20%20updateColorScheme();%5Cn%20%20%5Cn%20%20let%20colorSchemeMediaQuery%20=%20window.matchMedia(%5C%22(prefers-color-scheme:%20dark)%5C%22);%20%5Cn%20%20colorSchemeMediaQuery.addEventListener(%5C%22change%5C%22,%20updateColorScheme);%5Cn%20%20%5Cn%20%20let%20localStorageChangeHandler%20=%20function(e)%20%7B%20%5Cn%20%20%20%20if(!document.body.contains(outerCtn))%20%7B%20//%20prevent%20memory%20leak%5Cn%20%20%20%20%20%20window.removeEventListener(%5C%22storage%5C%22,%20localStorageChangeHandler);%5Cn%20%20%20%20%20%20colorSchemeMediaQuery.removeEventListener(%5C%22change%5C%22,%20updateColorScheme);%5Cn%20%20%20%20%20%20return;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20if(e.key%20===%20%5C%22forceColorScheme%5C%22)%20%7B%5Cn%20%20%20%20%20%20updateColorScheme();%5Cn%20%20%20%20%7D%5Cn%20%20%7D;%5Cn%20%20window.addEventListener(%5C%22storage%5C%22,%20localStorageChangeHandler);%5Cn%20%20let%20storageListenerInterval%20=%20setInterval(()%20=%3E%20%7B%5Cn%20%20%20%20if(!document.body.contains(outerCtn))%20%7B%20//%20prevent%20memory%20leak%5Cn%20%20%20%20%20%20window.removeEventListener(%5C%22storage%5C%22,%20localStorageChangeHandler);%5Cn%20%20%20%20%20%20colorSchemeMediaQuery.removeEventListener(%5C%22change%5C%22,%20updateColorScheme);%5Cn%20%20%20%20%20%20clearInterval(storageListenerInterval);%5Cn%20%20%20%20%7D%5Cn%20%20%7D,%201000*30);%5Cn%20%20%5Cn%20%20function%20updateMiddleTabModuleWidth()%20%7B%5Cn%20%20%20%20if(leftCtn.querySelector(%5C%22.tabbed-comments-plugin-add-tabs-module-button%5C%22)%20&&%20rightCtn.querySelector(%5C%22.tabbed-comments-plugin-add-tabs-module-button%5C%22))%20%7B%5Cn%20%20%20%20%20%20//%20both%20side%20modules%20are%20closed,%20so%20prevent%20it%20from%20getting%20too%20big:%5Cn%20%20%20%20%20%20middleCtn.style.maxWidth%20=%20%5C%22min(800px,%20100vw)%5C%22;%5Cn%20%20%20%20%20%20leftCtn.style.width%20=%20%5C%22%5C%22;%5Cn%20%20%20%20%20%20middleCtn.style.width%20=%20%5C%22100%25%5C%22;%5Cn%20%20%20%20%20%20rightCtn.style.width%20=%20%5C%22%5C%22;%5Cn%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20//%20at%20least%20one%20is%20open,%20so%20make%20them%20take%20up%20thirds%5Cn%20%20%20%20%20%20middleCtn.style.maxWidth%20=%20%5C%22%5C%22;%5Cn%20%20%20%20%20%20leftCtn.style.width%20=%20%5C%2233.3%25%5C%22;%5Cn%20%20%20%20%20%20middleCtn.style.width%20=%20%5C%2233.3%25%5C%22;%5Cn%20%20%20%20%20%20rightCtn.style.width%20=%20%5C%2233.3%25%5C%22;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20if(!opts.fillHeight)%20%7B%5Cn%20%20%20%20%20%20if(leftCtn.querySelector(%5C%22.tabbed-comments-plugin-add-tabs-module-button%5C%22)%20%7C%7C%20rightCtn.querySelector(%5C%22.tabbed-comments-plugin-add-tabs-module-button%5C%22))%20%7B%5Cn%20%20%20%20%20%20%20%20//%20at%20least%20one%20is%20closed,%20so%20restore%20normal%20height%5Cn%20%20%20%20%20%20%20%20middleCtn.style.minHeight%20=%20%5C%22%5C%22;%5Cn%20%20%20%20%20%20%20%20leftCtn.style.minHeight%20=%20%5C%22%5C%22;%5Cn%20%20%20%20%20%20%20%20rightCtn.style.minHeight%20=%20%5C%22%5C%22;%5Cn%20%20%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20%20%20//%20both%20side%20panels%20are%20open,%20so%20make%20the%20whole%20section%20taller%5Cn%20%20%20%20%20%20%20%20middleCtn.style.minHeight%20=%20%5C%2290vh%5C%22;%5Cn%20%20%20%20%20%20%20%20leftCtn.style.minHeight%20=%20%5C%2290vh%5C%22;%5Cn%20%20%20%20%20%20%20%20rightCtn.style.minHeight%20=%20%5C%2290vh%5C%22;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%7D%5Cn%20%20%7D%5Cn%20%20function%20initSideButton(side)%20%7B%5Cn%20%20%20%20let%20buttonHtml%20=%20%60%3Cbutton%20class=%5C%22tabbed-comments-plugin-add-tabs-module-button%5C%22%20style=%5C%22margin-$%7Bside===%5C%22left%5C%22%20?%20%5C%22right%5C%22%20:%20%5C%22left%5C%22%7D:0.5rem;%20padding:1px%206px;%5C%22%3E+%3C/button%3E%60;%5Cn%20%20%20%20let%20ctn%20=%20outerCtn.querySelector(%5C%22.tabbed-comments-ctn-%5C%22+side);%5Cn%20%20%20%20ctn.innerHTML%20=%20buttonHtml;%5Cn%20%20%20%20ctn.querySelector(%5C%22button%5C%22).onclick%20=%20function()%20%7B%5Cn%20%20%20%20%20%20ctn.innerHTML%20=%20%5C%22%5C%22;%5Cn%20%20%20%20%20%20let%20obj%20=%20createTabbedCommentsPanel(%7B%5Cn%20%20%20%20%20%20%20%20addCloseButton:true,%5Cn%20%20%20%20%20%20%20%20onClose:%20function()%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20sidePanelObjs.delete(obj);%5Cn%20%20%20%20%20%20%20%20%20%20setTimeout(()%20=%3E%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20initSideButton(side);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20updateMiddleTabModuleWidth();%5Cn%20%20%20%20%20%20%20%20%20%20%7D,%2010);%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%7D);%5Cn%20%20%20%20%20%20ctn.appendChild(obj.element);%5Cn%20%20%20%20%20%20sidePanelObjs.add(obj);%5Cn%20%20%20%20%20%20updateMiddleTabModuleWidth();%5Cn%20%20%20%20%7D;%5Cn%20%20%7D%5Cn%20%20initSideButton(%5C%22left%5C%22);%5Cn%20%20initSideButton(%5C%22right%5C%22);%5Cn%20%20%5Cn%20%20%5Cn%20%20%5Cn%20%20%5Cn%20%20%5Cn%20%20%5Cn%20%20/////////////////////////////////////////////////////////%5Cn%20%20//%20%20%20%20%20CHANNEL%20MENTIONS,%20SEEN/UNSEEN%20COUNTING,%20ETC.%20%20%20%20//%5Cn%20%20/////////////////////////////////////////////////////////%5Cn%20%20let%20unseenCommentCountByChannel%20=%20%7B%7D;%5Cn%20%20function%20updateUnseenCountHtml(channel)%20%7B%5Cn%20%20%20%20let%20count%20=%20unseenCommentCountByChannel%5Bchannel%5D;%5Cn%20%20%20%20for(let%20tabCtn%20of%20%5B...outerCtn.querySelectorAll(%5C%22.tabbed-comments-plugin-ctn%5C%22)%5D)%20%7B%5Cn%20%20%20%20%20%20let%20countEl%20=%20tabCtn.querySelector(%60.tabbed-comments-plugin-tab%5Bdata-channel='$%7Bchannel%7D'%5D%20.tabbed-comments-plugin-unseen-count%60);%5Cn%20%20%20%20%20%20if(countEl)%20%7B%20//%20since%20this%20tabCtn%20may%20not%20have%20that%20particular%20tab%5Cn%20%20%20%20%20%20%20%20countEl.textContent%20=%20count;%5Cn%20%20%20%20%20%20%20%20countEl.style.background%20=%20(count%20%3E%200)%20?%20%5C%22#ab0e0e%5C%22%20:%20%5C%22%5C%22;%5Cn%20%20%20%20%20%20%20%20countEl.style.display%20=%20(count%20%3E%200)%20?%20%5C%22inline%5C%22%20:%20%5C%22none%5C%22;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%7D%5Cn%20%20%7D%5Cn%5Cn%20%20let%20temporaryMentionedChannels%20=%20new%20Set();%5Cn%20%20let%20knownMessageIdsByChannel%20=%20%7B%7D;%5Cn%20%20let%20lastCurrentUserCommentTime%20=%20null;%5Cn%20%20function%20commentsPluginOnLoadHandler(comments)%20%7B%5Cn%20%20%20%20for(let%20comment%20of%20comments)%20%7B%5Cn%20%20%20%20%20%20processCommentForUnseenCounts(comment);%5Cn%20%20%20%20%20%20if(comment.byCurrentUser)%20%7B%5Cn%20%20%20%20%20%20%20%20lastCurrentUserCommentTime%20=%20Date.now();%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%7D%5Cn%20%20%20%20if(comments%5B0%5D)%20unseenCommentCountByChannel%5Bcomments%5B0%5D.channel%5D%20=%200;%20//%20reset%20unseen%20count%20since%20above%20%60processCommentForUnseenCounts%60%20has%20incremented%20it%5Cn%20%20%20%20processCommentsForTempChannels(comments.slice(-30));%5Cn%20%20%7D%5Cn%20%20function%20commentsPluginOnCommentHandler(comment)%20%7B%5Cn%20%20%20%20processCommentForUnseenCounts(comment);%5Cn%20%20%20%20if(comment.byCurrentUser)%20%7B%5Cn%20%20%20%20%20%20lastCurrentUserCommentTime%20=%20Date.now();%5Cn%20%20%20%20%7D%5Cn%20%20%20%20processCommentsForTempChannels(%5Bcomment%5D);%5Cn%20%20%7D%5Cn%20%20function%20processCommentForUnseenCounts(comment)%20%7B%5Cn%20%20%20%20//%20console.log(%5C%22new%20comment:%5C%22,%20comment);%5Cn%20%20%20%20let%20channel%20=%20comment.channel;%5Cn%20%20%20%20//%20initialize%20if%20we%20haven't%20yet:%5Cn%20%20%20%20if(!knownMessageIdsByChannel%5Bcomment.channel%5D)%20knownMessageIdsByChannel%5Bchannel%5D%20=%20new%20Set();%5Cn%5Cn%20%20%20%20//%20increment%20the%20unseen%20count%20if%20we%20haven't%20seen%20this%20comment%20id%20before:%5Cn%20%20%20%20if(!knownMessageIdsByChannel%5Bchannel%5D.has(comment.id))%20%7B%5Cn%20%20%20%20%20%20knownMessageIdsByChannel%5Bchannel%5D.add(comment.id);%5Cn%20%20%20%20%20%20unseenCommentCountByChannel%5Bchannel%5D%20=%20(unseenCommentCountByChannel%5Bchannel%5D%20%7C%7C%200)%20+%201;%5Cn%5Cn%20%20%20%20%20%20let%20tabIsVisible%20=%20false;%20//%20check%20if%20it's%20visible%20in%20any%20of%20the%20tabbedCommentsCtn%20elements%5Cn%20%20%20%20%20%20for(let%20tabCtn%20of%20%5B...outerCtn.querySelectorAll(%5C%22.tabbed-comments-plugin-ctn%5C%22)%5D)%20%7B%5Cn%20%20%20%20%20%20%20%20let%20tabContentEl%20=%20tabCtn.querySelector(%60.tabbed-comments-plugin-content%5Bdata-channel='$%7Bchannel%7D'%5D%60);%5Cn%20%20%20%20%20%20%20%20if(tabContentEl%20&&%20tabContentEl.offsetHeight%20!==%200)%20tabIsVisible%20=%20true;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20if(tabIsVisible)%20%7B%20//%20set%20unseen%20count%20to%200%20if%20tab%20is%20visible%5Cn%20%20%20%20%20%20%20%20unseenCommentCountByChannel%5Bchannel%5D%20=%200;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20updateUnseenCountHtml(channel);%5Cn%20%20%20%20%7D%5Cn%20%20%7D%5Cn%20%20function%20attachEventsToTemporaryMentionedChannelTab(tabEl,%20channelName)%20%7B%5Cn%20%20%20%20tabEl.addEventListener(%5C%22click%5C%22,%20function()%20%7B%5Cn%20%20%20%20%20%20temporaryMentionedChannels.delete(channelName);%5Cn%20%20%20%20%20%20for(let%20t%20of%20%5B...outerCtn.querySelectorAll(%60.tabbed-comments-plugin-ctn%20.tabbed-comments-plugin-header%20.tabbed-comments-plugin-tab%5Bdata-channel='$%7BchannelName%7D'%5D%60)%5D)%20%7B%5Cn%20%20%20%20%20%20%20%20t.dataset.tabbedCommentsPluginIsTemporaryMentionedChannel%20=%20%5C%22%5C%22;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%7D);%5Cn%20%20%20%20window.addEventListener(%5C%22beforeunload%5C%22,%20function()%20%7B%5Cn%20%20%20%20%20%20if(tabEl.dataset.tabbedCommentsPluginIsTemporaryMentionedChannel)%20%7B%5Cn%20%20%20%20%20%20%20%20temporaryMentionedChannels.delete(channelName);%5Cn%20%20%20%20%20%20%20%20for(let%20obj%20of%20%5B...sidePanelObjs,%20middlePanelObj%5D)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20obj.deleteCommentsChannel(channelName);%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%7D);%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20//%20to%20rate%20limit%20mentions:%5Cn%20%20let%20userIdToMentionedChannelsInLast2Minutes%20=%20%7B%7D;%5Cn%20%20setInterval(()%20=%3E%20%7B%5Cn%20%20%20%20userIdToMentionedChannelsInLast2Minutes%20=%20%7B%7D;%5Cn%20%20%7D,%201000*60*2);%5Cn%20%20%5Cn%20%20function%20processCommentsForTempChannels(comments)%20%7B%5Cn%20%20%20%20for(let%20comment%20of%20comments)%20%7B%5Cn%20%20%20%20%20%20let%20mentionedChannelName%20=%20comment.message.match(/(%5C%5Cs%7C%5E)#%5Ba-z0-9%5C%5C-%5D+(%5C%5Cs%7C$)/g)?.%5B0%5D;%5Cn%20%20%20%20%20%20if(mentionedChannelName%20&&%20!/%5E%5B0-9%5D+$/.test(mentionedChannelName))%20%7B%20//%20if%20it's%20all%20numbers,%20ignore%5Cn%20%20%20%20%20%20%20%20mentionedChannelName%20=%20mentionedChannelName.trim().replace(/%5E#/,%20%5C%22%5C%22).trim();%20//%20remove%20the%20hash%20from%20the%20start%20and%20whitespace%20from%20start/end%5Cn%20%20%20%20%20%20%20%20if(mentionedChannelName%20===%20%5C%22feedback%5C%22)%20continue;%5Cn%20%20%20%20%20%20%20%20if(!userIdToMentionedChannelsInLast2Minutes%5Bcomment.user.id%5D)%20userIdToMentionedChannelsInLast2Minutes%5Bcomment.user.id%5D%20=%20%5B%5D;%5Cn%20%20%20%20%20%20%20%20if(userIdToMentionedChannelsInLast2Minutes%5Bcomment.user.id%5D.length%20%3E=%2010)%20continue;%5Cn%20%20%20%20%20%20%20%20//%20add%20it%20as%20a%20temporary%20channel%20which%20self-deletes%20after%202%20minutes.%5Cn%20%20%20%20%20%20%20%20//%20it%20upgrades%20to%20a%20real%20one%20when%20clicked.%5Cn%20%20%20%20%20%20%20%20if(middlePanelObj)%20%7B%20//%20%3C--%20just%20in%20case%20somehow%20hasn't%20initialized%20yet,%20or%20whatever%5Cn%5Cn%20%20%20%20%20%20%20%20%20%20//%20If%20they've%20got%20the%20tab%20*somewhere*%20(e.g.%20in%20side%20module),%20then%20we%20don't%20add%20it%20as%20a%20temporary%20channel.%5Cn%20%20%20%20%20%20%20%20%20%20let%20alreadyExistsSomewhere%20=%20!!outerCtn.querySelector(%60.tabbed-comments-plugin-ctn%20.tabbed-comments-plugin-header%20.tabbed-comments-plugin-tab%5Bdata-channel='$%7BmentionedChannelName%7D'%5D%60);%5Cn%5Cn%20%20%20%20%20%20%20%20%20%20let%20%7B%20tab,%20alreadyExisted%20%7D%20=%20middlePanelObj.addCommentsChannel(mentionedChannelName);%5Cn%20%20%20%20%20%20%20%20%20%20userIdToMentionedChannelsInLast2Minutes%5Bcomment.user.id%5D.push(mentionedChannelName);%5Cn%20%20%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20%20%20if(!alreadyExisted%20&&%20!alreadyExistsSomewhere)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20temporaryMentionedChannels.add(mentionedChannelName);%5Cn%5Cn%20%20%20%20%20%20%20%20%20%20%20%20let%20newTabs%20=%20%5B%5D;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20newTabs.push(tab);%5Cn%5Cn%20%20%20%20%20%20%20%20%20%20%20%20try%20%7B%20//%20because%20it's%20new%20code%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20for(let%20obj%20of%20sidePanelObjs)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20let%20%7B%20tab%20%7D%20=%20obj.addCommentsChannel(mentionedChannelName);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20newTabs.push(tab);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%7D%20catch(e)%20%7B%20console.error(e);%20%7D%5Cn%5Cn%20%20%20%20%20%20%20%20%20%20%20%20for(let%20newTab%20of%20newTabs)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20newTab.dataset.tabbedCommentsPluginIsTemporaryMentionedChannel%20=%20%5C%221%5C%22;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20attachEventsToTemporaryMentionedChannelTab(newTab,%20mentionedChannelName);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20%20%20//%20make%20its%20background%20blink%20for%20a%20couple%20of%20seconds:%5Cn%20%20%20%20%20%20%20%20%20%20%20%20let%20blinkCount%20=%200;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20let%20blinkInterval%20=%20setInterval(()%20=%3E%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20tab.style.background%20=%20blinkCount%252===0%20?%20%5C%22#043a9b%5C%22%20:%20%5C%22%5C%22;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20blinkCount++;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20if(blinkCount%20%3E%205)%20clearInterval(blinkInterval);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%7D,%20300);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20setTimeout(()%20=%3E%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20temporaryMentionedChannels.delete(mentionedChannelName);%5Cn%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20if(document.body.contains(tab)%20&&%20tab.dataset.tabbedCommentsPluginIsTemporaryMentionedChannel)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20for(let%20obj%20of%20%5B...sidePanelObjs,%20middlePanelObj%5D)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20obj.deleteCommentsChannel(mentionedChannelName);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%7D,%201000*40);%5Cn%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%7D%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20%5Cn%20%20%5Cn%20%20%5Cn%20%20%5Cn%20%20%5Cn%20%20/////////////////////////////////////////////%5Cn%20%20//%20%20%20%20%20%20%20%20%20BOT/AUTO-COMMENT%20STUFF%20%20%20%20%20%20%20%20%20%20//%5Cn%20%20/////////////////////////////////////////////%5Cn%20%20let%20autoCommentChars%20=%20%5B%5D;%5Cn%20%20if(localStorage.autoCommentChars)%20%7B%5Cn%20%20%20%20try%20%7B%20autoCommentChars%20=%20JSON.parse(localStorage.autoCommentChars);%20%7D%20catch(e)%20%7B%20alert(e);%20%7D%5Cn%20%20%20%20autoCommentChars%20=%20autoCommentChars.filter(c%20=%3E%20c%20&&%20c.name);%5Cn%20%20%7D%5Cn%20%20function%20getAutoCommentNameFromNickname(nickname)%20%7B%5Cn%20%20%20%20let%20nicknameWithoutNonNameCharacters%20=%20nickname.replace(/%5B%5C%5Cn%5C%5C-:%7C()!%7B%7D*%5D/g,%20%5C%22%5C%22).replace(/(?!%5B*#0-9%5D+)%5B%5C%5Cp%7BEmoji%7D%5C%5Cp%7BEmoji_Modifier%7D%5C%5Cp%7BEmoji_Component%7D%5C%5Cp%7BEmoji_Modifier_Base%7D%5C%5Cp%7BEmoji_Presentation%7D%5D/gu,%20'');%5Cn%20%20%20%20let%20words%20=%20nicknameWithoutNonNameCharacters.split(/%5B%7C/%20%5C%5C-%7D)%5D/g).map(w%20=%3E%20w.trim()).filter(w%20=%3E%20w);%5Cn%20%20%20%20while(words.slice(0,%20-1).join(%5C%22_%5C%22).length%20%3E%2025)%20words.pop();%20//%20we%20remove%20the%20last%20one%20for%20the%20length%20check%20in%20case%20it's%20a%20name%20like%20One%20Supercalifragilisticexpialidocious%20-%20better%20for%20userTag%20to%20be%20%5C%22OneSupercalif%5C%22%20than%20%5C%22One%5C%22%5Cn%20%20%20%20if(words.slice(0,%20-1).join(%5C%22_%5C%22).length%20%3E%2015)%20words.pop();%20//%20we%20probably%20don't%20need%20the%20last%20word%20if%20all%20the%20earlier%20ones%20are%20over%2015%20characters%5Cn%20%20%20%20let%20name%20=%20words.join(%5C%22_%5C%22).trim().toLowerCase();%5Cn%20%20%20%20return%20name%20+%20(nickname.length%20%3E%2025%20?%20%5C%22%E2%80%A6%5C%22%20:%20%5C%22%5C%22);%5Cn%20%20%7D%5Cn%20%20window%5B%60__$%7BglobalFnsId%7D_tabbedCommentsPluginAutoComment%60%5D%20=%20function(character)%20%7B%5Cn%20%20%20%20let%20commentsBox%20=%20middleCtnChannelNameToObj%5BmiddleCtnCurrentlyShownCommentsChannelName%5D;%5Cn%20%20%20%20if(commentsBox.channel%20===%20%5C%22n/o/-/a/i%5C%22.replaceAll(%5C%22/%5C%22,%20%5C%22%5C%22))%20return;%5Cn%5Cn%20%20%20%20let%20startTime%20=%20Date.now();%5Cn%20%20%20%20autoCommentCharBtn.disabled%20=%20true;%5Cn%20%20%20%20autoCommentCharBtn.textContent%20=%20%5C%22%E2%8F%B3%20just%20a%20sec...%5C%22;%5Cn%5Cn%20%20%20%20let%20currentUser%20=%20commentsBox.comments.find(c%20=%3E%20c.byCurrentUser)?.user;%5Cn%20%20%20%20let%20comments%20=%20commentsBox.comments.slice(-500).map(c%20=%3E%20%7B%5Cn%20%20%20%20%20%20let%20userTag%20=%20c.user.visualId.toUpperCase();%5Cn%20%20%20%20%20%20if(c.user.nickname)%20%7B%5Cn%20%20%20%20%20%20%20%20let%20name%20=%20getAutoCommentNameFromNickname(c.user.nickname);%5Cn%20%20%20%20%20%20%20%20if(name)%20userTag%20=%20%60$%7Bc.user.visualId.toUpperCase()%7D($%7Bname%7D)%60%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20return%20%60$%7BuserTag%7D:%20$%7Bc.message.trim().replace(/%5C%5Cn%7B3,%7D/g,%20%5C%22%5C%5Cn%5C%5Cn%5C%22)%7D%60;%5Cn%20%20%20%20%7D);%5Cn%20%20%20%20while(comments.join(%5C%22%5C%22).length%20%3E%2010000)%20comments.shift();%5Cn%5Cn%20%20%20%20let%20nicknameOverride%20=%20character.name.replace(/%5C%5Cs+/g,%20%5C%22%20%5C%22).slice(0,%2050);%5Cn%20%20%20%20let%20currentUserVisualId%20=%20currentUser%20?%20currentUser.visualId.toUpperCase()%20:%20%5C%22U7OP%5C%22;%20//%20just%20use%20a%20random/arbitrary%20tag%20if%20we%20don't%20have%20the%20user's%20actual%20one%20(we'll%20get%20it%20once%20they've%20made%20their%20first%20comment)%5Cn%20%20%20%20let%20respondingUserTag%20=%20%60$%7BcurrentUserVisualId%7D($%7Bcharacter.name%7D)%60;%5Cn%20%20%20%20let%20characterDescription%20=%20character.description.replace(/%5C%5Cn/g,%20%5C%22%20%5C%22).slice(0,%205000);%5Cn%5Cn%20%20%20%20let%20newCommentText%20=%20%5C%22%5C%22;%20//commentsBox.inputText.trim().replace(/%5C%5Cn/g,%20%5C%22%20%5C%22).split(%5C%22%20%5C%22).slice(0,%203);%5Cn%20%20%20%20let%20obj%20=%20generateText(%7B%20//%20NOTE:%20perchance%20removes%20all%20leading%20spaces%20from%20lines,%20so%20we%20don't%20need%20to%20dedent%20the%20lines%20below%5Cn%20%20%20%20%20%20instruction:%20%60%5Cn%20%20%20%20%20%20Your%20task%20is%20to%20write%20the%20next%205%20messages%20in%20the%20following%20chat/roleplay.%20Keep%20it%20interesting.%20Stay%20in%20character%20based%20on%20the%20previous%20messages.%20You%20are%20**NOT**%20an%20AI.%20You%20are%20writing%20as%20a%20regular%20chat%20participant,%20not%20as%20an%20AI.%20When%20writing%20$%7BrespondingUserTag%7D's%20messages,%20you%20can%20ignore%20the%20off-topic/OOC/spam/commentary%20chat%20messages%20and%20focus%20on%20the%20roleplay%20messages%20that%20are%20actually%20a%20part%20of%20the%20story.%20Predict%20what%20the%20characters%20in%20this%20chat/roleplay%20are%20most%20likely%20to%20say%20next,%20and%20then%20write%20it%20**EXACTLY**%20as%20the%20chat%20participants%20would,%20based%20on%20what%20they've%20previously%20said.%5Cn%20%20%20%20%20%20IMPORTANT:%20Here's%20a%20description%20of%20$%7BrespondingUserTag%7D:%20$%7BcharacterDescription%7D.%5Cn%5Cn%20%20%20%20%20%20%3CMESSAGES%3E%5Cn%20%20%20%20%20%20$%7Bcomments.slice(0,%20-4).join(%5C%22%5C%5Cn%5C%5Cn---%5C%5Cn%5C%5Cn%5C%22).trim()%20%7C%7C%20%60(None%20yet.%20Start%20the%20chat/roleplay%20with%20an%20interesting%20starter%20message.)%60%7D%5Cn%20%20%20%20%20%20%3C/MESSAGES%3E%5Cn%5Cn%20%20%20%20%20%20Again,%20your%20task%20is%20to%20write%20the%20next%205%20messages.%20Make%20sure%20your%20writing%20is%20interesting,%20authentic,%20descriptive,%20natural,%20engaging,%20and%20creative.%20Create%20a%20captivating%20and%20genuinely%20fascinating%20roleplay,%20and%20always%20stay%20in-character%20and%20write%20responses%20based%20on%20the%20previous%20chat%20context.%20Don't%20be%20boring.%20Keep%20the%20roleplay%20flowing!%5Cn%20%20%20%20%20%20As%20a%20reminder%20about%20the%20$%7BrespondingUserTag%7D%20character:%20$%7BcharacterDescription.slice(0,%20500)%20+%20(characterDescription.length%20%3E%201000%20?%20%5C%22...%5C%22%20:%20%5C%22%5C%22)%7D%5Cn%20%20%20%20%20%20%60.trim(),%5Cn%20%20%20%20%20%20startWith:%20comments.slice(-4).join(%5C%22%5C%5Cn%5C%5Cn---%5C%5Cn%5C%5Cn%5C%22)+%5C%22%5C%5Cn%5C%5Cn---%5C%5Cn%5C%5Cn%5C%22+respondingUserTag+%5C%22:%20%5C%22+newCommentText,%5Cn%20%20%20%20%20%20stopSequences:%20%5B%5C%22%5C%5Cn%5C%5Cn%5C%22,%20%5C%22%3C/MESSAGES%3E%5C%22%5D,%5Cn%20%20%20%20%20%20onChunk:%20function(data)%20%7B%5Cn%20%20%20%20%20%20%20%20if(data.isFromStartWith)%20return;%5Cn%20%20%20%20%20%20%20%20newCommentText%20+=%20data.textChunk;%20%5Cn%20%20%20%20%20%20%20%20if(newCommentText.includes(%5C%22%3C/MESSAGES%3E%5C%22))%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20newCommentText%20=%20newCommentText.replace(/%3C%5C%5C/MESSAGES%3E/g,%20%5C%22%5C%22).trim();%5Cn%20%20%20%20%20%20%20%20%20%20obj.stop();%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20commentsBox.inputText%20=%20newCommentText.trim();%5Cn%5Cn%20%20%20%20%20%20%20%20//%20if%20really%20long,%20or%20repeating%20a%20single%20character,%20stop:%5Cn%20%20%20%20%20%20%20%20if(newCommentText.length%20%3E%20800%20%7C%7C%20newCommentText.slice(-30)%20===%20newCommentText%5BnewCommentText.length-1%5D.repeat(30))%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20obj.stop();%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%7D,%5Cn%20%20%20%20%20%20onFinish:%20async%20function()%20%7B%5Cn%20%20%20%20%20%20%20%20autoCommentCharBtn.disabled%20=%20false;%5Cn%20%20%20%20%20%20%20%20autoCommentCharBtn.textContent%20=%20%5C%22%F0%9F%A7%9D%20write%20as%20character%5C%22;%5Cn%5Cn%20%20%20%20%20%20%20%20if(/%5C%5Cn---%5C%5Cs*$/.test(commentsBox.inputText))%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20commentsBox.inputText%20=%20commentsBox.inputText.replace(/%5C%5Cn---%5C%5Cs*$/g,%20%5C%22%5C%22);%5Cn%20%20%20%20%20%20%20%20%20%20newCommentText%20=%20newCommentText.replace(/%5C%5Cn---%5C%5Cs*$/g,%20%5C%22%5C%22);%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%5Cn%20%20%20%20%20%20%20%20if(autoCommentAutoSendCheckboxEl.checked)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20if(newCommentText.trim())%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20if(lastCurrentUserCommentTime%20&&%20Date.now()-lastCurrentUserCommentTime%20%3C%203000)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20too%20soon%20to%20submit%20again,%20so%20just%20set%20nickname%20and%20let%20them%20click%20submit%20manually%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20commentsBox.setNicknameForNextComment(nicknameOverride);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20autoCommentCharBtn.textContent%20=%20%5C%22submitting%20too%20fast%5C%22;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20setTimeout(()%20=%3E%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20autoCommentCharBtn.textContent%20=%20%5C%22%F0%9F%A7%9D%20write%20as%20character%5C%22;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D,%201000);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20commentsBox.submit(newCommentText.trim(),%20%7Bnickname:nicknameOverride%7D).then(r%20=%3E%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if(!r.success)%20commentsBox.inputText%20=%20newCommentText.trim();%20//%20recover%20comment%20text%20if%20it%20failed%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20commentsBox.inputText%20=%20%5C%22%5C%22;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20//%20No%20auto-submit,%20but%20we%20still%20set%20the%20nickname%20to%20their%20character%5Cn%20%20%20%20%20%20%20%20%20%20commentsBox.setNicknameForNextComment(nicknameOverride);%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%7D,%5Cn%20%20%20%20%7D);%5Cn%20%20%7D%5Cn%20%20let%20saveAutoCommentCharInfoDebounceTimeout;%5Cn%20%20window%5B%60__$%7BglobalFnsId%7D_tabbedCommentsPluginSaveAutoCommentCharInfo%60%5D%20=%20function()%20%7B%5Cn%20%20%20%20autoCommentCharSelectEl.selectedOptions%5B0%5D.textContent%20=%20autoCommentCharNameEl.value;%5Cn%20%20%20%20autoCommentChars%5BautoCommentCharSelectEl.value%5D%20=%20%7Bname:autoCommentCharNameEl.value,%20description:autoCommentCharNameDescriptionEl.value%7D;%5Cn%20%20%20%20clearTimeout(saveAutoCommentCharInfoDebounceTimeout);%5Cn%20%20%20%20saveAutoCommentCharInfoDebounceTimeout%20=%20setTimeout(()%20=%3E%20%7B%5Cn%20%20%20%20%20%20localStorage.autoCommentChars%20=%20JSON.stringify(autoCommentChars);%5Cn%20%20%20%20%7D,%20500);%5Cn%20%20%7D%5Cn%20%20window%5B%60__$%7BglobalFnsId%7D_tabbedCommentsPluginSwitchToAutoCommentCharByIndex%60%5D%20=%20function(index)%20%7B%5Cn%20%20%20%20if(index%20===%20%5C%22#%5C%22)%20%7B%5Cn%20%20%20%20%20%20//%20add%20a%20new%20%3Coption%3E%20with%20an%20index%201%20higher%20than%20the%20current%20highest:%5Cn%20%20%20%20%20%20let%20newIndex%20=%20autoCommentChars.length;%5Cn%20%20%20%20%20%20let%20selectedOptionEl%20=%20autoCommentCharSelectEl.selectedOptions%5B0%5D;%5Cn%20%20%20%20%20%20selectedOptionEl.value%20=%20newIndex;%5Cn%20%20%20%20%20%20selectedOptionEl.textContent%20=%20%5C%22Unnamed%5C%22;%5Cn%20%20%20%20%20%20autoCommentCharNameEl.value%20=%20%5C%22%5C%22;%5Cn%20%20%20%20%20%20autoCommentCharNameDescriptionEl.value%20=%20%5C%22%5C%22;%5Cn%20%20%20%20%20%20autoCommentCharSelectEl.innerHTML%20+=%20%60%3Coption%20value=%5C%22#%5C%22%3EAdd%20char...%3C/option%3E%60;%5Cn%20%20%20%20%20%20autoCommentCharSelectEl.value%20=%20newIndex;%5Cn%20%20%20%20%20%20localStorage.__tabbedCommentsLastActiveAutoCommentCharIndex%20=%20newIndex;%5Cn%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20autoCommentCharNameEl.value%20=%20autoCommentChars%5Bindex%5D.name;%5Cn%20%20%20%20%20%20autoCommentCharNameDescriptionEl.value%20=%20autoCommentChars%5Bindex%5D.description;%5Cn%20%20%20%20%20%20autoCommentCharSelectEl.value%20=%20index;%5Cn%20%20%20%20%20%20localStorage.__tabbedCommentsLastActiveAutoCommentCharIndex%20=%20index;%5Cn%20%20%20%20%7D%5Cn%20%20%7D%5Cn%20%20if(autoCommentChars.length%20===%200)%20%7B%5Cn%20%20%20%20autoCommentChars.push(%7Bname:%5C%22Unnamed%5C%22,%20description:%5C%22%5C%22%7D);%5Cn%20%20%20%20autoCommentCharSelectEl.innerHTML%20=%20%60%3Coption%20value=%5C%220%5C%22%3EUnnamed%3C/option%3E%60;%5Cn%20%20%7D%20else%20%7B%5Cn%20%20%20%20autoCommentCharSelectEl.innerHTML%20=%20autoCommentChars.map((o,%20i)%20=%3E%20%60%3Coption%20value=%5C%22$%7Bi%7D%5C%22%3E$%7Bo.name%7D%3C/option%3E%60).join(%5C%22%5C%22);%5Cn%20%20%7D%5Cn%20%20autoCommentCharSelectEl.innerHTML%20+=%20%60%3Coption%20value=%5C%22#%5C%22%3EAdd%20char...%3C/option%3E%60;%5Cn%20%20try%20%7B%5Cn%20%20%20%20let%20charIndex%20=%20Number(localStorage.__tabbedCommentsLastActiveAutoCommentCharIndex%20%7C%7C%200);%5Cn%20%20%20%20if(isNaN(charIndex))%20charIndex%20=%200;%5Cn%20%20%20%20if(!autoCommentChars%5BcharIndex%5D)%20charIndex%20=%200;%5Cn%20%20%20%20if(!autoCommentChars%5BcharIndex%5D)%20%7B%5Cn%20%20%20%20%20%20charIndex%20=%200;%5Cn%20%20%20%20%20%20autoCommentChars%5B0%5D%20=%20%7Bname:%5C%22Unnamed%5C%22,%20description:%5C%22%5C%22%7D;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20localStorage.__tabbedCommentsLastActiveAutoCommentCharIndex%20=%20charIndex;%5Cn%20%20%20%20window%5B%60__$%7BglobalFnsId%7D_tabbedCommentsPluginSwitchToAutoCommentCharByIndex%60%5D(charIndex);%5Cn%20%20%20%20autoCommentAutoSendCheckboxEl.checked%20=%20!!localStorage.__tabbedCommentsAutoCommentAutoSendCheckboxValue;%5Cn%20%20%7D%20catch(e)%20%7B%20alert(e);%20%7D%5Cn%5Cn%20%20function%20createTabbedCommentsPanel(panelOpts)%20%7B%20//%20takes%20*list*%20of%20commentOptions%20as%20input%5Cn%20%20%20%20if(!panelOpts)%20panelOpts%20=%20%7B%7D;%5Cn%20%20%20%20let%20panelCtn%20=%20document.createElement(%5C%22div%5C%22);%5Cn%20%20%20%20panelCtn.innerHTML%20=%20%60%5Cn%20%20%20%20%20%20%3Cdiv%20class=%5C%22tabbed-comments-plugin-header%5C%22%3E%3C/div%3E%5Cn%20%20%20%20%20%20%3Cdiv%20class=%5C%22tabbed-comments-plugin-body%5C%22%3E%3C/div%3E%5Cn%20%20%20%20%60;%5Cn%20%20%20%20%5Cn%5Cn%20%20%20%20let%20commentsChannelNameToObj%20=%20%7B%7D;%5Cn%5Cn%20%20%20%20const%20tabsHeaderEl%20=%20panelCtn.querySelector('.tabbed-comments-plugin-header');%5Cn%20%20%20%20const%20tabsContentEl%20=%20panelCtn.querySelector('.tabbed-comments-plugin-body');%5Cn%5Cn%20%20%20%20function%20deleteCommentsChannel(channel)%20%7B%5Cn%20%20%20%20%20%20if(!localStorage.__tabbedCommentsPluginCustomChannels)%20localStorage.__tabbedCommentsPluginCustomChannels%20=%20%5C%22%7B%7D%5C%22;%5Cn%20%20%20%20%20%20let%20customChannels%20=%20%7B%7D;%5Cn%20%20%20%20%20%20try%20%7B%20customChannels%20=%20JSON.parse(localStorage.__tabbedCommentsPluginCustomChannels)%20%7D%20catch(e)%20%7B%20console.error(%5C%22Failed%20to%20parse%20custom%20channels%20from%20localStorage:%5C%22,%20e);%20%7D%5Cn%5Cn%20%20%20%20%20%20delete%20customChannels%5Bchannel%5D;%5Cn%20%20%20%20%20%20localStorage.__tabbedCommentsPluginCustomChannels%20=%20JSON.stringify(customChannels);%5Cn%5Cn%20%20%20%20%20%20tabsHeaderEl.querySelector(%60.tabbed-comments-plugin-tab%5Bdata-channel='$%7Bchannel%7D'%5D%60)?.remove();%5Cn%20%20%20%20%20%20tabsContentEl.querySelector(%60.tabbed-comments-plugin-content%5Bdata-channel='$%7Bchannel%7D'%5D%60)?.remove();%5Cn%5Cn%20%20%20%20%20%20tabsHeaderEl.append(tabsHeaderEl.querySelector(%5C%22.tabbed-comments-plugin-add-custom-channel%5C%22));%20//%20move%20%5C%22+%5C%22%20button%20to%20the%20end%5Cn%20%20%20%20%20%20tabsHeaderEl.prepend(tabsHeaderEl.querySelector(%5C%22.tabbed-comments-plugin-close-panel-btn%5C%22));%20//%20move%20close%20panel%20button%20to%20the%20start%5Cn%20%20%20%20%7D%5Cn%5Cn%20%20%20%20function%20addCommentsChannel(channel)%20%7B%5Cn%20%20%20%20%20%20if(!localStorage.__tabbedCommentsPluginCustomChannels)%20localStorage.__tabbedCommentsPluginCustomChannels%20=%20%5C%22%7B%7D%5C%22;%5Cn%20%20%20%20%20%20let%20customChannels%20=%20%7B%7D;%5Cn%20%20%20%20%20%20try%20%7B%20customChannels%20=%20JSON.parse(localStorage.__tabbedCommentsPluginCustomChannels)%20%7D%20catch(e)%20%7B%20console.error(%5C%22Failed%20to%20parse%20custom%20channels%20from%20localStorage:%5C%22,%20e);%20%7D%5Cn%5Cn%20%20%20%20%20%20let%20alreadyExisted%20=%20true;%5Cn%5Cn%20%20%20%20%20%20let%20existingTabEl%20=%20tabsHeaderEl.querySelector(%60.tabbed-comments-plugin-tab%5Bdata-channel='$%7Bchannel%7D'%5D%60);%5Cn%20%20%20%20%20%20if(!existingTabEl%20&&%20channel%20!==%20%5C%22%5C%22)%20%7B%5Cn%20%20%20%20%20%20%20%20alreadyExisted%20=%20false;%5Cn%20%20%20%20%20%20%20%20customChannels%5Bchannel%5D%20=%20%7Bchannel:channel%7D;%5Cn%20%20%20%20%20%20%20%20let%20commentOptions%20=%20JSON.parse(JSON.stringify(customChannels%5Bchannel%5D));%5Cn%20%20%20%20%20%20%20%20addTab(commentOptions);%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20localStorage.__tabbedCommentsPluginCustomChannels%20=%20JSON.stringify(customChannels);%5Cn%5Cn%20%20%20%20%20%20tabsHeaderEl.append(tabsHeaderEl.querySelector(%5C%22.tabbed-comments-plugin-add-custom-channel%5C%22));%20//%20move%20%5C%22+%5C%22%20button%20to%20the%20end%5Cn%20%20%20%20%20%20tabsHeaderEl.prepend(tabsHeaderEl.querySelector(%5C%22.tabbed-comments-plugin-close-panel-btn%5C%22));%20//%20move%20close%20panel%20button%20to%20the%20start%5Cn%5Cn%20%20%20%20%20%20let%20tab%20=%20tabsHeaderEl.querySelector(%60.tabbed-comments-plugin-tab%5Bdata-channel='$%7Bchannel%7D'%5D%60);%5Cn%20%20%20%20%20%20let%20tabContent%20=%20tabsContentEl.querySelector(%60.tabbed-comments-plugin-content%5Bdata-channel='$%7Bchannel%7D'%5D%60);%5Cn%5Cn%20%20%20%20%20%20return%20%7Btab,%20tabContent,%20alreadyExisted%7D;%5Cn%20%20%20%20%7D%5Cn%5Cn%20%20%20%20//%20Function%20to%20react%20to%20tab%20clicks%5Cn%20%20%20%20function%20handleTabClick(event)%20%7B%5Cn%20%20%20%20%20%20let%20clickedTab%20=%20event.target;%5Cn%20%20%20%20%20%20if(!clickedTab.classList.contains('tabbed-comments-plugin-tab'))%20return;%20//%20they%20didn't%20click%20directly%20on%20a%20tab%5Cn%5Cn%20%20%20%20%20%20if(event.target.classList.contains('tabbed-comments-plugin-add-custom-channel'))%20%7B%5Cn%20%20%20%20%20%20%20%20//%20They%20clicked%20on%20the%20%5C%22+%5C%22%20icon%20to%20add%20a%20new%20channel.%5Cn%20%20%20%20%20%20%20%20let%20channel%20=%20prompt(%5C%22Choose%20a%20channel%20name.%20Note:%20You%20can%20type%20#channelname%20in%20the%20chat%20to%20share%20your%20channel.%5C%22);%5Cn%20%20%20%20%20%20%20%20if(channel)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20let%20removeChannel%20=%20false;%5Cn%20%20%20%20%20%20%20%20%20%20if(channel.startsWith(%5C%22!%5C%22))%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20removeChannel%20=%20true;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20channel%20=%20channel.slice(1);%5Cn%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20channel%20=%20channel.toLowerCase();%5Cn%20%20%20%20%20%20%20%20%20%20channel%20=%20channel.replace(/%5B%5Ea-z0-9%5C%5C-%5D/g,%20%5C%22%5C%22);%5Cn%5Cn%20%20%20%20%20%20%20%20%20%20if(!channel)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20alert(%5C%22Channel%20names%20can%20only%20contain%20lower-case%20letters,%20numbers%20and%20hyphens.%5C%22);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20return;%5Cn%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20if(channel%20===%20%5C%22feedback%5C%22)%20return;%5Cn%20%20%20%20%20%20%20%20%20%20if(channel%20===%20%5C%22general%5C%22)%20return;%5Cn%5Cn%20%20%20%20%20%20%20%20%20%20if(removeChannel)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20deleteCommentsChannel(channel);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20showTabByChannelName(tabsHeaderEl.firstElementChild.dataset.channel);%5Cn%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20addCommentsChannel(channel);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20showTabByChannelName(channel);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20alert(%60The%20'$%7Bchannel%7D'%20channel%20has%20been%20added.%20Type%20#$%7Bchannel%7D%20in%20the%20chat%20to%20share%20it.%60)%5Cn%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20return;%5Cn%20%20%20%20%20%20%7D%20else%20if(event.target.classList.contains('tabbed-comments-plugin-channel-tab'))%20%7B%5Cn%20%20%20%20%20%20%20%20showTabByChannelName(clickedTab.dataset.channel);%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%7D%5Cn%5Cn%20%20%20%20//%20Given%20the%20channel%20of%20a%20tab,%20it%20shows%20the%20tab%20content:%5Cn%20%20%20%20function%20showTabByChannelName(channel)%20%7B%5Cn%20%20%20%20%20%20localStorage.__tabbedCommentsPluginLastViewedChannel%20=%20channel;%5Cn%20%20%20%20%20%20tabsHeaderEl.querySelectorAll('.tabbed-comments-plugin-tab').forEach(el%20=%3E%20el.classList.remove('tabbed-comments-plugin-active-tab'));%5Cn%20%20%20%20%20%20let%20activeTab%20=%20tabsHeaderEl.querySelector(%60.tabbed-comments-plugin-tab%5Bdata-channel='$%7Bchannel%7D'%5D%60);%5Cn%20%20%20%20%20%20activeTab.classList.add('tabbed-comments-plugin-active-tab');%5Cn%5Cn%20%20%20%20%20%20tabsContentEl.querySelectorAll('.tabbed-comments-plugin-content').forEach(el%20=%3E%20el.classList.remove('tabbed-comments-plugin-active-content'));%5Cn%20%20%20%20%20%20tabsContentEl.querySelector(%60.tabbed-comments-plugin-content%5Bdata-channel='$%7Bchannel%7D'%5D%60).classList.add('tabbed-comments-plugin-active-content');%5Cn%5Cn%20%20%20%20%20%20unseenCommentCountByChannel%5Bchannel%5D%20=%200;%5Cn%5Cn%20%20%20%20%20%20updateUnseenCountHtml(channel);%5Cn%5Cn%20%20%20%20%20%20if(!tabsHeaderEl.channelDeleteBtn)%20%7B%5Cn%20%20%20%20%20%20%20%20let%20btn%20=%20tabsHeaderEl.channelDeleteBtn%20=%20document.createElement(%5C%22div%5C%22);%5Cn%20%20%20%20%20%20%20%20btn.style.cssText%20=%20%5C%22cursor:pointer;%20width:min-content;%20display:flex;%20align-items:center;%20justify-content:center;%20padding-right:0.6rem;%20padding-left:0.1rem;%5C%22;%5Cn%20%20%20%20%20%20%20%20btn.innerHTML%20=%20%5C%22%F0%9F%97%91%EF%B8%8F%5C%22;%5Cn%20%20%20%20%20%20%20%20btn.onclick%20=%20function()%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20let%20channel%20=%20this.dataset.channelToDelete;%5Cn%20%20%20%20%20%20%20%20%20%20if(confirm(%60Hide/unpin%20the%20'$%7Bchannel%7D'%20channel?%60))%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20deleteCommentsChannel(channel);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20showTabByChannelName(tabsHeaderEl.querySelector('.tabbed-comments-plugin-channel-tab').dataset.channel);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20btn.style.display%20=%20%5C%22none%5C%22;%5Cn%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%7D;%5Cn%20%20%20%20%20%20%7D%5Cn%5Cn%20%20%20%20%20%20//%20add%20delete%20button%20if%20it's%20not%20a%20main%20channel:%5Cn%20%20%20%20%20%20if(channel%20!==%20%5C%22%5C%22%20&&%20!commentsChannels.selectAll.map(c%20=%3E%20c.getName).includes(channel))%20%7B%5Cn%20%20%20%20%20%20%20%20let%20btn%20=%20tabsHeaderEl.channelDeleteBtn;%5Cn%20%20%20%20%20%20%20%20btn.style.display%20=%20%5C%22flex%5C%22;%5Cn%20%20%20%20%20%20%20%20btn.dataset.channelToDelete%20=%20channel;%5Cn%20%20%20%20%20%20%20%20activeTab.after(btn);%5Cn%20%20%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20%20%20tabsHeaderEl.channelDeleteBtn.style.display%20=%20%5C%22none%5C%22;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20if(panelOpts.onShowTab)%20panelOpts.onShowTab(%7Bchannel%7D);%5Cn%20%20%20%20%7D%5Cn%5Cn%20%20%20%20//%20Adds%20a%20new%20tab%20to%20the%20module%5Cn%20%20%20%20function%20addTab(commentOptions)%20%7B%5Cn%20%20%20%20%5Cn%20%20%20%20%20%20commentOptions.width%20=%20%5C%22100%25%5C%22;%5Cn%20%20%20%20%20%20commentOptions.height%20=%20%5C%22100%25%5C%22;%20//%20only%20makes%20sense%20to%20set%20height%20via%20defaultChannelOptions,%20and%20that%20controls%20overall%20comments%20container%20height%5Cn%20%20%20%20%20%20if(!commentOptions.customEmojis)%20commentOptions.customEmojis%20=%20defaultChannelOptions.customEmojis%20%7C%7C%20defaultCustomEmojis;%5Cn%20%20%20%20%20%20commentOptions.forceColorScheme%20=%20defaultChannelOptions.forceColorScheme%20??%20localStorage.forceColorScheme%20??%20null;%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20let%20originalOnCommentHandler%20=%20commentOptions.onComment%20%7C%7C%20defaultChannelOptions.onComment;%5Cn%20%20%20%20%20%20let%20originalOnLoadHandler%20=%20commentOptions.onLoad%20%7C%7C%20defaultChannelOptions.onLoad%5Cn%20%20%20%20%20%20commentOptions.onComment%20=%20function(...args)%20%7B%5Cn%20%20%20%20%20%20%20%20commentsPluginOnCommentHandler(...args);%20//%20for%20counting%20unseen,%20channel%20mentions,%20etc.%5Cn%20%20%20%20%20%20%20%20try%20%7B%20if(originalOnCommentHandler)%20originalOnCommentHandler(...args);%20%7D%20catch(e)%20%7B%20console.error(e)%20%7D%20//%20userland%20code%5Cn%20%20%20%20%20%20%7D;%5Cn%20%20%20%20%20%20commentOptions.onLoad%20=%20function(...args)%20%7B%5Cn%20%20%20%20%20%20%20%20commentsPluginOnLoadHandler(...args);%20//%20for%20counting%20unseen,%20channel%20mentions,%20etc.%5Cn%20%20%20%20%20%20%20%20try%20%7B%20if(originalOnLoadHandler)%20originalOnLoadHandler(...args);%20%20%7D%20catch(e)%20%7B%20console.error(e)%20%7D%20//%20userland%20code%5Cn%20%20%20%20%20%20%7D;%5Cn%20%20%20%20%5Cn%20%20%20%20%20%20commentOptions.replacedDuringUpdate%20=%20true;%20//%20needed%20to%20allow%20multiple%20instances%20of%20the%20same%20channel%20(since%20we%20have%20multiple%20tabbed-comments-modules)%5Cn%20%20%20%20%20%20for(let%20key%20of%20defaultChannelOptions.getAllKeys%20%7C%7C%20Object.keys(defaultChannelOptions))%20%7B%5Cn%20%20%20%20%20%20%20%20if(!commentOptions%5Bkey%5D%20&&%20!commentOptions.hasOwnProperty(key))%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20//%20getter,%20because%20the%20default%20options%20could%20be%20dynamic%20(e.g.%20dark/light%20mode%20using%20localStorage),%20and%20this%20createTabbedCommentsPanel%20function%20is%20(as%20of%20writing)%20called%20every%20time%20the%20dark/light%20mode%20is%20switched.%5Cn%20%20%20%20%20%20%20%20%20%20Object.defineProperty(commentOptions,%20key,%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20get:%20()%20=%3E%20defaultChannelOptions%5Bkey%5D,%5Cn%20%20%20%20%20%20%20%20%20%20%7D);%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20let%20commentsPluginOutput%20=%20commentsPlugin(commentOptions);%5Cn%20%20%20%20%20%20commentsChannelNameToObj%5BcommentOptions.channel%5D%20=%20commentsPluginOutput;%5Cn%5Cn%20%20%20%20%20%20const%20tab%20=%20document.createElement('div');%5Cn%20%20%20%20%20%20tab.className%20=%20'tabbed-comments-plugin-tab%20tabbed-comments-plugin-channel-tab';%20//%20note%20that%20non-channel%20tabs/buttons%20are%20possible%20-%20e.g.%20close%20tab%20button,%20close%20panel%20button%5Cn%20%20%20%20%20%20tab.textContent%20=%20commentOptions.label%20%7C%7C%20commentOptions.channel%20%7C%7C%20%5C%22general%5C%22;%5Cn%20%20%20%20%20%20tab.innerHTML%20+=%20%60%3Cspan%20class=%5C%22tabbed-comments-plugin-unseen-count%5C%22%3E?%3C/span%3E%60;%5Cn%20%20%20%20%20%20tab.dataset.channel%20=%20commentOptions.channel;%5Cn%5Cn%20%20%20%20%20%20const%20tabContent%20=%20document.createElement('div');%5Cn%20%20%20%20%20%20tabContent.className%20=%20'tabbed-comments-plugin-content';%5Cn%20%20%20%20%20%20tabContent.innerHTML%20=%20commentsPluginOutput;%5Cn%20%20%20%20%20%20tabContent.dataset.channel%20=%20commentOptions.channel;%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20//%20for%20refreshing%20the%20comments%20if%20needed%20(e.g.%20when%20dark/light%20mode%20changes%20-%20see%20updateColorScheme%20function)%5Cn%20%20%20%20%20%20tabContent.dataset.tabbedCommentsDirectParentOfCommentsPluginOutput%20=%20%5C%221%5C%22;%5Cn%20%20%20%20%20%20tabContent.__commentOptionsUsed%20=%20commentOptions;%20//%20this%20should%20probably%20not%20be%20'concrete'%20ones%20because%20we%20want%20a%20reference%20to%20the%20dynamic%20onces%20for%20if/when%20we%20need%20to%20reload%20it%5Cn%5Cn%20%20%20%20%20%20tabsHeaderEl.appendChild(tab);%5Cn%20%20%20%20%20%20tabsContentEl.appendChild(tabContent);%5Cn%20%20%20%20%20%20return%20%7Btab,%20tabContent%7D;%5Cn%20%20%20%20%7D%5Cn%5Cn%20%20%20%20let%20existingChannelNames%20=%20%5B%5D;%5Cn%20%20%20%20let%20channelNameToChannelData%20=%20%7B%7D;%5Cn%20%20%20%20for(let%20commentOptions%20of%20commentsChannels.selectAll)%20%7B%5Cn%20%20%20%20%20%20if(!commentOptions.channel)%20commentOptions.channel%20=%20commentOptions.getName===%5C%22general%5C%22%20?%20%5C%22%5C%22%20:%20commentOptions.getName;%20//%20use%20name%20of%20commentOptions%20object%20as%20channel%20name%20by%20default%5Cn%20%20%20%20%20%20let%20channelName%20=%20commentOptions.channel.toString();%5Cn%20%20%20%20%20%20let%20%7Btab,%20tabContent%7D%20=%20addTab(commentOptions);%5Cn%20%20%20%20%20%20channelNameToChannelData%5BchannelName%5D%20=%20%7Btab,%20tabContent,%20channelName%7D;%5Cn%20%20%20%20%20%20existingChannelNames.push(channelName);%5Cn%20%20%20%20%7D%5Cn%5Cn%20%20%20%20//%20Add%20the%20%5C%22+%5C%22%20button:%5Cn%20%20%20%20if(commentsChannels.allowCustomChannels%20!==%20false)%20%7B%5Cn%5Cn%20%20%20%20%20%20//%20add%20user-specified%20custom%20channels:%5Cn%20%20%20%20%20%20if(!localStorage.__tabbedCommentsPluginCustomChannels)%20localStorage.__tabbedCommentsPluginCustomChannels%20=%20%5C%22%7B%7D%5C%22;%5Cn%20%20%20%20%20%20let%20customChannels%20=%20%7B%7D;%5Cn%20%20%20%20%20%20try%20%7B%20customChannels%20=%20JSON.parse(localStorage.__tabbedCommentsPluginCustomChannels)%20%7D%20catch(e)%20%7B%20console.error(%5C%22Failed%20to%20parse%20custom%20channels%20from%20localStorage:%5C%22,%20e);%20%7D%5Cn%20%20%20%20%20%20for(let%20commentOptions%20of%20Object.values(customChannels))%20%7B%5Cn%20%20%20%20%20%20%20%20if(existingChannelNames.includes(commentOptions.channel))%20continue;%20//%20already%20got%20that%20channel%5Cn%20%20%20%20%20%20%20%20let%20channelName%20=%20commentOptions.channel.toString();%5Cn%20%20%20%20%20%20%20%20let%20%7Btab,%20tabContent%7D%20=%20addTab(commentOptions);%5Cn%20%20%20%20%20%20%20%20channelNameToChannelData%5BchannelName%5D%20=%20%7Btab,%20tabContent,%20channelName%7D;%5Cn%5Cn%20%20%20%20%20%20%20%20if(temporaryMentionedChannels.has(channelName))%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20tab.dataset.tabbedCommentsPluginIsTemporaryMentionedChannel%20=%20%5C%221%5C%22;%5Cn%20%20%20%20%20%20%20%20%20%20attachEventsToTemporaryMentionedChannelTab(tab,%20channelName);%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20//%20add%20the%20%5C%22+%5C%22%20button:%5Cn%20%20%20%20%20%20const%20tab%20=%20document.createElement('div');%5Cn%20%20%20%20%20%20tab.className%20=%20'tabbed-comments-plugin-tab%20tabbed-comments-plugin-add-custom-channel';%5Cn%20%20%20%20%20%20tab.textContent%20=%20%5C%22+%5C%22;%5Cn%20%20%20%20%20%20tab.style.cssText%20=%20%5C%22min-width:1.4rem;%5C%22;%5Cn%20%20%20%20%20%20tabsHeaderEl.appendChild(tab);%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20//%20add%20the%20close-panel%20button%20if%20needed:%5Cn%20%20%20%20%7B%5Cn%20%20%20%20%20%20const%20tab%20=%20document.createElement('div');%5Cn%20%20%20%20%20%20tab.className%20=%20'tabbed-comments-plugin-tab%20tabbed-comments-plugin-close-panel-btn';%5Cn%20%20%20%20%20%20tab.textContent%20=%20%5C%22%E2%9D%8C%5C%22;%5Cn%20%20%20%20%20%20tab.title%20=%20%5C%22Close%20this%20panel%5C%22;%5Cn%20%20%20%20%20%20//%20NOTE:%20rather%20than%20not%20adding%20the%20button,%20or%20using%20display:none;%20we%20just%20remove%20it's%20width%20+%20opacity%20+%20pointer-events,%20because%20otherwise%20the%20height%20of%20the%20header%20can%20change%20due%20to%20emoji%20font%20size,%20which%20vertically%20offsets%20the%20panels%20by%20a%20pixel%20or%20two,%20which%20looks%20bad.%5Cn%20%20%20%20%20%20tab.style.cssText%20=%20panelOpts.addCloseButton%20?%20%5C%22min-width:1.4rem;%5C%22%20:%20%5C%22width:0px;%20max-width:0px;%20pointer-events:none;%20margin-left:0;%20margin-right:0;%20padding-left:0;%20padding-right:0;%20min-width:0px;%20opacity:0;%5C%22;%5Cn%20%20%20%20%20%20tab.onclick%20=%20function()%20%7B%5Cn%20%20%20%20%20%20%20%20panelCtn.remove();%5Cn%20%20%20%20%20%20%20%20if(panelOpts.onClose)%20panelOpts.onClose();%5Cn%20%20%20%20%20%20%7D;%5Cn%20%20%20%20%20%20tabsHeaderEl.prepend(tab);%5Cn%20%20%20%20%7D%5Cn%5Cn%20%20%20%20let%20defaultStartChannelIndex%20=%200;%5Cn%5Cn%20%20%20%20let%20activeChannelData%20=%20channelNameToChannelData%5BlocalStorage.__tabbedCommentsPluginLastViewedChannel%20??%20existingChannelNames%5BdefaultStartChannelIndex%5D%5D;%5Cn%20%20%20%20if(!activeChannelData)%20%7B%5Cn%20%20%20%20%20%20console.error(%5C%22localstorage%20had%20__tabbedCommentsPluginLastViewedChannel,%20but%20that%20channel%20doesn't%20exist?%5C%22);%5Cn%20%20%20%20%20%20activeChannelData%20=%20channelNameToChannelData%5BexistingChannelNames%5B0%5D%5D;%5Cn%20%20%20%20%7D%5Cn%5Cn%20%20%20%20setTimeout(async%20()%20=%3E%20%7B%5Cn%20%20%20%20%20%20while(!document.body.contains(panelCtn))%20await%20new%20Promise(r%20=%3E%20setTimeout(r,%20100));%5Cn%20%20%20%20%20%20showTabByChannelName(activeChannelData.channelName);%5Cn%20%20%20%20%7D,%2010);%5Cn%5Cn%20%20%20%20tabsHeaderEl.addEventListener('click',%20handleTabClick);%5Cn%5Cn%20%20%20%20let%20styleEl%20=%20document.createElement(%5C%22style%5C%22);%5Cn%20%20%20%20styleEl.textContent%20=%20%60%5Cn%20%20%20%20%20%20.tabbed-comments-plugin-header%20%7B%5Cn%20%20%20%20%20%20%20%20display:%20flex;%5Cn%20%20%20%20%20%20%20%20font-size:%2070%25;%5Cn%20%20%20%20%20%20%20%20overflow:auto;%5Cn%20%20%20%20%20%20%20%20color:var(--tabbed-comments-plugin-text-color);%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20.tabbed-comments-plugin-body%20%7B%5Cn%20%20%20%20%20%20%20%20flex-grow:1;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20.tabbed-comments-plugin-tab%20%7B%5Cn%20%20%20%20%20%20%20%20padding:%200.25rem;%5Cn%20%20%20%20%20%20%20%20cursor:%20pointer;%5Cn%20%20%20%20%20%20%20%20background:%20var(--tabbed-comments-plugin-box-color,%20#ebebeb);%5Cn%20%20%20%20%20%20%20%20border-radius:%200.25rem;%5Cn%20%20%20%20%20%20%20%20margin:%200.25rem;%5Cn%20%20%20%20%20%20%20%20user-select:%20none;%5Cn%20%20%20%20%20%20%20%20min-width:%20max-content;%5Cn%20%20%20%20%20%20%20%20display:%20flex;%5Cn%20%20%20%20%20%20%20%20align-items:%20center;%5Cn%20%20%20%20%20%20%20%20justify-content:%20center;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20.tabbed-comments-plugin-tab%5Bdata-tabbed-comments-plugin-is-temporary-mentioned-channel='1'%5D%20%7B%5Cn%20%20%20%20%20%20%20%20opacity:0.6;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20.tabbed-comments-plugin-unseen-count%20%7B%5Cn%20%20%20%20%20%20%20%20border-radius:%20100px;%5Cn%20%20%20%20%20%20%20%20padding:%200.05rem%200.15rem;%5Cn%20%20%20%20%20%20%20%20font-size:80%25;%5Cn%20%20%20%20%20%20%20%20background:grey;%5Cn%20%20%20%20%20%20%20%20margin-left:%200.1rem;%5Cn%20%20%20%20%20%20%20%20pointer-events:none;%5Cn%20%20%20%20%20%20%20%20color:white;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20.tabbed-comments-plugin-active-tab%20%7B%5Cn%20%20%20%20%20%20%20%20background:%20var(--tabbed-comments-plugin-active-comment-channel-tab-color,%20#c6c6c6);%5Cn%20%20%20%20%20%20%20%20outline:%202px%20solid%20#0086c9;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20.tabbed-comments-plugin-content%20%7B%5Cn%20%20%20%20%20%20%20%20display:%20none;%5Cn%20%20%20%20%20%20%20%20height:100%25;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20.tabbed-comments-plugin-active-content%20%7B%5Cn%20%20%20%20%20%20%20%20display:%20block;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20@media%20only%20screen%20and%20(max-width:%20650px)%20%7B%5Cn%20%20%20%20%20%20%20%20.tabbed-comments-auto-comment-ctn%20%7B%20flex-direction:column;%20%7D%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20.tabbed-comments-ctn-left%20%7B%20display:none;%20%7D%5Cn%20%20%20%20%20%20.tabbed-comments-ctn-right%20%7B%20display:none;%20%7D%5Cn%20%20%20%20%20%20$%7BCSS.supports(%5C%22container-type%5C%22,%20%5C%22inline-size%5C%22)%20?%20%60@container%60%20:%20%60@media%20only%20screen%20and%60%7D%20(min-width:%201100px)%20%7B%5Cn%20%20%20%20%20%20%20%20.tabbed-comments-ctn-left%20%7B%20display:flex;%20%7D%5Cn%20%20%20%20%20%20%20%20.tabbed-comments-ctn-right%20%7B%20display:flex;%20%7D%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%60;%5Cn%20%20%20%20panelCtn.append(styleEl);%5Cn%20%20%20%20panelCtn.style.cssText%20=%20%5C%22height:100%25;%20width:100%25;%20display:flex;%20flex-direction:column;%5C%22%5Cn%20%20%20%20return%20%7Belement:panelCtn,%20addCommentsChannel,%20deleteCommentsChannel,%20commentsChannelNameToObj%7D;%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20middlePanelObj%20=%20createTabbedCommentsPanel(%7B%5Cn%20%20%20%20onShowTab:%20(%7Bchannel%7D)%20=%3E%20%7B%5Cn%20%20%20%20%20%20middleCtnCurrentlyShownCommentsChannelName%20=%20channel;%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20let%20channelData%20=%20commentsChannels%5Bchannel%20%7C%7C%20%5C%22general%5C%22%5D;%5Cn%20%20%20%20%20%20if(!channelData)%20channelData%20=%20defaultChannelOptions;%5Cn%20%20%20%20%20%20let%20allowBots%20=%20channelData.allowBots;%5Cn%20%20%20%20%20%20if(channel%20===%20%5C%22%5C%22%20%7C%7C%20channel%20===%20%5C%22general%5C%22%20%7C%7C%20opts.allowBots%20===%20false)%20%7B%5Cn%20%20%20%20%20%20%20%20if(allowBots%20===%20undefined)%20allowBots%20=%20false;%20//%20by%20default,%20don't%20allow%20bots%20on%20main/general/chat%20channel%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20autoCommentCtn.style.display%20=%20%5C%22none%5C%22;%5Cn%20%20%20%20%20%20if(allowBots%20!==%20false)%20%7B%5Cn%20%20%20%20%20%20%20%20showAutoCommentAreaBtn.style.display%20=%20%5C%22%5C%22;%5Cn%20%20%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20%20%20showAutoCommentAreaBtn.style.display%20=%20%5C%22none%5C%22;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%7D,%5Cn%20%20%7D);%5Cn%20%20middleCtnChannelNameToObj%20=%20middlePanelObj.commentsChannelNameToObj;%5Cn%20%20middleCtn.appendChild(middlePanelObj.element);%5Cn%20%20return%20outerCtn;%22,%22imports%22:%5B%22ai-text-plugin%22,%22comments-plugin%22,%22huge-emoji-list%22%5D,%22lastEditTime%22:1751108433934,%22found%22:true%7D,%7B%22name%22:%22text-to-image-plugin%22,%22modelText%22:%22%5Cn//%20NOTE%20TO%20SELF:%20If%20you%20add%20more%20properties,%20make%20sure%20you%20add%20to%20the%20regex%20below,%20and%20the%20variable%20declarations%20in%20each%20'branch'%5Cn%5Cn(data,%20opts)%20=%3E%5Cn%20%20if(data%20===%20undefined)%20return%20%5C%22(Error:%20you've%20input%20an%20empty%20value/variable%20into%20the%20text-to-image-plugin)%5C%22;%5Cn%5Cn%20%20//%20Allow%20for%20%60await%20generateImage(%5C%22a%20cute%20cat%5C%22,%20%7Bresolution:%5C%22512x768%5C%22,%20removeBackground:true%7D)%60%20type%20usage%5Cn%20%20if(opts%20&&%20typeof%20opts%20===%20%5C%22object%5C%22)%20%7B%5Cn%20%20%20%20opts.prompt%20=%20data;%5Cn%20%20%20%20data%20=%20opts;%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20//%20if(options%20===%20undefined)%20options%20=%20%7B%7D;%5Cn%20%20%5Cn%20%20let%20serverOrigin%20=%20%5C%22https://image-generation.perchance.org%5C%22;%5Cn%20%20%5Cn%20%20let%20evaluatedInputs;%5Cn%20%20%5Cn%20%20//%20This%20is%20used%20for%20the%20heart-button%20gallery.%20It's%20a%20bit%20hacky,%20but%20most%20often%20devs%20will%20want%20the%20%5C%22open%20gallery%5C%22%20button%20to%20show%20a%20gallery%20with%20e.g.%20the%20same%20moderation%20options%20as%20the%20gallery%20that%20they've%20displayed%20on%20the%20page,%20if%20any.%5Cn%20%20window.lastUsedTextToImagePluginGalleryIframeUrl%20=%20null;%5Cn%20%20%5Cn%20%20let%20shouldRemoveIframeOnFinish%20=%20false;%20//%20for%20the%20case%20where%20the%20iframe%20was%20added%20automatically%20-%20i.e.%20when%20called%20like:%20%20%60let%20result%20=%20await%20image(%7Bprompt:%5C%22a%20cute%20mouse%5C%22%7D)%60%5Cn%5Cn%20%20let%20galleryOptionsHash%20=%20null;%20//%20only%20used%20if%20this%20is%20a%20gallery%20call%5Cn%5Cn%20%20////////////////////////////////////////////////%5Cn%20%20//%20%20%20%20%20%20%20set%20up%20handler%20for%20gallery%20%20%20%20%20%20%20%20%20%20%20//%5Cn%20%20////////////////////////////////////////////////%5Cn%20%20let%20pluginData;%5Cn%20%20if(!window.___textToImagePluginData98420274)%20%7B%5Cn%20%20%20%20window.addEventListener(%5C%22message%5C%22,%20function(e)%20%7B%5Cn%20%20%20%20%20%20let%20origin%20=%20e.origin%20%7C%7C%20e.originalEvent.origin;%5Cn%20%20%20%20%20%20if(origin%20!==%20serverOrigin)%20%7B%5Cn%20%20%20%20%20%20%20%20return;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20if(e.data.openGallerySignal)%20%7B%5Cn%20%20%20%20%20%20%20%20let%20ctn%20=%20document.createElement(%5C%22div%5C%22);%5Cn%20%20%20%20%20%20%20%20let%20subChannelName%20=%20e.data.subChannelName;%5Cn%20%20%20%20%20%20%20%20let%20url;%5Cn%20%20%20%20%20%20%20%20if(window.lastUsedTextToImagePluginGalleryIframeUrl)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20url%20=%20new%20URL(window.lastUsedTextToImagePluginGalleryIframeUrl);%5Cn%20%20%20%20%20%20%20%20%20%20url.searchParams.set(%5C%22subChannelName%5C%22,%20subChannelName);%5Cn%20%20%20%20%20%20%20%20%20%20url%20=%20url.href;%5Cn%20%20%20%20%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20url%20=%20%60$%7BserverOrigin%7D/gallery?channel=$%7Bwindow.generatorName%7D&subChannel=$%7BencodeURIComponent(subChannelName)%7D&sort=trending&timeRange=1-month&contentFilter=pg13%60;%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20let%20backgroundColor%20=%20window.matchMedia%20&&%20window.matchMedia('(prefers-color-scheme:%20dark)').matches%20?%20%5C%22#242424%5C%22%20:%20%5C%22white%5C%22;%5Cn%20%20%20%20%20%20%20%20ctn.innerHTML%20=%20%60%3Cdiv%20onclick=%5C%22this.remove()%5C%22%20style=%5C%22backdrop-filter:brightness(0.3);position:fixed;top:0;left:0;right:0;bottom:0;z-index:999;%5C%22%3E%3Cdiv%20style=%5C%22position:fixed;top:5vh;bottom:5vh;left:5vh;right:5vh;background:$%7BbackgroundColor%7D;border-radius:3px;%5C%22%3E%3Ciframe%20src=%5C%22$%7Burl%7D%5C%22%20style=%5C%22border:0;width:100%25;height:100%25;%5C%22%3E%3C/iframe%3E%3C/div%3E%3C/div%3E%60;%5Cn%20%20%20%20%20%20%20%20document.body.appendChild(ctn.firstElementChild);%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20if(e.data.savedImageToGallerySignal)%20%7B%5Cn%20%20%20%20%20%20%20%20document.querySelectorAll(%5C%22.text-to-image-plugin-gallery%5C%22).forEach(el%20=%3E%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20let%20targetOrigin%20=%20serverOrigin;%5Cn%20%20%20%20%20%20%20%20%20%20el.contentWindow.postMessage(%7BdoRefreshIfSortingByRecent:true%7D,%20targetOrigin);%5Cn%20%20%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20%20%20//%20the%20code%20below%20is%20commented%20out%20because%20it%20doesn't%20work%20for%20the%20case%20where%20the%20user%20has%20switched%20the%20sort%20to%20recent%20(since,%20counter-intuitively,%20iframe's%20window.location%20can%20change,%20while%20iframe.src%20stays%20as%20the%20original%20value%20-%20I'm%20assuming%20this%20is%20due%20to%20cross-origin%20security%20stuff)%5Cn%20%20%20%20%20%20%20%20%20%20//%20if(el.src.includes(%5C%22sort=recent%5C%22))%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20//%20%20%20//%20refresh%20galleries%20that%20are%20sorted%20by%20recent%20if%20the%20user%20makes%20a%20submission%5Cn%20%20%20%20%20%20%20%20%20%20//%20%20%20let%20url%20=%20new%20URL(el.src);%5Cn%20%20%20%20%20%20%20%20%20%20//%20%20%20url.searchParams.set(%5C%22cacheBust%5C%22,%20Math.random().toString());%5Cn%20%20%20%20%20%20%20%20%20%20//%20%20%20el.src%20=%20%5C%22%5C%22;%20//%20we%20do%20this%20instead%20of%20el.src=el.src%20because%20that%20doesn't%20work%20if%20the%20URL%20has%20a%20hash%20in%20it,%20and%20I%20might%20need%20to%20add%20data%20in%20the%20hash%20later%5Cn%20%20%20%20%20%20%20%20%20%20//%20%20%20setTimeout(()%20=%3Eel.src=url.href,%20700);%20//%20we%20need%20to%20wait%20a%20bit%20for%20the%20iframe%20to%20actually%20initiate%20a%20reload/refresh%20before%20setting%20the%20src%20again%5Cn%20%20%20%20%20%20%20%20%20%20//%20%7D%5Cn%20%20%20%20%20%20%20%20%7D);%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20if(e.data.documentHeightChanged)%20%7B%5Cn%20%20%20%20%20%20%20%20document.querySelectorAll(%5C%22.text-to-image-plugin-gallery%5C%22).forEach(el%20=%3E%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20if(el.dataset.adaptiveHeight%20===%20%5C%22yes%5C%22)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20el.style.height%20=%20(e.data.newHeight+1)+%5C%22px%5C%22;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20console.debug(%5C%22Updated%20gallery%20height%5C%22,%20e.data.newHeight);%5Cn%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%7D);%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20if(e.data.customButtonClickEvent)%20%7B%5Cn%20%20%20%20%20%20%20%20if(e.data.isButton2)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20let%20handlerFn%20=%20pluginData.galleryCustomButton2ClickHandlers%5Be.data.galleryInstanceId%5D;%5Cn%20%20%20%20%20%20%20%20%20%20if(handlerFn)%20handlerFn(e.data.onClickHandlerData);%5Cn%20%20%20%20%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20let%20handlerFn%20=%20pluginData.galleryCustomButtonClickHandlers%5Be.data.galleryInstanceId%5D;%5Cn%20%20%20%20%20%20%20%20%20%20if(handlerFn)%20handlerFn(e.data.onClickHandlerData);%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%7D);%5Cn%20%20%20%20window.___textToImagePluginData98420274%20=%20%7B%5Cn%20%20%20%20%20%20galleryCustomButtonClickHandlers:%20%7B%7D,%5Cn%20%20%20%20%20%20galleryCustomButton2ClickHandlers:%20%7B%7D,%5Cn%20%20%20%20%7D;%5Cn%20%20%7D%5Cn%20%20pluginData%20=%20window.___textToImagePluginData98420274;%5Cn%20%20%5Cn%20%20if(data.gallery)%20%7B%5Cn%20%20%20%20//%20NOTE:%20this%20is%20a%20somewhat%20'breaking'%20change,%20but%20I'm%20no%20longer%20allowing%20unfiltered%20content%20to%20be%20shown%20by%20default.%5Cn%20%20%20%20//%20The%20user%20must%20specifically%20choose%20to%20switch%20the%20gallery%20to%20unfiltered%20mode.%5Cn%20%20%20%20data.contentFilter%20=%20%5C%22pg13%5C%22;%5Cn%20%20%5Cn%20%20%20%20let%20sort%20=%20data.sort%20?%20data.sort.evaluateItem%20:%20%5C%22recent%5C%22;%5Cn%20%20%20%20if(sort%20===%20%5C%22best%5C%22)%20sort%20=%20%5C%22top%5C%22;%20//%20alias%5Cn%20%20%20%20%5Cn%20%20%20%20let%20contentFilter%20=%20data.contentFilter%20?%20data.contentFilter.evaluateItem.toLowerCase()%20:%20%5C%22pg13%5C%22;%5Cn%20%20%20%20if(contentFilter%20===%20%5C%22pg-13%5C%22)%20contentFilter%20=%20%5C%22pg13%5C%22;%5Cn%20%20%20%20%5Cn%20%20%20%20let%20bannedUsers%20=%20data.bannedUsers%20?%20data.bannedUsers.selectAll.map(item%20=%3E%20item.toString())%20:%20%5B%5D;%5Cn%20%20%20%20let%20bannedPromptPhrases%20=%20data.bannedPromptPhrases%20?%20data.bannedPromptPhrases.selectAll.map(item%20=%3E%20item.getRawListText.replace(%5C%22/%5C%5C%5C%5C%5E%5C%22,%20%5C%22/%5E%5C%22))%20:%20%5B%5D;%5Cn%20%20%20%20let%20bannedNegativePromptPhrases%20=%20data.bannedNegativePromptPhrases%20?%20data.bannedNegativePromptPhrases.selectAll.map(item%20=%3E%20item.getRawListText.replace(%5C%22/%5C%5C%5C%5C%5E%5C%22,%20%5C%22/%5E%5C%22))%20:%20%5B%5D;%5Cn%20%20%20%20%5Cn%20%20%20%20let%20timeRange%20=%20data.timeRange%20?%20data.timeRange.evaluateItem%20:%20(sort%20===%20%5C%22recent%5C%22%20?%20%5C%22all-time%5C%22%20:%20%5C%221-month%5C%22);%5Cn%20%20%20%20let%20hideIfScoreIsBelow%20=%20data.hideIfScoreIsBelow%20!==%20undefined%20?%20Number(data.hideIfScoreIsBelow.evaluateItem)%20:%20-1000000000;%5Cn%20%20%20%20if(isNaN(hideIfScoreIsBelow))%20hideIfScoreIsBelow%20=%20-1000000000;%5Cn%20%20%20%20%5Cn%20%20%20%20let%20galleryOptions%20=%20%7Bsort,%20timeRange,%20hideIfScoreIsBelow,%20contentFilter,%20subChannel:%5C%22public%5C%22%7D;%20//%20this%20is%20also%20used%20for%20checking%20if%20gallery%20options%20have%20been%20udpated%20(see%20below)%5Cn%20%20%20%20if(data.forceColorScheme)%20galleryOptions.forceColorScheme%20=%20data.forceColorScheme;%5Cn%5Cn%20%20%20%20const%20galleryInstanceId%20=%20%5C%22galleryInstanceId%5C%22+(Math.random().toString()+Math.random().toString()).replaceAll(%5C%22.%5C%22,%20%5C%22%5C%22);%5Cn%20%20%20%20%5Cn%20%20%20%20let%20customButtonEmoji%20=%20null;%5Cn%20%20%20%20let%20shouldShowCustomButton%20=%20false;%5Cn%20%20%20%20let%20customButtonOptions%20=%20data.customButton%20%7C%7C%20data.customButton1;%5Cn%20%20%20%20if(customButtonOptions)%20%7B%5Cn%20%20%20%20%20%20shouldShowCustomButton%20=%20true;%5Cn%20%20%20%20%20%20if(customButtonOptions.onClick)%20pluginData.galleryCustomButtonClickHandlers%5BgalleryInstanceId%5D%20=%20customButtonOptions.onClick;%5Cn%20%20%20%20%20%20if(customButtonOptions.emoji)%20customButtonEmoji%20=%20customButtonOptions.emoji.evaluateItem;%5Cn%20%20%20%20%7D%5Cn%5Cn%20%20%20%20let%20customButton2Emoji%20=%20null;%5Cn%20%20%20%20let%20shouldShowCustomButton2%20=%20false;%5Cn%20%20%20%20if(data.customButton2)%20%7B%5Cn%20%20%20%20%20%20shouldShowCustomButton2%20=%20true;%5Cn%20%20%20%20%20%20if(data.customButton2.onClick)%20pluginData.galleryCustomButton2ClickHandlers%5BgalleryInstanceId%5D%20=%20data.customButton2.onClick;%5Cn%20%20%20%20%20%20if(data.customButton2.emoji)%20customButton2Emoji%20=%20data.customButton2.emoji.evaluateItem;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20let%20hashData%20=%20%7BgalleryInstanceId,%20shouldShowCustomButton,%20customButtonEmoji,%20shouldShowCustomButton2,%20customButton2Emoji,%20bannedUsers,%20bannedPromptPhrases,%20bannedNegativePromptPhrases,%20injectedStyles:%7B%7D%7D;%5Cn%20%20%20%20if(data.style)%20%7B%5Cn%20%20%20%20%20%20let%20style%20=%20data.style.evaluateItem.trim();%5Cn%20%20%20%20%20%20if(style.includes(%5C%22background:%5C%22))%20%7B%5Cn%20%20%20%20%20%20%20%20hashData.injectedStyles.background%20=%20(style.match(/(?:%5E%7C;)%20*background:(.+?)(?:;%7C$)/)%20%7C%7C%20%5B%5D)%5B1%5D;%5Cn%20%20%20%20%20%20%7D%20else%20if(style.includes(%5C%22background-color:%5C%22))%20%7B%5Cn%20%20%20%20%20%20%20%20hashData.injectedStyles.background%20=%20(style.match(/(?:%5E%7C;)%20*background-color:(.+?)(?:;%7C$)/)%20%7C%7C%20%5B%5D)%5B1%5D;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20let%20otherUrlParams%20=%20%7Bchannel:window.generatorName%7D;%5Cn%20%20%20%20let%20iframeUrl%20=%20new%20URL(%60$%7BserverOrigin%7D/gallery%60);%5Cn%20%20%20%20Object.entries(galleryOptions).forEach((%5Bkey,%20value%5D)%20=%3E%20iframeUrl.searchParams.set(key,%20value));%5Cn%20%20%20%20Object.entries(otherUrlParams).forEach((%5Bkey,%20value%5D)%20=%3E%20iframeUrl.searchParams.set(key,%20value));%5Cn%20%20%20%20%5Cn%20%20%20%20%5Cn%20%20%20%20function%20makeGalleryIframeHtml()%20%7B%5Cn%20%20%20%20%20%20let%20url%20=%20iframeUrl.href%20+%20%60#data=$%7BencodeURIComponent(JSON.stringify(hashData))%7D%60;%5Cn%20%20%20%20%20%20window.lastUsedTextToImagePluginGalleryIframeUrl%20=%20url;%5Cn%20%20%20%20%20%20return%20%60%3Ciframe%20data-gallery-options=%5C%22$%7BencodeURIComponent(JSON.stringify(galleryOptions))%7D%5C%22%20data-adaptive-height=%5C%22$%7Bdata.adaptiveHeight%20?%20%5C%22yes%5C%22%20:%20%5C%22no%5C%22%7D%5C%22%20style=%5C%22width:100%25;%20height:70vh;%20border:none;%20$%7Bdata.style%20%7C%7C%20%5C%22%5C%22%7D%5C%22%20class=%5C%22text-to-image-plugin-gallery%5C%22%20src=%5C%22$%7Burl%7D%5C%22%20allow=%5C%22clipboard-write%5C%22%3E%3C/iframe%3E%60;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20if(!document.querySelector(%5C%22.text-to-image-plugin-gallery%5C%22))%20%7B%5Cn%20%20%20%20%20%20setTimeout(()%20=%3E%20%7B%5Cn%20%20%20%20%20%20%20%20let%20marker%20=%20document.querySelector(%5C%22#temporaryMarkerElForTextToImageGallery84738932%5C%22);%5Cn%20%20%20%20%20%20%20%20if(marker)%20marker.outerHTML%20=%20makeGalleryIframeHtml()%5Cn%20%20%20%20%20%20%7D,%2050);%5Cn%20%20%20%20%20%20return%20%60%3Cspan%20id=%5C%22temporaryMarkerElForTextToImageGallery84738932%5C%22%3E%3C/span%3E%60;%5Cn%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20//%20update%20any%20gallery%20parameters%20if%20they%20have%20been%20changed:%5Cn%20%20%20%20%20%20let%20galleryIframe%20=%20document.querySelector(%5C%22.text-to-image-plugin-gallery%5C%22);%5Cn%20%20%20%20%20%20let%20newGalleryOptionsText%20=%20encodeURIComponent(JSON.stringify(galleryOptions));%5Cn%20%20%20%20%20%20if(galleryIframe.dataset.galleryOptions%20!==%20newGalleryOptionsText)%20%7B%5Cn%20%20%20%20%20%20%20%20galleryIframe.outerHTML%20=%20makeGalleryIframeHtml();%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20return%20%5C%22%5C%22;%5Cn%20%20%20%20%7D%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20%5Cn%20%20%5Cn%20%20%5Cn%20%20%5Cn%20%20///////////////////////////////////////////////////////////////////////////////////////%5Cn%20%20//%20%20%20%20%20%20%20%20%20%20%20%20%20%20parse%20and%20evaluate%20prompt%20data/options%20from%20input%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%5Cn%20%20///////////////////////////////////////////////////////////////////////////////////////%5Cn%20%20const%20defaultGuidanceScale%20=%207;%5Cn%20%20%5Cn%20%20let%20d%20=%20%7B%7D;%20%5Cn%20%20//%20let%20dataInputWasNotAnOptionsObject%20=%20false;%5Cn%20%20%5Cn%20%20if(data.prompt%20===%20undefined)%20%7B%5Cn%20%20%20%20d.prompt%20=%20data.evaluateItem.toString();%20//%20they%20passed%20in%20some%20text%20directly%20like%20%5Bimage(%5C%22a%20carrot%5C%22)%5D%5Cn%20%20%7D%20else%20%7B%5Cn%20%20%20%20d.prompt%20=%20data.prompt.evaluateItem.toString();%5Cn%20%20%7D%5Cn%20%20//%20Apply%20some%20covenience%20fixes%20to%20the%20prompt,%20even%20though%20the%20plugin%20user%20should%20ideally%20fix%20this%20on%20their%20end:%5Cn%20%20d.prompt%20=%20d.prompt.replace(/%3Cspan%20%5B%5E%3E%5D+______tippy-tooltip-%5B%5E%3E%5D+%3E(.+?)%3C%5C%5C/span%3E/,%20%5C%22%5C%22);%5Cn%20%20%5Cn%20%20//%20parse%20values%20from%20prompts%20like:%20%60this%20is%20the%20prompt%20text%20(size:::400)%20(resolution:::512x768)%20(guidanceScale:::10)%60%5Cn%20%20if(d.prompt.includes(%5C%22:::%5C%22))%20%7B%5Cn%20%20%20%20let%20matches%20=%20%5B...d.prompt.matchAll(/%5C%5C((seed%7Csize%7Cstyle%7Cresolution%7Cwidth%7Cheight%7CguidanceScale%7CsaveTitle%7CsaveDescription)%5C%5C:%5C%5C:%5C%5C:/g)%5D;%5Cn%20%20%20%20//%20console.debug(%5C%22matches:%5C%22,%20matches);%5Cn%20%20%20%20const%20numericProps%20=%20%5B%5C%22seed%5C%22,%20%5C%22width%5C%22,%20%5C%22height%5C%22,%20%5C%22guidanceScale%5C%22,%20%5C%22width%5C%22,%20%5C%22height%5C%22,%20%5C%22size%5C%22%5D;%5Cn%20%20%20%20for(let%20match%20of%20matches)%20%7B%5Cn%20%20%20%20%20%20let%20re%20=%20new%20RegExp(%60%5C%5C%5C%5C($%7Bmatch%5B1%5D%7D%5C%5C%5C%5C:%5C%5C%5C%5C:%5C%5C%5C%5C:(.+?)%5C%5C%5C%5C).*?(?:%5C%5C%5C%5C:%5C%5C%5C%5C:%5C%5C%5C%5C:%7C$)%60,%20%5C%22m%5C%22);%5Cn%20%20%20%20%20%20let%20value%20=%20(d.prompt.match(re)%20%7C%7C%20%5B%5D)%5B1%5D%5Cn%20%20%20%20%20%20let%20key%20=%20match%5B1%5D;%5Cn%20%20%20%20%20%20if(value%20!==%20undefined)%20%7B%5Cn%20%20%20%20%20%20%20%20d%5Bkey%5D%20=%20numericProps.includes(key)%20?%20Number(value)%20:%20value;%5Cn%20%20%20%20%20%20%20%20d.prompt%20=%20d.prompt.replace(%60($%7Bkey%7D:::$%7Bvalue%7D)%60,%20%5C%22%5C%22);%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%7D%5Cn%20%20%20%20d.prompt%20=%20d.prompt.trim();%5Cn%20%20%7D%5Cn%20%20if(!window.___t2i__parseNegativePrompt)%20%7B%5Cn%20%20%20%20window.___t2i__parseNegativePrompt%20=%20function(str)%20%7B%5Cn%20%20%20%20%20%20const%20prefix%20=%20'(negativePrompt:::';%5Cn%20%20%20%20%20%20const%20start%20=%20str.indexOf(prefix);%5Cn%20%20%20%20%20%20if%20(start%20===%20-1)%20return%20null;%5Cn%20%20%20%20%20%20let%20depth%20=%200;%5Cn%20%20%20%20%20%20let%20result%20=%20'';%5Cn%20%20%20%20%20%20for(let%20i%20=%20start%20+%20prefix.length;%20i%20%3C%20str.length;%20i++)%20%7B%5Cn%20%20%20%20%20%20%20%20if(str%5Bi%5D%20===%20'(')%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20depth++;%5Cn%20%20%20%20%20%20%20%20%7D%20else%20if%20(str%5Bi%5D%20===%20')')%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20if(depth%20===%200)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20break;%5Cn%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20depth--;%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20result%20+=%20str%5Bi%5D;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20return%20result;%5Cn%20%20%20%20%7D;%5Cn%20%20%7D%5Cn%20%20if(d.prompt.includes(%5C%22(negativePrompt:::%5C%22))%20%7B%5Cn%20%20%20%20let%20result%20=%20window.___t2i__parseNegativePrompt(d.prompt);%5Cn%20%20%20%20if(result)%20%7B%5Cn%20%20%20%20%20%20d.negativePrompt%20=%20result;%5Cn%20%20%20%20%20%20d.prompt%20=%20d.prompt.replace(%60(negativePrompt:::$%7Bd.negativePrompt%7D)%60,%20%5C%22%5C%22);%5Cn%20%20%20%20%20%20d.prompt%20=%20d.prompt.replace(%60(negativePrompt:::$%7Bd.negativePrompt%7D%60,%20%5C%22%5C%22);%20//%20since%20if%20final%20bracket%20is%20missing,%20then%20all%20following%20text%20is%20considered%20the%20negative%20prompt%5Cn%20%20%20%20%7D%5Cn%20%20%20%20d.prompt%20=%20d.prompt.trim();%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20if(!data.prompt)%20%7B%20//%20they%20passed%20in%20some%20text%20directly%20like%20%5Bimage(%5C%22a%20carrot%5C%22)%5D,%20so%20add%20some%20defaults/fallbacks.%5Cn%20%20%20%20if(d.seed%20===%20undefined)%20d.seed%20=%20-1;%5Cn%20%20%20%20if(d.width%20===%20undefined)%20d.width%20=%20300;%5Cn%20%20%20%20if(d.height%20===%20undefined)%20d.height%20=%20300;%5Cn%20%20%20%20if(d.resolution%20===%20undefined)%20d.resolution%20=%20%5C%22512x512%5C%22;%20%20%20%5Cn%20%20%20%20if(d.guidanceScale%20===%20undefined)%20d.guidanceScale%20=%20defaultGuidanceScale;%5Cn%20%20%20%20if(d.negativePrompt%20===%20undefined)%20d.negativePrompt%20=%20%5C%22%5C%22;%5Cn%20%20%20%20if(d.style%20===%20undefined)%20d.style%20=%20%5C%22%5C%22;%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20%5Cn%20%20//%20EDIT:%20Not%20going%20ahead%20with%20this%20for%20now%20in%20favor%20of%20a%20setting%20a%20global%20variable%20which%20contains%20data%20on%20the%20last-used%20prompt.%5Cn%20%20//%20//%20NOTE:%20Originally%20%60data%60%20was%20the%20only%20param%20and%20it%20could%20be%20the%20prompt,%20or%20a%20promptOptions%20object/list.%5Cn%20%20//%20//%20But%20I%20realised%20that%20it's%20not%20very%20ergonomic%20(see%20e.g.%20reddit.com/r/perchance/comments/yta11r),%20so%20now,%20in%20a%20backwards-compatible%20way,%5Cn%20%20//%20//%20I'm%20allowing%20the%20user%20to%20pass%20the%20options%20as%20the%20second%20parameter%20instead.%20This%20just%20means%20that%20if%20data%20is%20a%20prompt%20(rather%20than%20a%5Cn%20%20//%20//%20promptOptions%20object),%20then%20we%20use%20the%20%60options%60%20parameter%20(which%20defaults%20to%20an%20empty%20object)%20for%20the%20generation%20options:%5Cn%20%20//%20if(dataInputWasNotAnOptionsObject)%20%7B%5Cn%20%20//%20%20%20data%20=%20options;%20//%20this%5Cn%20%20//%20%7D%5Cn%20%20%5Cn%20%20if(!d.seed)%20d.seed%20=%20data.seed%20?%20data.seed.evaluateItem%20:%20-1;%5Cn%20%20if(!d.resolution)%20d.resolution%20=%20data.resolution%20?%20data.resolution.evaluateItem%20:%20%5C%22512x512%5C%22;%5Cn%20%20if(!d.guidanceScale)%20d.guidanceScale%20=%20data.guidanceScale%20?%20data.guidanceScale.evaluateItem%20:%20defaultGuidanceScale;%5Cn%20%20if(!d.negativePrompt)%20d.negativePrompt%20=%20data.negativePrompt%20?%20data.negativePrompt.evaluateItem%20:%20%5C%22%5C%22;%5Cn%20%20if(!d.width)%20d.width%20=%20data.width%20?%20data.width.evaluateItem%20:%20undefined;%20%5Cn%20%20if(!d.height)%20d.height%20=%20data.height%20?%20data.height.evaluateItem%20:%20undefined;%20%5Cn%20%20if(!d.style)%20d.style%20=%20data.style%20?%20data.style.evaluateItem%20:%20%5C%22%5C%22;%5Cn%20%20if(!d.saveTitle)%20d.saveTitle%20=%20data.saveTitle%20?%20data.saveTitle.evaluateItem%20:%20%5C%22%5C%22;%5Cn%20%20if(!d.saveDescription)%20d.saveDescription%20=%20data.saveDescription%20?%20data.saveDescription.evaluateItem%20:%20%5C%22%5C%22;%5Cn%20%20%5Cn%20%20%5Cn%20%20//%20NOTE:%20This%20stuff%20is%20not%20longer%20needed%20because%20we%20do%20the%20parsing%20above%20regardless%20of%20whether%20they%20passed%20a%20plain%20string%20in,%20or%20a%20promptOptions%20object.%5Cn%20%20//%20//%20if%20seed%20is%20specified%20within%20the%20prompt%20with%20the%20(key:::value)%20format%20-%20i.e.%20they%20used%20promptOptions%20input%20but%20specified%20the%20seed%20within%20promptOptions.prompt,%20and%20so%20long%20as%20promptOptions.seed%20is%20not%20specified,%20then%20we%20set%20the%20seed%20to%20the%20one%20specified%20in%20the%20prompt:%5Cn%20%20//%20if(data.seed%20===%20undefined%20&&%20d.prompt.includes(%5C%22(seed:::%5C%22))%20%7B%5Cn%20%20//%20%20%20let%20seed%20=%20null;%5Cn%20%20//%20%20%20d.prompt%20=%20d.prompt.replace(/%5C%5C(seed:::(%5B0-9%5D+)%5C%5C)/g,%20(m,%20p1)%20=%3E%20%7B%20seed=Number(p1);%20return%20%5C%22%5C%22;%20%7D);%5Cn%20%20//%20%20%20if(seed)%20%7B%5Cn%20%20//%20%20%20%20%20d.seed%20=%20seed;%5Cn%20%20//%20%20%20%7D%5Cn%20%20//%20%7D%5Cn%20%20//%20//%20same%20for%20guidanceScale:%5Cn%20%20//%20if(data.guidanceScale%20===%20undefined%20&&%20d.prompt.includes(%5C%22(guidanceScale:::%5C%22))%20%7B%5Cn%20%20//%20%20%20let%20guidanceScale%20=%20null;%5Cn%20%20//%20%20%20d.prompt%20=%20d.prompt.replace(/%5C%5C(guidanceScale:::(%5B0-9%5D+)%5C%5C)/g,%20(m,%20p1)%20=%3E%20%7B%20guidanceScale=Number(p1);%20return%20%5C%22%5C%22;%20%7D);%5Cn%20%20//%20%20%20if(guidanceScale)%20%7B%5Cn%20%20//%20%20%20%20%20d.guidanceScale%20=%20guidanceScale;%5Cn%20%20//%20%20%20%7D%5Cn%20%20//%20%7D%5Cn%20%20//%20//%20same%20for%20width:%5Cn%20%20//%20if(data.guidanceScale%20===%20undefined%20&&%20d.prompt.includes(%5C%22(width:::%5C%22))%20%7B%5Cn%20%20//%20%20%20let%20width%20=%20null;%5Cn%20%20//%20%20%20d.prompt%20=%20d.prompt.replace(/%5C%5C(width:::(%5B0-9%5D+)%5C%5C)/g,%20(m,%20p1)%20=%3E%20%7B%20width=Number(p1);%20return%20%5C%22%5C%22;%20%7D);%5Cn%20%20//%20%20%20if(width)%20%7B%5Cn%20%20//%20%20%20%20%20d.width%20=%20width;%5Cn%20%20//%20%20%20%7D%5Cn%20%20//%20%7D%5Cn%20%20//%20//%20same%20for%20height:%5Cn%20%20//%20if(data.guidanceScale%20===%20undefined%20&&%20d.prompt.includes(%5C%22(height:::%5C%22))%20%7B%5Cn%20%20//%20%20%20let%20height%20=%20null;%5Cn%20%20//%20%20%20d.prompt%20=%20d.prompt.replace(/%5C%5C(height:::(%5B0-9%5D+)%5C%5C)/g,%20(m,%20p1)%20=%3E%20%7B%20height=Number(p1);%20return%20%5C%22%5C%22;%20%7D);%5Cn%20%20//%20%20%20if(height)%20%7B%5Cn%20%20//%20%20%20%20%20d.height%20=%20height;%5Cn%20%20//%20%20%20%7D%5Cn%20%20//%20%7D%5Cn%20%20//%20//%20same%20for%20size:%5Cn%20%20//%20if(data.guidanceScale%20===%20undefined%20&&%20d.prompt.includes(%5C%22(size:::%5C%22))%20%7B%5Cn%20%20//%20%20%20let%20size%20=%20null;%5Cn%20%20//%20%20%20d.prompt%20=%20d.prompt.replace(/%5C%5C(size:::(%5B0-9%5D+)%5C%5C)/g,%20(m,%20p1)%20=%3E%20%7B%20size=Number(p1);%20return%20%5C%22%5C%22;%20%7D);%5Cn%20%20//%20%20%20if(size)%20%7B%5Cn%20%20//%20%20%20%20%20d.size%20=%20size;%5Cn%20%20//%20%20%20%7D%5Cn%20%20//%20%7D%5Cn%20%20%5Cn%20%20%5Cn%20%20////////////////////////////////////////////////%5Cn%20%20//%20%20%20%20%20%20%20%20%20%20%20sanity%20checks%20on%20inputs%20%20%20%20%20%20%20%20%20%20//%5Cn%20%20////////////////////////////////////////////////%5Cn%20%20%5Cn%20%20if(d.size%20&&%20d.resolution%20&&%20d.resolution.split(%5C%22x%5C%22)%5B0%5D%20!==%20d.resolution.split(%5C%22x%5C%22)%5B1%5D)%20%7B%5Cn%20%20%20%20return%20%60(text-to-image-plugin:%20%3Cb%3Esize%3C/b%3E%20is%20only%20a%20valid%20parameter%20with%20square%20resolutions.%20use%20%3Cb%3Ewidth%3C/b%3E%20and%20%3Cb%3Eheight%3C/b%3E%20instead)%60;%5Cn%20%20%7D%5Cn%5Cn%20%20if(d.guidanceScale%20%3C%201%20%7C%7C%20Math.round(d.guidanceScale)%20!==%20d.guidanceScale)%20%7B%5Cn%20%20%20%20return%20%60(text-to-image-plugin:%20%3Cb%3EguidanceScale%3C/b%3E%20should%20be%20a%20whole%20number%20between%201%20and%2030,%20inclusive)%60;%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20if(!%5B%5C%22512x512%5C%22,%20%5C%22512x768%5C%22,%20%5C%22768x512%5C%22,%20%5C%22768x768%5C%22%5D.includes(d.resolution))%20%7B%5Cn%20%20%20%20return%20%5C%22(text-to-image-plugin:%20Currently,%20the%20only%20valid%20resolutions%20are%20512x512,%20768x768,%20512x768%20and%20768x512)%5C%22;%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20%5Cn%20%20%5Cn%20%20////////////////////////////////////////////////%5Cn%20%20//%20%20%20%20%20%20%20%20un-shortcut%20size/width/height%20%20%20%20%20%20%20//%5Cn%20%20////////////////////////////////////////////////%5Cn%20%20let%20resW%20=%20Number(d.resolution.split(%5C%22x%5C%22)%5B0%5D);%5Cn%20%20let%20resH%20=%20Number(d.resolution.split(%5C%22x%5C%22)%5B1%5D);%5Cn%20%20let%20widthHeightCss%20=%20%5C%22%5C%22;%5Cn%20%20if(d.size)%20%7B%5Cn%20%20%20%20let%20size%20=%20d.size.evaluateItem;%5Cn%20%20%20%20if(typeof%20size%20===%20%5C%22number%5C%22)%20size%20+=%20%5C%22px%5C%22;%5Cn%20%20%20%20widthHeightCss%20=%20%60width:$%7Bsize%7D%60;%5Cn%20%20%7D%20else%20%7B%5Cn%20%20%20%20if(d.width%20&&%20!d.height)%20%7B%5Cn%20%20%20%20%20%20d.width%20=%20d.width.evaluateItem;%5Cn%20%20%20%20%20%20if(typeof%20d.width%20===%20%5C%22number%5C%22)%20d.width%20+=%20%5C%22px%5C%22;%5Cn%20%20%20%20%20%20widthHeightCss%20=%20%60width:$%7Bd.width%7D%60;%5Cn%20%20%20%20%20%20//%20d.height%20=%20d.width%20*%20(resH/resW);%5Cn%20%20%20%20%7D%20else%20if(!d.width%20&&%20d.height)%20%7B%5Cn%20%20%20%20%20%20d.height%20=%20d.height.evaluateItem;%5Cn%20%20%20%20%20%20if(typeof%20d.height%20===%20%5C%22number%5C%22)%20d.height%20+=%20%5C%22px%5C%22;%5Cn%20%20%20%20%20%20widthHeightCss%20=%20%60height:$%7Bd.height%7D%60;%5Cn%20%20%20%20%20%20//%20d.width%20=%20d.height%20*%20(resW/resH);%5Cn%20%20%20%20%7D%20else%20if(!d.width%20&&%20!d.height)%20%7B%5Cn%20%20%20%20%20%20//%20make%20the%20smallest%20side%20300px%20by%20default:%5Cn%20%20%20%20%20%20let%20defaultSize%20=%20300;%5Cn%20%20%20%20%20%20if(d.resolution%20===%20%5C%22768x768%5C%22)%20defaultSize%20=%20450;%5Cn%20%20%20%20%20%20if(resW%20%3E%20resH)%20%7B%5Cn%20%20%20%20%20%20%20%20d.height%20=%20defaultSize;%5Cn%20%20%20%20%20%20%20%20widthHeightCss%20=%20%60height:$%7Bd.height%7Dpx%60;%20//%20can't%20add%20max-height:100%25%20here%20-%20it%20breaks%20stuff,%20like%20ai-character-chat%5Cn%20%20%20%20%20%20%20%20//%20d.width%20=%20d.height%20*%20(resW/resH);%5Cn%20%20%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20%20%20d.width%20=%20defaultSize;%5Cn%20%20%20%20%20%20%20%20widthHeightCss%20=%20%60width:$%7Bd.width%7Dpx%60;%20//%20can't%20add%20max-width:100%25%20here%20-%20it%20breaks%20stuff,%20like%20ai-character-chat%5Cn%20%20%20%20%20%20%20%20//%20d.height%20=%20d.width%20*%20(resH/resW);%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%7D%20else%20if(d.width%20&&%20d.height)%20%7B%5Cn%20%20%20%20%20%20if(typeof%20d.width%20===%20%5C%22number%5C%22)%20d.width%20+=%20%5C%22px%5C%22;%5Cn%20%20%20%20%20%20if(typeof%20d.height%20===%20%5C%22number%5C%22)%20d.height%20+=%20%5C%22px%5C%22;%5Cn%20%20%20%20%20%20widthHeightCss%20=%20%60width:$%7Bd.width%7D;%20height:$%7Bd.height%7D%60;%5Cn%20%20%20%20%7D%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20if(d.style%20&&%20/%5B;%5C%5Cs%5D?(width%7Cheight):/.test(d.style))%20widthHeightCss%20=%20%5C%22%5C%22;%5Cn%20%20%5Cn%20%20if(!CSS.supports(%5C%22aspect-ratio%5C%22,%20%5C%221/2%5C%22))%20%7B%20//%20hackily%20help%20old%20browsers%20that%20don't%20support%20aspect-ratio%20if%20possible%5Cn%20%20%20%20let%20width%20=%20(widthHeightCss.match(/width:(%5B%5E;%5D+)px;?/)%20%7C%7C%20%5B%5D)%5B1%5D;%5Cn%20%20%20%20if(width%20&&%20!widthHeightCss.includes(%5C%22height%5C%22)%20&&%20!isNaN(Number(width)))%20%7B%5Cn%20%20%20%20%20%20widthHeightCss%20+=%20%60;%20height:$%7BNumber(width)%20*%20(resH/resW)%7Dpx;%60;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20let%20height%20=%20(widthHeightCss.match(/height:(%5B%5E;%5D+)px;?/)%20%7C%7C%20%5B%5D)%5B1%5D;%5Cn%20%20%20%20if(height%20&&%20!widthHeightCss.includes(%5C%22width%5C%22)%20&&%20!isNaN(Number(height)))%20%7B%5Cn%20%20%20%20%20%20widthHeightCss%20+=%20%60;%20width:$%7BNumber(height)%20*%20(resW/resH)%7Dpx;%60;%5Cn%20%20%20%20%7D%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20let%20requestId%20=%20Math.random().toString();%5Cn%20%20let%20privateIframeId%20=%20%5C%22id%5C%22%20+%20Math.random().toString().replace(%5C%22.%5C%22,%20%5C%22%5C%22);%5Cn%20%20%5Cn%20%20//%20let%20iframePromiseResolver;%5Cn%20%20//%20let%20iframePromise%20=%20new%20Promise(r%20=%3E%20iframePromiseResolver=r);%5Cn%20%20//%20let%20canvasPromiseResolver;%5Cn%20%20//%20let%20canvasPromise%20=%20new%20Promise(r%20=%3E%20canvasPromiseResolver=r);%5Cn%20%20//%20let%20dataUrlPromiseResolver;%5Cn%20%20//%20let%20dataUrlPromise%20=%20new%20Promise(r%20=%3E%20dataUrlPromiseResolver=r);%5Cn%20%20let%20onFinishPromiseResolver;%5Cn%20%20let%20onFinishPromise%20=%20new%20Promise(r%20=%3E%20onFinishPromiseResolver=r);%5Cn%20%20%5Cn%5Cn%20%20async%20function%20messageHandler(event)%20%7B%5Cn%20%20%20%20if(event.data.type%20===%20'finished'%20&&%20event.data.id%20===%20privateIframeId)%20%7B%5Cn%20%20%20%20%20%20//%20TODO:%20Should%20remove%20this%20message%20handler%20when%20it's%20finished,%20but%20%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20function%20drawDataURLToCanvas(dataURL)%20%7B%5Cn%20%20%20%20%20%20%20%20return%20new%20Promise((resolve,%20reject)%20=%3E%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20const%20canvas%20=%20document.createElement(%5C%22canvas%5C%22);%5Cn%20%20%20%20%20%20%20%20%20%20const%20ctx%20=%20canvas.getContext(%5C%222d%5C%22);%5Cn%20%20%20%20%20%20%20%20%20%20const%20img%20=%20new%20Image();%5Cn%20%20%20%20%20%20%20%20%20%20img.onload%20=%20()%20=%3E%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20canvas.width%20=%20img.width;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20canvas.height%20=%20img.height;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20ctx.drawImage(img,%200,%200);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20resolve(canvas);%5Cn%20%20%20%20%20%20%20%20%20%20%7D;%5Cn%20%20%20%20%20%20%20%20%20%20img.src%20=%20dataURL;%5Cn%20%20%20%20%20%20%20%20%7D);%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20async%20function%20removeBackground(imageUrl)%20%7B%20//%20can%20be%20data%20url%20or%20normal%20URL%5Cn%20%20%20%20%20%20%20%20if%20(!removeBackground.transformers)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20const%20transformers%20=%20await%20import('https://cdn.jsdelivr.net/npm/@huggingface/transformers@3.3.3');%5Cn%20%20%20%20%20%20%20%20%20%20transformers.env.allowLocalModels%20=%20false;%5Cn%20%20%20%20%20%20%20%20%20%20transformers.env.backends.onnx.wasm.proxy%20=%20true;%5Cn%20%20%20%20%20%20%20%20%20%20removeBackground.transformers%20=%20transformers;%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20const%20%7B%20AutoModel,%20AutoProcessor,%20RawImage%20%7D%20=%20removeBackground.transformers;%5Cn%20%20%20%20%20%20%20%20if%20(!removeBackground.model%20%7C%7C%20!removeBackground.processor)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20removeBackground.model%20=%20await%20AutoModel.from_pretrained('briaai/RMBG-1.4',%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20config:%20%7B%20model_type:%20'custom'%20%7D,%5Cn%20%20%20%20%20%20%20%20%20%20%7D);%5Cn%20%20%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20%20%20removeBackground.processor%20=%20await%20AutoProcessor.from_pretrained('briaai/RMBG-1.4',%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20config:%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20do_normalize:%20true,%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20do_pad:%20false,%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20do_rescale:%20true,%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20do_resize:%20true,%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20image_mean:%20%5B0.5,%200.5,%200.5%5D,%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20feature_extractor_type:%20%5C%22ImageFeatureExtractor%5C%22,%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20image_std:%20%5B1,%201,%201%5D,%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20resample:%202,%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20rescale_factor:%200.00392156862745098,%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20size:%20%7B%20width:%201024,%20height:%201024%20%7D,%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20%7D);%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20const%20image%20=%20await%20RawImage.fromURL(imageUrl);%5Cn%20%20%20%20%20%20%20%20const%20%7B%20pixel_values%20%7D%20=%20await%20removeBackground.processor(image);%5Cn%20%20%20%20%20%20%20%20const%20%7B%20output%20%7D%20=%20await%20removeBackground.model(%7B%20input:%20pixel_values%20%7D);%5Cn%20%20%20%20%20%20%20%20const%20mask%20=%20await%20RawImage.fromTensor(output%5B0%5D.mul(255).to('uint8')).resize(image.width,%20image.height);%5Cn%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20const%20canvas%20=%20document.createElement('canvas');%5Cn%20%20%20%20%20%20%20%20canvas.width%20=%20image.width;%5Cn%20%20%20%20%20%20%20%20canvas.height%20=%20image.height;%5Cn%20%20%20%20%20%20%20%20const%20ctx%20=%20canvas.getContext('2d');%5Cn%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20//%20Draw%20original%20image%20output%20to%20canvas%5Cn%20%20%20%20%20%20%20%20ctx.drawImage(image.toCanvas(),%200,%200);%5Cn%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20//%20Update%20alpha%20channel%5Cn%20%20%20%20%20%20%20%20const%20pixelData%20=%20ctx.getImageData(0,%200,%20image.width,%20image.height);%5Cn%20%20%20%20%20%20%20%20for%20(let%20i%20=%200;%20i%20%3C%20mask.data.length;%20++i)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20pixelData.data%5B4%20*%20i%20+%203%5D%20=%20mask.data%5Bi%5D;%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20ctx.putImageData(pixelData,%200,%200);%5Cn%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20return%20canvas.toDataURL('image/png');%5Cn%20%20%20%20%20%20%7D%5Cn%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20let%20dataUrl%20=%20event.data.dataUrl;%5Cn%20%20%20%20%20%20if(data.removeBackground)%20%7B%5Cn%20%20%20%20%20%20%20%20let%20pngDataUrlWithBgRemoved%20=%20await%20removeBackground(dataUrl).catch(console.error);%5Cn%20%20%20%20%20%20%20%20if(pngDataUrlWithBgRemoved)%20dataUrl%20=%20pngDataUrlWithBgRemoved;%5Cn%20%20%20%20%20%20%7D%5Cn%5Cn%20%20%20%20%20%20let%20canvas%20=%20await%20drawDataURLToCanvas(dataUrl);%5Cn%20%20%20%20%20%20let%20iframe%20=%20document.querySelector(%60iframe.$%7BprivateIframeId%7D%60);%20//%20NOTE:%20may%20be%20null%20if%20it%20has%20been%20removed!%20(todo:%20keep%20original%20reference%20around%20instead%20of%20querySelector?)%5Cn%5Cn%20%20%20%20%20%20if(!iframe)%20window.removeEventListener('message',%20messageHandler);%20//%20iframes%20not%20in%20DOM%20cannot%20send%20any%20more%20messages%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20let%20outputData%20=%20new%20String(dataUrl);%5Cn%20%20%20%20%20%20outputData.canvas%20=%20canvas;%5Cn%20%20%20%20%20%20outputData.iframe%20=%20iframe;%5Cn%20%20%20%20%20%20outputData.dataUrl%20=%20dataUrl;%5Cn%20%20%20%20%20%20outputData.inputs%20=%20evaluatedInputs;%5Cn%20%20%20%20%20%20outputData.inputs.seed%20=%20event.data.seedUsed;%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20if(iframe)%20iframe.textToImagePluginOutput%20=%20outputData;%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20if(shouldRemoveIframeOnFinish)%20%7B%5Cn%20%20%20%20%20%20%20%20delete%20outputData.iframe;%5Cn%20%20%20%20%20%20%20%20iframe.remove();%5Cn%20%20%20%20%20%20%20%20window.removeEventListener('message',%20messageHandler);%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20if(data.onFinish)%20%7B%5Cn%20%20%20%20%20%20%20%20data.onFinish(outputData);%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20onFinishPromiseResolver(outputData);%5Cn%20%20%20%20%7D%5Cn%20%20%7D%5Cn%20%20window.addEventListener('message',%20messageHandler);%5Cn%20%20%5Cn%20%20let%20iframeExistentPollInterval%20=%20setInterval(()%20=%3E%20%7B%5Cn%20%20%20%20if(!document.querySelector(%60iframe.$%7BprivateIframeId%7D%60))%20%7B%5Cn%20%20%20%20%20%20clearInterval(iframeExistentPollInterval);%5Cn%20%20%20%20%20%20window.removeEventListener('message',%20messageHandler);%5Cn%20%20%20%20%7D%5Cn%20%20%7D,%201000*60);%20//%20not%20important%20to%20remove%20listener%20immediately,%20so%20long%20interval%20is%20fine%5Cn%20%20%5Cn%20%20function%20blobToDataUrl(blob)%20%7B%5Cn%20%20%20%20return%20new%20Promise(r%20=%3E%20%7B%5Cn%20%20%20%20%20%20const%20reader%20=%20new%20FileReader();%5Cn%20%20%20%20%20%20reader.onload%20=%20()%20=%3E%20r(reader.result);%5Cn%20%20%20%20%20%20reader.readAsDataURL(blob);%5Cn%20%20%20%20%7D);%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20let%20referenceImage%20=%20null;%5Cn%20%20if(data.referenceImage)%20%7B%5Cn%20%20%20%20referenceImage%20=%20%7B%7D;%5Cn%20%20%20%20//%20url%20can%20actually%20be%20a%20blob%20or%20a%20blob%20URL,%20in%20which%20case%20we%20postMessage%20the%20data%20to%20the%20iframe%5Cn%20%20%20%20let%20isBlobby%20=%20data.referenceImage.url%20instanceof%20Blob;%20//%20blobby%20means%20Blob%20or%20blob%20URL%20string%5Cn%20%20%20%20let%20url,%20blobby;%5Cn%20%20%20%20%5Cn%20%20%20%20if(isBlobby)%20blobby%20=%20data.referenceImage.url;%5Cn%20%20%20%20else%20url%20=%20data.referenceImage.url.evaluateItem;%5Cn%20%20%20%20%5Cn%20%20%20%20if(url.startsWith(%5C%22blob:%5C%22))%20%7B%5Cn%20%20%20%20%20%20isBlobby%20=%20true;%5Cn%20%20%20%20%20%20blobby%20=%20url;%5Cn%20%20%20%20%20%20url%20=%20null;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20if(isBlobby)%20%7B%5Cn%20%20%20%20%20%20referenceImage.url%20=%20%5C%22%3Cdata-via-postmessage%3E%5C%22;%5Cn%20%20%20%20%20%20(async%20()%20=%3E%20%7B%5Cn%20%20%20%20%20%20%20%20let%20blob;%5Cn%20%20%20%20%20%20%20%20if(typeof%20blobby%20===%20%5C%22string%5C%22%20&&%20blobby.startsWith(%5C%22blob:%5C%22))%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20blob%20=%20await%20fetch(blobby).then(r%20=%3E%20r.blob());%5Cn%20%20%20%20%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20blob%20=%20blobby;%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20let%20dataUrl%20=%20await%20blobToDataUrl(blob);%5Cn%20%20%20%20%20%20%20%20window.addEventListener('message',%20function(event)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20if(event.data.type%20===%20'readyForData'%20&&%20event.data.id%20===%20privateIframeId)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20document.querySelector(%60iframe.$%7BprivateIframeId%7D%60).contentWindow.postMessage(%7Bid:privateIframeId,%20referenceImageDataUrl:dataUrl%7D,%20serverOrigin);%5Cn%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%7D);%5Cn%20%20%20%20%20%20%7D)();%5Cn%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20referenceImage.url%20=%20url;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20referenceImage.blur%20=%20data.referenceImage.blur.evaluateItem;%5Cn%20%20%20%20//%20if(referenceImage.url%20&&%20!referenceImage.url.startsWith(%5C%22https://user-uploads.perchance.%5C%22)%20&&%20!referenceImage.url.startsWith(%5C%22data:%5C%22))%20return%20%60referenceImage.url%20must%20either%20be%20a%20'data%20URL'%20(starting%20with%20'data:')%20or%20a%20https://user-uploads.perchance.org%20URL%20-%20i.e.%20an%20image%20that%20has%20been%20uploaded%20to%20https://perchance.org/upload%20-%20the%20URL%20you've%20used%20is:%20'$%7BreferenceImage.url%20&&%20typeof%20referenceImage.url%20===%20%5C%22string%5C%22%20&&%20referenceImage.url.length%20%3E%2030%20?%20referenceImage.url.slice(0,%2030)+%5C%22...%5C%22%20:%20referenceImage.url%7D'.%60;%5Cn%20%20%20%20if(referenceImage.blur%20%3E%201%20%7C%7C%20referenceImage.blur%20%3C%200)%20return%20%60referenceImage.blur%20must%20be%20between%200%20and%201,%20but%20is%20instead%20'$%7BreferenceImage.blur%20%3E%201%7D'.%60%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20window.addEventListener('message',%20function(event)%20%7B%5Cn%20%20%20%20if(event.data.type%20===%20'readyForData'%20&&%20event.data.id%20===%20privateIframeId)%20%7B%5Cn%20%20%20%20%20%20let%20iframe%20=%20document.querySelector(%60iframe.$%7BprivateIframeId%7D%60);%5Cn%20%20%20%20%20%20if(iframe)%20iframe.contentWindow.postMessage(%7Btype:%5C%22originNotify%5C%22,%20frameId:privateIframeId%7D,%20serverOrigin);%5Cn%20%20%20%20%7D%5Cn%20%20%7D);%5Cn%20%20%5Cn%20%20let%20urlHashData%20=%20%7B%5Cn%20%20%20%20saveChannel:%20window.generatorName,%5Cn%20%20%20%20saveTitle:%20d.saveTitle,%5Cn%20%20%20%20saveDescription:%20d.saveDescription,%5Cn%20%20%20%20prompt:%20d.prompt,%5Cn%20%20%20%20seed:%20d.seed,%5Cn%20%20%20%20resolution:%20d.resolution,%5Cn%20%20%20%20guidanceScale:%20d.guidanceScale,%5Cn%20%20%20%20defaultGuidanceScale,%5Cn%20%20%20%20negativePrompt:%20d.negativePrompt,%5Cn%20%20%20%20requestId:%20requestId,%5Cn%20%20%20%20forceColorScheme:%20data.forceColorScheme,%5Cn%20%20%20%20verifyOnly:%20data.verifyOnly,%5Cn%20%20%20%20iframeId:%20privateIframeId,%5Cn%20%20%20%20hideGalleryButtons:%20data.hideGalleryButtons,%5Cn%20%20%20%20removeBackground:%20data.removeBackground,%5Cn%20%20%20%20referenceImage,%5Cn%20%20%7D;%5Cn%20%20%5Cn%20%20//%20clone%20input%20for%20onFinish%20data:%5Cn%20%20evaluatedInputs%20=%20JSON.parse(JSON.stringify(d));%5Cn%20%20%5Cn%20%20let%20iframeId%20=%20data.id%20?%20data.id.evaluateItem%20:%20%5C%22%5C%22;%5Cn%20%20if(iframeId)%20%7B%5Cn%20%20%20%20setTimeout(()%20=%3E%20%7B%5Cn%20%20%20%20%20%20document.querySelector(%5C%22#%5C%22+iframeId).reload%20=%20function()%20%7B%5Cn%20%20%20%20%20%20%20%20let%20src%20=%20this.src;%5Cn%20%20%20%20%20%20%20%20this.src%20=%20%5C%22%5C%22;%5Cn%20%20%20%20%20%20%20%20setTimeout(()%20=%3Ethis.src=src,%20700);%5Cn%20%20%20%20%20%20%7D;%5Cn%20%20%20%20%7D,%20500);%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20window.lastTextToImagePrompt%20=%20d.prompt;%5Cn%20%20if(data.prompt)%20%7B%20//%20%3C--%20i.e.%20if%20they%20passed%20a%20promptOptions%20object%5Cn%20%20%20%20data.lastUsedPrompt%20=%20d.prompt;%5Cn%20%20%20%20data.lastUsedNegativePrompt%20=%20d.negativePrompt;%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20//%20VERY%20lazily%20load%20the%20iframe%20(only%20when%20screen%20actually%20intersects)%20because%20some%20people%20add%20a%20lot%20of%20images%20in%20subsections%20and%20in%20several%20different%20tabs%20of%20tabs-plugin,%20etc.%5Cn%20%20//%20This%20ensures%20they%20don't%20spam%20the%20server,%20and%20the%20visible%20ones%20get%20generated%20first.%5Cn%20%20setTimeout(async%20()%20=%3E%20%7B%5Cn%20%20%20%20//%20the%20dev%20may%20have%20generated%20the%20HTML,%20but%20not%20actually%20added%20it%20to%20the%20DOM%20for%20a%20while,%20so%20we%20wait%20up%20to%205%20mins%20for%20it%5Cn%20%20%20%20let%20waitedSeconds%20=%200;%5Cn%20%20%20%20while(%5B...document.querySelectorAll(%5C%22.text-to-image-plugin-image-iframe%5C%22)%5D.filter(el%20=%3E%20el.dataset.alreadyAddedIntersectionObserver%20===%20%5C%22no%5C%22).length%20===%200)%20%7B%5Cn%20%20%20%20%20%20await%20new%20Promise(r%20=%3E%20setTimeout(r,%20500));%5Cn%20%20%20%20%20%20waitedSeconds%20+=%200.5;%5Cn%20%20%20%20%20%20if(waitedSeconds%20%3E%2060*5)%20return;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20for(let%20el%20of%20%5B...document.querySelectorAll(%5C%22.text-to-image-plugin-image-iframe%5C%22)%5D)%20%7B%5Cn%20%20%20%20%20%20if(el.dataset.alreadyAddedIntersectionObserver%20===%20%5C%22yes%5C%22)%20continue;%5Cn%20%20%20%20%20%20el.dataset.alreadyAddedIntersectionObserver%20=%20%5C%22yes%5C%22;%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20let%20observer1,%20observer2;%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20let%20rootMarginSize%20=%20Math.min(1000,%20(window.innerHeight*2));%5Cn%20%20%20%20%20%20if(window.innerWidth%20%3C%20600)%20%7B%5Cn%20%20%20%20%20%20%20%20rootMarginSize%20=%20Math.min(1500,%20(window.innerHeight*3));%20//%20larger%20on%20mobile%20because%20e.g.%20images%20that%20might%20otherwise%20be%20displayed%20side%20by%20side%20are%20instead%20displayed%20vertically%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20function%20handler(entries)%20%7B%5Cn%20%20%20%20%20%20%20%20if(entries%5B0%5D.isIntersecting)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20//%20console.debug(%5C%22t2i%20iframe:%20Visible%5C%22);%5Cn%20%20%20%20%20%20%20%20%20%20if(!el.src)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20el.removeAttribute(%5C%22srcdoc%5C%22);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20el.src%20=%20el.dataset.src;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20observer1.disconnect();%5Cn%20%20%20%20%20%20%20%20%20%20%20%20observer2.disconnect();%20%5Cn%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20//%20console.debug(%5C%22t2i%20iframe:%20NOT%20Visible%5C%22);%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20observer1%20=%20new%20IntersectionObserver(handler,%20%7B%5Cn%20%20%20%20%20%20%20%20root:%20document.documentElement,%20//%20otherwise%20I%20think%20it%20uses%20the%20top-level%20viewport?%20either%20way,%20it%20doesn't%20seem%20to%20work%20without%20specifying%20this.%5Cn%20%20%20%20%20%20%20%20rootMargin:%20rootMarginSize+%5C%22px%5C%22,%20//%20it's%20important%20that%20this%20is%20quite%20big%20-%20so%20that%20e.g.%20mobile%20users%20don't%20have%20to%20scroll%20down%20to%20trigger%20stuff.%20we%20basically%20want%20to%20trigger%20~all%20visible%20elements%20anyway%20-%20just%20not%20stuff%20hidden%20within%20e.g.%20tabs%20plugin%20or%20whatever.%5Cn%20%20%20%20%20%20%7D);%5Cn%20%20%20%20%20%20observer1.observe(el);%5Cn%20%20%20%20%20%20//%20for%20some%20reason,%20in%20some%20situations,%20the%20above%20intersection%20observer%20was%20reporting%20the%20%60root%60%20and%20%60el%60%20bounding%20rects%20as%200x0x0x0.%20Adding%20a%20second%20observer%20using%20the%20viewport%20root%20fixes%20this:%5Cn%20%20%20%20%20%20observer2%20=%20new%20IntersectionObserver(handler,%20%7B%5Cn%20%20%20%20%20%20%20%20rootMargin:%20rootMarginSize+%5C%22px%5C%22,%5Cn%20%20%20%20%20%20%7D);%5Cn%20%20%20%20%20%20observer2.observe(el);%5Cn%20%20%20%20%7D%5Cn%20%20%7D,%20100);%20//%20CAUTION:%20do%20not%20remove/lower%20this%20delay.%20Some%20generators%20may%20create%20a%20large%20%5C%22feed%5C%22%20of%20images,%20and%20expect%20them%20to%20be%20lazy-loaded%20when%20scrolled%20to%20(e.g.%20AI%20chat%20feeds),%20so%20if%20you%20add%20the%20intersection%20observers%20~synchronously,%20they%20could%20be%20triggered%20during%20the%20process%20of%20actually%20generating%20the%20feed,%20which%20would%20cause%20them%20to%20all%20start%20generating%20during%20page%20load.%5Cn%20%20%5Cn%20%20//%20let%20outputString%20=%20new%20String(%60%3Ciframe%20$%7BiframeId%20?%20%60id=%5C%22$%7BiframeId%7D%5C%22%60%20:%20%5C%22%5C%22%7D%20class=%5C%22text-to-image-plugin-image-iframe%20$%7BprivateIframeId%7D%5C%22%20data-already-added-intersection-observer=%5C%22no%5C%22%20data-src=%5C%22$%7BserverOrigin%7D/embed#$%7BencodeURIComponent(JSON.stringify(urlHashData))%7D%5C%22%20style=%5C%22border:0;%20background:transparent;%20$%7BwidthHeightCss%7D;%20aspect-ratio:$%7BresW%7D/$%7BresH%7D;%20$%7Bd.style%7D%5C%22%3E%3C/iframe%3E%60);%5Cn%20%20//%20//%20leaving%20these%20out%20for%20now%20in%20favor%20of%20'onFinish'%20in%20prompt%20options%5Cn%20%20//%20//%20outputString.dataUrl%20=%20dataUrlPromise;%5Cn%20%20//%20//%20outputString.canvas%20=%20canvasPromise;%5Cn%20%20//%20outputString.onFinishPromise%20=%20onFinishPromise;%5Cn%20%20//%20outputString.iframeHtml%20=%20outputString;%5Cn%20%20//%20return%20outputString;%5Cn%20%20%5Cn%20%20//%20we%20return%20the%20promise%20which%20stringifies%20into%20the%20iframe%20html,%20we%20can%20write%20%5BtextToImage(promptOptions)%5D%20and%20while%20also%20being%20able%20to%20write%20%60let%20result%20=%20await%20textToImage(promptOptions);%60%5Cn%20%20let%20outputString%20=%20%60%3Ciframe%20$%7BiframeId%20?%20%60id=%5C%22$%7BiframeId%7D%5C%22%60%20:%20%5C%22%5C%22%7D%20class=%5C%22text-to-image-plugin-image-iframe%20$%7BprivateIframeId%7D%5C%22%20data-already-added-intersection-observer=%5C%22no%5C%22%20data-src=%5C%22$%7BserverOrigin%7D/embed#$%7BencodeURIComponent(JSON.stringify(urlHashData))%7D%5C%22%20style=%5C%22border:0;%20background:transparent;%20$%7BwidthHeightCss%7D;%20aspect-ratio:$%7BresW%7D/$%7BresH%7D;%20$%7Bd.style%7D%5C%22%3E%3C/iframe%3E%60;%5Cn%20%20let%20outputStringHasBeenRead%20=%20false;%5Cn%20%20onFinishPromise.toString%20=%20function()%20%7B%5Cn%20%20%20%20outputStringHasBeenRead%20=%20true;%5Cn%20%20%20%20return%20outputString;%5Cn%20%20%7D;%5Cn%20%20//%20onFinishPromise.iframeHtml%20=%20outputString;%5Cn%20%20Object.defineProperty(onFinishPromise,%20'iframeHtml',%20%7B%5Cn%20%20%20%20get:%20function()%20%7B%5Cn%20%20%20%20%20%20outputStringHasBeenRead%20=%20true;%5Cn%20%20%20%20%20%20return%20outputString;%5Cn%20%20%20%20%7D%5Cn%20%20%7D);%5Cn%20%20Object.defineProperty(onFinishPromise,%20'evaluateItem',%20%7B%5Cn%20%20%20%20get:%20function()%20%7B%5Cn%20%20%20%20%20%20outputStringHasBeenRead%20=%20true;%5Cn%20%20%20%20%20%20return%20outputString;%5Cn%20%20%20%20%7D%5Cn%20%20%7D);%5Cn%20%20onFinishPromise.onFinishPromise%20=%20onFinishPromise;%5Cn%20%20%5Cn%20%20//%20trigger%20the%20loading%20automatically%20if%20they%20haven't%20added%20the%20iframe%20to%20the%20document:%5Cn%20%20setTimeout(()%20=%3E%20%7B%5Cn%20%20%20%20if(!outputStringHasBeenRead%20&&%20!iframeId%20&&%20!document.querySelector(%60.$%7BprivateIframeId%7D%60))%20%7B%5Cn%20%20%20%20%20%20shouldRemoveIframeOnFinish%20=%20true;%5Cn%20%20%20%20%20%20let%20div%20=%20document.createElement(%5C%22div%5C%22);%5Cn%20%20%20%20%20%20div.innerHTML%20=%20outputString.replace(%60data-already-added-intersection-observer=%5C%22no%5C%22%60,%20%5C%22%5C%22);%5Cn%20%20%20%20%20%20let%20iframe%20=%20div.firstElementChild;%5Cn%20%20%20%20%20%20iframe.style.cssText%20=%20%60opacity:0;%20pointer-events:none;%20position:fixed;%20top:0;%20left:0;%60;%5Cn%20%20%20%20%20%20document.body.append(iframe);%5Cn%20%20%20%20%20%20iframe.src%20=%20iframe.dataset.src;%5Cn%20%20%20%20%7D%5Cn%20%20%7D,%20150);%20//%20this%20should%20be%20longer%20than%20100ms%20for%20backward-compat%20because%20then%20it%20runs%20after%20the%20intersection%20observer%20is%20added,%20which%20means%20it%20wouldn't%20have%20loaded%20anyway,%20so%20it%20guards%20against%20the%20case%20where%20they're%20just%20a%20bit%20slow%20to%20add%20it%20to%20the%20HTML%20doc.%5Cn%20%20%5Cn%20%20return%20onFinishPromise;%5Cn%5Cn%5Cncharacter%5Cn%20%20a%20%7Bmech%7Cdemon%7Ccyberpunk%7D%20%7Bwarrior%7Cminion%7Csamurai%7D%5Cn%5Cnplace%5Cn%20%20soviet%20russia%5Cn%20%20a%20small%20village%5Cn%20%20a%20mountainous%20region%5Cn%20%20an%20underwater%20cavern%5Cn%5Cnseason%5Cn%20%20winter%5Cn%20%20summer%5Cn%20%20%5Cnprompt%5Cn%20%20detailed%20painting%20of%20%5Bcharacter%5D%20in%20%5Bplace%5D,%20%5Bseason%5D%5Cn%20%20%5Cn%20%20%5Cn%20%20%5Cn%22,%22imports%22:%5B%5D,%22lastEditTime%22:1751698314898,%22found%22:true%7D,%7B%22name%22:%22upload-plugin%22,%22modelText%22:%22(data,%20opts)%20=%3E%5Cn%20%20if(!opts)%20opts%20=%20%7B%7D;%5Cn%20%20//%20if(typeof%20data%20!==%20%5C%22string%5C%22)%20return%20alert(%5C%22error:%20only%20text/strings%20are%20supported%20by%20the%20upload%20plugin%20for%20now.%20please%20request%20other%20types%20on%20the%20forum.%5C%22);%5Cn%20%20%5Cn%20%20if(!window.__alreadyLoadedUploadPluginStuff0435342908)%20%7B%5Cn%20%20%20%20window.__alreadyLoadedUploadPluginStuff0435342908%20=%20true;%5Cn%20%20%20%20%5Cn%20%20%20%20window.__uploadPluginIframe0435342908%20=%20document.createElement('iframe');%20%5Cn%5Cn%20%20%20%20window.addEventListener('message',%20(event)%20=%3E%20%7B%5Cn%20%20%20%20%20%20if(event.source%20!==%20window.__uploadPluginIframe0435342908.contentWindow)%20return;%5Cn%20%20%20%20%20%20if(event.origin%20!==%20%5C%22https://upload.perchance.org%5C%22)%20return;%5Cn%20%20%20%20%20%20console.log(%5C%22upload%20plugin%20got%20message:%5C%22,%20event);%5Cn%5Cn%20%20%20%20%20%20if(event.data.type%20===%20%5C%22uploadEmbedIsReady%5C%22)%20%7B%20%20%20%5Cn%20%20%20%20%20%20%20%20window.__uploadPluginEmbedIsReady%20=%20true;%5Cn%20%20%20%20%20%20%20%20console.log(%5C%22upload%20plugin%20embedIsReady%5C%22);%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%7D);%5Cn%5Cn%20%20%20%20function%20initIframeAttributes(iframe)%20%7B%5Cn%20%20%20%20%20%20//%20email==false%20implies%20anon%20upload%5Cn%20%20%20%20%20%20iframe.src%20=%20%60https://upload.perchance.org/embed#$%7BJSON.stringify(%7Bemail:false,%20sessionToken:false%7D)%7D%60;%5Cn%20%20%20%20%20%20iframe.style.cssText%20=%20'width:1px;%20height:1px;%20border:none;%20top:-100px;%20left:-100px;%20position:fixed;';%5Cn%20%20%20%20%7D%5Cn%20%20%20%20initIframeAttributes(window.__uploadPluginIframe0435342908);%5Cn%20%20%20%20document.body.appendChild(window.__uploadPluginIframe0435342908);%5Cn%5Cn%20%20%20%20//%20ping%20embed%20until%20it%20is%20ready%20(hacky%20way%20to%20wait%20for%20it%20to%20load)%5Cn%20%20%20%20(async%20function()%20%7B%5Cn%20%20%20%20%20%20await%20new%20Promise(r%20=%3E%20setTimeout(r,%20500));%5Cn%20%20%20%20%20%20let%20waitedTime%20=%200;%5Cn%20%20%20%20%20%20while(!window.__uploadPluginEmbedIsReady)%20%7B%5Cn%20%20%20%20%20%20%20%20if(waitedTime%20%3E%201000*20)%20%7B%20//%20if%20we've%20waited%20too%20long%20(perhaps%20due%20to%20upload%20server%20error%20response),%20try%20deleting%20the%20iframe%20and%20adding%20it%20again%5Cn%20%20%20%20%20%20%20%20%20%20window.__uploadPluginIframe0435342908.remove();%5Cn%20%20%20%20%20%20%20%20%20%20window.__uploadPluginIframe0435342908%20=%20document.createElement('iframe');%5Cn%20%20%20%20%20%20%20%20%20%20initIframeAttributes(window.__uploadPluginIframe0435342908);%5Cn%20%20%20%20%20%20%20%20%20%20document.body.appendChild(window.__uploadPluginIframe0435342908);%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20await%20new%20Promise(r%20=%3E%20setTimeout(r,%20500));%5Cn%20%20%20%20%20%20%20%20waitedTime%20+=%20500;%5Cn%20%20%20%20%20%20%20%20window.__uploadPluginIframe0435342908.contentWindow.postMessage(%7Btype:%5C%22init%5C%22%7D,%20'https://upload.perchance.org');%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%7D)();%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20let%20requestId%20=%20%5C%22id%5C%22+(Math.random().toString()+Math.random().toString()).replaceAll(%5C%22.%5C%22,%20%5C%22%5C%22);%5Cn%20%20%5Cn%20%20let%20promiseResolver,%20promiseRejecter;%5Cn%20%20let%20promise%20=%20new%20Promise((resolve,%20reject)%20=%3E%20%7B%5Cn%20%20%20%20promiseResolver%20=%20resolve;%5Cn%20%20%20%20promiseRejecter%20=%20reject;%20//%20unused.%5Cn%20%20%7D);%5Cn%20%20%5Cn%20%20function%20messageHandler(event)%20%7B%5Cn%20%20%20%20if(event.source%20!==%20window.__uploadPluginIframe0435342908.contentWindow)%20return;%5Cn%20%20%20%20if(event.origin%20!==%20%5C%22https://upload.perchance.org%5C%22)%20return;%5Cn%5Cn%20%20%20%20if(event.data.type%20===%20%5C%22anonUploadResponse%5C%22%20&&%20event.data.requestId%20===%20requestId)%20%7B%5Cn%20%20%20%20%20%20let%20url%20=%20event.data.result.url;%5Cn%20%20%20%20%20%20let%20error%20=%20event.data.result.error;%5Cn%20%20%20%20%20%20let%20message%20=%20event.data.result.message;%5Cn%20%20%20%20%20%20let%20size%20=%20event.data.result.size;%5Cn%20%20%20%20%20%20let%20deletionUrl%20=%20event.data.result.deletionUrl;%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20if(!error)%20error%20=%20null;%20//%20just%20make%20sure%20it's%20null%20rather%20than%20'undefined',%20since%20that's%20part%20of%20the%20specified%20behavior%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20//%20If%20it%20didn't%20upload%20successfully,%20then%20deletionUrl%20can%20just%20be%20a%20dummy%20URL%20that%20returns%20success:%5Cn%20%20%20%20%20%20if(!deletionUrl)%20deletionUrl%20=%20%5C%22https://user.uploads.dev/file/fcf0aa53193434e1de2a3a2b878bb893.txt%5C%22;%5Cn%5Cn%20%20%20%20%20%20//%20Reduce%20breaking-change-ness%20of%20the%20move%20to%20user.uploads.dev%20for%20a%20common%20pattern%20of%20getting%20the%20file%20id%20by%20removing%20the%20URL's%20prefix:%5Cn%20%20%20%20%20%20if(typeof%20url%20===%20%5C%22string%5C%22)%20%7B%5Cn%20%20%20%20%20%20%20%20let%20originalUrl%20=%20url;%5Cn%20%20%20%20%20%20%20%20url%20=%20new%20String(url)%5Cn%20%20%20%20%20%20%20%20url.replace%20=%20function(...args)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20if(typeof%20args%5B0%5D%20===%20%5C%22string%5C%22%20&&%20args%5B0%5D.startsWith(%5C%22https://user-uploads.perchance.org%5C%22))%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20args%5B0%5D%20=%20args%5B0%5D.replace(%5C%22https://user-uploads.perchance.org%5C%22,%20%5C%22https://user.uploads.dev%5C%22);%5Cn%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20return%20originalUrl.replace(...args);%5Cn%20%20%20%20%20%20%20%20%7D;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20promiseResolver(%7Burl,%20error,%20size,%20deletionUrl%7D);%20//%20always%20'resolve'%20(i.e.%20we%20don't%20%60reject%60%20on%20error).%20easier%20for%20people%20to%20handle%20errors%20without%20knowing%20about%20try/catch%20stuff%20-%20they%20just%20check%20if%20%60error%60%20is%20null%5Cn%20%20%20%20%20%20window.removeEventListener('message',%20messageHandler);%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20let%20el%20=%20document.querySelector(%60#$%7BrequestId%7D%60);%5Cn%20%20%20%20%20%20if(el)%20%7B%5Cn%20%20%20%20%20%20%20%20if(error)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20el.innerHTML%20=%20error;%5Cn%20%20%20%20%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20el.innerHTML%20=%20%60%3Ca%20href=%5C%22$%7Burl%7D%5C%22%20target=%5C%22_blank%5C%22%3E$%7Burl%7D%3C/a%3E%60;%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20if(error)%20%7B%5Cn%20%20%20%20%20%20%20%20let%20div%20=%20document.createElement(%5C%22div%5C%22);%5Cn%20%20%20%20%20%20%20%20let%20errorMessageHtml%20=%20message%20?%20%60%20($%7Bmessage%7D)%60%20:%20%5C%22%5C%22;%5Cn%20%20%20%20%20%20%20%20div.innerHTML%20=%20%60%3Cdiv%20style=%5C%22z-index:1000;%20position:%20fixed;%20bottom:%201rem;%20width:%20100%25;%20pointer-events:none;%5C%22%3E%3Cspan%20style=%5C%22%20padding:%200.5rem;%20background:%20#ac2c2c;%20border-radius:%203px;%20color:%20white;%20pointer-events:auto;%5C%22%3Eupload%20error:%20$%7Berror.replaceAll(%5C%22_%5C%22,%20%5C%22%20%5C%22)%7D$%7BerrorMessageHtml%7D%3C/span%3E%3C/div%3E%60;%5Cn%20%20%20%20%20%20%20%20div%20=%20div.firstElementChild;%5Cn%20%20%20%20%20%20%20%20document.body.appendChild(div);%5Cn%20%20%20%20%20%20%20%20setTimeout(()%20=%3E%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20div.remove();%5Cn%20%20%20%20%20%20%20%20%7D,%201000*5);%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%7D%5Cn%20%20%7D%5Cn%20%20window.addEventListener('message',%20messageHandler);%5Cn%20%20%5Cn%20%20(async%20function()%20%7B%5Cn%20%20%20%20while(!window.__uploadPluginEmbedIsReady)%20%7B%5Cn%20%20%20%20%20%20console.log(%5C%22waiting%20for%20upload%20iframe%20embed%20to%20be%20ready%5C%22);%5Cn%20%20%20%20%20%20await%20new%20Promise(r%20=%3E%20setTimeout(r,%20100));%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20function%20blobToDataUrl(blob)%20%7B%5Cn%20%20%20%20%20%20return%20new%20Promise((resolve,%20_)%20=%3E%20%7B%5Cn%20%20%20%20%20%20%20%20const%20reader%20=%20new%20FileReader();%5Cn%20%20%20%20%20%20%20%20reader.onloadend%20=%20()%20=%3E%20resolve(reader.result);%5Cn%20%20%20%20%20%20%20%20reader.readAsDataURL(blob);%5Cn%20%20%20%20%20%20%7D);%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20let%20dataUrl;%5Cn%20%20%20%20if(typeof%20data%20===%20%5C%22string%5C%22)%20dataUrl%20=%20%60data:text/plain;charset=utf-8,$%7BencodeURIComponent(data)%7D%60;%5Cn%20%20%20%20if(data%20instanceof%20Blob)%20dataUrl%20=%20await%20blobToDataUrl(data);%5Cn%20%20%20%20%5Cn%20%20%20%20window.__uploadPluginIframe0435342908.contentWindow.postMessage(%7Btype:%5C%22anonUploadRequest%5C%22,%20requestId,%20dataUrl,%20expires:opts.expires,%20generatorName:window.generatorName%7D,%20'https://upload.perchance.org');%5Cn%20%20%7D)();%5Cn%20%20%5Cn%20%20promise.toString%20=%20function()%20%7B%5Cn%20%20%20%20return%20%60%3Cspan%20id=%5C%22$%7BrequestId%7D%5C%22%3Euploading...%3C/span%3E%60;%5Cn%20%20%7D;%5Cn%20%20return%20promise;%5Cn%5Cn%5Cn%5Cn%22,%22imports%22:%5B%5D,%22lastEditTime%22:1748065062782,%22found%22:true%7D,%7B%22name%22:%22animal%22,%22modelText%22:%22title%20=%20Random%20Animal%20Generator%5Cnsubtitle%20=%20A%20simple%20generator%20that%20gives%20you%20a%20random%20animal%20name.%5CnfontSize%20=%20230%5CnfontColor%20=%20black%5CnbuttonText%20=%20randomize%20%5CnnumberOfItems%20=%201%5CnitemSeperator%20=%20%3Cbr/%3E%5Cndescription%5Cn%20%20%7Bimport:simple-gen-footer%7D%5Cn%20%20%20=%20%3Cp%3E%5Bthis.joinItems(%5C%22%3C/p%3E%3Cp%3E%5C%22)%5D%3C/p%3E%20//%20%3C--%20don't%20remove%20this%20last%20line,%20it%20uses%20the%20special%20%5C%22%5C%22%20property%20to%20join%20and%20format%20your%20description%20as%20HTML%20paragraphs%20:)%5Cn%5Cn%5Cn%20=%20%5Banimal%5D%5Cn%5Cn//%20Credit%20goes%20to:%20https://github.com/dariusk/corpora%5Cnanimal%5Cn%20%20aardvark%5Cn%20%20alligator%5Cn%20%20alpaca%5Cn%20%20antelope%5Cn%20%20ape%5Cn%20%20armadillo%5Cn%20%20baboon%5Cn%20%20badger%5Cn%20%20bat%5Cn%20%20bear%5Cn%20%20beaver%5Cn%20%20bison%5Cn%20%20boar%5Cn%20%20buffalo%5Cn%20%20bull%5Cn%20%20camel%5Cn%20%20canary%5Cn%20%20capybara%5Cn%20%20cat%5Cn%20%20chameleon%5Cn%20%20cheetah%5Cn%20%20chimpanzee%5Cn%20%20chinchilla%5Cn%20%20chipmunk%5Cn%20%20cougar%5Cn%20%20cow%5Cn%20%20coyote%5Cn%20%20crocodile%5Cn%20%20crow%5Cn%20%20deer%5Cn%20%20dingo%5Cn%20%20dog%5Cn%20%20donkey%5Cn%20%20dromedary%5Cn%20%20elephant%5Cn%20%20elk%5Cn%20%20ewe%5Cn%20%20ferret%5Cn%20%20finch%5Cn%20%20fish%5Cn%20%20fox%5Cn%20%20frog%5Cn%20%20gazelle%5Cn%20%20gila%20monster%5Cn%20%20giraffe%5Cn%20%20gnu%5Cn%20%20goat%5Cn%20%20gopher%5Cn%20%20gorilla%5Cn%20%20grizzly%20bear%5Cn%20%20ground%20hog%5Cn%20%20guinea%20pig%5Cn%20%20hamster%5Cn%20%20hedgehog%5Cn%20%20hippopotamus%5Cn%20%20hog%5Cn%20%20horse%5Cn%20%20hyena%5Cn%20%20ibex%5Cn%20%20iguana%5Cn%20%20impala%5Cn%20%20jackal%5Cn%20%20jaguar%5Cn%20%20kangaroo%5Cn%20%20koala%5Cn%20%20lamb%5Cn%20%20lemur%5Cn%20%20leopard%5Cn%20%20lion%5Cn%20%20lizard%5Cn%20%20llama%5Cn%20%20lynx%5Cn%20%20mandrill%5Cn%20%20marmoset%5Cn%20%20mink%5Cn%20%20mole%5Cn%20%20mongoose%5Cn%20%20monkey%5Cn%20%20moose%5Cn%20%20mountain%20goat%5Cn%20%20mouse%5Cn%20%20mule%5Cn%20%20muskrat%5Cn%20%20mustang%5Cn%20%20mynah%20bird%5Cn%20%20newt%5Cn%20%20ocelot%5Cn%20%20opossum%5Cn%20%20orangutan%5Cn%20%20oryx%5Cn%20%20otter%5Cn%20%20ox%5Cn%20%20panda%5Cn%20%20panther%5Cn%20%20parakeet%5Cn%20%20parrot%5Cn%20%20pig%5Cn%20%20platypus%5Cn%20%20polar%20bear%5Cn%20%20porcupine%5Cn%20%20porpoise%5Cn%20%20prairie%20dog%5Cn%20%20puma%5Cn%20%20rabbit%5Cn%20%20raccoon%5Cn%20%20ram%5Cn%20%20rat%5Cn%20%20reindeer%5Cn%20%20reptile%5Cn%20%20rhinoceros%5Cn%20%20salamander%5Cn%20%20seal%5Cn%20%20sheep%5Cn%20%20shrew%5Cn%20%20silver%20fox%5Cn%20%20skunk%5Cn%20%20sloth%5Cn%20%20snake%5Cn%20%20squirrel%5Cn%20%20tapir%5Cn%20%20tiger%5Cn%20%20toad%5Cn%20%20turtle%5Cn%20%20walrus%5Cn%20%20warthog%5Cn%20%20weasel%5Cn%20%20whale%5Cn%20%20wildcat%5Cn%20%20wolf%5Cn%20%20wolverine%5Cn%20%20wombat%5Cn%20%20woodchuck%5Cn%20%20yak%5Cn%20%20zebra%5Cn%20%20anaconda%5Cn%20%20anteater%5Cn%20%20bobcat%5Cn%20%20buzzard%5Cn%20%20catfish%5Cn%20%20chicken%5Cn%20%20cobra%5Cn%20%20crab%5Cn%20%20cuckoo%5Cn%20%20dinosaur%5Cn%20%20dolphin%5Cn%20%20dove%5Cn%20%20duck%5Cn%20%20eagle%5Cn%20%20eel%5Cn%20%20emu%5Cn%20%20falcon%5Cn%20%20flamingo%5Cn%20%20goose%5Cn%20%20hare%5Cn%20%20hawk%5Cn%20%20hummingbird%5Cn%20%20lobster%5Cn%20%20meerkat%5Cn%20%20octopus%5Cn%20%20ostrich%5Cn%20%20owl%5Cn%20%20oyster%5Cn%20%20peacock%5Cn%20%20pelican%5Cn%20%20penguin%5Cn%20%20pheasant%5Cn%20%20pigeon%5Cn%20%20pony%5Cn%20%20quail%5Cn%20%20rattlesnake%5Cn%20%20rooster%5Cn%20%20shark%5Cn%20%20sparrow%22,%22imports%22:%5B%22simple-gen-footer%22%5D,%22lastEditTime%22:1725191809726,%22found%22:true%7D,%7B%22name%22:%22vionet20-t2i-styles-importable-v2%22,%22modelText%22:%22//%20Note:%20Text%20that%20comes%20after%20%5C%22//%5C%22%20is%20ignored,%20which%20allows%5Cn//%20you%20to%20write%20notes%20-%20like%20the%20one%20you're%20reading%20now!%5Cn%5Cntitle%5Cn%20%20vionet20-t2i-styles-importable%5Cn%5Cnimg%20=%20%7Bimport:text-to-image-plugin%7D%5Cn%5CnimgPrompt%5Cn%20%20guidanceScale%20=%207%5Cn%20%20//%20style%20=%20width:%20100%25;%5Cn%20%20//%20onFinish(data)%20=%3E%5Cn%20%20//%20%20%20let%20iframe%20=%20data.iframe;%5Cn%20%20//%20%20%20let%20img%20=%20document.createElement('img')%5Cn%20%20//%20%20%20img.src%20=%20data.dataUrl%5Cn%20%20//%20%20%20iframe.replaceWith(img);%5Cn%20%20%20%20%5Cnres%5Cn%20%20512x512%5Cn%20%20768x512%5Cn%20%20512x768%5Cn%20%20768x768%5Cn%5CngetStylesObject()%20=%3E%5Cn%20%20let%20tree%20=%20%5Cn%20%20let%20obj%20=%20%7B%7D%5Cn%20%20Object.keys(tree).forEach(a%20=%3E%20%7B%5Cn%20%20%20%20let%20copy%20=%20tree%5Ba%5D.copyPrompt.evaluateItem.replaceAll('%5B',%20'%5C%5C%5C%5C%5C%5C%5C%5C%5C%5C%5C%5C%5B').replaceAll('%5D',%20'%5C%5C%5C%5C%5C%5C%5C%5C%5C%5C%5C%5C%5D')%5Cn%20%20%20%20let%20prompt%20=%20tree%5Ba%5D.prompt.getRawListText.split('%5C%5Cn').slice(2).join('%5C%5Cn').replace('%5Bthis.getParent.copyPrompt%5D',%20copy).trim()%5Cn%20%20%20%20let%20%5Btrailing,%20negative%5D%20=%20tree%5Ba%5D.negative.getRawListText.split('%5C%5Cn').slice(2).join('%5C%5Cn').trim().split('%5Binput.negative%5D')%5Cn%20%20%20%20let%20neg%20=%20negative%20?%20negative.replaceAll('%5B',%20'%5C%5C%5C%5C%5C%5C%5C%5C%5B').replaceAll('%5D',%20'%5C%5C%5C%5C%5C%5C%5C%5C%5D').trim()%20:%20''%5Cn%20%20%20%20obj%5Ba%5D%20=%20%7B%5Cn%20%20%20%20%20%20prompt:%20prompt,%5Cn%20%20%20%20%20%20negative:%20%5C%22%5Binput.negative%5D%5C%22%20+%20neg%5Cn%20%20%20%20%7D%5Cn%20%20%7D)%5Cn%20%20console.log(obj);%5Cn%20%20%5Cnout()%20=%3E%5Cn%20%20window.input%20=%20%7Bdescription:%20'',%20negative:%20'%3CNEG%3E'%7D%5Cn%20%20let%20arr%20=%20.selectAll.reduce((acc,a)%20=%3E%20%7B%5Cn%20%20%20%20let%20name%20=%20a.getName;%5Cn%20%20%20%20console.log(a.getRawListText)%5Cn%20%20%20%20let%20prompt%20=%20a.prompt.getRawListText.split('=')%5B1%5D.trim()%5Cn%20%20%20%20let%20negative%20=%20%5B...a.getRawListText.matchAll(/%5C%5Cs+negative%20%5C%5C=%20(.+?)$/gm)%5D%5B0%5D%5B1%5D%20//%20.split('=')%5B1%5D.trim()%5Cn%20%20%20%20//%20console.log(prompt,negative);%5Cn%20%20%20%20let%20styles%20=%20%7B%20prompt,%20negative%20%7D%5Cn%20%20%20%20acc%5Bname%5D%20=%20styles%5Cn%20%20%20%20return%20acc%5Cn%20%20%7D)%5Cn%20%20console.log(arr);%5Cn%20%20%5Cn%5Cn%20%20//%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20createCard(a)).join(%5C%22%5C%22)%5D%5Cn%20%20No%20Style%5Cn%20%20%20%20prompt%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.description%5D%5Cn%20%20%20%20copyPrompt%20=%20%5B''%5D%5Cn%20%20%20%20negative%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.negative%5D%5Cn%20%20%20%20%20%20%5Cn%20%20Fineline%20Illustration%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Billustration:100,%20drawing:70%7D)%5D%5Cn%20%20%20%20prompt%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.description%5D,%20%5Bthis.getParent.copyPrompt%5D%5Cn%20%20%20%20copyPrompt%5Cn%20%20%20%20%20%20flat%20colored%20cel-shaded%20fineline%20illustration%20using%20a%200.5mm%20technical%20pen%20in%20crisp%208k%20resolution%20UHD%20by%20Adrian%20Tomine%20and%20Sachin%20Teng%5Cn%20%20%20%20negative%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.negative%5D,%20noisy%20and%20grainy,%203d%20render,%20photograph,%20watermark%20and%20signature%5Cn%20%20%20%20//%20sample_imgs%5Cn%20%20%20%20//%20%20%20//%20*%5Cn%20%20%20%20//%20%20%20//%20%20%20x%20=%20%5Bthis.selectOne%5D%5Cn%20%20%20%20//%20%20%20//%20%20%20prompt%20=%20%5Bthis.x.prompt%5D%5Cn%20%20%20%20//%20%20%20//%20%20%20img%20=%20%5Bthis.x.img%5D%5Cn%20%20%20%20//%20%20%20//%20%20%20size%20=%20%5Bthis.x.size%20%7C%7C%20''%5D%5Cn%20%20%20%20//%20%20%20*%5Cn%20%20%20%20//%20%20%20%20%20prompt%20=%20A%20snobby%20cleric%20waiting%20in%20a%20thriving%20tower,%20Magic%20Realism,%20Lime%20palette,%20Cinematic%20lighting,%20Earnest%5Cn%20%20%20%20//%20%20%20%20%20img%20=%20https://user-uploads.perchance.org/file/9d06387350eb7669c949fa76022461f5.webp%5Cn%20%20%20%20//%20%20%20*%5Cn%20%20%20%20//%20%20%20%20%20prompt%20=%20A%20picturesque%20downs,%20after%20dawn,%20Futuresynth%5Cn%20%20%20%20//%20%20%20%20%20img%20=%20https://user-uploads.perchance.org/file/132cb92af68e157dd6addd09c55bb169.webp%5Cn%20%20%20%20//%20%20%20*%20%5Cn%20%20%20%20//%20%20%20%20%20prompt%20=%20An%20overwhelming%20movie%20frame%20of%20a%20loud%20alien%20planet,%20Zealous%5Cn%20%20%20%20//%20%20%20%20%20img%20=%20https://user-uploads.perchance.org/file/c34a5f84b536a70f5126d6465375a03a.webp%5Cn%20%20%20%20//%20%20%20*%5Cn%20%20%20%20//%20%20%20%20%20prompt%20=%20A%20flashy%20Albanian%20human%20flying%20in%20a%20stunning%20alien%20planet,%20morning,%20Lively%5Cn%20%20%20%20//%20%20%20%20%20img%20=%20https://user-uploads.perchance.org/file/f57a8f5dea478ffe4ff3d1346dd37ac8.webp%5Cn%20%20%20%20//%20%20%20//%20*%5Cn%20%20%20%20//%20%20%20//%20%20%20x%20=%20%5Bthis.selectOne%5D%5Cn%20%20%20%20//%20%20%20//%20%20%20prompt%20=%20%5Bthis.x.prompt%5D%5Cn%20%20%20%20//%20%20%20//%20%20%20img%20=%20%5Bthis.x.img%5D%5Cn%20%20%20%20//%20%20%20//%20%20%20size%20=%20%5Bthis.x.size%20%7C%7C%20''%5D%5Cn%20%20%20%20//%20%20%20*%5Cn%20%20%20%20//%20%20%20%20%20prompt%20=%20A%20careful%20Macedonian%20mercenary%20staring%20at%20you%20in%20a%20dark%20plain,%20Secularism,%20Spotlighting,%20Sympathetic%5Cn%20%20%20%20//%20%20%20%20%20img%20=%20https://user-uploads.perchance.org/file/5a56013dde251358b013893beb1291dd.webp%5Cn%20%20%20%20//%20%20%20%20%20size%20=%20landscape%5Cn%20%20%20%20//%20%20%20*%5Cn%20%20%20%20//%20%20%20%20%20prompt%20=%20An%20overwhelming%20acrylic%20painting%20of%20an%20obscure%20machine%20in%20a%20island,%20midday,%20Hypermodernism,%20Waning%20light,%20Delightful,%20Tilt-Shift%5Cn%20%20%20%20//%20%20%20%20%20img%20=%20https://user-uploads.perchance.org/file/116ee0174fb136b45bdf674368144f8b.webp%5Cn%20%20%20%20//%20%20%20%20%20size%20=%20landscape%5Cn%20%20%20%20//%20%20%20//%20*%5Cn%20%20%20%20//%20%20%20//%20%20%20x%20=%20%5Bthis.selectOne%5D%5Cn%20%20%20%20//%20%20%20//%20%20%20prompt%20=%20%5Bthis.x.prompt%5D%5Cn%20%20%20%20//%20%20%20//%20%20%20img%20=%20%5Bthis.x.img%5D%5Cn%20%20%20%20//%20%20%20//%20%20%20size%20=%20%5Bthis.x.size%20%7C%7C%20''%5D%5Cn%20%20%20%20//%20%20%20*%5Cn%20%20%20%20//%20%20%20%20%20prompt%20=%20A%20deft%20shrew%20fleeing%20in%20an%20unexpected%20quagmire,%20Subtle%20white%20and%20brown%20palette%5Cn%20%20%20%20//%20%20%20%20%20img%20=%20https://user-uploads.perchance.org/file/6e2e3338ca4b63477bb0cf8f3659b3f4.webp%5Cn%20%20%20%20//%20%20%20*%5Cn%20%20%20%20//%20%20%20%20%20prompt%20=%20A%20loud%20road,%20afternoon,%20Furious,%20Cyberpunk%5Cn%20%20%20%20//%20%20%20%20%20img%20=%20https://user-uploads.perchance.org/file/2b8b87a05cfb833836e28bb1b0b0b808.webp%5Cn%20%20%20%20//%20%20%20*%5Cn%20%20%20%20//%20%20%20%20%20prompt%20=%20An%20empty%20shoreline,%20Caustic%20lighting,%20Cheerful%5Cn%20%20%20%20//%20%20%20%20%20img%20=%20https://user-uploads.perchance.org/file/6c1c637f183ebe6341d74e064b4f4fb7.webp%5Cn%20%20%20%20//%20%20%20*%5Cn%20%20%20%20//%20%20%20%20%20prompt%20=%20A%20delightful%20badger%20wandering%20in%20a%20surreal%20village%20in%20a%20plains%5Cn%20%20%20%20//%20%20%20%20%20img%20=%20https://user-uploads.perchance.org/file/ac434c99226d9bae089cde294b26a298.webp%5Cn%20%20%20%20%20%20%20%20%5Cn%5Cn%20%20Flat%20Vector%20Illustration%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Billustration:100,%20logo:70,%20icon:70,%20poster:30%7D)%5D%5Cn%20%20%20%20prompt%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.description%5D,%20%5Bthis.getParent.copyPrompt%5D%5Cn%20%20%20%20copyPrompt%5Cn%20%20%20%20%20%20simple%20minimal%20flat%20colored%20and%20cel-shaded%202d%20vector%20art%20in%20SVG%20UHD%20resolution%20by%20jbstyle%20and%20Michael%20Deforge%5Cn%20%20%20%20negative%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.negative%5D,%20noisy%20and%20grainy,%203d%20render,%20photograph,%20watermark%20and%20signature%5Cn%5Cn%20%20Polygonal%20Illustration%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Billustration:100,%20logo:70,%20icon:70,%20poster:30%7D)%5D%5Cn%20%20%20%20prompt%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.description%5D,%20%5Bthis.getParent.copyPrompt%5D%5Cn%20%20%20%20copyPrompt%5Cn%20%20%20%20%20%20cel-shaded%20very%20low%20poly%20illustration%20in%20style%20of%20Sim%C3%B3n%20Prades,%20Syd%20Mead%20and%20Gregory%20Manchess%20with%20FXAA%20shaders%5Cn%20%20%20%20negative%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.negative%5D,%20highly%20detailed,%20noisy%20and%20grainy,%203d%20render,%20photograph,%20watermark%20and%20signature%5Cn%20%20%20%20%20%20%5Cn%20%20Detailed%20Cartoony%20Illustrations%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Billustration:100,cartoon:70,%20ghibli:50,%20digitalPainting:30,%20anime:10%7D)%5D%5Cn%20%20%20%20prompt%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.description%5D,%20%5Bthis.getParent.copyPrompt%5D%5Cn%20%20%20%20copyPrompt%5Cn%20%20%20%20%20%20digitally%20illustrated%20in%20300%20PPI/DPI%20print,%20in%20cartoon%20style%20of%20Hayao%20Miyazaki,%20and%20rendering%20by%20Zac%20Retz%20and%20Brian%20Kesinger,%20with%20insanely%20intricate%20details%5Cn%20%20%20%20negative%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.negative%5D,%203d%20render,%20photograph,%20noisy%20and%20grainy,%20watermark%20and%20signature%5Cn%20%20Cute%20Cartoon%20Illustrations%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Billustration:100,cartoon:70,%20cute:50,%20digitalPainting:30,%20anime:5%7D)%5D%5Cn%20%20%20%20prompt%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.description%5D,%20%5Bthis.getParent.copyPrompt%5D%5Cn%20%20%20%20copyPrompt%5Cn%20%20%20%20%20%20digitally%20illustrated%20in%20300%20PPI/DPI%20print%20with%20insanely%20intricate%20details,%20in%20cartoon%20style%20by%20Apollonia%20Saintclair%5Cn%20%20%20%20negative%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.negative%5D,%203d%20render,%20photograph,%20painting,%20noisy%20and%20grainy,%20watermark%20and%20signature%5Cn%20%20%5Cn%20%20Comic/Manga%20Illustration%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Billustration:100,comic:70,%20manga:50,fantasy:%2040,%20anime:40%7D)%5D%5Cn%20%20%20%20prompt%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.description%5D,%20%5Bthis.getParent.copyPrompt%5D%5Cn%20%20%20%20copyPrompt%5Cn%20%20%20%20%20%20smooth%20cel-shaded%20digital%20illustration%20with%20details%20by%20Siya%20Oum,%20Ruan%20Jia,%20and%20character%20design%20style%20by%20Alex%20Toth,%20Jim%20Lee,%20Neal%20Adams%5Cn%20%20%20%20negative%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.negative%5D,%20highly%20detailed,%20noisy%20and%20grainy,%203d%20render,%20photograph,%20watermark%20and%20signature%5Cn%5Cn%20%20Grim%20Dark%20Fantasy%20Illustration%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Billustration:100,comic:70,%20manga:50,fantasy:%2040,%20anime:40,creepy:50%7D)%5D%5Cn%20%20%20%20prompt%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.description%5D,%20%5Bthis.getParent.copyPrompt%5D%5Cn%20%20%20%20copyPrompt%5Cn%20%20%20%20%20%20grim%20dark%20fantasy%20digital%20painting%20with%20design%20by%20Peder%20Balkeby%20and%20Mike%20Mignola%20and%20atmosphere%20by%20Zdzis%C5%82aw%20Beksi%C5%84ski%20and%20Y%C5%8Dji%20Shinkawa%20in%20low%20light%20moody%20lighting%5Cn%20%20%20%20negative%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.negative%5D,%20highly%20detailed,%20noisy%20and%20grainy,%203d%20render,%20photograph,%20watermark%20and%20signature%5Cn%20%20%5Cn%20%20General%20High%20Quality%20Anime%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Billustration:100,anime:70,%20color:50%7D)%5D%5Cn%20%20%20%20prompt%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.description%5D,%20%5Bthis.getParent.copyPrompt%5D%5Cn%20%20%20%20copyPrompt%5Cn%20%20%20%20%20%20digitally%20illustrated%20in%204k%20UHD%20resolution,%20in%20anime%20style%20of%20Kohei%20Horikoshi%20+%20Keith%20Negley%20+%20Makoto%20Yukimura%5Cn%20%20%20%20negative%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.negative%5D,%20highly%20detailed,%20noisy%20and%20grainy,%203d%20render,%20watermarks%20and%20signatures%5Cn%20%20Old%20Style%20Anime%20A%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Billustration:100,anime:70,%20comic:70,%20manga:50,fantasy:%2040%7D)%5D%5Cn%20%20%20%20prompt%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.description%5D,%20%5Bthis.getParent.copyPrompt%5D%5Cn%20%20%20%20copyPrompt%5Cn%20%20%20%20%20%20digitally%20illustrated,%20in%20old%20anime%20style%20of%20Yoshiyuki%20Sadamoto%20+%20Makoto%20Yukimura%20+%20Katsuhiro%20Otomo%20+%20Makoto%20Shinkai,%20with%20line%20art%20in%20Zebra%20G%20Nib%20and%20colored%20with%20Copic%20markers%5Cn%20%20%20%20negative%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.negative%5D,%20highly%20detailed,%20noisy%20and%20grainy%5Cn%5Cn%20%20Old%20Style%20Anime%20B%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Billustration:100,anime:70,%20comic:70,%20manga:50,fantasy:%2040%7D)%5D%5Cn%20%20%20%20prompt%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.description%5D,%20%5Bthis.getParent.copyPrompt%5D%5Cn%20%20%20%20copyPrompt%5Cn%20%20%20%20%20%20in%20anime%20style%20of%20Gosho%20Aoyama%20+%20Osamu%20Tezuka%20+%20Katsuhiro%20Otomo,%201890s%20manga%20comics,%20heavily%20stylized%20cartoon%20anime%5Cn%20%20%20%20negative%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.negative%5D,%20noisy%20and%20grainy,%20highly%20detailed%5Cn%20%20Color%20Pop%20Anime%20Illustration%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Billustration:100,anime:70,%20color:50,pop:%2040%7D)%5D%5Cn%20%20%20%20prompt%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.description%5D,%20%5Bthis.getParent.copyPrompt%5D%5Cn%20%20%20%20copyPrompt%5Cn%20%20%20%20%20%20limited%20color%20palette%20in%20cel%20shading%20with%20popping%20vibrant%20colors,%20digitally%20illustrated,%20in%20anime%20style%20of%20Sui%20Ishida%20+%20Kohei%20Horikoshi%20in%20300%20PPI/DPI%20resolution%5Cn%20%20%20%20negative%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.negative%5D,%20highly%20detailed,%203d%20render%20and%20photo,%20noisy%20and%20grainy%5Cn%20%20%20%20%5Cn%20%20Colored%20Patterns%20Anime%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Billustration:100,anime:70,%20color:50,patterns:%2040%7D)%5D%5Cn%20%20%20%20prompt%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.description%5D,%20%5Bthis.getParent.copyPrompt%5D%5Cn%20%20%20%20copyPrompt%5Cn%20%20%20%20%20%20littered%20with%20patterns%20and%20shapes%20of%20Ernst%20Wilhelm%20Nay%20+%20Stanley%20Pinker%20+%20Clovis%20Trouille,%20digitally%20illustrated,%20in%20anime%20style%20of%20Sui%20Ishida%20+%20Frank%20Hong%20+%20Kohei%20Horikoshi%20in%20600%20PPI/DPI%20resolution%5Cn%20%20%20%20negative%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.negative%5D,%20highly%20detailed,%203d%20render%20and%20photo,%20noisy%20and%20grainy%5Cn%20%20%20%20%20%20%5Cn%20%20Atmospheric%20Painting%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bpainting:100,%20oilPainting:50,%20cinematic:30%7D)%5D%5Cn%20%20%20%20prompt%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.description%5D,%20%5Bthis.getParent.copyPrompt%5D%5Cn%20%20%20%20copyPrompt%5Cn%20%20%20%20%20%20masterful%20painting%20by%20Gregory%20Manchess,%20with%20soft%20blurry%20atmosphere%20in%20style%20of%20Zao%20Wou-Ki%20and%20expressionism%20by%20Karl%20Wilhelm%20Diefenbach%5Cn%20%20%20%20negative%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.negative%5D,%20highly%20detailed,%20noisy%20and%20grainy,%203d%20render,%20photograph,%20watermark%20and%20signature%5Cn%5Cn%20%20%20%20//%20sample_imgs%5Cn%20%20%20%20%20%20//%20*%5Cn%20%20%20%20%20%20//%20%20%20x%20=%20%5Bthis.selectOne%5D%5Cn%20%20%20%20%20%20//%20%20%20prompt%20=%20%5Bthis.x.prompt%5D%5Cn%20%20%20%20%20%20//%20%20%20img%20=%20%5Bthis.x.img%5D%5Cn%20%20%20%20%20%20//%20%20%20size%20=%20%5Bthis.x.size%20%7C%7C%20''%5D%5Cn%20%20%20%20%20%20//%20*%5Cn%20%20%20%20%20%20//%20%20%20prompt%20=%20An%20inventive%20vampire%20in%20a%20stunning%20desolate%20house,%20Anaglyph%20Filter%5Cn%20%20%20%20%20%20//%20%20%20img%20=%20https://user-uploads.perchance.org/file/cc6319acce82178846b4c5187fdaffd4.webp%5Cn%20%20%20%20%20%20//%20*%5Cn%20%20%20%20%20%20//%20%20%20prompt%20=%20An%20intense%20monastery%20in%20a%20islands,%20Indigo%20and%20purple%20palette%5Cn%20%20%20%20%20%20//%20%20%20img%20=%20https://user-uploads.perchance.org/file/f35c71d58e16c475f7107e6bf19ad518.webp%5Cn%20%20%20%20%20%20//%20*%5Cn%20%20%20%20%20%20//%20%20%20prompt%20=%20An%20intricate%20portal%20in%20a%20shopping%20mall,%20in%20the%20golden%20hour,%20Tachisme%5Cn%20%20%20%20%20%20//%20%20%20img%20=%20https://user-uploads.perchance.org/file/d85a5a0079c1df806780eeb3ae95e35d.webp%5Cn%20%20%20%20%20%20//%20*%5Cn%20%20%20%20%20%20//%20%20%20prompt%20=%20A%20loud%20lake,%20dawn,%20Subtle%20orange%20and%20pink%20colour%20scheme,%20Cinematic%20lighting,%20Forestpunk%5Cn%20%20%20%20%20%20//%20%20%20img%20=%20https://user-uploads.perchance.org/file/a5768a5fd90a28ac373f25da2aaa1316.webp%5Cn%20%20%20%20%20%20//%20%20%20size%20=%20landscape%5Cn%20%20%20%20%20%20//%20*%5Cn%20%20%20%20%20%20//%20%20%20prompt%20=%20%5Cn%20%20%20%20%20%20//%20%20%20img%20=%20https://user-uploads.perchance.org/file/cf4d48b40358066d1b1927ab80127fff.webp%5Cn%20%20%20%20%20%20//%20%20%20size%20=%20landscape%5Cn%20%20Brushy%20Paintings%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bpainting:100,%20oilPainting:50,%20portrait:40,%20landscape:40,%20cinematic:30%7D)%5D%5Cn%20%20%20%20prompt%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.description%5D,%20%5Bthis.getParent.copyPrompt%5D%5Cn%20%20%20%20copyPrompt%5Cn%20%20%20%20%20%20brushy%20digital%20painting%20by%20Cathleen%20McAllister,%20John%20Singer%20Sargent,%20with%20large%20brush%20strokes%20in%20style%20of%20Gregg%20Manchess,%20and%20smooth%20abstract%20atmosphere%20background%20by%20Zao%20Wou-Ki%20and%20Jackson%20Pollock%20in%208k%20UHD%20resolution%5Cn%20%20%20%20negative%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.negative%5D,%20watermark%20and%20signature,%20noisy%20and%20grainy,%203d%20render%5Cn%5Cn%20%20Brushy%20Paintings%202%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bpainting:100,%20oilPainting:50,%20portrait:40,%20landscape:40,%20cinematic:30%7D)%5D%5Cn%20%20%20%20prompt%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.description%5D,%20%5Bthis.getParent.copyPrompt%5D%5Cn%20%20%20%20copyPrompt%5Cn%20%20%20%20%20%20brushy%20masterpiece%20painting%20with%20rough%20textured%20visible%20brush%20strokes%20and%20shapes%20in%20the%20style%20of%20Colin%20Campbell%20Cooper,%20with%20atmospheric%20background%20by%20Gy%C3%B6rgy%20Kepes%20and%20Zou%20Wou-Ki%5Cn%20%20%20%20negative%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.negative%5D,%20highly%20detailed,%20noisy%20and%20grainy,%203d%20render,%20photograph,%20watermark%20and%20signature%5Cn%5Cn%20%20%20%20%20%20%5Cn%20%20Drip/Palette%20Knife%20Paintings%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bpainting:100,%20oilPainting:50,%20portrait:40,%20landscape:40,%20cinematic:30%7D)%5D%5Cn%20%20%20%20prompt%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.description%5D,%20%5Bthis.getParent.copyPrompt%5D%5Cn%20%20%20%20copyPrompt%5Cn%20%20%20%20%20%20drip/palette%20knife%20painting%20in%20style%20of%20Pino%20Daeni%20with%20large%20thick%20paint%20impastos%20and%20background%20in%20style%20of%20Bill%20Sienkiewicz%20and%20Jackson%20Pollock%5Cn%20%20%20%20negative%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.negative%5D,%20highly%20detailed,%20noisy%20and%20grainy,%203d%20render,%20photograph,%20watermark%20and%20signature%5Cn%5Cn%5Cn%20%20Anime-Realism%20Paintings%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Banime:%20100,%20painting:100,%20oilPainting:50,%20portrait:40,%20landscape:40,%20cinematic:30%7D)%5D%5Cn%20%20%20%20prompt%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.description%5D,%20%5Bthis.getParent.copyPrompt%5D%5Cn%20%20%20%20copyPrompt%5Cn%20%20%20%20%20%20realist%20art%20painting%20in%20style%20of%20Ilya%20Repin,%20Gustave%20Couebrt,%20and%20Anders%20Zorn%20with%20soft%20diffused%20lighting,%20in%20anime%20style%20by%20Stanley%20Lau%20and%20Wlop,%20realism%20art%20movement,%20raw%20photo%5Cn%20%20%20%20negative%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.negative%5D,%20highly%20detailed,%20noisy%20and%20grainy,%203d%20render,%20photograph,%20watermark%20and%20signature%5Cn%5Cn%20%20%20%20%20%20%5Cn%20%20Anime-Impressionism%20Paintings%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Banime:%20100,%20painting:100,%20oilPainting:50,%20portrait:40,%20landscape:40,%20cinematic:30%7D)%5D%5Cn%20%20%20%20prompt%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.description%5D,%20%5Bthis.getParent.copyPrompt%5D%5Cn%20%20%20%20copyPrompt%5Cn%20%20%20%20%20%20impressionist%20art%20painting%20in%20style%20of%20Claude%20Monet,%20Mary%20Cassatt,%20and%20James%20McNeill%20Whistler%20with%20soft%20diffused%20lighting,%20in%20anime%20style%20by%20Stanley%20Lau%20and%20Wlop,%20impressionism%20art%20movement,%20raw%20photo%5Cn%20%20%20%20negative%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.negative%5D,%20highly%20detailed,%20noisy%20and%20grainy,%203d%20render,%20photograph,%20watermark%20and%20signature%5Cn%5Cn%20%20%20%20%20%20%5Cn%20%20Vintage%20Anime-Realistic%20Render%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Banime:%20100,%20illustration:100,%20drawing:50,%20portrait:40,%20landscape:40,%20cinematic:30%7D)%5D%5Cn%20%20%20%20prompt%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.description%5D,%20%5Bthis.getParent.copyPrompt%5D%5Cn%20%20%20%20copyPrompt%5Cn%20%20%20%20%20%20vintage%20anime%20illustration%20in%20style%20of%20Hajime%20Sorayama,%20Scott%20Naismith,%20and%20Anton%20Fadeev%20in%201200%20dpi%20resolution%5Cn%20%20%20%20negative%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.negative%5D,%20highly%20detailed,%20noisy%20and%20grainy,%203d%20render,%20photograph,%20watermark%20and%20signature%5Cn%5Cn%20%20%20%20%20%20%5Cn%20%20Wetplate%20Photo%20Look%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bportrait:70,%20photo:70,%20cinematic:50,%20vintage:60,%20creepy:30%7D)%5D%5Cn%20%20%20%20prompt%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.description%5D,%20%5Bthis.getParent.copyPrompt%5D%5Cn%20%20%20%20copyPrompt%5Cn%20%20%20%20%20%20age-old%20wet%20plate%20photo%20retrieved%20from%20a%20time%20capsule%20in%204k%20with%20grunge%20texture%5Cn%20%20%20%20negative%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.negative%5D,%20highly%20detailed,%20noisy%20and%20grainy,%203d%20render,%20watermarks%20and%20signatures%5Cn%20%20%20%20%20%20%5Cn%20%20B&W%20Photo%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bportrait:100,%20photo:80,%20cinematic:50,%20vintage:10%7D)%5D%5Cn%20%20%20%20prompt%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.description%5D,%20%5Bthis.getParent.copyPrompt%5D%5Cn%20%20%20%20copyPrompt%5Cn%20%20%20%20%20%20b/w%20stock%20photo%20in%20style%20of%20David%20Bailey%20in%208k%20raw%20resolution%20with%20monochromatic%20palette,%20contrast%20lighting%5Cn%20%20%20%20negative%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.negative%5D,%20highly%20detailed,%20noisy%20and%20grainy,%203d%20render,%20illustration,%20watermarks%20and%20signatures%5Cn%20%20%5Cn%20%20*Realistic*%20Portraits%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bportrait:100,%20photo:100,%20casualPhoto:50,%20cinematic:30%7D)%5D%5Cn%20%20%20%20prompt%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.description%5D,%20%5Bthis.getParent.copyPrompt%5D%5Cn%20%20%20%20copyPrompt%5Cn%20%20%20%20%20%20amateur%20portrait%20photo,%20shot%20candidly%20in%208k%20resolution%20without%20color%20grading%20and%20correction,%20raw%20photo%5Cn%20%20%20%20negative%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.negative%5D,%20highly%20detailed,%20noisy%20and%20grainy,%203d%20render,%20illustration,%20drawing,%20watermarks%20and%20signatures%5Cn%20%20%5Cn%20%20*Realistic*%20Anime%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bphotograph:100,anime:70,realism:%2040%7D)%5D%5Cn%20%20%20%20prompt%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.description%5D,%20%5Bthis.getParent.copyPrompt%5D%5Cn%20%20%20%20copyPrompt%5Cn%20%20%20%20%20%20realistic%20anime%20painting%20in%20anime%20style%20of%20Anders%20Zorn%20and%20Mike%20Dargas%20with%20smooth%20cel-shading,%20digitally%20painted%20in%208k%20resolution,%20realistic%20art%5Cn%20%20%20%20negative%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.negative%5D,%20highly%20detailed,%20noisy%20and%20grainy,%203d%20render,%20watermarks%20and%20signatures%5Cn%20%20%5Cn%20%20Sims/Runescape%20Graphics%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Brender:100,%20cinematic:50,%20threeDimensional:60,%20fantasy:30%7D)%5D%5Cn%20%20%20%20prompt%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.description%5D,%20%5Bthis.getParent.copyPrompt%5D%5Cn%20%20%20%20copyPrompt%5Cn%20%20%20%20%20%20ray-traced%203d%20render%20in%20Unreal%20Engine%204,%20with%20volumetric%20lighting%20in%208k%20resolution,%20and%20in%20the%20universe%20of%20The%20Sims%204%20and%20Old%20School%20RuneScape%5Cn%20%20%20%20negative%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.negative%5D,%20highly%20detailed,%20noisy%20and%20grainy,%20illustration,%20painting,%20drawing,%20watermarks%20and%20signatures%5Cn%20%20%5Cn%20%20Noisy/Grainy%20Effect%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Brender:100,%20filter:80,%20effects:60%7D)%5D%5Cn%20%20%20%20prompt%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.description%5D,%20%5Bthis.getParent.copyPrompt%5D%5Cn%20%20%20%20copyPrompt%5Cn%20%20%20%20%20%20noisy%20and%20grainy%20dithered%20illustration,%20in%20textured%20background,%20displayed%20with%208-bit%20VGA%20color%20space%20in%20Macintosh%20LC%20display,%20soft%20double%20exposure%5Cn%20%20%20%20negative%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.negative%5D,%20highly%20detailed,%203d%20render,%20photograph,%20painting,%20watermarks%20and%20signatures%5Cn%5Cn%20%20//%20Glamrock%20Quilt%20Fashion%20WIP%5Cn%20%20//%20%20%20meta:tags%20=%20%5B(%7Bportrait:50,%20casualPhoto:30%7D)%5D%5Cn%20%20//%20%20%20prompt%5Cn%20%20//%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20//%20%20%20%20%20%5Binput.description%5D,%20%5Bthis.getParent.copyPrompt%5D%5Cn%20%20//%20%20%20copyPrompt%5Cn%20%20//%20%20%20%20%20,%20candid%20headshot,%20photography,%20quilt,%20%5C%5C%5Bquiltglamrock:crazy%20quilt%20textured:0.2%5C%5C%5D%20fashion,%20sfx,%20%5C%5C%5BJohn%20Singer%20Sargent:Anders%20Zorn:0.6%5C%5C%5D%5Cn%20%20//%20%20%20negative%5Cn%20%20//%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20//%20%20%20%20%20%5Binput.negative%5D,%20signature,%20nsfw,%20nude,%20nipples%20BREAK%20blurry,%20out%20of%20focus,%20depth%20of%20field,%20vignette,%20painting,%20anime,%203d%20render,%20cgi,%20drawing,%20(worst%20quality,%20low%20quality,%20normal%20quality:1.1)%5Cn%5Cn%20%20Stained%20Glass%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bpainting:40,%20illustration:30%7D)%5D%5Cn%20%20%20%20prompt%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.description%5D,%20%5Bthis.getParent.copyPrompt%5D%5Cn%20%20%20%20copyPrompt%5Cn%20%20%20%20%20%20stained-glass%20art%20in%20a%20stained-glass%20window%20in%208k%20resolution,%20digital%20stained-glass%20illustration%20masterpiece%5Cn%20%20%20%20negative%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.negative%5D,%20highly%20detailed,%203d%20render,%20photograph,%20painting,%20watermarks%20and%20signatures%5Cn%5Cn%20%20Marble%20Sculpture%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bsculpture:40,%20threeDimensional:30%7D)%5D%5Cn%20%20%20%20prompt%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.description%5D,%20%5Bthis.getParent.copyPrompt%5D%5Cn%20%20%20%20copyPrompt%5Cn%20%20%20%20%20%20realistic%20sculpture%20out%20of%20smooth%20marble%20stone,%20shot%20in%204k%20resolution%20with%20ambient%20occlusion,%20plaster%20texture%5Cn%20%20%20%20negative%5Cn%20%20%20%20%20%20%20=%20%5Bthis.selectAll.map(a%20=%3E%20a.getRawListText).join(%5C%22%5C%22)%5D%5Cn%20%20%20%20%20%20%5Binput.negative%5D,%20highly%20detailed,%203d%20render,%20illustration,%20painting,%20noise%20and%20grainy,%20watermarks%20and%20signatures%5Cn%5Cn%5Cn%5Cn%5Cn//%20ci%20=%20%7Bimport:create-instance-plugin%7D%5CncreateCard(a)%20=%3E%5Cn%20%20console.log(a.getName)%5Cn%20%20let%20id%20=%20a.getName.replaceAll(/%5C%5CW/g,%20'').replaceAll(%5C%22%20%5C%22,%20%5C%22%5C%22)%5Cn%20%20return%20%60%5Cn%20%20%3Cfieldset%20class=%5C%22style-con%5C%22%3E%5Cn%20%20%20%20%3Csummary%3E%3Ch2%3E$%7Ba.getName%7D%3C/h2%3E%3C/summary%3E%5Cn%20%20%20%20%3Cdiv%20id=%5C%22$%7Bid%7D%5C%22%20class=%5C%22img-con%5C%22%3E%5Cn%20%20%20%20%3C/div%3E%5Cn%20%20%20%20%3Cpre%3E$%7Ba.copyPrompt.replaceText('%5B',%20'%5C%5C%5C%5C%5B').replaceText('%5D',%20'%5C%5C%5C%5C%5D').trim()%7D%3C/pre%3E%5Cn%20%20%20%20%3Cpre%3E$%7Ba.negative.replaceText('%5B',%20'%5C%5C%5C%5C%5B').replaceText('%5D',%20'%5C%5C%5C%5C%5D').trim()%7D%3C/pre%3E%5Cn%20%20%20%20%3Cbutton%20style=%5C%22position:%20absolute;%20top:%20-1.25rem;%20right:%201.5em;%20border:%20none;%20background:%20white;%20border-radius:%2050%25;%20font-size:%201.75rem;%20z-index:%20999;%5C%22%20onclick=%5C%22$%7Bid%7D.innerHTML%20=%20''%5C%22%20title=%5C%22remove%20images?%5C%22%3E%3Ci%20class=%5C%22bi-trash-fill%5C%22%3E%3C/i%3E%3C/button%3E%5Cn%5Cn%20%20%20%20%3Cbutton%20style=%5C%22position:%20absolute;%20top:%20-1.5rem;%20right:%200;%20border:%20none;%20background:%20white;%20border-radius:%2050%25;%20font-size:%202rem;%20z-index:%20999;%5C%22%20onclick=%5C%22reloadImages('$%7Ba.getName%7D')%5C%22%20title=%5C%22add/reload%20images?%5C%22%3E%3Ci%20class=%5C%22bi-arrow-repeat%5C%22%3E%3C/i%3E%3C/button%3E%5Cn%20%20%3C/fieldset%3E%60%5Cn%5CnreloadImages(style)%20=%3E%5Cn%20%20let%20selectedStyle%20=%20%5Bstyle%5D%5Cn%20%20let%20con%20=%20document.getElementById(style.replaceAll(/%5C%5CW/g,%20'').replaceAll(%5C%22%20%5C%22,%20%5C%22%5C%22));%5Cn%20%20console.log(con);%5Cn%20%20let%20seed%20=%20Number(Math.random().toString().slice(12))%5Cn%20%20let%20html%20=%20new%20Array(4).fill(0).map((b,i)%20=%3E%20%7B%5Cn%20%20%20%20let%20x%20=%20imgPrompt%5Cn%20%20%20%20x.seed%20=%20seed%5Cn%20%20%20%20x.prompt%20=%20selectedStyle.prompt%5Cn%20%20%20%20x.negativePrompt%20=%20selectedStyle.negative%5Cn%20%20%20%20x.resolution%20=%20res.selectAll%5Bi%20%25%204%5D%5Cn%20%20%20%20return%20%60%3Cfigure%20data-res=%5C%22$%7Bres.selectAll%5Bi%20%25%204%5D%7D%5C%22%3E$%7Bimg(x)%7D%3Cfigcaption%3E$%7BlastTextToImagePrompt.replaceText('%5B',%20'%5C%5C%5C%5C%5B').replaceText('%5D',%20'%5C%5C%5C%5C%5D').replaceAll(selectedStyle.copyPrompt.replaceText('%5B',%20'%5C%5C%5C%5C%5B').replaceText('%5D',%20'%5C%5C%5C%5C%5D').trim(),%20'').trim()%7D%3C/figcaption%3E%3C/figure%3E%60%5Cn%20%20%7D).join(%5C%22%5C%22)%5Cn%20%20con.innerHTML%20=%20html;%5Cn%5CngetPromptObj()%20=%3E%5Cn%20%20let%20obj%20=%20Object.entries(%7B...%7D)%5Cn%20%20obj.forEach((a,i,arr)%20=%3E%20arr%5Bi%5D%20=%20%5Ba%5B0%5D,%20Object.entries(a%5B1%5D)%5D)%5Cn%20%20obj.forEach((a,i,arr)%20=%3E%20arr%5Bi%5D%20=%20%5Ba%5B0%5D,%20a%5B1%5D.map((b,ib,barr)%20=%3E%20barr%5Bib%5D%20=%20%5Bb%5B0%5D,%20(x%20=%20b%5B1%5D.getRawListText.split('%5C%5Cn'),%20%20x%20=%20x.getLength%20%3E%202%20?%20x.slice(2).join('%5C%5Cn')%20:%20x.slice(1).join('%5C%5Cn'),%20x.toString().trim())%5D)%5D)%5Cn%20%20obj.forEach((a,i,arr)%20=%3E%20arr%5Bi%5D%20=%20%5Ba%5B0%5D,%20Object.fromEntries(%5B...a%5B1%5D%5D)%5D)%5Cn%20%20obj.forEach((a,i,arr)%20=%3E%20arr%5Bi%5D%20=%20%5Ba%5B0%5D,%20(a%5B1%5D.prompt%20=%20a%5B1%5D.prompt.replace('%5Bthis.getParent.copyPrompt%5D',%20a%5B1%5D.copyPrompt).replaceAll('%5C%5C%5C%5C%5B',%20'%5C%5C%5C%5C%5C%5C%5C%5C%5C%5C%5C%5C%5B').replaceAll('%5C%5C%5C%5C%5D',%20'%5C%5C%5C%5C%5C%5C%5C%5C%5C%5C%5C%5C%5D'),delete%20a%5B1%5D.copyPrompt,%20a%5B1%5D)%5D)%5Cn%20%20//%20console.log(obj);%5Cn%20%20console.log(Object.fromEntries(obj));%5Cn%20%20//%20obj%20=%20obj.map(a%20=%3E%20Object.fromEntries(%5Ba%5B0%5D,%20a%5B1%5D%5Cn%20%20%5Cn%20%20%5Cn%20%20return%20''%5Cn%5CnrandomDescription%5Cn%20%20%7Benigmatic%7Cmysterious%7D%20%7Bdemon%7Cangel%7Cghost%7D%20%7Bqueen%7Cking%7Cprince%7Cprincess%7Cemperor%7D%20%7Bsitting%20on%7Cstanding%20beside%7D%20%7Btheir%20throne%7Ca%20cosmic%20altar%7D,%20%7Ba%20horde%20of%20minions%7Can%20array%20of%20celestial%20servants%7Ca%20legion%20of%20spectral%20beings%7D%20%7Bbehind%7Cin%20front%20of%7D%20then,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20portrait%20of%20%7Ba%7D%20%7Bimport:animal%7D-%7Bman%7Cwoman%7D,%20%7Bservant%7Cgod%7Cpriest%7Cwarrior%7Cgardener%7Ckeeper%7D%20of%20%7Bthe%20underworld%7Cthe%20seven%20worlds%7Clight%7Cdarkness%7Cjungle%20world%7Ccybercrystal%7Cblue%20fire%7Celectrical%20storms%7Cthe%20deep%20heart%7Cthe%20overworld%7Cluxury%7Cdragonkind%7D%5Cn%20%20%7Ba%7D%20%7Bcute%20%7C%5E3%7D%7Bimport:animal%7D%20x%20%7Bimport:animal%7D%20hybrid,%20pokemon-like%20creature%5Cn%20%20%7Bcyborg%7Csteampunk%7Cmagical%7D%20%7Bmermaid%7Cmerman%7Cdolphin%7D%20exploring%20%7Ba%20coral%20reef%7Can%20underwater%20city%7Cunderwater%20dunes%7D%5Cn%20%20%7Bsteampunk%7Cfuturistic%7Cancient%7D%20explorer%20with%20%7Ban%20airship%7Ca%20hoverbike%7Ca%20time-traveling%20artifact%7D%5Cn%20%20%7Bgraceful%7Cagile%7Cmysterious%7D%20%7Balien%7Chuman%7Crobotic%7D%20dancer%20performing%20%7Bon%20stage%7Cin%20a%20street%7Cin%20moonlight%7D%5Cn%20%20%7Bneon%7Csunset%7Cmoonlit%7D%20cityscape%20during%20%7Ba%20rainstorm%7Ca%20snowfall%7Ca%20meteor%20shower%7D%5Cn%20%20%7Bmagical%7Cenchanted%7Ccursed%7D%20forest%20guarded%20by%20%7Bgiant%20mushrooms%7Csentient%20trees%7Cwhimsical%20spirits%7D%5Cn%20%20%7Blonely%7Cbrave%7Ccurious%7D%20lighthouse%20keeper%20with%20%7Ba%20ghostly%7Can%20animal%7Ca%20supernatural%7D%20companion%5Cn%20%20%7Bhaunted%7Cabandoned%7Cancient%7D%20mansion%20inhabited%20by%20%7Bquirky%7Ccreepy%7Ckind%7D%20spirits%5Cn%20%20%7Bfuturistic%7Cold-fashioned%7Cmagical%7D%20train%20racing%20through%20%7Ba%20desert%7Ca%20tundra%7Ca%20jungle%7D%20landscape%5Cn%20%20%7Bunderwater%7Csky%7Cspace%7D%20pirate%20captain%20with%20%7Ba%20submarine%7Can%20airship%7Ca%20spaceship%7D%20ship%5Cn%20%20%7Btime-traveling%7Cinterdimensional%7Csupernatural%7D%20detective%20with%20%7Ba%20pet%20dinosaur%7Ca%20ghostly%20sidekick%7Ca%20shape-shifting%20familiar%7D%5Cn%20%20%7Brobotic%7Cmedieval%7Cfantasy%7D%20knight%20jousting%20on%20%7Ba%20mechanical%7Ca%20fire-breathing%7Ca%20spectral%7D%20horse%5Cn%20%20%7Bethereal%7Cancient%7Ccosmic%7D%20space%20goddess%20floating%20among%20%7Bstars%7Cnebulae%7Cgalaxies%7D%5Cn%20%20%7Bwise%7Cancient%7Cintelligent%7D%20%7Btree%7Crock%7Ccloud%7D%20spirit%20with%20%7Ba%20magical%20staff%7Ca%20crystal%20orb%7Can%20enchanted%20flute%7D%5Cn%20%20%7Bsuperhero%7Cvillain%7Cantihero%7D%20with%20the%20ability%20to%20control%20%7Bplants%7Cweather%7Cfire%7D%5Cn%20%20%7Bflying%7Chovering%7Csubmersible%7D%20car%20chase%20through%20%7Ba%20futuristic%7Can%20underwater%7Ca%20post-apocalyptic%7D%20city%5Cn%20%20%7Bunderwater%7Cfloating%7Chidden%7D%20cityscape%20lit%20by%20%7Bbioluminescent%20plants%7Cancient%20crystals%7Cmagical%20torches%7D%5Cn%20%20%7Bmystical%7Ccursed%7Cprehistoric%7D%20cave%20with%20%7Bglowing%20crystal%7Cshimmering%20ice%7Cluminescent%20fungus%7D%20formations%5Cn%20%20%7Bpost-apocalyptic%7Cfuturistic%7Cancient%7D%20wanderer%20with%20%7Ba%20pet%20robot%7Ca%20loyal%20animal%20companion%7Ca%20supernatural%20guide%7D%5Cn%20%20%7Bmasked%7Carmored%7Cstealthy%7D%20vigilante%20perched%20%7Bon%20a%20skyscraper%7Cin%20a%20tree%7Catop%20a%20cliff%7D%5Cn%20%20%7Bsorceress%7Cwitch%7Calchemist%7D%20brewing%20%7Ba%20potion%7Ca%20spell%7Ca%20concoction%7D%20in%20%7Bher%20hidden%20lair%7Ca%20secret%20cave%7Can%20enchanted%20laboratory%7D%5Cn%20%20%7Bsteampunk%7Ccyberpunk%7Cfantasy%7D%20inventor%20with%20%7Ba%20mechanical%7Ca%20magical%7Ca%20sentient%7D%20companion%5Cn%20%20%7Bcyberpunk%7Cinterstellar%7Cparanormal%7D%20hacker%20in%20%7Ba%20digital%20world%7Ca%20secret%20network%7Can%20alternate%20reality%7D%5Cn%20%20%7Benchanted%7Cfairy-tale%7Csecret%7D%20garden%20filled%20with%20%7Bmythical%7Cunusual%7Cmagical%7D%20creatures%5Cn%20%20%7Bcute%7Cfierce%7Cfriendly%7D%20monster%20family%20%7Bgoing%20on%20a%20picnic%7Cexploring%20a%20forest%7Cvisiting%20a%20village%7D%5Cn%20%20%7Bastronaut%7Calien%7Ctime-traveler%7D%20discovering%20%7Ban%20alien%20oasis%7Ca%20hidden%20planet%7Ca%20realm%20beyond%20time%7D%5Cn%20%20%7Bold-fashioned%7Cmodern%7Cmagical%7D%20%7Bice%20cream%7Ccandy%7Cdessert%7D%20parlour%20with%20%7Bmagical%7Cunusual%7Cdangerous%7D%20flavors%5Cn%20%20%7Babandoned%7Chaunted%7Cenchanted%7D%20amusement%20park%20%7Breclaimed%20by%20nature%7Cinhabited%20by%20spirits%7Cguarded%20by%20creatures%7D%5Cn%20%20%7Bwarrior%7Csorceress%7Cqueen%7D%20riding%20%7Ba%20mythical%7Ca%20giant%7Can%20elemental%7D%20beast%5Cn%20%20%7Bvintage%7Cmodern%7Cotherworldly%7D%20circus%20with%20%7Bsupernatural%7Cmagical%7Cdangerous%7D%20performers%5Cn%20%20%7Botherworldly%7Cmajestic%7Cmysterious%7D%20library%20filled%20with%20%7Bancient%7Cenchanted%7Cforbidden%7D%20tomes%5Cn%20%20%7Bintrepid%7Cfearless%7Cdaring%7D%20explorer%20navigating%20%7Ba%20perilous%7Ca%20mysterious%7Can%20enchanted%7D%20jungle%5Cn%20%20%7Bcozy%7Cremote%7Cenchanted%7D%20cottage%20in%20%7Bthe%20mountains%7Ca%20forest%7Ca%20magical%20realm%7D%20with%20%7Bmagical%7Csupernatural%7Cancient%7D%20neighbors%5Cn%20%20%7Bstreet%7Cstage%7Ctelevised%7D%20magician%20performing%20%7Ba%20jaw-dropping%7Ca%20dangerous%7Can%20enchanting%7D%20illusion%5Cn%20%20%7Bmighty%7Cancient%7Cwinged%7D%20dragon%20%7Bslumbering%7Cguarding%7Chiding%7D%20atop%20%7Ba%20hoard%20of%20treasure%7Cenchanted%20crystals%7Ccursed%20artifacts%7D%5Cn%20%20%7Bchibi-style%7Ccartoon%7Crealistic%7D%20superheroes%20%7Bsaving%20the%20day%7Cbattling%20villains%7Cprotecting%20a%20city%7D%5Cn%20%20%7Bwhimsical%7Cindustrial%7Csupernatural%7D%20factory%20where%20%7Bdreams%7Cnightmares%7Cwishes%7D%20are%20manufactured%5Cn%20%20%7Bspace%7Cintergalactic%7Ctime-traveling%7D%20cowboy%20hunting%20%7Bintergalactic%20outlaws%7Cancient%20threats%7Csupernatural%20foes%7D%5Cn%20%20%7Bnecromancer%7Csummoner%7Cwitch%7D%20raising%20%7Ban%20army%20of%20the%20undead%7Celemental%20creatures%7Cmagical%20beings%7D%5Cn%20%20%7Bbrave%7Ccursed%7Clegendary%7D%20warrior%20with%20%7Ba%20haunted%7Can%20enchanted%7Ca%20sentient%7D%20weapon%5Cn%20%20%7Binterdimensional%7Ccosmic%7Cparanormal%7D%20%7Bcoffee%7Ctea%7Cdessert%7D%20shop%20frequented%20by%20%7Bodd%7Cmagical%7Calien%7D%20patrons%5Cn%20%20%7Benchanted%7Cbewitched%7Csacred%7D%20forest%20populated%20by%20%7Bsentient%7Cmagical%7Ccursed%7D%20trees%5Cn%20%20%7Bcybernetic%7Csupernatural%7Cmystical%7D%20musician%20creating%20%7Botherworldly%7Chaunting%7Chypnotic%7D%20tunes%5Cn%20%20%7Balien%7Clost%7Cancient%7D%20civilization%20thriving%20on%20%7Ba%20floating%20island%7Ca%20hidden%20continent%7Can%20undiscovered%20planet%7D%5Cn%20%20woman,%20at%20a%20%7Bmarket%7Cgrocery%20store%7D,%20%7Bchoosing%20fruits%7Cselecting%20produce%7D,%20sunny%20smile,%20close-up%5Cn%20%20man,%20at%20a%20%7Bzoo%7Csafari%7D,%20%7Bfeeding%20giraffe%7Cwatching%20elephants%7D,%20laughing,%20close-up%5Cn%20%20girl%20at%20a%20%7Bplayground%7Cpark%7D,%20on%20swings,%20%7Bskyward%7Cforward%7D,%20joyous,%20close-up%5Cn%20%20%7Bdj%7Cmusician%7D,%20%7Bmixing%7Cperforming%7D,%20at%20a%20club,%20crowd,%20excited,%20close-up%5Cn%20%20woman,%20in%20a%20%7Byoga%20pose%7Ctai%20chi%20stance%7D,%20%7Bpeaceful%20garden%7Czen%20studio%7D,%20serene,%20close-up%5Cn%20%20chef,%20at%20a%20%7Bfood%20truck%7Cdiner%7D,%20serving%20%7Btacos%7Cburgers%7D,%20friendly%20wink,%20close-up%5Cn%20%20%7Bgirl%7Cboy%7D,%20in%20a%20%7Bsnowy%20landscape%7Crainy%20city%7D,%20%7Bcatching%20snowflakes%7Cjumping%20in%20puddles%7D,%20amused,%20close-up%5Cn%20%20sailor,%20in%20a%20%7Bboat%7Cdock%7D,%20%7Bsea%7Clake%7D,%20%7Bstormy%20weather%7Ccalm%20waters%7D,%20determined,%20close-up%5Cn%20%20woman,%20at%20a%20%7Bvineyard%7Cbrewery%7D,%20%7Btasting%20wine%7Csampling%20beer%7D,%20indulgent%20smile,%20close-up%5Cn%20%20%7Bman%7Cwoman%7D,%20hiking,%20%7Bforest%7Cdesert%7Cmountain%7D,%20close-up%5Cn%20%20girl,%20at%20a%20%7Bmusic%20store%7Ccomic%20shop%7D,%20%7Bflipping%20through%20vinyl%20records%7Cbrowsing%20graphic%20novels%7D,%20nostalgic,%20close-up%5Cn%20%20%7Bman%7Cwoman%7D,%20in%20a%20lab,%20%7Bmicroscope%7Ctest%20tubes%7D,%20%7Bdiscovery%7Cexperiment%7D,%20astonished,%20close-up%5Cn%20%20%7Bbeautiful%20%7C%7Dwoman,%20at%20a%20%7Bcafe%7Cco-working%20space%7D,%20%7Blaptop%7Cnotepad%7D,%20deep%20in%20work,%20focused,%20close-up%5Cn%20%20soldier,%20in%20%7Buniform%7Ccamouflage%7D,%20%7Bsaluting%7Cat%20attention%7D,%20proud,%20close-up%5Cn%20%20%7Bbeautiful%20%7C%7Dwoman,%20in%20a%20%7Bgreenhouse%7Cbotanical%20garden%7D,%20%7Bsurrounded%20by%20plants%7Cstudying%20foliage%7D,%20peaceful,%20close-up%5Cn%20%20man,%20at%20a%20%7Bpottery%20wheel%7Cloom%7D,%20%7Bmolding%20clay%7Cweaving%20fabric%7D,%20concentrated,%20close-up%5Cn%20%20%7Bgirl%7Cboy%7D,%20at%20a%20%7Brooftop%7Cpenthouse%7D,%20%7Blooking%20at%20stars%7Cwatching%20the%20city%7D,%20thoughtful,%20close-up%5Cn%20%20%7Bman%7Cwoman%7D,%20in%20a%20tattoo%20parlor,%20%7Bgetting%20inked%7Cchoosing%20designs%7D,%20excited,%20close-up%5Cn%20%20woman,%20at%20a%20%7Bbasketball%20game%7Csoccer%20match%7D,%20cheering,%20exuberant,%20close-up%5Cn%20%20%7Btailor%7Cdressmaker%7D,%20%7Bfitting%20a%20suit%7Cadjusting%20a%20dress%7D,%20%7Bmeasuring%20tape%7Cpins%7D,%20focused,%20close-up%5Cn%20%20%7Bbeautiful%20%7C%7Dwoman,%20at%20a%20%7Blake%7Cpond%7D,%20%7Bskipping%20stones%7Crowing%20a%20boat%7D,%20playful%20grin,%20close-up%5Cn%20%20hawaiian%20%7Bwoman%7Cman%7D,%20%7Bbeach%7Cgarden%7D%20selfie,%20%7Bflower%20crown%7Cleis%7D,%20%7Bsmiling%7Cgoofy%7D%20expression%5Cn%20%20%7Bbeautiful%20%7Ccute%20%7C%7D%7Bnorwegian%7Cswedish%7D%20college%20girl,%20selfie%20on%20the%20couch,%20%7Bbraided%20hair%7Cponytail%7D,%20puckered%20lips%5Cn%20%20%7Bbeautiful%20%7Ccute%20%7C%7Dindian%20%7Bman%7Cwoman%7D,%20%7Bstudy%7Chome%20office%7D%20selfie,%20%7Bspectacles%7Cheadphones%7D,%20amused%5Cn%20%20%7Bbeautiful%20%7Ccute%20%7C%7D%7Bjapanese%7Ckorean%7D%20%7Bman%7Cwoman%7D,%20%7Bbathroom%7Cbedroom%7D%20selfie,%20%7Bcasual%20wear%7Cpajamas%7D,%20dimpled%20grin%5Cn%20%20%7Bbeautiful%20%7Ccute%20%7C%7Dafrican%20%7Bwoman%7Cman%7D,%20%7Bbalcony%7Cterrace%7D%20full-body%20selfie,%20%7Bsundress%7Cshorts%7D,%20%7Bbarefoot%7Csandaled%7D%20with%20a%20%7Blaid-back%7Ccheery%7D%20smile%5Cn%20%20%7Bbeautiful%20%7Ccute%20%7C%7D%7Bpolish%7Cukrainian%7D%20girl,%20%7Bbedroom%7Cliving%20room%7D%20mirror%20selfie,%20%7Btracksuit%7Cleisure%20wear%7D,%20%7Btied%20up%20hair%7Ccap%7D,%20%7Bcasual%7Crelaxed%7D%20look%5Cn%20%20%7Bbeautiful%20%7Ccute%20%7C%7D%7Bmexican%7Cspanish%7D%20%7Bman%7Cwoman%7D,%20%7Bcouch%7Cgarden%7D%20selfie,%20%7Bbook%7Ccoffee%7D%20in%20hand,%20%7Bglasses%7Cbeanie%7D,%20%7Bcontent%7Cabsorbed%7D%20expression%5Cn%20%20%7Bbeautiful%20%7Ccute%20%7C%7Dchinese%20%7Bwoman%7Cman%7D,%20%7Bkitchen%7Cdining%20room%7D%20selfie,%20%7Bapron%7Cchef%E2%80%99s%20hat%7D,%20%7Bcooking%7Cbaking%7D,%20%7Bpleased%7Cexcited%7D%20grin%5Cn%20%20%7Bbeautiful%20%7Ccute%20%7C%7D%7Bitalian%7Cfrench%7D%20%7Bwoman%7Cman%7D,%20%7Bbedroom%7Chome%20studio%7D%20mirror%20selfie,%20%7Bpaint-stained%20jeans%7Csmudged%20shirt%7D,%20%7Bbrush%7Cpalette%7D%20in%20hand,%20%7Bcreative%7Cinspired%7D%20look%5Cn%20%20%7Bbeautiful%20%7Ccute%20%7C%7D%7Bcanadian%7Camerican%7D%20%7Bman%7Cwoman%7D,%20%7Bbackyard%7Cfront%20porch%7D%20full-body%20selfie,%20%7Bplaid%20shirt%7Cdenim%20jacket%7D,%20%7Bbaseball%20cap%7Csunglasses%7D,%20%7Bgrinning%7Cwinking%7D%20expression%5Cn%20%20%7Bmountain%7CMediterranean%7D%20vista,%20%7Bsunrise%7Csunset%7D,%20%7Bforested%7Cclear%7D%20landscape,%20%7Bmisty%7Cclear%7D%20view%5Cn%20%20cityscape,%20%7Bnight%7Cdawn%7D,%20%7Bskyscrapers%7Chistoric%20buildings%7D,%20%7Bglistening%7Csoft%7D%20lights%5Cn%20%20%7Bsafari%7Cgrassland%7D,%20%7Blion%7Celephant%7D,%20%7Bprowling%7Cgrazing%7D,%20%7Bhot%20midday%7Ccool%20dusk%7D%5Cn%20%20%7Bceltic%7Cscottish%7Cirish%7D%20man,%20early%20%7B30s%7C40s%7D,%20%7Bred%7Cauburn%7Cginger%7D%20hair,%20wearing%20a%20%7Btartan%7Cwoolen%7Cclan%7D%20kilt,%20on%20a%20%7Bwindy%7Cgrass-covered%7Crolling%7D%20hill,%20%7Bbagpipes%7Cflute%7D%20in%20the%20background,%20close%20up%5Cn%20%20%7Bhawaiian%7Cpolynesian%7Ctahitian%7D%20woman,%20late%20%7Bteens%7Cearly%2020s%7D,%20%7Blong%7Ccurly%7Cflowing%7D%20hair,%20wearing%20a%20%7Bgrass%7Cleaf%7Cfloral%7D%20skirt,%20on%20the%20%7Bbeach%7Cseashore%7D,%20%7Bhula%7Ctraditional%7D%20dance,%20close%20up%5Cn%20%20%7Bmexican%7Ctexan%7Cnew%20mexican%7D%20man,%20mid%20%7B40s%7C50s%7D,%20%7Bmustache%7Cbeard%7D,%20wearing%20a%20%7Bsombrero%7Cwide-brimmed%20hat%7D,%20%7Bzarape%7Cponcho%7D,%20in%20a%20%7Bsleepy%7Chumble%7Cquiet%7D%20village,%20%7Bsiesta%20time%7Cafternoon%20nap%7D,%20close%20up%5Cn%20%20%7Bindonesian%7Cjavanesian%7Cbalinese%7D%20woman,%20early%20%7B30s%7C40s%7D,%20%7Bbatik%7Cfloral%7Ctraditional%7D%20headscarf,%20in%20a%20%7Brice%20paddy%7Cgreen%20field%7D,%20%7Bdistant%20volcano%7Cmountain%20range%7D,%20%7Bsunset%7Cdusk%7D,%20close%20up%5Cn%20%20%7Baustralian%7Caussie%7Coutback%7D%20man,%20late%20%7B20s%7C30s%7D,%20%7Bsun-bleached%7Clight%20brown%7Csandy%7D%20hair,%20wearing%20a%20%7Bbush%7Cleather%7Coutback%7D%20hat,%20in%20a%20%7Bdusty%20outback%7Crugged%20wilderness%7D,%20%7Bkangaroo%7Chopping%20kangaroo%7Cwildlife%7D%20hopping%20by,%20close%20up%5Cn%20%20%7Bcambodian%7Ckhmer%7Csouth%20asian%7D%20woman,%20mid%20%7B20s%7C30s%7D,%20%7Bsleek%7Cdark%7Clong%7D%20hair,%20wearing%20a%20%7Bsampot%7Ctraditional%20dress%7D,%20in%20a%20%7Btemple%7Cancient%20ruin%7D,%20%7Bincense%7Ccandle%7D%20smoke,%20close%20up%5Cn%20%20%7Bargentinian%7Cchilean%7Csouth%20american%7D%20man,%20early%20%7B30s%7C40s%7D,%20%7Bslicked-back%7Cneat%7Ctidy%7D%20hair,%20wearing%20a%20%7Bgaucho%7Ccowboy%7D%20outfit,%20on%20a%20%7Branch%7Cfarm%7D,%20%7Bhorses%7Clivestock%7D%20grazing,%20close%20up%5Cn%20%20%7Becuadorian%7Cperuvian%7Candes%7D%20woman,%20late%20%7Bteens%7Cearly%2020s%7D,%20wearing%20a%20%7Bcolorful%7Cvibrant%7Cwoolen%7D%20poncho,%20in%20a%20%7Bflower%7Coutdoor%7D%20market,%20%7BAndean%7Cmountainous%7D%20mountains,%20close%20up%5Cn%20%20%7Bromanian%7Ctransylvanian%7Ceast%20european%7D%20woman,%20early%20%7B40s%7C30s%7D,%20%7Bbraided%7Cwoven%7Clong%7D%20hair,%20wearing%20a%20%7Bpeasant%20blouse%7Ctraditional%20top%7D,%20in%20a%20%7Bfortified%20church%7Cancient%20chapel%7D,%20%7Bmedieval%7Crustic%7D%20atmosphere,%20close%20up%5Cn%20%20%7Bsamoan%7Cpolynesian%7Cpacific%7D%20man,%20early%20%7B30s%7C40s%7D,%20%7Bmuscular%7Cstrong%7Cwell-built%7D,%20wearing%20a%20%7Blava-lava%7Ctraditional%20cloth%7D,%20on%20a%20%7Bbeach%7Cshore%7D,%20%7BPacific%20Ocean%7Clagoon%7D,%20%7Bsunset%7Cdusk%7D,%20close%20up%5Cn%20%20%7Bscottish%7Chighland%7Cceltic%7D%20woman,%20late%20%7B20s%7Cearly%2030s%7D,%20%7Bred%7Cstrawberry%20blonde%7Cauburn%7D%20curls,%20wearing%20a%20%7Btartan%7Cwoolen%7Cplaid%7D%20shawl,%20on%20a%20%7Bwindy%7Clonely%7Cbare%7D%20moor,%20%7Bbagpipes%7Clonely%20music%7D%20in%20the%20distance,%20close%20up%5Cn%20%20%7Bperuvian%7Candes%7Csouth%20american%7D%20man,%20late%20%7B40s%7C50s%7D,%20wearing%20a%20%7Bchullo%7Cwoolen%20cap%7D,%20in%20a%20%7Bmarket%7Cbazaar%7D,%20%7Bllamas%7Calpacas%7D%20grazing,%20close%20up%5Cn%20%20%7Bvietnamese%7Csoutheast%20asian%7Casiatic%7D%20woman,%20%7B20s%7Clate%20teens%7D,%20%7Blong%7Cflowing%7Cblack%7D%20hair,%20wearing%20an%20%7Bao%20dai%7Ctraditional%20dress%7D,%20in%20a%20%7Blantern-lit%7Cmoonlit%7D%20street,%20%7BTet%20celebration%7CNew%20Year%20celebration%7D,%20close%20up%5Cn%20%20%7Bcyberpunk%7Cfuturistic%7Cpunk%7D%20girl,%20%7Bneon%7Cflaming%7Cluminous%7D%20hair,%20%7Baugmented%20reality%20glasses%7Cholographic%20visor%7Claser%20monocle%7D,%20in%20a%20%7Btechnopolis%7Cmegacity%7Celectron%20city%7D,%20%7Bneon%20lights%7Claser%20beams%7Cholographic%20billboards%7D,%20%7Bgraffiti%7Cposter-covered%7CLED%7D%20walls,%20close%20up%5Cn%20%20%7Bninja%7Csamurai%7Cassassin%7D,%20%7Bmasked%7Chooded%7Chooded%20and%20masked%7D,%20%7Bdarting%7Cpiercing%7Calert%7D%20eyes,%20%7Bshuriken%7Ckunai%7Cninja%20stars%7D%20on%20belt,%20lurking%20in%20the%20%7Bshadows%7Cdarkness%7Cunderbrush%7D,%20%7Bbamboo%7Cpine%7Csakura%7D%20forest,%20%7Bfull%7Ccrescent%7Cnew%7D%20moon,%20close%20up%5Cn%20%20%7Bsuccubus%7Cdemoness%7Cfiend%7D,%20%7Bcrimson%7Cobsidian%7Craven%7D%20hair,%20%7Bblack%7Cdark%7Cshadowy%7D%20wings,%20%7Brevealing%7Csculpted%7Cintricate%7D%20black%20dress,%20in%20a%20%7Bgothic%7Cancient%7Cforbidding%7D%20castle,%20%7Bflickering%7Cdim%7Csputtering%7D%20candles%5Cn%20%20%7Bgreek%7Croman%7Cmythical%7D%20goddess,%20%7Bflowing%7Cdraping%7Cbillowing%7D%20white%20robes,%20%7Bgolden%7Csilver%7Cbronze%7D%20laurel%20crown,%20in%20an%20%7Bancient%7Cmarble%7Cstone%7D%20temple,%20%7Bolive%7Ccypress%7Cpalm%7D%20trees,%20%7Bsetting%7Crising%7Cmidday%7D%20sun,%20close%20up%5Cn%20%20%7Bsteampunk%7Cvintage%7Cretro%7D%20woman,%20%7Bgoggles%7Cmonocle%7Cspectacles%7D,%20%7Bcorset%7Cbodice%7Cvest%7D,%20in%20a%20%7BVictorian%7Cindustrial-era%7Cold-world%7D%20cityscape,%20%7Bsteam-powered%7Cgear-driven%7Cclockwork%7D%20machines,%20%7Bcobblestone%7Cbrick-paved%7Cgravel%7D%20streets,%20close%20up%5Cn%20%20%7Bmuscular%7Ctowering%7Cburly%7D%20tauren,%20%7Btribal%7Cancient%7Cspiritual%7D%20tattoos,%20wearing%20a%20%7Bfur%20kilt%7Cleather%20loincloth%7Chide%20pants%7D,%20in%20a%20%7Bgrassy%20knoll%7Csacred%20site%7Cprairie%7D,%20%7Btowering%7Ccarved%7Cancient%7D%20totem%20poles,%20%7Bsunset%7Cdawn%7Ctwilight%7D%5Cn%20%20%7Battractive%7Cmysterious%7Calluring%7D%20vampire,%20%7Bpale%7Cmoonlit%7Ctranslucent%7D%20skin,%20%7Bslicked%20back%7Cmessy%7Ccurly%7D%20hair,%20%7Bpiercing%7Cglowing%7Cshimmering%7D%20red%20eyes,%20in%20a%20%7BEuropean%7Cmedieval%7Cancient%7D%20castle,%20%7Bfull%7Ccrescent%7Ccloud-covered%7D%20moon,%20close%20up%5Cn%20%20%7Bviking%7Cnorse%7Cwarrior%7D%20warrior,%20%7Bburly%7Cmuscular%7Cbattle-hardened%7D,%20%7Bspear%7Caxe%7Csword%7D,%20wearing%20a%20%7Bfur%20cloak%7Cleather%20armor%7Cwolf%20pelt%7D,%20in%20a%20%7Blongboat%7Cdrakkar%7Cship%7D,%20%7Bicy%20fjord%7Cchurning%20sea%7Ccalm%20lake%7D,%20%7Bnorthern%20lights%7Cstarry%20sky%7Cmisty%20skies%7D,%20close%20up%5Cn%20%20%7Btiefling%7Cdemonic%7Chellborn%7D%20priestess,%20%7Bdark%20purple%7Cburgundy%7Cdeep%20blue%7D%20skin,%20%7Blong%7Ccurved%7Ctwisted%7D%20horns,%20wearing%20a%20%7Bceremonial%7Csacred%7Cornate%7D%20robe,%20in%20a%20%7Bdarkened%7Cshadowy%7Csilent%7D%20chapel,%20%7Bstained%20glass%7Cmosaic%7Cetched%7D%20windows%5Cn%20%20%7Bogre%7Cgiant%7Cbrute%7D,%20%7Blarge%7Cimposing%7Ctowering%7D,%20wearing%20%7Brough%20hide%7Cpatchwork%20leather%7Cthick%20fur%7D%20armor,%20in%20a%20%7Bdank%7Cmurky%7Cfetid%7D%20swamp,%20%7Bbuzzing%7Cswarming%7D%20mosquitoes%5Cn%20%20%7Bfairy%7Cfae%7Cpixie%7D,%20%7Biridescent%7Cshimmering%7Ctranslucent%7D%20wings,%20%7Blong%20wavy%7Ccurly%7Cpixie%20cut%7D%20hair,%20in%20a%20%7Bmushroom%7Cfairy%7Cflower%7D%20ring,%20%7Bforest%7Cglen%7Cmeadow%7D%20glade,%20%7Bfireflies%7Cglow%20worms%7Cmoonbeams%7D%20around,%20close%20up%5Cn%20%20%7Bmermaid%7Csiren%7D,%20%7Bshimmering%7Csparkling%7Cradiant%7D%20tail,%20%7Bflowing%7Ccurly%7Cwavy%7D%20red%20hair,%20%7Bsunning%7Clounging%7Cresting%7D%20on%20a%20rock,%20%7Bazure%7Ccrystal-clear%7Cturquoise%7D%20sea,%20%7Bseagulls%7Calbatrosses%7Cpelicans%7D%20soaring,%20close%20up%5Cn%20%20%7Bdragonborn%7Cdraconian%7Cdrake-blooded%7D,%20%7Bscales%7Cspines%7Cridged%20armor%7D,%20wearing%20a%20%7Bplate%7Cchainmail%7Cscale%7D%20armor,%20in%20a%20%7Bcavern%7Cmountain%20lair%7Chidden%20den%7D,%20hoard%20of%20%7Btreasure%7Cgold%7Cjewels%7D,%20%7Bflickering%7Cblazing%7Cguttering%7D%20torchlight,%20close%20up%5Cn%20%20%7Belven%7Csylvan%7Cwoodland%7D%20ranger,%20%7Blongbow%7Cshortbow%7Ccrossbow%7D,%20%7Bgreen%7Cbrown%7Cforest%7D%20cloak,%20in%20a%20%7Bdense%7Clush%7Cdeep%7D%20forest,%20%7Bancient%7Cmajestic%7Ctowering%7D%20trees,%20%7Brustling%7Cwhispering%7Cswaying%7D%20leaves,%20close%20up%5Cn%20%20%7Bgnome%7Cdwarf%7Chalfling%7D%20tinkerer,%20%7Bgoggles%7Cspectacles%7Cmonocle%7D,%20%7Boveralls%7Cworkwear%7Capron%7D,%20in%20a%20%7Bcluttered%7Cchaotic%7Cbustling%7D%20workshop,%20%7Bgears%20and%20springs%7Ccogs%20and%20wheels%7Cparts%20and%20pieces%7D,%20%7Bsparks%7Cflames%7Cembers%7D%20flying,%20close%20up%5Cn%20%20%7Bamazonian%7Cwarrior%7Cjungle%7D%20warrior,%20%7Btall%7Cstatuesque%7Cmighty%7D%20and%20muscular,%20wearing%20a%20%7Bleather%20cuirass%7Cscale%20armor%7Ccloth%20wrap%7D,%20in%20a%20%7Bjungle%7Crainforest%7Ccanopy%7D%20clearing,%20%7Bparrots%7Cmacaws%7Ctoucans%7D%20squawking,%20close%20up%5Cn%20%20%7Bcybernetic%7Cfuturistic%7Ctechno%7D%20samurai,%20%7Bkatana%7Claser%20sword%7Cmonomolecular%20blade%7D,%20in%20a%20%7Bneo-Tokyo%7Cdystopian%7Cfuturistic%7D%20cityscape,%20%7Bneon%20signs%7Cholo%20ads%7CLED%20billboards%7D,%20%7Brain-soaked%7Cneon-lit%7Cfoggy%7D%20streets,%20close%20up%5Cn%20%20%7Bsorceress%7Cmage%7Cwitch%7D,%20%7Bstaff%7Cwand%7Corb%7D,%20in%20a%20%7Bspellbound%7Cenchanted%7Carcane%7D%20tower,%20%7Bfloating%7Clevitating%7Chovering%7D%20books,%20%7Barcane%7Cmystic%7Cancient%7D%20symbols,%20close%20up%5Cn%5Cn%5Cn//%20t2i_tags%5Cn//%20%20%20anime%5Cn//%20%20%20painting%5Cn//%20%20%20paintedAnime%5Cn//%20%20%20drawing%5Cn//%20%20%20cartoon%5Cn//%20%20%20photo%5Cn//%20%20%20casualPhoto%5Cn//%20%20%20portrait%5Cn//%20%20%20render%5Cn//%20%20%20cinematic%5Cn//%20%20%20landscape%5Cn//%20%20%20digitalPainting%5Cn//%20%20%20disney%5Cn//%20%20%20comic%5Cn//%20%20%20sketch%5Cn//%20%20%20oilPainting%5Cn//%20%20%20basicAnime%5Cn//%20%20%20drawnAnime%5Cn//%20%20%20cuteAnime%5Cn//%20%20%20fantasy%5Cn//%20%20%20poster%5Cn//%20%20%20coverArt%5Cn//%20%20%20vintage%5Cn//%20%20%20fantasyPortrait%5Cn//%20%20%20ghibli%5Cn//%20%20%20pixelArt%5Cn//%20%20%20furryOil%5Cn//%20%20%20furry%5Cn//%20%20%20emoji%5Cn//%20%20%20illustration%5Cn//%20%20%20pokemon%5Cn//%20%20%20manga%5Cn//%20%20%20map%5Cn//%20%20%20icon%5Cn//%20%20%20logo%5Cn//%20%20%20tattoo%5Cn//%20%20%20waifu%5Cn//%20%20%20yugioh%5Cn//%20%20%20japanese%5Cn//%20%20%20claymation%5Cn//%20%20%20basicCartoon%5Cn//%20%20%20creepy%20%20%22,%22imports%22:%5B%22animal%22,%22text-to-image-plugin%22%5D,%22lastEditTime%22:1748591718606,%22found%22:true%7D,%7B%22name%22:%22kv-plugin%22,%22modelText%22:%22%20=%20%5BgetKv()%5D%5Cn%5CngetKv()%20=%3E%5Cn%20%20const%20moduleName%20=%20this..;%20//%20this%20is%20'kv-plugin'%20-%20it's%20different%20to%20%60window.generatorName%60%20because%20that%20will%20be%20the%20name/url%20of%20the%20generator%20that%20imports%20this%20plugin,%20not%20this%20plugin's%20name/url.%20This%20is%20used%20in%20IndexedDB%20db/store%20name%20so%20forks%20of%20this%20plugin%20don't%20conflict%20with%20one%20another.%5Cn%20%20%5Cn%20%20if(!window.__kvPluginProxy7583683)%20%7B%5Cn%20%20%20%20//%20let%20idbKeyval%20=%20await%20import(%5C%22https://cdn.jsdelivr.net/npm/idb-keyval@6/+esm%5C%22);%5Cn%20%20%20%20let%20idbKeyval%20=%20(function()%20%7B%20//%20This%20is%20v6.2.1%5Cn%20%20%20%20%20%20function%20e(e)%7Breturn%20new%20Promise(((t,n)=%3E%7Be.oncomplete=e.onsuccess=()=%3Et(e.result),e.onabort=e.onerror=()=%3En(e.error)%7D))%7Dfunction%20t(t,n)%7Bconst%20r=indexedDB.open(t);r.onupgradeneeded=()=%3Er.result.createObjectStore(n);const%20o=e(r);return(e,t)=%3Eo.then((r=%3Et(r.transaction(n,e).objectStore(n))))%7Dlet%20n;function%20r()%7Breturn%20n%7C%7C(n=t(%5C%22keyval-store%5C%22,%5C%22keyval%5C%22)),n%7Dfunction%20o(t,n=r())%7Breturn%20n(%5C%22readonly%5C%22,(n=%3Ee(n.get(t))))%7Dfunction%20u(t,n,o=r())%7Breturn%20o(%5C%22readwrite%5C%22,(r=%3E(r.put(n,t),e(r.transaction))))%7Dfunction%20c(t,n=r())%7Breturn%20n(%5C%22readwrite%5C%22,(n=%3E(t.forEach((e=%3En.put(e%5B1%5D,e%5B0%5D))),e(n.transaction))))%7Dfunction%20s(t,n=r())%7Breturn%20n(%5C%22readonly%5C%22,(n=%3EPromise.all(t.map((t=%3Ee(n.get(t)))))))%7Dfunction%20a(t,n,o=r())%7Breturn%20o(%5C%22readwrite%5C%22,(r=%3Enew%20Promise(((o,u)=%3E%7Br.get(t).onsuccess=function()%7Btry%7Br.put(n(this.result),t),o(e(r.transaction))%7Dcatch(e)%7Bu(e)%7D%7D%7D))))%7Dfunction%20i(t,n=r())%7Breturn%20n(%5C%22readwrite%5C%22,(n=%3E(n.delete(t),e(n.transaction))))%7Dfunction%20l(t,n=r())%7Breturn%20n(%5C%22readwrite%5C%22,(n=%3E(t.forEach((e=%3En.delete(e))),e(n.transaction))))%7Dfunction%20f(t=r())%7Breturn%20t(%5C%22readwrite%5C%22,(t=%3E(t.clear(),e(t.transaction))))%7Dfunction%20d(t,n)%7Breturn%20t.openCursor().onsuccess=function()%7Bthis.result&&(n(this.result),this.result.continue())%7D,e(t.transaction)%7Dfunction%20h(t=r())%7Breturn%20t(%5C%22readonly%5C%22,(t=%3E%7Bif(t.getAllKeys)return%20e(t.getAllKeys());const%20n=%5B%5D;return%20d(t,(e=%3En.push(e.key))).then((()=%3En))%7D))%7Dfunction%20y(t=r())%7Breturn%20t(%5C%22readonly%5C%22,(t=%3E%7Bif(t.getAll)return%20e(t.getAll());const%20n=%5B%5D;return%20d(t,(e=%3En.push(e.value))).then((()=%3En))%7D))%7Dfunction%20p(t=r())%7Breturn%20t(%5C%22readonly%5C%22,(n=%3E%7Bif(n.getAll&&n.getAllKeys)return%20Promise.all(%5Be(n.getAllKeys()),e(n.getAll())%5D).then(((%5Be,t%5D)=%3Ee.map(((e,n)=%3E%5Be,t%5Bn%5D%5D))));const%20r=%5B%5D;return%20t(%5C%22readonly%5C%22,(e=%3Ed(e,(e=%3Er.push(%5Be.key,e.value%5D))).then((()=%3Er))))%7D))%7D%5Cn%20%20%20%20%20%20return%20%7Bclear:f,createStore:t,del:i,delMany:l,entries:p,get:o,getMany:s,keys:h,set:u,setMany:c,update:a,values:y%7D;%5Cn%20%20%20%20%7D)();%5Cn%20%20%20%20%5Cn%20%20%20%20let%20storeNameToStore%20=%20%7B%7D;%5Cn%20%20%20%20%5Cn%20%20%20%20window.__kvPluginProxy7583683%20=%20new%20Proxy(%7B%7D,%20%7B%20//%20so%20api%20is%20like:%20kv.myStoreName.get(...)%5Cn%20%20%20%20%20%20get(target,%20storeName,%20receiver)%20%7B%5Cn%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20let%20store%20=%20storeNameToStore%5BstoreName%5D;%5Cn%20%20%20%20%20%20%20%20if(!store)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20//%20NOTE:%20We%20don't%20need%20to%20include%20%60window.generatorName%60%20in%20the%20storeName%20because%20each%20generator%20has%20its%20own%20subdomain,%20and%20hence%20its%20own%20partitioned%20IndexedDB%20database.%5Cn%20%20%20%20%20%20%20%20%20%20//%20CAUTION:%20changing%20the%20store%20naming%20(in%20createStore%20calls)%20will%20make%20previously-added%20data%20inaccessible!!!%20Don't%20change%20it.%5Cn%20%20%20%20%20%20%20%20%20%20store%20=%20idbKeyval.createStore(%60$%7BstoreName%7D-db-$%7BmoduleName%7D%60,%20%60$%7BstoreName%7D-store-$%7BmoduleName%7D%60);%20//%20%3C--%20creates%20if%20it%20doesn't%20already%20exist,%20but%20we%20have%20an%20extra%20cache%20on%20top%20of%20that%20anyway%20in%20case%20it's%20expensive%5Cn%20%20%20%20%20%20%20%20%20%20storeNameToStore%5BstoreName%5D%20=%20store;%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20return%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20//%20Reads:%5Cn%20%20%20%20%20%20%20%20%20%20get:%20(key)%20=%3E%20idbKeyval.get(key,%20store),%5Cn%20%20%20%20%20%20%20%20%20%20has:%20(key)%20=%3E%20idbKeyval.keys(store).then(keys%20=%3E%20keys.includes(key)),%20//%20probably%20a%20bit%20inefficient,%20but%20fine%20for%20now%5Cn%20%20%20%20%20%20%20%20%20%20getMany:%20(keys)%20=%3E%20idbKeyval.getMany(keys,%20store),%5Cn%20%20%20%20%20%20%20%20%20%20entries:%20()%20=%3E%20idbKeyval.entries(store),%5Cn%20%20%20%20%20%20%20%20%20%20keys:%20()%20=%3E%20idbKeyval.keys(store),%5Cn%20%20%20%20%20%20%20%20%20%20values:%20()%20=%3E%20idbKeyval.values(store),%5Cn%20%20%20%20%20%20%20%20%20%20//%20Writes/Mutations:%5Cn%20%20%20%20%20%20%20%20%20%20set:%20(key,%20value)%20=%3E%20idbKeyval.set(key,%20value,%20store),%5Cn%20%20%20%20%20%20%20%20%20%20setMany:%20(entries)%20=%3E%20idbKeyval.setMany(entries,%20store),%5Cn%20%20%20%20%20%20%20%20%20%20update:%20(key,%20setterFn)%20=%3E%20idbKeyval.update(key,%20setterFn,%20store),%5Cn%20%20%20%20%20%20%20%20%20%20delete:%20(key)%20=%3E%20idbKeyval.del(key,%20store),%5Cn%20%20%20%20%20%20%20%20%20%20deleteMany:%20(keys)%20=%3E%20idbKeyval.delMany(keys,%20store),%5Cn%20%20%20%20%20%20%20%20%20%20clear:%20()%20=%3E%20idbKeyval.clear(store),%5Cn%20%20%20%20%20%20%20%20%7D;%5Cn%20%20%20%20%20%20%7D,%5Cn%20%20%20%20%7D);%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20return%20window.__kvPluginProxy7583683;%22,%22imports%22:%5B%5D,%22lastEditTime%22:1749700949044,%22found%22:true%7D,%7B%22name%22:%22super-fetch-plugin%22,%22modelText%22:%22async%20(...args)%20=%3E%5Cn%20%20let%20url;%5Cn%20%20if(typeof%20args%5B0%5D%20===%20%5C%22object%5C%22)%20url%20=%20args%5B0%5D.href%20%7C%7C%20args%5B0%5D.url;%20//%20can%20be%20URL%20object,%20or%20%7Burl,%20method,%20etc%7D%5Cn%20%20else%20url%20=%20args%5B0%5D;%5Cn%20%20%5Cn%20%20if(typeof%20url%20!==%20%5C%22string%5C%22)%20%7B%5Cn%20%20%20%20throw%20new%20Error(%5C%22Invalid%20URL%20provided.%5C%22);%5Cn%20%20%7D%5Cn%5Cn%20%20if(url.startsWith(%5C%22blob:%5C%22)%20%7C%7C%20url.startsWith(%5C%22data:%5C%22))%20return%20window.fetch(...args);%5Cn%20%20%5Cn%20%20//%20Disallow%20relative%20URLs%20(for%20now,%20at%20least):%5Cn%20%20if(!/%5Ehttps?:%5C%5C/%5C%5C//.test(url))%20%7B%5Cn%20%20%20%20throw%20new%20Error(%5C%22Must%20provide%20full%20URL,%20starting%20with%20https://%20or%20http://%5C%22);%5Cn%20%20%7D%5Cn%5Cn%20%20let%20origin%20=%20new%20URL(url).origin;%5Cn%5Cn%20%20//%20for%20performance,%20exclude%20some%20CDNs%20that%20don't%20need%20CORS%20proxying%5Cn%20%20if(origin.endsWith(%5C%22jsdelivr.net%5C%22)%20%7C%7C%20origin.endsWith(%5C%22catbox.moe%5C%22)%20%7C%7C%20(origin.endsWith(%5C%22huggingface.co%5C%22)%20&&%20url.includes(%5C%22/resolve/%5C%22))%20%7C%7C%20origin%20===%20%5C%22https://raw.githubusercontent.com%5C%22)%20%7B%5Cn%20%20%20%20return%20window.fetch(...args);%5Cn%20%20%7D%5Cn%20%20//%20for%20some%20reason%20error/non-CORS%20responses%20get%20cached%20in%20the%20browser%20sometimes,%20so%20if%20that%20happens,%20we%20retry%20with%20proxy%5Cn%20%20if(origin%20===%20%5C%22https://user-uploads.perchance.org%5C%22%20%7C%7C%20origin%20===%20%5C%22https://user.uploads.dev%5C%22%20%7C%7C%20origin%20===%20%5C%22https://aigc.uploads.dev%5C%22)%20%7B%5Cn%20%20%20%20let%20response%20=%20await%20window.fetch(...args).catch(e%20=%3E%20%7B%5Cn%20%20%20%20%20%20console.error(e);%5Cn%20%20%20%20%20%20return%20false;%5Cn%20%20%20%20%7D);%5Cn%20%20%20%20if(response%20!==%20false)%20return%20response;%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20//%20Note%20that%20we%20use%20%60new%20URL(url).href%60%20to%20exactly%20emulate%20the%20browser's%20encoding%20of%20'invalid'%20URL%20characters%20(this%20is%20different%20to%20encodeURI%20IIUC).%20There%20were%20issues%20related%20to%20server%20handling%20of%20this%20sort%20of%20thing%20before%20I%20added%20this.%5Cn%20%20//%20EDIT:%20Changed%20to%20putting%20URL%20in%20path%20instead%20of%20in%20query%20param%20for%20annoying/technical%20Cloudflare-related%20reasons.%5Cn%20%20const%20proxiedUrl%20=%20%60https://fetch-plugin.perchance.org/proxy1/$%7BencodeURIComponent(new%20URL(url).href)%7D?origin=$%7BencodeURIComponent(%60https://$%7Bwindow.generatorPublicId%7D.perchance.org%60)%7D%60;%5Cn%20%20if(typeof%20args%5B0%5D%20===%20%5C%22object%5C%22%20&&%20args%5B0%5D.url)%20%7B%20//%20%3C--%20since%20it's%20possible%20to%20call%20fetch%20like%20this:%20fetch(%7Burl:%5C%22https://example.com%5C%22%7D)%20-%20i.e.%20options%20object%20as%20first%20param%20that%20*includes*%20the%20URL%5Cn%20%20%20%20args%5B0%5D%20=%20new%20Request(proxiedUrl,%20args%5B0%5D);%5Cn%20%20%20%20let%20response%20=%20await%20window.fetch(...args);%5Cn%20%20%20%20if(response.status%20===%20530)%20throw%20new%20Error(%5C%22Failed%20to%20fetch%5C%22);%20//%20CF%20error%20for%20e.g.%20DNS%20lookup%20fail%5Cn%20%20%20%20return%20response;%5Cn%20%20%7D%20else%20%7B%5Cn%20%20%20%20let%20response%20=%20await%20window.fetch(proxiedUrl,%20...args.slice(1));%5Cn%20%20%20%20if(response.status%20===%20530)%20throw%20new%20Error(%5C%22Failed%20to%20fetch%5C%22);%20//%20CF%20error%20for%20e.g.%20DNS%20lookup%20fail%5Cn%20%20%20%20return%20response;%5Cn%20%20%7D%22,%22imports%22:%5B%5D,%22lastEditTime%22:1749986362487,%22found%22:true%7D,%7B%22name%22:%22huge-emoji-list%22,%22modelText%22:%22%20=%20https://user.uploads.dev/file/a39d52b89a33865b9a903fcc5786a2da.txt%5Cn%5Cn//%20The%20reason%20I%20put%20this%20simple%20URL%20into%20its%20own%20generator%20is%20so%20that%20I%20can%20update%20the%20URL%5Cn//%20here%20(e.g.%20when%20I%20add/remove%20emojis)%20and%20the%20update%20automatically%20propagates%20to%20all%20my%20generators.%5Cn%5Cn//%20You%20can%20import%20this%20into%20your%20own%20generator%20by%20putting%20this%20line%20in%20your%20comments%20options:%5Cn//%20%20%20%20customEmojis%20=%20%7Bimport:huge-emoji-list%7D%5Cn//%20But%20do%20note%20that%20I%20may%20add/remove%20emojis%20to%20improve%20the%20list,%20remove%20some%20NSFW%20that%20I%20missed,%20etc.%22,%22imports%22:%5B%5D,%22lastEditTime%22:1750744274356,%22found%22:true%7D,%7B%22name%22:%22simple-gen-footer%22,%22modelText%22:%22%5Cn%5CtThe%20%3Ca%20href%5C%5C=%5C%22/useful-generators%5C%22%3Euseful%20generators%20list%3C/a%3E%20is%20a%20handy%20list%20of%20simple%20text%20generators%20on%20various%20topics.%20If%20you're%20a%20Perchance%20builder%20then%20you'll%20probably%20find%20some%20of%20them%20useful%20for%20importing%20into%20your%20own%20projects.%5Cn%5CtIf%20you'd%20like%20to%20learn%20how%20to%20create%20a%20random%20text%20generator,%20then%20check%20out%20the%20%3Ca%20href%5C%5C=%5C%22/minimal#edit%5C%22%3Eminimal%20generator%20template%3C/a%3E%20and%20the%20%3Ca%20href%5C%5C=%5C%22/tutorial%5C%22%3Etutorial%3C/a%3E.%20It's%20easier%20than%20you'd%20think%20and%20is%20great%20fun%20:)%5Cn%5Ct%20=%20%3Cp%3E%5Bthis.joinItems(%5C%22%3C/p%3E%3Cp%3E%5C%22)%5D%3C/p%3E%22,%22imports%22:%5B%5D,%22lastEditTime%22:1618109989813,%22found%22:true%7D%5D</script>
        <script id="imported-generator-names" type="notjs">%5B%22neg-pack-t%22,%22rpg-icon-plugin%22,%22t2i-framework-plugin-v2%22,%22t2i-styles%22,%22vionet20-t2i-styles-importable%22,%22x-xx-styles-andothersv1%22,%22ai-text-plugin%22,%22comments-plugin%22,%22create-media-gallery-plugin%22,%22fullscreen-button-plugin%22,%22prompt2-plugin%22,%22select-leaf-plugin%22,%22tabbed-comments-plugin-v1%22,%22text-to-image-plugin%22,%22upload-plugin%22,%22animal%22,%22vionet20-t2i-styles-importable-v2%22,%22kv-plugin%22,%22super-fetch-plugin%22,%22huge-emoji-list%22,%22simple-gen-footer%22%5D</script>
        <script id="static-meta-data" type="notjs">%7B%22title%22:%22Zephyrus%20Ai%20Art%20Studio%22,%22description%22:%22This%20generator%20has%20useful%20features%20for%20quickly%20AI.%22%7D</script>
        <script id="this-html-server-render-time" type="notjs">1752514934217</script> 
        
        
        <script>window.generatorPublicId = "908f97c38727bb4c12a5ef1d46671625";</script> 
        <script>window.generatorLastSaveTime = Number(`1752514310282`);</script>
        <script>window.shouldLiftGeneratorHtmlFromEmbed = `true` === "true";</script>


        <script>
          window.currentInterfaceMode = "view"; 

          window.generatorData = window.js0nparse( decodeURI( document.querySelector("#preloaded-generator-data").innerText ) );
          window.generatorName = window.generatorData.name;
          window.generatorCanLinkWithRelFollow = generatorData.canLink; // make it global so the iframe-based description update has access to it.

          window.initialLoadIsOwnerResolver = null;
          window.initialLoadIsOwnerPromise = new Promise(r => window.initialLoadIsOwnerResolver=r);

          window.generatorStaticMetaData = {}; 
          try {
            window.generatorStaticMetaData = window.js0nparse( decodeURI( document.querySelector("#static-meta-data").innerText ) );
          } catch(e) { console.error(e); } 

          // For crawlers that don't have es6 support and thus can't execute the iframe:
          if(!window.canExecuteModernJavascript) {
            window.addEventListener("DOMContentLoaded", function() {
              var data = window.generatorData;

              window.document.querySelector("#generator-description").innerHTML = DOMPurify.sanitize(data.outputTemplate, {ALLOWED_TAGS: ['h1', 'h2', 'h3', 'h4', 'p', 'div', 'pre', 'button', 'i', 'b', 'a', 'ul', 'li', 'br', 'ol', 'hr', 'span'], ALLOWED_ATTR: ['href']});
              var pre = document.createElement('pre');
              pre.innerText = data.modelText.slice(0, 10000);
              window.document.querySelector("#generator-description").appendChild(pre);
              
              window.document.querySelector("#generator-description").style.cssText = "";

              // EDIT: Removed, since title is hardcoded in HTML now.
              // var h1 = window.document.querySelector("#generator-description h1");
              // if(!h1) h1 = window.document.querySelector("#generator-description h2");
              // if(h1) {
              //   var h1Text = h1.textContent;
              //   if(h1Text !== "Your Generator's Title" && h1Text !== "Minimal Example" && h1Text.indexOf("[") === -1 && h1Text.indexOf("]") === -1) {
              //     document.title = h1Text+" ― Perchance" + (h1Text.toLowerCase().includes("gener") ? "" : " Generator");
              //   }
              // } else {
              //   let title = window.location.pathname.slice(1).split("-").filter(function(a){return a;}).map(function(word){return word[0].toUpperCase()+word.slice(1); }).join(" ");
              //   document.title = title+" ― Perchance" + (title.toLowerCase().includes("gener") ? "" : " Generator");
              // }

              if(!window.generatorCanLinkWithRelFollow) {
                var links = window.document.querySelectorAll("#generator-description a");
                for(var i = 0; i < links.length; i++) {
                  links[i].rel = "nofollow";
                }
              }
            });
          }
        </script>  

        <!-- CODEMIRROR (stylesheets must come before javascript init) -->
        <style>
/* BASICS */

.CodeMirror {
  /* Set height, width, borders, and global font properties here */
  font-family: monospace;
  height: 300px;
  color: black;
  direction: ltr;
}

/* PADDING */

.CodeMirror-lines {
  padding: 4px 0; /* Vertical padding around content */
}
.CodeMirror pre.CodeMirror-line,
.CodeMirror pre.CodeMirror-line-like {
  padding: 0 4px; /* Horizontal padding of content */
}

.CodeMirror-scrollbar-filler, .CodeMirror-gutter-filler {
  background-color: white; /* The little square between H and V scrollbars */
}

/* GUTTER */

.CodeMirror-gutters {
  border-right: 1px solid #ddd;
  background-color: #f7f7f7;
  white-space: nowrap;
}
.CodeMirror-linenumbers {}
.CodeMirror-linenumber {
  padding: 0 3px 0 5px;
  min-width: 20px;
  text-align: right;
  color: #999;
  white-space: nowrap;
}

.CodeMirror-guttermarker { color: black; }
.CodeMirror-guttermarker-subtle { color: #999; }

/* CURSOR */

.CodeMirror-cursor {
  border-left: 1px solid black;
  border-right: none;
  width: 0;
}
/* Shown when moving in bi-directional text */
.CodeMirror div.CodeMirror-secondarycursor {
  border-left: 1px solid silver;
}
.cm-fat-cursor .CodeMirror-cursor {
  width: auto;
  border: 0 !important;
  background: #7e7;
}
.cm-fat-cursor div.CodeMirror-cursors {
  z-index: 1;
}
.cm-fat-cursor .CodeMirror-line::selection,
.cm-fat-cursor .CodeMirror-line > span::selection, 
.cm-fat-cursor .CodeMirror-line > span > span::selection { background: transparent; }
.cm-fat-cursor .CodeMirror-line::-moz-selection,
.cm-fat-cursor .CodeMirror-line > span::-moz-selection,
.cm-fat-cursor .CodeMirror-line > span > span::-moz-selection { background: transparent; }
.cm-fat-cursor { caret-color: transparent; }
@-moz-keyframes blink {
  0% {}
  50% { background-color: transparent; }
  100% {}
}
@-webkit-keyframes blink {
  0% {}
  50% { background-color: transparent; }
  100% {}
}
@keyframes blink {
  0% {}
  50% { background-color: transparent; }
  100% {}
}

/* Can style cursor different in overwrite (non-insert) mode */
.CodeMirror-overwrite .CodeMirror-cursor {}

.cm-tab { display: inline-block; text-decoration: inherit; }

.CodeMirror-rulers {
  position: absolute;
  left: 0; right: 0; top: -50px; bottom: 0;
  overflow: hidden;
}
.CodeMirror-ruler {
  border-left: 1px solid #ccc;
  top: 0; bottom: 0;
  position: absolute;
}

/* DEFAULT THEME */

.cm-s-default .cm-header {color: blue;}
.cm-s-default .cm-quote {color: #090;}
.cm-negative {color: #d44;}
.cm-positive {color: #292;}
.cm-header, .cm-strong {font-weight: bold;}
.cm-em {font-style: italic;}
.cm-link {text-decoration: underline;}
.cm-strikethrough {text-decoration: line-through;}

.cm-s-default .cm-keyword {color: #708;}
.cm-s-default .cm-atom {color: #219;}
.cm-s-default .cm-number {color: #164;}
.cm-s-default .cm-def {color: #00f;}
.cm-s-default .cm-variable,
.cm-s-default .cm-punctuation,
.cm-s-default .cm-property,
.cm-s-default .cm-operator {}
.cm-s-default .cm-variable-2 {color: #05a;}
.cm-s-default .cm-variable-3, .cm-s-default .cm-type {color: #085;}
.cm-s-default .cm-comment {color: #a50;}
.cm-s-default .cm-string {color: #a11;}
.cm-s-default .cm-string-2 {color: #f50;}
.cm-s-default .cm-meta {color: #555;}
.cm-s-default .cm-qualifier {color: #555;}
.cm-s-default .cm-builtin {color: #30a;}
.cm-s-default .cm-bracket {color: #997;}
.cm-s-default .cm-tag {color: #170;}
.cm-s-default .cm-attribute {color: #00c;}
.cm-s-default .cm-hr {color: #999;}
.cm-s-default .cm-link {color: #00c;}

.cm-s-default .cm-error {color: #f00;}
.cm-invalidchar {color: #f00;}

.CodeMirror-composing { border-bottom: 2px solid; }

/* Default styles for common addons */

div.CodeMirror span.CodeMirror-matchingbracket {color: #0b0;}
div.CodeMirror span.CodeMirror-nonmatchingbracket {color: #a22;}
.CodeMirror-matchingtag { background: rgba(255, 150, 0, .3); }
.CodeMirror-activeline-background {background: #e8f2ff;}

/* STOP */

/* The rest of this file contains styles related to the mechanics of
   the editor. You probably shouldn't touch them. */

.CodeMirror {
  position: relative;
  overflow: hidden;
  background: white;
}

.CodeMirror-scroll {
  overflow: scroll !important; /* Things will break if this is overridden */
  /* 50px is the magic margin used to hide the element's real scrollbars */
  /* See overflow: hidden in .CodeMirror */
  margin-bottom: -50px; margin-right: -50px;
  padding-bottom: 50px;
  height: 100%;
  outline: none; /* Prevent dragging from highlighting the element */
  position: relative;
  z-index: 0;
}
.CodeMirror-sizer {
  position: relative;
  border-right: 50px solid transparent;
}

/* The fake, visible scrollbars. Used to force redraw during scrolling
   before actual scrolling happens, thus preventing shaking and
   flickering artifacts. */
.CodeMirror-vscrollbar, .CodeMirror-hscrollbar, .CodeMirror-scrollbar-filler, .CodeMirror-gutter-filler {
  position: absolute;
  z-index: 6;
  display: none;
  outline: none;
}
.CodeMirror-vscrollbar {
  right: 0; top: 0;
  overflow-x: hidden;
  overflow-y: scroll;
}
.CodeMirror-hscrollbar {
  bottom: 0; left: 0;
  overflow-y: hidden;
  overflow-x: scroll;
}
.CodeMirror-scrollbar-filler {
  right: 0; bottom: 0;
}
.CodeMirror-gutter-filler {
  left: 0; bottom: 0;
}

.CodeMirror-gutters {
  position: absolute; left: 0; top: 0;
  min-height: 100%;
  z-index: 3;
}
.CodeMirror-gutter {
  white-space: normal;
  height: 100%;
  display: inline-block;
  vertical-align: top;
  margin-bottom: -50px;
}
.CodeMirror-gutter-wrapper {
  position: absolute;
  z-index: 4;
  background: none !important;
  border: none !important;
}
.CodeMirror-gutter-background {
  position: absolute;
  top: 0; bottom: 0;
  z-index: 4;
}
.CodeMirror-gutter-elt {
  position: absolute;
  cursor: default;
  z-index: 4;
}
.CodeMirror-gutter-wrapper ::selection { background-color: transparent }
.CodeMirror-gutter-wrapper ::-moz-selection { background-color: transparent }

.CodeMirror-lines {
  cursor: text;
  min-height: 1px; /* prevents collapsing before first draw */
}
.CodeMirror pre.CodeMirror-line,
.CodeMirror pre.CodeMirror-line-like {
  /* Reset some styles that the rest of the page might have set */
  -moz-border-radius: 0; -webkit-border-radius: 0; border-radius: 0;
  border-width: 0;
  background: transparent;
  font-family: inherit;
  font-size: inherit;
  margin: 0;
  white-space: pre;
  word-wrap: normal;
  line-height: inherit;
  color: inherit;
  z-index: 2;
  position: relative;
  overflow: visible;
  -webkit-tap-highlight-color: transparent;
  -webkit-font-variant-ligatures: contextual;
  font-variant-ligatures: contextual;
}
.CodeMirror-wrap pre.CodeMirror-line,
.CodeMirror-wrap pre.CodeMirror-line-like {
  word-wrap: break-word;
  white-space: pre-wrap;
  word-break: normal;
}

.CodeMirror-linebackground {
  position: absolute;
  left: 0; right: 0; top: 0; bottom: 0;
  z-index: 0;
}

.CodeMirror-linewidget {
  position: relative;
  z-index: 2;
  padding: 0.1px; /* Force widget margins to stay inside of the container */
}

.CodeMirror-widget {}

.CodeMirror-rtl pre { direction: rtl; }

.CodeMirror-code {
  outline: none;
}

/* Force content-box sizing for the elements where we expect it */
.CodeMirror-scroll,
.CodeMirror-sizer,
.CodeMirror-gutter,
.CodeMirror-gutters,
.CodeMirror-linenumber {
  -moz-box-sizing: content-box;
  box-sizing: content-box;
}

.CodeMirror-measure {
  position: absolute;
  width: 100%;
  height: 0;
  overflow: hidden;
  visibility: hidden;
}

.CodeMirror-cursor {
  position: absolute;
  pointer-events: none;
}
.CodeMirror-measure pre { position: static; }

div.CodeMirror-cursors {
  visibility: hidden;
  position: relative;
  z-index: 3;
}
div.CodeMirror-dragcursors {
  visibility: visible;
}

.CodeMirror-focused div.CodeMirror-cursors {
  visibility: visible;
}

.CodeMirror-selected { background: #d9d9d9; }
.CodeMirror-focused .CodeMirror-selected { background: #d7d4f0; }
.CodeMirror-crosshair { cursor: crosshair; }
.CodeMirror-line::selection, .CodeMirror-line > span::selection, .CodeMirror-line > span > span::selection { background: #d7d4f0; }
.CodeMirror-line::-moz-selection, .CodeMirror-line > span::-moz-selection, .CodeMirror-line > span > span::-moz-selection { background: #d7d4f0; }

.cm-searching {
  background-color: #ffa;
  background-color: rgba(255, 255, 0, .4);
}

/* Used to force a border model for a node */
.cm-force-border { padding-right: .1px; }

@media print {
  /* Hide the cursor when printing */
  .CodeMirror div.CodeMirror-cursors {
    visibility: hidden;
  }
}

/* See issue #2901 */
.cm-tab-wrap-hack:after { content: ''; }

/* Help users use markselection to safely style text background */
span.CodeMirror-selectedtext { background: none; }

.CodeMirror-dialog {
  position: absolute;
  left: 0; right: 0;
  background: inherit;
  z-index: 15;
  padding: .1em .8em;
  overflow: hidden;
  color: inherit;
}

.CodeMirror-dialog-top {
  border-bottom: 1px solid #eee;
  top: 0;
}

.CodeMirror-dialog-bottom {
  border-top: 1px solid #eee;
  bottom: 0;
}

.CodeMirror-dialog input {
  border: none;
  outline: none;
  background: transparent;
  width: 20em;
  color: inherit;
  font-family: monospace;
}

.CodeMirror-dialog button {
  font-size: 70%;
}
/*
    Name:       one-light 1.0.0
    Author:     Yohan de Rose (https://github.com/yohanderose/)
                -> originally Török Ádám (http://github.com/Aerobird98)
    Original Atom One Dark Theme (https://github.com/atom/one-dark-ui & https://github.com/atom/one-dark-syntax)
*/

/* basic */
.cm-s-one-light {
  font-family: Menlo, Consolas, 'DejaVu Sans Mono', monospace;
  /*font-weight: 350;*/
  /*font-size: 18px;*/
  color: #383a42;
  background-color: #fafafa;
}

.cm-s-one-light .CodeMirror-selected {background-color: #d0d1d5;}
.cm-s-one-light .CodeMirror-gutter,
.cm-s-one-light .CodeMirror-gutters {
  border: none;
  background-color: #fafafa;
}

.cm-s-one-light .CodeMirror-linenumber,
.cm-s-one-light .CodeMirror-linenumbers {
  color: #9a9b9f !important;
  background-color: transparent;
}

.cm-s-one-light .CodeMirror-lines {
  color: #383a42 !important;
  background-color: transparent;
}

.cm-s-one-light .CodeMirror-cursor {border-left: 2px solid #0184bb !important;}

/* addon: edit/machingbrackets.js & addon: edit/matchtags.js */
.cm-s-one-light .CodeMirror-matchingbracket,
.cm-s-one-light .CodeMirror-matchingtag {
  border-bottom: 2px solid #0184bb;
  color: #383a42 !important;
  background-color: transparent;
}

.cm-s-one-light .CodeMirror-nonmatchingbracket {
  border-bottom: 2px solid #e45649;
  color: #383a42 !important;
  background-color: transparent;
}

/* addon: fold/foldgutter.js */
.cm-s-one-light .CodeMirror-foldmarker,
.cm-s-one-light .CodeMirror-foldgutter,
.cm-s-one-light .CodeMirror-foldgutter-open,
.cm-s-one-light .CodeMirror-foldgutter-folded {
  border: none;
  text-shadow: none;
  color: #9a9b9f !important;
  background-color: transparent;
}

/* addon: selection/active-line.js */
.cm-s-one-light .CodeMirror-activeline-background {background-color: rgba(0, 123, 255, 0.04);}

/* basic syntax */
.cm-s-one-light .cm-header {color: #e45649;}
.cm-s-one-light .cm-quote {color: #9a9b9f;font-style: italic;}
.cm-s-one-light .cm-negative {color: #e45649;}
.cm-s-one-light .cm-positive {color: #50a14f;}
.cm-s-one-light .cm-strong {color: #c18401;font-weight: bold;}
.cm-s-one-light .cm-header .cm-strong {color: #c18401;font-weight: bold;}
.cm-s-one-light .cm-em {color: #986801;font-style: italic;}
.cm-s-one-light .cm-header .cm-em {color: #986801;font-style: italic;}
.cm-s-one-light .cm-tag {color: #e45649;}
.cm-s-one-light .cm-attribute {color: #c18401;}
.cm-s-one-light .cm-link {color: #0184bb;border-bottom: solid 1px #0184bb;}
.cm-s-one-light .cm-builtin {color: #0184bb;}
.cm-s-one-light .cm-keyword {color: #a626a4;}
.cm-s-one-light .cm-def {color: #4078f2;}
.cm-s-one-light .cm-atom {color: #986801;}
.cm-s-one-light .cm-number {color: #986801;}
.cm-s-one-light .cm-property {color: #0184bb;}
.cm-s-one-light .cm-qualifier {color: #c18401;}
.cm-s-one-light .cm-variable {color: #e45649;}
.cm-s-one-light .cm-string {color: #50a14f;}
.cm-s-one-light .cm-punctuation {color: #383a42;}
.cm-s-one-light .cm-operator {color: #0184bb;}
.cm-s-one-light .cm-meta {color: #383a42;}
.cm-s-one-light .cm-bracket {color: #383a42;}
.cm-s-one-light .cm-comment {color: #a0a1a7;font-style: italic;}
.cm-s-one-light .cm-error {color: #e45649;}

/* css syntax corrections */
.cm-s-one-light .cm-m-css.cm-variable {color: #383a42;}
.cm-s-one-light .cm-m-css.cm-property {color: #383a42;}
.cm-s-one-light .cm-m-css.cm-atom {color: #0184bb;}
.cm-s-one-light .cm-m-css.cm-builtin {color: #0184bb;}

/* lua syntax corrections */
.cm-s-one-light .cm-m-lua.cm-variable {color: #0184bb;}.CodeMirror-search-match {
  background: gold;
  border-top: 1px solid orange;
  border-bottom: 1px solid orange;
  -moz-box-sizing: border-box;
  box-sizing: border-box;
  opacity: .5;
}
/*
    Name:       one-dark 1.1.1
    Author:     Török Ádám (http://github.com/Aerobird98)
    Original Atom One Dark Theme (https://github.com/atom/one-dark-ui & https://github.com/atom/one-dark-syntax)
*/

/* basic */
.cm-s-one-dark {
  font-family: Menlo, Consolas, 'DejaVu Sans Mono', monospace;
  /*font-weight: 350;*/
  /*font-size: 18px;*/
  color: #abb2bf;
  background-color: #282c34;
}
.cm-s-one-dark .CodeMirror-selected {background-color: #3e4451;}
.cm-s-one-dark .CodeMirror-gutter,
.cm-s-one-dark .CodeMirror-gutters {
  border: none;
  background-color: #282c34;
}
.cm-s-one-dark .CodeMirror-linenumber,
.cm-s-one-dark .CodeMirror-linenumbers {
  color: #5c6370 !important;
  background-color: transparent;
}
.cm-s-one-dark .CodeMirror-lines {
  color: #abb2bf !important;
  background-color: transparent;
}
.cm-s-one-dark .CodeMirror-cursor {border-left: 2px solid #56b6c2 !important;}
/* addon: edit/machingbrackets.js & addon: edit/matchtags.js */
.cm-s-one-dark .CodeMirror-matchingbracket,
.cm-s-one-dark .CodeMirror-matchingtag {
  border-bottom: 2px solid #56b6c2;
  color: #abb2bf !important;
  background-color: transparent;
}
.cm-s-one-dark .CodeMirror-nonmatchingbracket {
  border-bottom: 2px solid #e06c75;
  color: #abb2bf !important;
  background-color: transparent;
}
/* addon: fold/foldgutter.js */
.cm-s-one-dark .CodeMirror-foldmarker,
.cm-s-one-dark .CodeMirror-foldgutter,
.cm-s-one-dark .CodeMirror-foldgutter-open,
.cm-s-one-dark .CodeMirror-foldgutter-folded {
  border: none;
  text-shadow: none;
  color: #5c6370 !important;
  background-color: transparent;
}
/* addon: selection/active-line.js */
.cm-s-one-dark .CodeMirror-activeline-background {background-color: rgba(153, 187, 255, 0.04);}
/* basic syntax */
.cm-s-one-dark .cm-header {color: #e06c75;}
.cm-s-one-dark .cm-quote {color: #5c6370;font-style: italic;}
.cm-s-one-dark .cm-negative {color: #e06c75;}
.cm-s-one-dark .cm-positive {color: #e06c75;}
.cm-s-one-dark .cm-strong {color: #d19a66;font-weight: bold;}
.cm-s-one-dark .cm-header .cm-strong {color: #d19a66;font-weight: bold;}
.cm-s-one-dark .cm-em {color: #c678dd;font-style: italic;}
.cm-s-one-dark .cm-header .cm-em {color: #c678dd;font-style: italic;}
.cm-s-one-dark .cm-tag {color: #e06c75;}
.cm-s-one-dark .cm-attribute {color: #d19a66;}
.cm-s-one-dark .cm-link {color: #98c379;border-bottom: solid 1px #98c379;}
.cm-s-one-dark .cm-builtin {color: #e06c75;}
.cm-s-one-dark .cm-keyword {color: #c678dd;}
.cm-s-one-dark .cm-def {color: #e5c07b;} /* original:  #d19a66; */
.cm-s-one-dark .cm-atom {color: #d19a66;}
.cm-s-one-dark .cm-number {color: #d19a66;}
.cm-s-one-dark .cm-property {color: #56b6c2;} /* original: #abb2bf */
.cm-s-one-dark .cm-qualifier {color: #d19a66;}
.cm-s-one-dark .cm-variable {color: #e06c75;}
.cm-s-one-dark .cm-string {color: #98c379;}
.cm-s-one-dark .cm-punctuation {color: #abb2bf;}
.cm-s-one-dark .cm-operator {color: #56b6c2;} /* original: #abb2bf */
.cm-s-one-dark .cm-meta {color: #abb2bf;}
.cm-s-one-dark .cm-bracket {color: #abb2bf;}
.cm-s-one-dark .cm-comment {color: #5c6370;font-style: italic;}
.cm-s-one-dark .cm-error {color: #e06c75;}
/* css syntax corrections */
.cm-s-one-dark .cm-m-css.cm-variable {color: #828997;}
.cm-s-one-dark .cm-m-css.cm-property  {color: #abb2bf;}
.cm-s-one-dark .cm-m-css.cm-atom  {color: #56b6c2;}
.cm-s-one-dark .cm-m-css.cm-builtin {color: #56b6c2;}
/* lua syntax corrections */
.cm-s-one-dark .cm-m-lua.cm-variable {color: #56b6c2;}.CodeMirror-foldmarker {
  color: blue;
  text-shadow: #b9f 1px 1px 2px, #b9f -1px -1px 2px, #b9f 1px -1px 2px, #b9f -1px 1px 2px;
  font-family: arial;
  line-height: .3;
  cursor: pointer;
}
.CodeMirror-foldgutter {
  width: .7em;
}
.CodeMirror-foldgutter-open,
.CodeMirror-foldgutter-folded {
  cursor: pointer;
}
.CodeMirror-foldgutter-open:after {
  content: "\25BE";
}
.CodeMirror-foldgutter-folded:after {
  content: "\25B8";
}

</style><script>
(function(global,factory){typeof exports==="object"&&typeof module!=="undefined"?module.exports=factory():typeof define==="function"&&define.amd?define(factory):(global=global||self,global.CodeMirror=factory())})(this,(function(){"use strict";var userAgent=navigator.userAgent;var platform=navigator.platform;var gecko=/gecko\/\d/i.test(userAgent);var ie_upto10=/MSIE \d/.test(userAgent);var ie_11up=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(userAgent);var edge=/Edge\/(\d+)/.exec(userAgent);var ie=ie_upto10||ie_11up||edge;var ie_version=ie&&(ie_upto10?document.documentMode||6:+(edge||ie_11up)[1]);var webkit=!edge&&/WebKit\//.test(userAgent);var qtwebkit=webkit&&/Qt\/\d+\.\d+/.test(userAgent);var chrome=!edge&&/Chrome\/(\d+)/.exec(userAgent);var chrome_version=chrome&&+chrome[1];var presto=/Opera\//.test(userAgent);var safari=/Apple Computer/.test(navigator.vendor);var mac_geMountainLion=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(userAgent);var phantom=/PhantomJS/.test(userAgent);var ios=safari&&(/Mobile\/\w+/.test(userAgent)||navigator.maxTouchPoints>2);var android=/Android/.test(userAgent);var mobile=ios||android||/webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(userAgent);var mac=ios||/Mac/.test(platform);var chromeOS=/\bCrOS\b/.test(userAgent);var windows=/win/i.test(platform);var presto_version=presto&&userAgent.match(/Version\/(\d*\.\d*)/);if(presto_version){presto_version=Number(presto_version[1])}if(presto_version&&presto_version>=15){presto=false;webkit=true}var flipCtrlCmd=mac&&(qtwebkit||presto&&(presto_version==null||presto_version<12.11));var captureRightClick=gecko||ie&&ie_version>=9;function classTest(cls){return new RegExp("(^|\\s)"+cls+"(?:$|\\s)\\s*")}var rmClass=function(node,cls){var current=node.className;var match=classTest(cls).exec(current);if(match){var after=current.slice(match.index+match[0].length);node.className=current.slice(0,match.index)+(after?match[1]+after:"")}};function removeChildren(e){for(var count=e.childNodes.length;count>0;--count){e.removeChild(e.firstChild)}return e}function removeChildrenAndAdd(parent,e){return removeChildren(parent).appendChild(e)}function elt(tag,content,className,style){var e=document.createElement(tag);if(className){e.className=className}if(style){e.style.cssText=style}if(typeof content=="string"){e.appendChild(document.createTextNode(content))}else if(content){for(var i=0;i<content.length;++i){e.appendChild(content[i])}}return e}function eltP(tag,content,className,style){var e=elt(tag,content,className,style);e.setAttribute("role","presentation");return e}var range;if(document.createRange){range=function(node,start,end,endNode){var r=document.createRange();r.setEnd(endNode||node,end);r.setStart(node,start);return r}}else{range=function(node,start,end){var r=document.body.createTextRange();try{r.moveToElementText(node.parentNode)}catch(e){return r}r.collapse(true);r.moveEnd("character",end);r.moveStart("character",start);return r}}function contains(parent,child){if(child.nodeType==3){child=child.parentNode}if(parent.contains){return parent.contains(child)}do{if(child.nodeType==11){child=child.host}if(child==parent){return true}}while(child=child.parentNode)}function activeElt(doc){var activeElement;try{activeElement=doc.activeElement}catch(e){activeElement=doc.body||null}while(activeElement&&activeElement.shadowRoot&&activeElement.shadowRoot.activeElement){activeElement=activeElement.shadowRoot.activeElement}return activeElement}function addClass(node,cls){var current=node.className;if(!classTest(cls).test(current)){node.className+=(current?" ":"")+cls}}function joinClasses(a,b){var as=a.split(" ");for(var i=0;i<as.length;i++){if(as[i]&&!classTest(as[i]).test(b)){b+=" "+as[i]}}return b}var selectInput=function(node){node.select()};if(ios){selectInput=function(node){node.selectionStart=0;node.selectionEnd=node.value.length}}else if(ie){selectInput=function(node){try{node.select()}catch(_e){}}}function doc(cm){return cm.display.wrapper.ownerDocument}function win(cm){return doc(cm).defaultView}function bind(f){var args=Array.prototype.slice.call(arguments,1);return function(){return f.apply(null,args)}}function copyObj(obj,target,overwrite){if(!target){target={}}for(var prop in obj){if(obj.hasOwnProperty(prop)&&(overwrite!==false||!target.hasOwnProperty(prop))){target[prop]=obj[prop]}}return target}function countColumn(string,end,tabSize,startIndex,startValue){if(end==null){end=string.search(/[^\s\u00a0]/);if(end==-1){end=string.length}}for(var i=startIndex||0,n=startValue||0;;){var nextTab=string.indexOf("\t",i);if(nextTab<0||nextTab>=end){return n+(end-i)}n+=nextTab-i;n+=tabSize-n%tabSize;i=nextTab+1}}var Delayed=function(){this.id=null;this.f=null;this.time=0;this.handler=bind(this.onTimeout,this)};Delayed.prototype.onTimeout=function(self){self.id=0;if(self.time<=+new Date){self.f()}else{setTimeout(self.handler,self.time-+new Date)}};Delayed.prototype.set=function(ms,f){this.f=f;var time=+new Date+ms;if(!this.id||time<this.time){clearTimeout(this.id);this.id=setTimeout(this.handler,ms);this.time=time}};function indexOf(array,elt){for(var i=0;i<array.length;++i){if(array[i]==elt){return i}}return-1}var scrollerGap=50;var Pass={toString:function(){return"CodeMirror.Pass"}};var sel_dontScroll={scroll:false},sel_mouse={origin:"*mouse"},sel_move={origin:"+move"};function findColumn(string,goal,tabSize){for(var pos=0,col=0;;){var nextTab=string.indexOf("\t",pos);if(nextTab==-1){nextTab=string.length}var skipped=nextTab-pos;if(nextTab==string.length||col+skipped>=goal){return pos+Math.min(skipped,goal-col)}col+=nextTab-pos;col+=tabSize-col%tabSize;pos=nextTab+1;if(col>=goal){return pos}}}var spaceStrs=[""];function spaceStr(n){while(spaceStrs.length<=n){spaceStrs.push(lst(spaceStrs)+" ")}return spaceStrs[n]}function lst(arr){return arr[arr.length-1]}function map(array,f){var out=[];for(var i=0;i<array.length;i++){out[i]=f(array[i],i)}return out}function insertSorted(array,value,score){var pos=0,priority=score(value);while(pos<array.length&&score(array[pos])<=priority){pos++}array.splice(pos,0,value)}function nothing(){}function createObj(base,props){var inst;if(Object.create){inst=Object.create(base)}else{nothing.prototype=base;inst=new nothing}if(props){copyObj(props,inst)}return inst}var nonASCIISingleCaseWordChar=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;function isWordCharBasic(ch){return/\w/.test(ch)||ch>""&&(ch.toUpperCase()!=ch.toLowerCase()||nonASCIISingleCaseWordChar.test(ch))}function isWordChar(ch,helper){if(!helper){return isWordCharBasic(ch)}if(helper.source.indexOf("\\w")>-1&&isWordCharBasic(ch)){return true}return helper.test(ch)}function isEmpty(obj){for(var n in obj){if(obj.hasOwnProperty(n)&&obj[n]){return false}}return true}var extendingChars=/[\u0300-\u036f\u0483-\u0489\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u065e\u0670\u06d6-\u06dc\u06de-\u06e4\u06e7\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u07a6-\u07b0\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0900-\u0902\u093c\u0941-\u0948\u094d\u0951-\u0955\u0962\u0963\u0981\u09bc\u09be\u09c1-\u09c4\u09cd\u09d7\u09e2\u09e3\u0a01\u0a02\u0a3c\u0a41\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a70\u0a71\u0a75\u0a81\u0a82\u0abc\u0ac1-\u0ac5\u0ac7\u0ac8\u0acd\u0ae2\u0ae3\u0b01\u0b3c\u0b3e\u0b3f\u0b41-\u0b44\u0b4d\u0b56\u0b57\u0b62\u0b63\u0b82\u0bbe\u0bc0\u0bcd\u0bd7\u0c3e-\u0c40\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0cbc\u0cbf\u0cc2\u0cc6\u0ccc\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0d3e\u0d41-\u0d44\u0d4d\u0d57\u0d62\u0d63\u0dca\u0dcf\u0dd2-\u0dd4\u0dd6\u0ddf\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9\u0ebb\u0ebc\u0ec8-\u0ecd\u0f18\u0f19\u0f35\u0f37\u0f39\u0f71-\u0f7e\u0f80-\u0f84\u0f86\u0f87\u0f90-\u0f97\u0f99-\u0fbc\u0fc6\u102d-\u1030\u1032-\u1037\u1039\u103a\u103d\u103e\u1058\u1059\u105e-\u1060\u1071-\u1074\u1082\u1085\u1086\u108d\u109d\u135f\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b7-\u17bd\u17c6\u17c9-\u17d3\u17dd\u180b-\u180d\u18a9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193b\u1a17\u1a18\u1a56\u1a58-\u1a5e\u1a60\u1a62\u1a65-\u1a6c\u1a73-\u1a7c\u1a7f\u1b00-\u1b03\u1b34\u1b36-\u1b3a\u1b3c\u1b42\u1b6b-\u1b73\u1b80\u1b81\u1ba2-\u1ba5\u1ba8\u1ba9\u1c2c-\u1c33\u1c36\u1c37\u1cd0-\u1cd2\u1cd4-\u1ce0\u1ce2-\u1ce8\u1ced\u1dc0-\u1de6\u1dfd-\u1dff\u200c\u200d\u20d0-\u20f0\u2cef-\u2cf1\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua66f-\ua672\ua67c\ua67d\ua6f0\ua6f1\ua802\ua806\ua80b\ua825\ua826\ua8c4\ua8e0-\ua8f1\ua926-\ua92d\ua947-\ua951\ua980-\ua982\ua9b3\ua9b6-\ua9b9\ua9bc\uaa29-\uaa2e\uaa31\uaa32\uaa35\uaa36\uaa43\uaa4c\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uabe5\uabe8\uabed\udc00-\udfff\ufb1e\ufe00-\ufe0f\ufe20-\ufe26\uff9e\uff9f]/;function isExtendingChar(ch){return ch.charCodeAt(0)>=768&&extendingChars.test(ch)}function skipExtendingChars(str,pos,dir){while((dir<0?pos>0:pos<str.length)&&isExtendingChar(str.charAt(pos))){pos+=dir}return pos}function findFirst(pred,from,to){var dir=from>to?-1:1;for(;;){if(from==to){return from}var midF=(from+to)/2,mid=dir<0?Math.ceil(midF):Math.floor(midF);if(mid==from){return pred(mid)?from:to}if(pred(mid)){to=mid}else{from=mid+dir}}}function iterateBidiSections(order,from,to,f){if(!order){return f(from,to,"ltr",0)}var found=false;for(var i=0;i<order.length;++i){var part=order[i];if(part.from<to&&part.to>from||from==to&&part.to==from){f(Math.max(part.from,from),Math.min(part.to,to),part.level==1?"rtl":"ltr",i);found=true}}if(!found){f(from,to,"ltr")}}var bidiOther=null;function getBidiPartAt(order,ch,sticky){var found;bidiOther=null;for(var i=0;i<order.length;++i){var cur=order[i];if(cur.from<ch&&cur.to>ch){return i}if(cur.to==ch){if(cur.from!=cur.to&&sticky=="before"){found=i}else{bidiOther=i}}if(cur.from==ch){if(cur.from!=cur.to&&sticky!="before"){found=i}else{bidiOther=i}}}return found!=null?found:bidiOther}var bidiOrdering=function(){var lowTypes="bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN";var arabicTypes="nnnnnnNNr%%r,rNNmmmmmmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmmmnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmnNmmmmmmrrmmNmmmmrr1111111111";function charType(code){if(code<=247){return lowTypes.charAt(code)}else if(1424<=code&&code<=1524){return"R"}else if(1536<=code&&code<=1785){return arabicTypes.charAt(code-1536)}else if(1774<=code&&code<=2220){return"r"}else if(8192<=code&&code<=8203){return"w"}else if(code==8204){return"b"}else{return"L"}}var bidiRE=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;var isNeutral=/[stwN]/,isStrong=/[LRr]/,countsAsLeft=/[Lb1n]/,countsAsNum=/[1n]/;function BidiSpan(level,from,to){this.level=level;this.from=from;this.to=to}return function(str,direction){var outerType=direction=="ltr"?"L":"R";if(str.length==0||direction=="ltr"&&!bidiRE.test(str)){return false}var len=str.length,types=[];for(var i=0;i<len;++i){types.push(charType(str.charCodeAt(i)))}for(var i$1=0,prev=outerType;i$1<len;++i$1){var type=types[i$1];if(type=="m"){types[i$1]=prev}else{prev=type}}for(var i$2=0,cur=outerType;i$2<len;++i$2){var type$1=types[i$2];if(type$1=="1"&&cur=="r"){types[i$2]="n"}else if(isStrong.test(type$1)){cur=type$1;if(type$1=="r"){types[i$2]="R"}}}for(var i$3=1,prev$1=types[0];i$3<len-1;++i$3){var type$2=types[i$3];if(type$2=="+"&&prev$1=="1"&&types[i$3+1]=="1"){types[i$3]="1"}else if(type$2==","&&prev$1==types[i$3+1]&&(prev$1=="1"||prev$1=="n")){types[i$3]=prev$1}prev$1=type$2}for(var i$4=0;i$4<len;++i$4){var type$3=types[i$4];if(type$3==","){types[i$4]="N"}else if(type$3=="%"){var end=void 0;for(end=i$4+1;end<len&&types[end]=="%";++end){}var replace=i$4&&types[i$4-1]=="!"||end<len&&types[end]=="1"?"1":"N";for(var j=i$4;j<end;++j){types[j]=replace}i$4=end-1}}for(var i$5=0,cur$1=outerType;i$5<len;++i$5){var type$4=types[i$5];if(cur$1=="L"&&type$4=="1"){types[i$5]="L"}else if(isStrong.test(type$4)){cur$1=type$4}}for(var i$6=0;i$6<len;++i$6){if(isNeutral.test(types[i$6])){var end$1=void 0;for(end$1=i$6+1;end$1<len&&isNeutral.test(types[end$1]);++end$1){}var before=(i$6?types[i$6-1]:outerType)=="L";var after=(end$1<len?types[end$1]:outerType)=="L";var replace$1=before==after?before?"L":"R":outerType;for(var j$1=i$6;j$1<end$1;++j$1){types[j$1]=replace$1}i$6=end$1-1}}var order=[],m;for(var i$7=0;i$7<len;){if(countsAsLeft.test(types[i$7])){var start=i$7;for(++i$7;i$7<len&&countsAsLeft.test(types[i$7]);++i$7){}order.push(new BidiSpan(0,start,i$7))}else{var pos=i$7,at=order.length,isRTL=direction=="rtl"?1:0;for(++i$7;i$7<len&&types[i$7]!="L";++i$7){}for(var j$2=pos;j$2<i$7;){if(countsAsNum.test(types[j$2])){if(pos<j$2){order.splice(at,0,new BidiSpan(1,pos,j$2));at+=isRTL}var nstart=j$2;for(++j$2;j$2<i$7&&countsAsNum.test(types[j$2]);++j$2){}order.splice(at,0,new BidiSpan(2,nstart,j$2));at+=isRTL;pos=j$2}else{++j$2}}if(pos<i$7){order.splice(at,0,new BidiSpan(1,pos,i$7))}}}if(direction=="ltr"){if(order[0].level==1&&(m=str.match(/^\s+/))){order[0].from=m[0].length;order.unshift(new BidiSpan(0,0,m[0].length))}if(lst(order).level==1&&(m=str.match(/\s+$/))){lst(order).to-=m[0].length;order.push(new BidiSpan(0,len-m[0].length,len))}}return direction=="rtl"?order.reverse():order}}();function getOrder(line,direction){var order=line.order;if(order==null){order=line.order=bidiOrdering(line.text,direction)}return order}var noHandlers=[];var on=function(emitter,type,f){if(emitter.addEventListener){emitter.addEventListener(type,f,false)}else if(emitter.attachEvent){emitter.attachEvent("on"+type,f)}else{var map=emitter._handlers||(emitter._handlers={});map[type]=(map[type]||noHandlers).concat(f)}};function getHandlers(emitter,type){return emitter._handlers&&emitter._handlers[type]||noHandlers}function off(emitter,type,f){if(emitter.removeEventListener){emitter.removeEventListener(type,f,false)}else if(emitter.detachEvent){emitter.detachEvent("on"+type,f)}else{var map=emitter._handlers,arr=map&&map[type];if(arr){var index=indexOf(arr,f);if(index>-1){map[type]=arr.slice(0,index).concat(arr.slice(index+1))}}}}function signal(emitter,type){var handlers=getHandlers(emitter,type);if(!handlers.length){return}var args=Array.prototype.slice.call(arguments,2);for(var i=0;i<handlers.length;++i){handlers[i].apply(null,args)}}function signalDOMEvent(cm,e,override){if(typeof e=="string"){e={type:e,preventDefault:function(){this.defaultPrevented=true}}}signal(cm,override||e.type,cm,e);return e_defaultPrevented(e)||e.codemirrorIgnore}function signalCursorActivity(cm){var arr=cm._handlers&&cm._handlers.cursorActivity;if(!arr){return}var set=cm.curOp.cursorActivityHandlers||(cm.curOp.cursorActivityHandlers=[]);for(var i=0;i<arr.length;++i){if(indexOf(set,arr[i])==-1){set.push(arr[i])}}}function hasHandler(emitter,type){return getHandlers(emitter,type).length>0}function eventMixin(ctor){ctor.prototype.on=function(type,f){on(this,type,f)};ctor.prototype.off=function(type,f){off(this,type,f)}}function e_preventDefault(e){if(e.preventDefault){e.preventDefault()}else{e.returnValue=false}}function e_stopPropagation(e){if(e.stopPropagation){e.stopPropagation()}else{e.cancelBubble=true}}function e_defaultPrevented(e){return e.defaultPrevented!=null?e.defaultPrevented:e.returnValue==false}function e_stop(e){e_preventDefault(e);e_stopPropagation(e)}function e_target(e){return e.target||e.srcElement}function e_button(e){var b=e.which;if(b==null){if(e.button&1){b=1}else if(e.button&2){b=3}else if(e.button&4){b=2}}if(mac&&e.ctrlKey&&b==1){b=3}return b}var dragAndDrop=function(){if(ie&&ie_version<9){return false}var div=elt("div");return"draggable"in div||"dragDrop"in div}();var zwspSupported;function zeroWidthElement(measure){if(zwspSupported==null){var test=elt("span","​");removeChildrenAndAdd(measure,elt("span",[test,document.createTextNode("x")]));if(measure.firstChild.offsetHeight!=0){zwspSupported=test.offsetWidth<=1&&test.offsetHeight>2&&!(ie&&ie_version<8)}}var node=zwspSupported?elt("span","​"):elt("span"," ",null,"display: inline-block; width: 1px; margin-right: -1px");node.setAttribute("cm-text","");return node}var badBidiRects;function hasBadBidiRects(measure){if(badBidiRects!=null){return badBidiRects}var txt=removeChildrenAndAdd(measure,document.createTextNode("AخA"));var r0=range(txt,0,1).getBoundingClientRect();var r1=range(txt,1,2).getBoundingClientRect();removeChildren(measure);if(!r0||r0.left==r0.right){return false}return badBidiRects=r1.right-r0.right<3}var splitLinesAuto="\n\nb".split(/\n/).length!=3?function(string){var pos=0,result=[],l=string.length;while(pos<=l){var nl=string.indexOf("\n",pos);if(nl==-1){nl=string.length}var line=string.slice(pos,string.charAt(nl-1)=="\r"?nl-1:nl);var rt=line.indexOf("\r");if(rt!=-1){result.push(line.slice(0,rt));pos+=rt+1}else{result.push(line);pos=nl+1}}return result}:function(string){return string.split(/\r\n?|\n/)};var hasSelection=window.getSelection?function(te){try{return te.selectionStart!=te.selectionEnd}catch(e){return false}}:function(te){var range;try{range=te.ownerDocument.selection.createRange()}catch(e){}if(!range||range.parentElement()!=te){return false}return range.compareEndPoints("StartToEnd",range)!=0};var hasCopyEvent=function(){var e=elt("div");if("oncopy"in e){return true}e.setAttribute("oncopy","return;");return typeof e.oncopy=="function"}();var badZoomedRects=null;function hasBadZoomedRects(measure){if(badZoomedRects!=null){return badZoomedRects}var node=removeChildrenAndAdd(measure,elt("span","x"));var normal=node.getBoundingClientRect();var fromRange=range(node,0,1).getBoundingClientRect();return badZoomedRects=Math.abs(normal.left-fromRange.left)>1}var modes={},mimeModes={};function defineMode(name,mode){if(arguments.length>2){mode.dependencies=Array.prototype.slice.call(arguments,2)}modes[name]=mode}function defineMIME(mime,spec){mimeModes[mime]=spec}function resolveMode(spec){if(typeof spec=="string"&&mimeModes.hasOwnProperty(spec)){spec=mimeModes[spec]}else if(spec&&typeof spec.name=="string"&&mimeModes.hasOwnProperty(spec.name)){var found=mimeModes[spec.name];if(typeof found=="string"){found={name:found}}spec=createObj(found,spec);spec.name=found.name}else if(typeof spec=="string"&&/^[\w\-]+\/[\w\-]+\+xml$/.test(spec)){return resolveMode("application/xml")}else if(typeof spec=="string"&&/^[\w\-]+\/[\w\-]+\+json$/.test(spec)){return resolveMode("application/json")}if(typeof spec=="string"){return{name:spec}}else{return spec||{name:"null"}}}function getMode(options,spec){spec=resolveMode(spec);var mfactory=modes[spec.name];if(!mfactory){return getMode(options,"text/plain")}var modeObj=mfactory(options,spec);if(modeExtensions.hasOwnProperty(spec.name)){var exts=modeExtensions[spec.name];for(var prop in exts){if(!exts.hasOwnProperty(prop)){continue}if(modeObj.hasOwnProperty(prop)){modeObj["_"+prop]=modeObj[prop]}modeObj[prop]=exts[prop]}}modeObj.name=spec.name;if(spec.helperType){modeObj.helperType=spec.helperType}if(spec.modeProps){for(var prop$1 in spec.modeProps){modeObj[prop$1]=spec.modeProps[prop$1]}}return modeObj}var modeExtensions={};function extendMode(mode,properties){var exts=modeExtensions.hasOwnProperty(mode)?modeExtensions[mode]:modeExtensions[mode]={};copyObj(properties,exts)}function copyState(mode,state){if(state===true){return state}if(mode.copyState){return mode.copyState(state)}var nstate={};for(var n in state){var val=state[n];if(val instanceof Array){val=val.concat([])}nstate[n]=val}return nstate}function innerMode(mode,state){var info;while(mode.innerMode){info=mode.innerMode(state);if(!info||info.mode==mode){break}state=info.state;mode=info.mode}return info||{mode:mode,state:state}}function startState(mode,a1,a2){return mode.startState?mode.startState(a1,a2):true}var StringStream=function(string,tabSize,lineOracle){this.pos=this.start=0;this.string=string;this.tabSize=tabSize||8;this.lastColumnPos=this.lastColumnValue=0;this.lineStart=0;this.lineOracle=lineOracle};StringStream.prototype.eol=function(){return this.pos>=this.string.length};StringStream.prototype.sol=function(){return this.pos==this.lineStart};StringStream.prototype.peek=function(){return this.string.charAt(this.pos)||undefined};StringStream.prototype.next=function(){if(this.pos<this.string.length){return this.string.charAt(this.pos++)}};StringStream.prototype.eat=function(match){var ch=this.string.charAt(this.pos);var ok;if(typeof match=="string"){ok=ch==match}else{ok=ch&&(match.test?match.test(ch):match(ch))}if(ok){++this.pos;return ch}};StringStream.prototype.eatWhile=function(match){var start=this.pos;while(this.eat(match)){}return this.pos>start};StringStream.prototype.eatSpace=function(){var start=this.pos;while(/[\s\u00a0]/.test(this.string.charAt(this.pos))){++this.pos}return this.pos>start};StringStream.prototype.skipToEnd=function(){this.pos=this.string.length};StringStream.prototype.skipTo=function(ch){var found=this.string.indexOf(ch,this.pos);if(found>-1){this.pos=found;return true}};StringStream.prototype.backUp=function(n){this.pos-=n};StringStream.prototype.column=function(){if(this.lastColumnPos<this.start){this.lastColumnValue=countColumn(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue);this.lastColumnPos=this.start}return this.lastColumnValue-(this.lineStart?countColumn(this.string,this.lineStart,this.tabSize):0)};StringStream.prototype.indentation=function(){return countColumn(this.string,null,this.tabSize)-(this.lineStart?countColumn(this.string,this.lineStart,this.tabSize):0)};StringStream.prototype.match=function(pattern,consume,caseInsensitive){if(typeof pattern=="string"){var cased=function(str){return caseInsensitive?str.toLowerCase():str};var substr=this.string.substr(this.pos,pattern.length);if(cased(substr)==cased(pattern)){if(consume!==false){this.pos+=pattern.length}return true}}else{var match=this.string.slice(this.pos).match(pattern);if(match&&match.index>0){return null}if(match&&consume!==false){this.pos+=match[0].length}return match}};StringStream.prototype.current=function(){return this.string.slice(this.start,this.pos)};StringStream.prototype.hideFirstChars=function(n,inner){this.lineStart+=n;try{return inner()}finally{this.lineStart-=n}};StringStream.prototype.lookAhead=function(n){var oracle=this.lineOracle;return oracle&&oracle.lookAhead(n)};StringStream.prototype.baseToken=function(){var oracle=this.lineOracle;return oracle&&oracle.baseToken(this.pos)};function getLine(doc,n){n-=doc.first;if(n<0||n>=doc.size){throw new Error("There is no line "+(n+doc.first)+" in the document.")}var chunk=doc;while(!chunk.lines){for(var i=0;;++i){var child=chunk.children[i],sz=child.chunkSize();if(n<sz){chunk=child;break}n-=sz}}return chunk.lines[n]}function getBetween(doc,start,end){var out=[],n=start.line;doc.iter(start.line,end.line+1,(function(line){var text=line.text;if(n==end.line){text=text.slice(0,end.ch)}if(n==start.line){text=text.slice(start.ch)}out.push(text);++n}));return out}function getLines(doc,from,to){var out=[];doc.iter(from,to,(function(line){out.push(line.text)}));return out}function updateLineHeight(line,height){var diff=height-line.height;if(diff){for(var n=line;n;n=n.parent){n.height+=diff}}}function lineNo(line){if(line.parent==null){return null}var cur=line.parent,no=indexOf(cur.lines,line);for(var chunk=cur.parent;chunk;cur=chunk,chunk=chunk.parent){for(var i=0;;++i){if(chunk.children[i]==cur){break}no+=chunk.children[i].chunkSize()}}return no+cur.first}function lineAtHeight(chunk,h){var n=chunk.first;outer:do{for(var i$1=0;i$1<chunk.children.length;++i$1){var child=chunk.children[i$1],ch=child.height;if(h<ch){chunk=child;continue outer}h-=ch;n+=child.chunkSize()}return n}while(!chunk.lines);var i=0;for(;i<chunk.lines.length;++i){var line=chunk.lines[i],lh=line.height;if(h<lh){break}h-=lh}return n+i}function isLine(doc,l){return l>=doc.first&&l<doc.first+doc.size}function lineNumberFor(options,i){return String(options.lineNumberFormatter(i+options.firstLineNumber))}function Pos(line,ch,sticky){if(sticky===void 0)sticky=null;if(!(this instanceof Pos)){return new Pos(line,ch,sticky)}this.line=line;this.ch=ch;this.sticky=sticky}function cmp(a,b){return a.line-b.line||a.ch-b.ch}function equalCursorPos(a,b){return a.sticky==b.sticky&&cmp(a,b)==0}function copyPos(x){return Pos(x.line,x.ch)}function maxPos(a,b){return cmp(a,b)<0?b:a}function minPos(a,b){return cmp(a,b)<0?a:b}function clipLine(doc,n){return Math.max(doc.first,Math.min(n,doc.first+doc.size-1))}function clipPos(doc,pos){if(pos.line<doc.first){return Pos(doc.first,0)}var last=doc.first+doc.size-1;if(pos.line>last){return Pos(last,getLine(doc,last).text.length)}return clipToLen(pos,getLine(doc,pos.line).text.length)}function clipToLen(pos,linelen){var ch=pos.ch;if(ch==null||ch>linelen){return Pos(pos.line,linelen)}else if(ch<0){return Pos(pos.line,0)}else{return pos}}function clipPosArray(doc,array){var out=[];for(var i=0;i<array.length;i++){out[i]=clipPos(doc,array[i])}return out}var SavedContext=function(state,lookAhead){this.state=state;this.lookAhead=lookAhead};var Context=function(doc,state,line,lookAhead){this.state=state;this.doc=doc;this.line=line;this.maxLookAhead=lookAhead||0;this.baseTokens=null;this.baseTokenPos=1};Context.prototype.lookAhead=function(n){var line=this.doc.getLine(this.line+n);if(line!=null&&n>this.maxLookAhead){this.maxLookAhead=n}return line};Context.prototype.baseToken=function(n){if(!this.baseTokens){return null}while(this.baseTokens[this.baseTokenPos]<=n){this.baseTokenPos+=2}var type=this.baseTokens[this.baseTokenPos+1];return{type:type&&type.replace(/( |^)overlay .*/,""),size:this.baseTokens[this.baseTokenPos]-n}};Context.prototype.nextLine=function(){this.line++;if(this.maxLookAhead>0){this.maxLookAhead--}};Context.fromSaved=function(doc,saved,line){if(saved instanceof SavedContext){return new Context(doc,copyState(doc.mode,saved.state),line,saved.lookAhead)}else{return new Context(doc,copyState(doc.mode,saved),line)}};Context.prototype.save=function(copy){var state=copy!==false?copyState(this.doc.mode,this.state):this.state;return this.maxLookAhead>0?new SavedContext(state,this.maxLookAhead):state};function highlightLine(cm,line,context,forceToEnd){var st=[cm.state.modeGen],lineClasses={};runMode(cm,line.text,cm.doc.mode,context,(function(end,style){return st.push(end,style)}),lineClasses,forceToEnd);var state=context.state;var loop=function(o){context.baseTokens=st;var overlay=cm.state.overlays[o],i=1,at=0;context.state=true;runMode(cm,line.text,overlay.mode,context,(function(end,style){var start=i;while(at<end){var i_end=st[i];if(i_end>end){st.splice(i,1,end,st[i+1],i_end)}i+=2;at=Math.min(end,i_end)}if(!style){return}if(overlay.opaque){st.splice(start,i-start,end,"overlay "+style);i=start+2}else{for(;start<i;start+=2){var cur=st[start+1];st[start+1]=(cur?cur+" ":"")+"overlay "+style}}}),lineClasses);context.state=state;context.baseTokens=null;context.baseTokenPos=1};for(var o=0;o<cm.state.overlays.length;++o)loop(o);return{styles:st,classes:lineClasses.bgClass||lineClasses.textClass?lineClasses:null}}function getLineStyles(cm,line,updateFrontier){if(!line.styles||line.styles[0]!=cm.state.modeGen){var context=getContextBefore(cm,lineNo(line));var resetState=line.text.length>cm.options.maxHighlightLength&&copyState(cm.doc.mode,context.state);var result=highlightLine(cm,line,context);if(resetState){context.state=resetState}line.stateAfter=context.save(!resetState);line.styles=result.styles;if(result.classes){line.styleClasses=result.classes}else if(line.styleClasses){line.styleClasses=null}if(updateFrontier===cm.doc.highlightFrontier){cm.doc.modeFrontier=Math.max(cm.doc.modeFrontier,++cm.doc.highlightFrontier)}}return line.styles}function getContextBefore(cm,n,precise){var doc=cm.doc,display=cm.display;if(!doc.mode.startState){return new Context(doc,true,n)}var start=findStartLine(cm,n,precise);var saved=start>doc.first&&getLine(doc,start-1).stateAfter;var context=saved?Context.fromSaved(doc,saved,start):new Context(doc,startState(doc.mode),start);doc.iter(start,n,(function(line){processLine(cm,line.text,context);var pos=context.line;line.stateAfter=pos==n-1||pos%5==0||pos>=display.viewFrom&&pos<display.viewTo?context.save():null;context.nextLine()}));if(precise){doc.modeFrontier=context.line}return context}function processLine(cm,text,context,startAt){var mode=cm.doc.mode;var stream=new StringStream(text,cm.options.tabSize,context);stream.start=stream.pos=startAt||0;if(text==""){callBlankLine(mode,context.state)}while(!stream.eol()){readToken(mode,stream,context.state);stream.start=stream.pos}}function callBlankLine(mode,state){if(mode.blankLine){return mode.blankLine(state)}if(!mode.innerMode){return}var inner=innerMode(mode,state);if(inner.mode.blankLine){return inner.mode.blankLine(inner.state)}}function readToken(mode,stream,state,inner){for(var i=0;i<10;i++){if(inner){inner[0]=innerMode(mode,state).mode}var style=mode.token(stream,state);if(stream.pos>stream.start){return style}}throw new Error("Mode "+mode.name+" failed to advance stream.")}var Token=function(stream,type,state){this.start=stream.start;this.end=stream.pos;this.string=stream.current();this.type=type||null;this.state=state};function takeToken(cm,pos,precise,asArray){var doc=cm.doc,mode=doc.mode,style;pos=clipPos(doc,pos);var line=getLine(doc,pos.line),context=getContextBefore(cm,pos.line,precise);var stream=new StringStream(line.text,cm.options.tabSize,context),tokens;if(asArray){tokens=[]}while((asArray||stream.pos<pos.ch)&&!stream.eol()){stream.start=stream.pos;style=readToken(mode,stream,context.state);if(asArray){tokens.push(new Token(stream,style,copyState(doc.mode,context.state)))}}return asArray?tokens:new Token(stream,style,context.state)}function extractLineClasses(type,output){if(type){for(;;){var lineClass=type.match(/(?:^|\s+)line-(background-)?(\S+)/);if(!lineClass){break}type=type.slice(0,lineClass.index)+type.slice(lineClass.index+lineClass[0].length);var prop=lineClass[1]?"bgClass":"textClass";if(output[prop]==null){output[prop]=lineClass[2]}else if(!new RegExp("(?:^|\\s)"+lineClass[2]+"(?:$|\\s)").test(output[prop])){output[prop]+=" "+lineClass[2]}}}return type}function runMode(cm,text,mode,context,f,lineClasses,forceToEnd){var flattenSpans=mode.flattenSpans;if(flattenSpans==null){flattenSpans=cm.options.flattenSpans}var curStart=0,curStyle=null;var stream=new StringStream(text,cm.options.tabSize,context),style;var inner=cm.options.addModeClass&&[null];if(text==""){extractLineClasses(callBlankLine(mode,context.state),lineClasses)}while(!stream.eol()){if(stream.pos>cm.options.maxHighlightLength){flattenSpans=false;if(forceToEnd){processLine(cm,text,context,stream.pos)}stream.pos=text.length;style=null}else{style=extractLineClasses(readToken(mode,stream,context.state,inner),lineClasses)}if(inner){var mName=inner[0].name;if(mName){style="m-"+(style?mName+" "+style:mName)}}if(!flattenSpans||curStyle!=style){while(curStart<stream.start){curStart=Math.min(stream.start,curStart+5e3);f(curStart,curStyle)}curStyle=style}stream.start=stream.pos}while(curStart<stream.pos){var pos=Math.min(stream.pos,curStart+5e3);f(pos,curStyle);curStart=pos}}function findStartLine(cm,n,precise){var minindent,minline,doc=cm.doc;var lim=precise?-1:n-(cm.doc.mode.innerMode?1e3:100);for(var search=n;search>lim;--search){if(search<=doc.first){return doc.first}var line=getLine(doc,search-1),after=line.stateAfter;if(after&&(!precise||search+(after instanceof SavedContext?after.lookAhead:0)<=doc.modeFrontier)){return search}var indented=countColumn(line.text,null,cm.options.tabSize);if(minline==null||minindent>indented){minline=search-1;minindent=indented}}return minline}function retreatFrontier(doc,n){doc.modeFrontier=Math.min(doc.modeFrontier,n);if(doc.highlightFrontier<n-10){return}var start=doc.first;for(var line=n-1;line>start;line--){var saved=getLine(doc,line).stateAfter;if(saved&&(!(saved instanceof SavedContext)||line+saved.lookAhead<n)){start=line+1;break}}doc.highlightFrontier=Math.min(doc.highlightFrontier,start)}var sawReadOnlySpans=false,sawCollapsedSpans=false;function seeReadOnlySpans(){sawReadOnlySpans=true}function seeCollapsedSpans(){sawCollapsedSpans=true}function MarkedSpan(marker,from,to){this.marker=marker;this.from=from;this.to=to}function getMarkedSpanFor(spans,marker){if(spans){for(var i=0;i<spans.length;++i){var span=spans[i];if(span.marker==marker){return span}}}}function removeMarkedSpan(spans,span){var r;for(var i=0;i<spans.length;++i){if(spans[i]!=span){(r||(r=[])).push(spans[i])}}return r}function addMarkedSpan(line,span,op){var inThisOp=op&&window.WeakSet&&(op.markedSpans||(op.markedSpans=new WeakSet));if(inThisOp&&line.markedSpans&&inThisOp.has(line.markedSpans)){line.markedSpans.push(span)}else{line.markedSpans=line.markedSpans?line.markedSpans.concat([span]):[span];if(inThisOp){inThisOp.add(line.markedSpans)}}span.marker.attachLine(line)}function markedSpansBefore(old,startCh,isInsert){var nw;if(old){for(var i=0;i<old.length;++i){var span=old[i],marker=span.marker;var startsBefore=span.from==null||(marker.inclusiveLeft?span.from<=startCh:span.from<startCh);if(startsBefore||span.from==startCh&&marker.type=="bookmark"&&(!isInsert||!span.marker.insertLeft)){var endsAfter=span.to==null||(marker.inclusiveRight?span.to>=startCh:span.to>startCh);(nw||(nw=[])).push(new MarkedSpan(marker,span.from,endsAfter?null:span.to))}}}return nw}function markedSpansAfter(old,endCh,isInsert){var nw;if(old){for(var i=0;i<old.length;++i){var span=old[i],marker=span.marker;var endsAfter=span.to==null||(marker.inclusiveRight?span.to>=endCh:span.to>endCh);if(endsAfter||span.from==endCh&&marker.type=="bookmark"&&(!isInsert||span.marker.insertLeft)){var startsBefore=span.from==null||(marker.inclusiveLeft?span.from<=endCh:span.from<endCh);(nw||(nw=[])).push(new MarkedSpan(marker,startsBefore?null:span.from-endCh,span.to==null?null:span.to-endCh))}}}return nw}function stretchSpansOverChange(doc,change){if(change.full){return null}var oldFirst=isLine(doc,change.from.line)&&getLine(doc,change.from.line).markedSpans;var oldLast=isLine(doc,change.to.line)&&getLine(doc,change.to.line).markedSpans;if(!oldFirst&&!oldLast){return null}var startCh=change.from.ch,endCh=change.to.ch,isInsert=cmp(change.from,change.to)==0;var first=markedSpansBefore(oldFirst,startCh,isInsert);var last=markedSpansAfter(oldLast,endCh,isInsert);var sameLine=change.text.length==1,offset=lst(change.text).length+(sameLine?startCh:0);if(first){for(var i=0;i<first.length;++i){var span=first[i];if(span.to==null){var found=getMarkedSpanFor(last,span.marker);if(!found){span.to=startCh}else if(sameLine){span.to=found.to==null?null:found.to+offset}}}}if(last){for(var i$1=0;i$1<last.length;++i$1){var span$1=last[i$1];if(span$1.to!=null){span$1.to+=offset}if(span$1.from==null){var found$1=getMarkedSpanFor(first,span$1.marker);if(!found$1){span$1.from=offset;if(sameLine){(first||(first=[])).push(span$1)}}}else{span$1.from+=offset;if(sameLine){(first||(first=[])).push(span$1)}}}}if(first){first=clearEmptySpans(first)}if(last&&last!=first){last=clearEmptySpans(last)}var newMarkers=[first];if(!sameLine){var gap=change.text.length-2,gapMarkers;if(gap>0&&first){for(var i$2=0;i$2<first.length;++i$2){if(first[i$2].to==null){(gapMarkers||(gapMarkers=[])).push(new MarkedSpan(first[i$2].marker,null,null))}}}for(var i$3=0;i$3<gap;++i$3){newMarkers.push(gapMarkers)}newMarkers.push(last)}return newMarkers}function clearEmptySpans(spans){for(var i=0;i<spans.length;++i){var span=spans[i];if(span.from!=null&&span.from==span.to&&span.marker.clearWhenEmpty!==false){spans.splice(i--,1)}}if(!spans.length){return null}return spans}function removeReadOnlyRanges(doc,from,to){var markers=null;doc.iter(from.line,to.line+1,(function(line){if(line.markedSpans){for(var i=0;i<line.markedSpans.length;++i){var mark=line.markedSpans[i].marker;if(mark.readOnly&&(!markers||indexOf(markers,mark)==-1)){(markers||(markers=[])).push(mark)}}}}));if(!markers){return null}var parts=[{from:from,to:to}];for(var i=0;i<markers.length;++i){var mk=markers[i],m=mk.find(0);for(var j=0;j<parts.length;++j){var p=parts[j];if(cmp(p.to,m.from)<0||cmp(p.from,m.to)>0){continue}var newParts=[j,1],dfrom=cmp(p.from,m.from),dto=cmp(p.to,m.to);if(dfrom<0||!mk.inclusiveLeft&&!dfrom){newParts.push({from:p.from,to:m.from})}if(dto>0||!mk.inclusiveRight&&!dto){newParts.push({from:m.to,to:p.to})}parts.splice.apply(parts,newParts);j+=newParts.length-3}}return parts}function detachMarkedSpans(line){var spans=line.markedSpans;if(!spans){return}for(var i=0;i<spans.length;++i){spans[i].marker.detachLine(line)}line.markedSpans=null}function attachMarkedSpans(line,spans){if(!spans){return}for(var i=0;i<spans.length;++i){spans[i].marker.attachLine(line)}line.markedSpans=spans}function extraLeft(marker){return marker.inclusiveLeft?-1:0}function extraRight(marker){return marker.inclusiveRight?1:0}function compareCollapsedMarkers(a,b){var lenDiff=a.lines.length-b.lines.length;if(lenDiff!=0){return lenDiff}var aPos=a.find(),bPos=b.find();var fromCmp=cmp(aPos.from,bPos.from)||extraLeft(a)-extraLeft(b);if(fromCmp){return-fromCmp}var toCmp=cmp(aPos.to,bPos.to)||extraRight(a)-extraRight(b);if(toCmp){return toCmp}return b.id-a.id}function collapsedSpanAtSide(line,start){var sps=sawCollapsedSpans&&line.markedSpans,found;if(sps){for(var sp=void 0,i=0;i<sps.length;++i){sp=sps[i];if(sp.marker.collapsed&&(start?sp.from:sp.to)==null&&(!found||compareCollapsedMarkers(found,sp.marker)<0)){found=sp.marker}}}return found}function collapsedSpanAtStart(line){return collapsedSpanAtSide(line,true)}function collapsedSpanAtEnd(line){return collapsedSpanAtSide(line,false)}function collapsedSpanAround(line,ch){var sps=sawCollapsedSpans&&line.markedSpans,found;if(sps){for(var i=0;i<sps.length;++i){var sp=sps[i];if(sp.marker.collapsed&&(sp.from==null||sp.from<ch)&&(sp.to==null||sp.to>ch)&&(!found||compareCollapsedMarkers(found,sp.marker)<0)){found=sp.marker}}}return found}function conflictingCollapsedRange(doc,lineNo,from,to,marker){var line=getLine(doc,lineNo);var sps=sawCollapsedSpans&&line.markedSpans;if(sps){for(var i=0;i<sps.length;++i){var sp=sps[i];if(!sp.marker.collapsed){continue}var found=sp.marker.find(0);var fromCmp=cmp(found.from,from)||extraLeft(sp.marker)-extraLeft(marker);var toCmp=cmp(found.to,to)||extraRight(sp.marker)-extraRight(marker);if(fromCmp>=0&&toCmp<=0||fromCmp<=0&&toCmp>=0){continue}if(fromCmp<=0&&(sp.marker.inclusiveRight&&marker.inclusiveLeft?cmp(found.to,from)>=0:cmp(found.to,from)>0)||fromCmp>=0&&(sp.marker.inclusiveRight&&marker.inclusiveLeft?cmp(found.from,to)<=0:cmp(found.from,to)<0)){return true}}}}function visualLine(line){var merged;while(merged=collapsedSpanAtStart(line)){line=merged.find(-1,true).line}return line}function visualLineEnd(line){var merged;while(merged=collapsedSpanAtEnd(line)){line=merged.find(1,true).line}return line}function visualLineContinued(line){var merged,lines;while(merged=collapsedSpanAtEnd(line)){line=merged.find(1,true).line;(lines||(lines=[])).push(line)}return lines}function visualLineNo(doc,lineN){var line=getLine(doc,lineN),vis=visualLine(line);if(line==vis){return lineN}return lineNo(vis)}function visualLineEndNo(doc,lineN){if(lineN>doc.lastLine()){return lineN}var line=getLine(doc,lineN),merged;if(!lineIsHidden(doc,line)){return lineN}while(merged=collapsedSpanAtEnd(line)){line=merged.find(1,true).line}return lineNo(line)+1}function lineIsHidden(doc,line){var sps=sawCollapsedSpans&&line.markedSpans;if(sps){for(var sp=void 0,i=0;i<sps.length;++i){sp=sps[i];if(!sp.marker.collapsed){continue}if(sp.from==null){return true}if(sp.marker.widgetNode){continue}if(sp.from==0&&sp.marker.inclusiveLeft&&lineIsHiddenInner(doc,line,sp)){return true}}}}function lineIsHiddenInner(doc,line,span){if(span.to==null){var end=span.marker.find(1,true);return lineIsHiddenInner(doc,end.line,getMarkedSpanFor(end.line.markedSpans,span.marker))}if(span.marker.inclusiveRight&&span.to==line.text.length){return true}for(var sp=void 0,i=0;i<line.markedSpans.length;++i){sp=line.markedSpans[i];if(sp.marker.collapsed&&!sp.marker.widgetNode&&sp.from==span.to&&(sp.to==null||sp.to!=span.from)&&(sp.marker.inclusiveLeft||span.marker.inclusiveRight)&&lineIsHiddenInner(doc,line,sp)){return true}}}function heightAtLine(lineObj){lineObj=visualLine(lineObj);var h=0,chunk=lineObj.parent;for(var i=0;i<chunk.lines.length;++i){var line=chunk.lines[i];if(line==lineObj){break}else{h+=line.height}}for(var p=chunk.parent;p;chunk=p,p=chunk.parent){for(var i$1=0;i$1<p.children.length;++i$1){var cur=p.children[i$1];if(cur==chunk){break}else{h+=cur.height}}}return h}function lineLength(line){if(line.height==0){return 0}var len=line.text.length,merged,cur=line;while(merged=collapsedSpanAtStart(cur)){var found=merged.find(0,true);cur=found.from.line;len+=found.from.ch-found.to.ch}cur=line;while(merged=collapsedSpanAtEnd(cur)){var found$1=merged.find(0,true);len-=cur.text.length-found$1.from.ch;cur=found$1.to.line;len+=cur.text.length-found$1.to.ch}return len}function findMaxLine(cm){var d=cm.display,doc=cm.doc;d.maxLine=getLine(doc,doc.first);d.maxLineLength=lineLength(d.maxLine);d.maxLineChanged=true;doc.iter((function(line){var len=lineLength(line);if(len>d.maxLineLength){d.maxLineLength=len;d.maxLine=line}}))}var Line=function(text,markedSpans,estimateHeight){this.text=text;attachMarkedSpans(this,markedSpans);this.height=estimateHeight?estimateHeight(this):1};Line.prototype.lineNo=function(){return lineNo(this)};eventMixin(Line);function updateLine(line,text,markedSpans,estimateHeight){line.text=text;if(line.stateAfter){line.stateAfter=null}if(line.styles){line.styles=null}if(line.order!=null){line.order=null}detachMarkedSpans(line);attachMarkedSpans(line,markedSpans);var estHeight=estimateHeight?estimateHeight(line):1;if(estHeight!=line.height){updateLineHeight(line,estHeight)}}function cleanUpLine(line){line.parent=null;detachMarkedSpans(line)}var styleToClassCache={},styleToClassCacheWithMode={};function interpretTokenStyle(style,options){if(!style||/^\s*$/.test(style)){return null}var cache=options.addModeClass?styleToClassCacheWithMode:styleToClassCache;return cache[style]||(cache[style]=style.replace(/\S+/g,"cm-$&"))}function buildLineContent(cm,lineView){var content=eltP("span",null,null,webkit?"padding-right: .1px":null);var builder={pre:eltP("pre",[content],"CodeMirror-line"),content:content,col:0,pos:0,cm:cm,trailingSpace:false,splitSpaces:cm.getOption("lineWrapping")};lineView.measure={};for(var i=0;i<=(lineView.rest?lineView.rest.length:0);i++){var line=i?lineView.rest[i-1]:lineView.line,order=void 0;builder.pos=0;builder.addToken=buildToken;if(hasBadBidiRects(cm.display.measure)&&(order=getOrder(line,cm.doc.direction))){builder.addToken=buildTokenBadBidi(builder.addToken,order)}builder.map=[];var allowFrontierUpdate=lineView!=cm.display.externalMeasured&&lineNo(line);insertLineContent(line,builder,getLineStyles(cm,line,allowFrontierUpdate));if(line.styleClasses){if(line.styleClasses.bgClass){builder.bgClass=joinClasses(line.styleClasses.bgClass,builder.bgClass||"")}if(line.styleClasses.textClass){builder.textClass=joinClasses(line.styleClasses.textClass,builder.textClass||"")}}if(builder.map.length==0){builder.map.push(0,0,builder.content.appendChild(zeroWidthElement(cm.display.measure)))}if(i==0){lineView.measure.map=builder.map;lineView.measure.cache={}}else{(lineView.measure.maps||(lineView.measure.maps=[])).push(builder.map);(lineView.measure.caches||(lineView.measure.caches=[])).push({})}}if(webkit){var last=builder.content.lastChild;if(/\bcm-tab\b/.test(last.className)||last.querySelector&&last.querySelector(".cm-tab")){builder.content.className="cm-tab-wrap-hack"}}signal(cm,"renderLine",cm,lineView.line,builder.pre);if(builder.pre.className){builder.textClass=joinClasses(builder.pre.className,builder.textClass||"")}return builder}function defaultSpecialCharPlaceholder(ch){var token=elt("span","•","cm-invalidchar");token.title="\\u"+ch.charCodeAt(0).toString(16);token.setAttribute("aria-label",token.title);return token}function buildToken(builder,text,style,startStyle,endStyle,css,attributes){if(!text){return}var displayText=builder.splitSpaces?splitSpaces(text,builder.trailingSpace):text;var special=builder.cm.state.specialChars,mustWrap=false;var content;if(!special.test(text)){builder.col+=text.length;content=document.createTextNode(displayText);builder.map.push(builder.pos,builder.pos+text.length,content);if(ie&&ie_version<9){mustWrap=true}builder.pos+=text.length}else{content=document.createDocumentFragment();var pos=0;while(true){special.lastIndex=pos;var m=special.exec(text);var skipped=m?m.index-pos:text.length-pos;if(skipped){var txt=document.createTextNode(displayText.slice(pos,pos+skipped));if(ie&&ie_version<9){content.appendChild(elt("span",[txt]))}else{content.appendChild(txt)}builder.map.push(builder.pos,builder.pos+skipped,txt);builder.col+=skipped;builder.pos+=skipped}if(!m){break}pos+=skipped+1;var txt$1=void 0;if(m[0]=="\t"){var tabSize=builder.cm.options.tabSize,tabWidth=tabSize-builder.col%tabSize;txt$1=content.appendChild(elt("span",spaceStr(tabWidth),"cm-tab"));txt$1.setAttribute("role","presentation");txt$1.setAttribute("cm-text","\t");builder.col+=tabWidth}else if(m[0]=="\r"||m[0]=="\n"){txt$1=content.appendChild(elt("span",m[0]=="\r"?"␍":"␤","cm-invalidchar"));txt$1.setAttribute("cm-text",m[0]);builder.col+=1}else{txt$1=builder.cm.options.specialCharPlaceholder(m[0]);txt$1.setAttribute("cm-text",m[0]);if(ie&&ie_version<9){content.appendChild(elt("span",[txt$1]))}else{content.appendChild(txt$1)}builder.col+=1}builder.map.push(builder.pos,builder.pos+1,txt$1);builder.pos++}}builder.trailingSpace=displayText.charCodeAt(text.length-1)==32;if(style||startStyle||endStyle||mustWrap||css||attributes){var fullStyle=style||"";if(startStyle){fullStyle+=startStyle}if(endStyle){fullStyle+=endStyle}var token=elt("span",[content],fullStyle,css);if(attributes){for(var attr in attributes){if(attributes.hasOwnProperty(attr)&&attr!="style"&&attr!="class"){token.setAttribute(attr,attributes[attr])}}}return builder.content.appendChild(token)}builder.content.appendChild(content)}function splitSpaces(text,trailingBefore){if(text.length>1&&!/  /.test(text)){return text}var spaceBefore=trailingBefore,result="";for(var i=0;i<text.length;i++){var ch=text.charAt(i);if(ch==" "&&spaceBefore&&(i==text.length-1||text.charCodeAt(i+1)==32)){ch=" "}result+=ch;spaceBefore=ch==" "}return result}function buildTokenBadBidi(inner,order){return function(builder,text,style,startStyle,endStyle,css,attributes){style=style?style+" cm-force-border":"cm-force-border";var start=builder.pos,end=start+text.length;for(;;){var part=void 0;for(var i=0;i<order.length;i++){part=order[i];if(part.to>start&&part.from<=start){break}}if(part.to>=end){return inner(builder,text,style,startStyle,endStyle,css,attributes)}inner(builder,text.slice(0,part.to-start),style,startStyle,null,css,attributes);startStyle=null;text=text.slice(part.to-start);start=part.to}}}function buildCollapsedSpan(builder,size,marker,ignoreWidget){var widget=!ignoreWidget&&marker.widgetNode;if(widget){builder.map.push(builder.pos,builder.pos+size,widget)}if(!ignoreWidget&&builder.cm.display.input.needsContentAttribute){if(!widget){widget=builder.content.appendChild(document.createElement("span"))}widget.setAttribute("cm-marker",marker.id)}if(widget){builder.cm.display.input.setUneditable(widget);builder.content.appendChild(widget)}builder.pos+=size;builder.trailingSpace=false}function insertLineContent(line,builder,styles){var spans=line.markedSpans,allText=line.text,at=0;if(!spans){for(var i$1=1;i$1<styles.length;i$1+=2){builder.addToken(builder,allText.slice(at,at=styles[i$1]),interpretTokenStyle(styles[i$1+1],builder.cm.options))}return}var len=allText.length,pos=0,i=1,text="",style,css;var nextChange=0,spanStyle,spanEndStyle,spanStartStyle,collapsed,attributes;for(;;){if(nextChange==pos){spanStyle=spanEndStyle=spanStartStyle=css="";attributes=null;collapsed=null;nextChange=Infinity;var foundBookmarks=[],endStyles=void 0;for(var j=0;j<spans.length;++j){var sp=spans[j],m=sp.marker;if(m.type=="bookmark"&&sp.from==pos&&m.widgetNode){foundBookmarks.push(m)}else if(sp.from<=pos&&(sp.to==null||sp.to>pos||m.collapsed&&sp.to==pos&&sp.from==pos)){if(sp.to!=null&&sp.to!=pos&&nextChange>sp.to){nextChange=sp.to;spanEndStyle=""}if(m.className){spanStyle+=" "+m.className}if(m.css){css=(css?css+";":"")+m.css}if(m.startStyle&&sp.from==pos){spanStartStyle+=" "+m.startStyle}if(m.endStyle&&sp.to==nextChange){(endStyles||(endStyles=[])).push(m.endStyle,sp.to)}if(m.title){(attributes||(attributes={})).title=m.title}if(m.attributes){for(var attr in m.attributes){(attributes||(attributes={}))[attr]=m.attributes[attr]}}if(m.collapsed&&(!collapsed||compareCollapsedMarkers(collapsed.marker,m)<0)){collapsed=sp}}else if(sp.from>pos&&nextChange>sp.from){nextChange=sp.from}}if(endStyles){for(var j$1=0;j$1<endStyles.length;j$1+=2){if(endStyles[j$1+1]==nextChange){spanEndStyle+=" "+endStyles[j$1]}}}if(!collapsed||collapsed.from==pos){for(var j$2=0;j$2<foundBookmarks.length;++j$2){buildCollapsedSpan(builder,0,foundBookmarks[j$2])}}if(collapsed&&(collapsed.from||0)==pos){buildCollapsedSpan(builder,(collapsed.to==null?len+1:collapsed.to)-pos,collapsed.marker,collapsed.from==null);if(collapsed.to==null){return}if(collapsed.to==pos){collapsed=false}}}if(pos>=len){break}var upto=Math.min(len,nextChange);while(true){if(text){var end=pos+text.length;if(!collapsed){var tokenText=end>upto?text.slice(0,upto-pos):text;builder.addToken(builder,tokenText,style?style+spanStyle:spanStyle,spanStartStyle,pos+tokenText.length==nextChange?spanEndStyle:"",css,attributes)}if(end>=upto){text=text.slice(upto-pos);pos=upto;break}pos=end;spanStartStyle=""}text=allText.slice(at,at=styles[i++]);style=interpretTokenStyle(styles[i++],builder.cm.options)}}}function LineView(doc,line,lineN){this.line=line;this.rest=visualLineContinued(line);this.size=this.rest?lineNo(lst(this.rest))-lineN+1:1;this.node=this.text=null;this.hidden=lineIsHidden(doc,line)}function buildViewArray(cm,from,to){var array=[],nextPos;for(var pos=from;pos<to;pos=nextPos){var view=new LineView(cm.doc,getLine(cm.doc,pos),pos);nextPos=pos+view.size;array.push(view)}return array}var operationGroup=null;function pushOperation(op){if(operationGroup){operationGroup.ops.push(op)}else{op.ownsGroup=operationGroup={ops:[op],delayedCallbacks:[]}}}function fireCallbacksForOps(group){var callbacks=group.delayedCallbacks,i=0;do{for(;i<callbacks.length;i++){callbacks[i].call(null)}for(var j=0;j<group.ops.length;j++){var op=group.ops[j];if(op.cursorActivityHandlers){while(op.cursorActivityCalled<op.cursorActivityHandlers.length){op.cursorActivityHandlers[op.cursorActivityCalled++].call(null,op.cm)}}}}while(i<callbacks.length)}function finishOperation(op,endCb){var group=op.ownsGroup;if(!group){return}try{fireCallbacksForOps(group)}finally{operationGroup=null;endCb(group)}}var orphanDelayedCallbacks=null;function signalLater(emitter,type){var arr=getHandlers(emitter,type);if(!arr.length){return}var args=Array.prototype.slice.call(arguments,2),list;if(operationGroup){list=operationGroup.delayedCallbacks}else if(orphanDelayedCallbacks){list=orphanDelayedCallbacks}else{list=orphanDelayedCallbacks=[];setTimeout(fireOrphanDelayed,0)}var loop=function(i){list.push((function(){return arr[i].apply(null,args)}))};for(var i=0;i<arr.length;++i)loop(i)}function fireOrphanDelayed(){var delayed=orphanDelayedCallbacks;orphanDelayedCallbacks=null;for(var i=0;i<delayed.length;++i){delayed[i]()}}function updateLineForChanges(cm,lineView,lineN,dims){for(var j=0;j<lineView.changes.length;j++){var type=lineView.changes[j];if(type=="text"){updateLineText(cm,lineView)}else if(type=="gutter"){updateLineGutter(cm,lineView,lineN,dims)}else if(type=="class"){updateLineClasses(cm,lineView)}else if(type=="widget"){updateLineWidgets(cm,lineView,dims)}}lineView.changes=null}function ensureLineWrapped(lineView){if(lineView.node==lineView.text){lineView.node=elt("div",null,null,"position: relative");if(lineView.text.parentNode){lineView.text.parentNode.replaceChild(lineView.node,lineView.text)}lineView.node.appendChild(lineView.text);if(ie&&ie_version<8){lineView.node.style.zIndex=2}}return lineView.node}function updateLineBackground(cm,lineView){var cls=lineView.bgClass?lineView.bgClass+" "+(lineView.line.bgClass||""):lineView.line.bgClass;if(cls){cls+=" CodeMirror-linebackground"}if(lineView.background){if(cls){lineView.background.className=cls}else{lineView.background.parentNode.removeChild(lineView.background);lineView.background=null}}else if(cls){var wrap=ensureLineWrapped(lineView);lineView.background=wrap.insertBefore(elt("div",null,cls),wrap.firstChild);cm.display.input.setUneditable(lineView.background)}}function getLineContent(cm,lineView){var ext=cm.display.externalMeasured;if(ext&&ext.line==lineView.line){cm.display.externalMeasured=null;lineView.measure=ext.measure;return ext.built}return buildLineContent(cm,lineView)}function updateLineText(cm,lineView){var cls=lineView.text.className;var built=getLineContent(cm,lineView);if(lineView.text==lineView.node){lineView.node=built.pre}lineView.text.parentNode.replaceChild(built.pre,lineView.text);lineView.text=built.pre;if(built.bgClass!=lineView.bgClass||built.textClass!=lineView.textClass){lineView.bgClass=built.bgClass;lineView.textClass=built.textClass;updateLineClasses(cm,lineView)}else if(cls){lineView.text.className=cls}}function updateLineClasses(cm,lineView){updateLineBackground(cm,lineView);if(lineView.line.wrapClass){ensureLineWrapped(lineView).className=lineView.line.wrapClass}else if(lineView.node!=lineView.text){lineView.node.className=""}var textClass=lineView.textClass?lineView.textClass+" "+(lineView.line.textClass||""):lineView.line.textClass;lineView.text.className=textClass||""}function updateLineGutter(cm,lineView,lineN,dims){if(lineView.gutter){lineView.node.removeChild(lineView.gutter);lineView.gutter=null}if(lineView.gutterBackground){lineView.node.removeChild(lineView.gutterBackground);lineView.gutterBackground=null}if(lineView.line.gutterClass){var wrap=ensureLineWrapped(lineView);lineView.gutterBackground=elt("div",null,"CodeMirror-gutter-background "+lineView.line.gutterClass,"left: "+(cm.options.fixedGutter?dims.fixedPos:-dims.gutterTotalWidth)+"px; width: "+dims.gutterTotalWidth+"px");cm.display.input.setUneditable(lineView.gutterBackground);wrap.insertBefore(lineView.gutterBackground,lineView.text)}var markers=lineView.line.gutterMarkers;if(cm.options.lineNumbers||markers){var wrap$1=ensureLineWrapped(lineView);var gutterWrap=lineView.gutter=elt("div",null,"CodeMirror-gutter-wrapper","left: "+(cm.options.fixedGutter?dims.fixedPos:-dims.gutterTotalWidth)+"px");gutterWrap.setAttribute("aria-hidden","true");cm.display.input.setUneditable(gutterWrap);wrap$1.insertBefore(gutterWrap,lineView.text);if(lineView.line.gutterClass){gutterWrap.className+=" "+lineView.line.gutterClass}if(cm.options.lineNumbers&&(!markers||!markers["CodeMirror-linenumbers"])){lineView.lineNumber=gutterWrap.appendChild(elt("div",lineNumberFor(cm.options,lineN),"CodeMirror-linenumber CodeMirror-gutter-elt","left: "+dims.gutterLeft["CodeMirror-linenumbers"]+"px; width: "+cm.display.lineNumInnerWidth+"px"))}if(markers){for(var k=0;k<cm.display.gutterSpecs.length;++k){var id=cm.display.gutterSpecs[k].className,found=markers.hasOwnProperty(id)&&markers[id];if(found){gutterWrap.appendChild(elt("div",[found],"CodeMirror-gutter-elt","left: "+dims.gutterLeft[id]+"px; width: "+dims.gutterWidth[id]+"px"))}}}}}function updateLineWidgets(cm,lineView,dims){if(lineView.alignable){lineView.alignable=null}var isWidget=classTest("CodeMirror-linewidget");for(var node=lineView.node.firstChild,next=void 0;node;node=next){next=node.nextSibling;if(isWidget.test(node.className)){lineView.node.removeChild(node)}}insertLineWidgets(cm,lineView,dims)}function buildLineElement(cm,lineView,lineN,dims){var built=getLineContent(cm,lineView);lineView.text=lineView.node=built.pre;if(built.bgClass){lineView.bgClass=built.bgClass}if(built.textClass){lineView.textClass=built.textClass}updateLineClasses(cm,lineView);updateLineGutter(cm,lineView,lineN,dims);insertLineWidgets(cm,lineView,dims);return lineView.node}function insertLineWidgets(cm,lineView,dims){insertLineWidgetsFor(cm,lineView.line,lineView,dims,true);if(lineView.rest){for(var i=0;i<lineView.rest.length;i++){insertLineWidgetsFor(cm,lineView.rest[i],lineView,dims,false)}}}function insertLineWidgetsFor(cm,line,lineView,dims,allowAbove){if(!line.widgets){return}var wrap=ensureLineWrapped(lineView);for(var i=0,ws=line.widgets;i<ws.length;++i){var widget=ws[i],node=elt("div",[widget.node],"CodeMirror-linewidget"+(widget.className?" "+widget.className:""));if(!widget.handleMouseEvents){node.setAttribute("cm-ignore-events","true")}positionLineWidget(widget,node,lineView,dims);cm.display.input.setUneditable(node);if(allowAbove&&widget.above){wrap.insertBefore(node,lineView.gutter||lineView.text)}else{wrap.appendChild(node)}signalLater(widget,"redraw")}}function positionLineWidget(widget,node,lineView,dims){if(widget.noHScroll){(lineView.alignable||(lineView.alignable=[])).push(node);var width=dims.wrapperWidth;node.style.left=dims.fixedPos+"px";if(!widget.coverGutter){width-=dims.gutterTotalWidth;node.style.paddingLeft=dims.gutterTotalWidth+"px"}node.style.width=width+"px"}if(widget.coverGutter){node.style.zIndex=5;node.style.position="relative";if(!widget.noHScroll){node.style.marginLeft=-dims.gutterTotalWidth+"px"}}}function widgetHeight(widget){if(widget.height!=null){return widget.height}var cm=widget.doc.cm;if(!cm){return 0}if(!contains(document.body,widget.node)){var parentStyle="position: relative;";if(widget.coverGutter){parentStyle+="margin-left: -"+cm.display.gutters.offsetWidth+"px;"}if(widget.noHScroll){parentStyle+="width: "+cm.display.wrapper.clientWidth+"px;"}removeChildrenAndAdd(cm.display.measure,elt("div",[widget.node],null,parentStyle))}return widget.height=widget.node.parentNode.offsetHeight}function eventInWidget(display,e){for(var n=e_target(e);n!=display.wrapper;n=n.parentNode){if(!n||n.nodeType==1&&n.getAttribute("cm-ignore-events")=="true"||n.parentNode==display.sizer&&n!=display.mover){return true}}}function paddingTop(display){return display.lineSpace.offsetTop}function paddingVert(display){return display.mover.offsetHeight-display.lineSpace.offsetHeight}function paddingH(display){if(display.cachedPaddingH){return display.cachedPaddingH}var e=removeChildrenAndAdd(display.measure,elt("pre","x","CodeMirror-line-like"));var style=window.getComputedStyle?window.getComputedStyle(e):e.currentStyle;var data={left:parseInt(style.paddingLeft),right:parseInt(style.paddingRight)};if(!isNaN(data.left)&&!isNaN(data.right)){display.cachedPaddingH=data}return data}function scrollGap(cm){return scrollerGap-cm.display.nativeBarWidth}function displayWidth(cm){return cm.display.scroller.clientWidth-scrollGap(cm)-cm.display.barWidth}function displayHeight(cm){return cm.display.scroller.clientHeight-scrollGap(cm)-cm.display.barHeight}function ensureLineHeights(cm,lineView,rect){var wrapping=cm.options.lineWrapping;var curWidth=wrapping&&displayWidth(cm);if(!lineView.measure.heights||wrapping&&lineView.measure.width!=curWidth){var heights=lineView.measure.heights=[];if(wrapping){lineView.measure.width=curWidth;var rects=lineView.text.firstChild.getClientRects();for(var i=0;i<rects.length-1;i++){var cur=rects[i],next=rects[i+1];if(Math.abs(cur.bottom-next.bottom)>2){heights.push((cur.bottom+next.top)/2-rect.top)}}}heights.push(rect.bottom-rect.top)}}function mapFromLineView(lineView,line,lineN){if(lineView.line==line){return{map:lineView.measure.map,cache:lineView.measure.cache}}if(lineView.rest){for(var i=0;i<lineView.rest.length;i++){if(lineView.rest[i]==line){return{map:lineView.measure.maps[i],cache:lineView.measure.caches[i]}}}for(var i$1=0;i$1<lineView.rest.length;i$1++){if(lineNo(lineView.rest[i$1])>lineN){return{map:lineView.measure.maps[i$1],cache:lineView.measure.caches[i$1],before:true}}}}}function updateExternalMeasurement(cm,line){line=visualLine(line);var lineN=lineNo(line);var view=cm.display.externalMeasured=new LineView(cm.doc,line,lineN);view.lineN=lineN;var built=view.built=buildLineContent(cm,view);view.text=built.pre;removeChildrenAndAdd(cm.display.lineMeasure,built.pre);return view}function measureChar(cm,line,ch,bias){return measureCharPrepared(cm,prepareMeasureForLine(cm,line),ch,bias)}function findViewForLine(cm,lineN){if(lineN>=cm.display.viewFrom&&lineN<cm.display.viewTo){return cm.display.view[findViewIndex(cm,lineN)]}var ext=cm.display.externalMeasured;if(ext&&lineN>=ext.lineN&&lineN<ext.lineN+ext.size){return ext}}function prepareMeasureForLine(cm,line){var lineN=lineNo(line);var view=findViewForLine(cm,lineN);if(view&&!view.text){view=null}else if(view&&view.changes){updateLineForChanges(cm,view,lineN,getDimensions(cm));cm.curOp.forceUpdate=true}if(!view){view=updateExternalMeasurement(cm,line)}var info=mapFromLineView(view,line,lineN);return{line:line,view:view,rect:null,map:info.map,cache:info.cache,before:info.before,hasHeights:false}}function measureCharPrepared(cm,prepared,ch,bias,varHeight){if(prepared.before){ch=-1}var key=ch+(bias||""),found;if(prepared.cache.hasOwnProperty(key)){found=prepared.cache[key]}else{if(!prepared.rect){prepared.rect=prepared.view.text.getBoundingClientRect()}if(!prepared.hasHeights){ensureLineHeights(cm,prepared.view,prepared.rect);prepared.hasHeights=true}found=measureCharInner(cm,prepared,ch,bias);if(!found.bogus){prepared.cache[key]=found}}return{left:found.left,right:found.right,top:varHeight?found.rtop:found.top,bottom:varHeight?found.rbottom:found.bottom}}var nullRect={left:0,right:0,top:0,bottom:0};function nodeAndOffsetInLineMap(map,ch,bias){var node,start,end,collapse,mStart,mEnd;for(var i=0;i<map.length;i+=3){mStart=map[i];mEnd=map[i+1];if(ch<mStart){start=0;end=1;collapse="left"}else if(ch<mEnd){start=ch-mStart;end=start+1}else if(i==map.length-3||ch==mEnd&&map[i+3]>ch){end=mEnd-mStart;start=end-1;if(ch>=mEnd){collapse="right"}}if(start!=null){node=map[i+2];if(mStart==mEnd&&bias==(node.insertLeft?"left":"right")){collapse=bias}if(bias=="left"&&start==0){while(i&&map[i-2]==map[i-3]&&map[i-1].insertLeft){node=map[(i-=3)+2];collapse="left"}}if(bias=="right"&&start==mEnd-mStart){while(i<map.length-3&&map[i+3]==map[i+4]&&!map[i+5].insertLeft){node=map[(i+=3)+2];collapse="right"}}break}}return{node:node,start:start,end:end,collapse:collapse,coverStart:mStart,coverEnd:mEnd}}function getUsefulRect(rects,bias){var rect=nullRect;if(bias=="left"){for(var i=0;i<rects.length;i++){if((rect=rects[i]).left!=rect.right){break}}}else{for(var i$1=rects.length-1;i$1>=0;i$1--){if((rect=rects[i$1]).left!=rect.right){break}}}return rect}function measureCharInner(cm,prepared,ch,bias){var place=nodeAndOffsetInLineMap(prepared.map,ch,bias);var node=place.node,start=place.start,end=place.end,collapse=place.collapse;var rect;if(node.nodeType==3){for(var i$1=0;i$1<4;i$1++){while(start&&isExtendingChar(prepared.line.text.charAt(place.coverStart+start))){--start}while(place.coverStart+end<place.coverEnd&&isExtendingChar(prepared.line.text.charAt(place.coverStart+end))){++end}if(ie&&ie_version<9&&start==0&&end==place.coverEnd-place.coverStart){rect=node.parentNode.getBoundingClientRect()}else{rect=getUsefulRect(range(node,start,end).getClientRects(),bias)}if(rect.left||rect.right||start==0){break}end=start;start=start-1;collapse="right"}if(ie&&ie_version<11){rect=maybeUpdateRectForZooming(cm.display.measure,rect)}}else{if(start>0){collapse=bias="right"}var rects;if(cm.options.lineWrapping&&(rects=node.getClientRects()).length>1){rect=rects[bias=="right"?rects.length-1:0]}else{rect=node.getBoundingClientRect()}}if(ie&&ie_version<9&&!start&&(!rect||!rect.left&&!rect.right)){var rSpan=node.parentNode.getClientRects()[0];if(rSpan){rect={left:rSpan.left,right:rSpan.left+charWidth(cm.display),top:rSpan.top,bottom:rSpan.bottom}}else{rect=nullRect}}var rtop=rect.top-prepared.rect.top,rbot=rect.bottom-prepared.rect.top;var mid=(rtop+rbot)/2;var heights=prepared.view.measure.heights;var i=0;for(;i<heights.length-1;i++){if(mid<heights[i]){break}}var top=i?heights[i-1]:0,bot=heights[i];var result={left:(collapse=="right"?rect.right:rect.left)-prepared.rect.left,right:(collapse=="left"?rect.left:rect.right)-prepared.rect.left,top:top,bottom:bot};if(!rect.left&&!rect.right){result.bogus=true}if(!cm.options.singleCursorHeightPerLine){result.rtop=rtop;result.rbottom=rbot}return result}function maybeUpdateRectForZooming(measure,rect){if(!window.screen||screen.logicalXDPI==null||screen.logicalXDPI==screen.deviceXDPI||!hasBadZoomedRects(measure)){return rect}var scaleX=screen.logicalXDPI/screen.deviceXDPI;var scaleY=screen.logicalYDPI/screen.deviceYDPI;return{left:rect.left*scaleX,right:rect.right*scaleX,top:rect.top*scaleY,bottom:rect.bottom*scaleY}}function clearLineMeasurementCacheFor(lineView){if(lineView.measure){lineView.measure.cache={};lineView.measure.heights=null;if(lineView.rest){for(var i=0;i<lineView.rest.length;i++){lineView.measure.caches[i]={}}}}}function clearLineMeasurementCache(cm){cm.display.externalMeasure=null;removeChildren(cm.display.lineMeasure);for(var i=0;i<cm.display.view.length;i++){clearLineMeasurementCacheFor(cm.display.view[i])}}function clearCaches(cm){clearLineMeasurementCache(cm);cm.display.cachedCharWidth=cm.display.cachedTextHeight=cm.display.cachedPaddingH=null;if(!cm.options.lineWrapping){cm.display.maxLineChanged=true}cm.display.lineNumChars=null}function pageScrollX(doc){if(chrome&&android){return-(doc.body.getBoundingClientRect().left-parseInt(getComputedStyle(doc.body).marginLeft))}return doc.defaultView.pageXOffset||(doc.documentElement||doc.body).scrollLeft}function pageScrollY(doc){if(chrome&&android){return-(doc.body.getBoundingClientRect().top-parseInt(getComputedStyle(doc.body).marginTop))}return doc.defaultView.pageYOffset||(doc.documentElement||doc.body).scrollTop}function widgetTopHeight(lineObj){var ref=visualLine(lineObj);var widgets=ref.widgets;var height=0;if(widgets){for(var i=0;i<widgets.length;++i){if(widgets[i].above){height+=widgetHeight(widgets[i])}}}return height}function intoCoordSystem(cm,lineObj,rect,context,includeWidgets){if(!includeWidgets){var height=widgetTopHeight(lineObj);rect.top+=height;rect.bottom+=height}if(context=="line"){return rect}if(!context){context="local"}var yOff=heightAtLine(lineObj);if(context=="local"){yOff+=paddingTop(cm.display)}else{yOff-=cm.display.viewOffset}if(context=="page"||context=="window"){var lOff=cm.display.lineSpace.getBoundingClientRect();yOff+=lOff.top+(context=="window"?0:pageScrollY(doc(cm)));var xOff=lOff.left+(context=="window"?0:pageScrollX(doc(cm)));rect.left+=xOff;rect.right+=xOff}rect.top+=yOff;rect.bottom+=yOff;return rect}function fromCoordSystem(cm,coords,context){if(context=="div"){return coords}var left=coords.left,top=coords.top;if(context=="page"){left-=pageScrollX(doc(cm));top-=pageScrollY(doc(cm))}else if(context=="local"||!context){var localBox=cm.display.sizer.getBoundingClientRect();left+=localBox.left;top+=localBox.top}var lineSpaceBox=cm.display.lineSpace.getBoundingClientRect();return{left:left-lineSpaceBox.left,top:top-lineSpaceBox.top}}function charCoords(cm,pos,context,lineObj,bias){if(!lineObj){lineObj=getLine(cm.doc,pos.line)}return intoCoordSystem(cm,lineObj,measureChar(cm,lineObj,pos.ch,bias),context)}function cursorCoords(cm,pos,context,lineObj,preparedMeasure,varHeight){lineObj=lineObj||getLine(cm.doc,pos.line);if(!preparedMeasure){preparedMeasure=prepareMeasureForLine(cm,lineObj)}function get(ch,right){var m=measureCharPrepared(cm,preparedMeasure,ch,right?"right":"left",varHeight);if(right){m.left=m.right}else{m.right=m.left}return intoCoordSystem(cm,lineObj,m,context)}var order=getOrder(lineObj,cm.doc.direction),ch=pos.ch,sticky=pos.sticky;if(ch>=lineObj.text.length){ch=lineObj.text.length;sticky="before"}else if(ch<=0){ch=0;sticky="after"}if(!order){return get(sticky=="before"?ch-1:ch,sticky=="before")}function getBidi(ch,partPos,invert){var part=order[partPos],right=part.level==1;return get(invert?ch-1:ch,right!=invert)}var partPos=getBidiPartAt(order,ch,sticky);var other=bidiOther;var val=getBidi(ch,partPos,sticky=="before");if(other!=null){val.other=getBidi(ch,other,sticky!="before")}return val}function estimateCoords(cm,pos){var left=0;pos=clipPos(cm.doc,pos);if(!cm.options.lineWrapping){left=charWidth(cm.display)*pos.ch}var lineObj=getLine(cm.doc,pos.line);var top=heightAtLine(lineObj)+paddingTop(cm.display);return{left:left,right:left,top:top,bottom:top+lineObj.height}}function PosWithInfo(line,ch,sticky,outside,xRel){var pos=Pos(line,ch,sticky);pos.xRel=xRel;if(outside){pos.outside=outside}return pos}function coordsChar(cm,x,y){var doc=cm.doc;y+=cm.display.viewOffset;if(y<0){return PosWithInfo(doc.first,0,null,-1,-1)}var lineN=lineAtHeight(doc,y),last=doc.first+doc.size-1;if(lineN>last){return PosWithInfo(doc.first+doc.size-1,getLine(doc,last).text.length,null,1,1)}if(x<0){x=0}var lineObj=getLine(doc,lineN);for(;;){var found=coordsCharInner(cm,lineObj,lineN,x,y);var collapsed=collapsedSpanAround(lineObj,found.ch+(found.xRel>0||found.outside>0?1:0));if(!collapsed){return found}var rangeEnd=collapsed.find(1);if(rangeEnd.line==lineN){return rangeEnd}lineObj=getLine(doc,lineN=rangeEnd.line)}}function wrappedLineExtent(cm,lineObj,preparedMeasure,y){y-=widgetTopHeight(lineObj);var end=lineObj.text.length;var begin=findFirst((function(ch){return measureCharPrepared(cm,preparedMeasure,ch-1).bottom<=y}),end,0);end=findFirst((function(ch){return measureCharPrepared(cm,preparedMeasure,ch).top>y}),begin,end);return{begin:begin,end:end}}function wrappedLineExtentChar(cm,lineObj,preparedMeasure,target){if(!preparedMeasure){preparedMeasure=prepareMeasureForLine(cm,lineObj)}var targetTop=intoCoordSystem(cm,lineObj,measureCharPrepared(cm,preparedMeasure,target),"line").top;return wrappedLineExtent(cm,lineObj,preparedMeasure,targetTop)}function boxIsAfter(box,x,y,left){return box.bottom<=y?false:box.top>y?true:(left?box.left:box.right)>x}function coordsCharInner(cm,lineObj,lineNo,x,y){y-=heightAtLine(lineObj);var preparedMeasure=prepareMeasureForLine(cm,lineObj);var widgetHeight=widgetTopHeight(lineObj);var begin=0,end=lineObj.text.length,ltr=true;var order=getOrder(lineObj,cm.doc.direction);if(order){var part=(cm.options.lineWrapping?coordsBidiPartWrapped:coordsBidiPart)(cm,lineObj,lineNo,preparedMeasure,order,x,y);ltr=part.level!=1;begin=ltr?part.from:part.to-1;end=ltr?part.to:part.from-1}var chAround=null,boxAround=null;var ch=findFirst((function(ch){var box=measureCharPrepared(cm,preparedMeasure,ch);box.top+=widgetHeight;box.bottom+=widgetHeight;if(!boxIsAfter(box,x,y,false)){return false}if(box.top<=y&&box.left<=x){chAround=ch;boxAround=box}return true}),begin,end);var baseX,sticky,outside=false;if(boxAround){var atLeft=x-boxAround.left<boxAround.right-x,atStart=atLeft==ltr;ch=chAround+(atStart?0:1);sticky=atStart?"after":"before";baseX=atLeft?boxAround.left:boxAround.right}else{if(!ltr&&(ch==end||ch==begin)){ch++}sticky=ch==0?"after":ch==lineObj.text.length?"before":measureCharPrepared(cm,preparedMeasure,ch-(ltr?1:0)).bottom+widgetHeight<=y==ltr?"after":"before";var coords=cursorCoords(cm,Pos(lineNo,ch,sticky),"line",lineObj,preparedMeasure);baseX=coords.left;outside=y<coords.top?-1:y>=coords.bottom?1:0}ch=skipExtendingChars(lineObj.text,ch,1);return PosWithInfo(lineNo,ch,sticky,outside,x-baseX)}function coordsBidiPart(cm,lineObj,lineNo,preparedMeasure,order,x,y){var index=findFirst((function(i){var part=order[i],ltr=part.level!=1;return boxIsAfter(cursorCoords(cm,Pos(lineNo,ltr?part.to:part.from,ltr?"before":"after"),"line",lineObj,preparedMeasure),x,y,true)}),0,order.length-1);var part=order[index];if(index>0){var ltr=part.level!=1;var start=cursorCoords(cm,Pos(lineNo,ltr?part.from:part.to,ltr?"after":"before"),"line",lineObj,preparedMeasure);if(boxIsAfter(start,x,y,true)&&start.top>y){part=order[index-1]}}return part}function coordsBidiPartWrapped(cm,lineObj,_lineNo,preparedMeasure,order,x,y){var ref=wrappedLineExtent(cm,lineObj,preparedMeasure,y);var begin=ref.begin;var end=ref.end;if(/\s/.test(lineObj.text.charAt(end-1))){end--}var part=null,closestDist=null;for(var i=0;i<order.length;i++){var p=order[i];if(p.from>=end||p.to<=begin){continue}var ltr=p.level!=1;var endX=measureCharPrepared(cm,preparedMeasure,ltr?Math.min(end,p.to)-1:Math.max(begin,p.from)).right;var dist=endX<x?x-endX+1e9:endX-x;if(!part||closestDist>dist){part=p;closestDist=dist}}if(!part){part=order[order.length-1]}if(part.from<begin){part={from:begin,to:part.to,level:part.level}}if(part.to>end){part={from:part.from,to:end,level:part.level}}return part}var measureText;function textHeight(display){if(display.cachedTextHeight!=null){return display.cachedTextHeight}if(measureText==null){measureText=elt("pre",null,"CodeMirror-line-like");for(var i=0;i<49;++i){measureText.appendChild(document.createTextNode("x"));measureText.appendChild(elt("br"))}measureText.appendChild(document.createTextNode("x"))}removeChildrenAndAdd(display.measure,measureText);var height=measureText.offsetHeight/50;if(height>3){display.cachedTextHeight=height}removeChildren(display.measure);return height||1}function charWidth(display){if(display.cachedCharWidth!=null){return display.cachedCharWidth}var anchor=elt("span","xxxxxxxxxx");var pre=elt("pre",[anchor],"CodeMirror-line-like");removeChildrenAndAdd(display.measure,pre);var rect=anchor.getBoundingClientRect(),width=(rect.right-rect.left)/10;if(width>2){display.cachedCharWidth=width}return width||10}function getDimensions(cm){var d=cm.display,left={},width={};var gutterLeft=d.gutters.clientLeft;for(var n=d.gutters.firstChild,i=0;n;n=n.nextSibling,++i){var id=cm.display.gutterSpecs[i].className;left[id]=n.offsetLeft+n.clientLeft+gutterLeft;width[id]=n.clientWidth}return{fixedPos:compensateForHScroll(d),gutterTotalWidth:d.gutters.offsetWidth,gutterLeft:left,gutterWidth:width,wrapperWidth:d.wrapper.clientWidth}}function compensateForHScroll(display){return display.scroller.getBoundingClientRect().left-display.sizer.getBoundingClientRect().left}function estimateHeight(cm){var th=textHeight(cm.display),wrapping=cm.options.lineWrapping;var perLine=wrapping&&Math.max(5,cm.display.scroller.clientWidth/charWidth(cm.display)-3);return function(line){if(lineIsHidden(cm.doc,line)){return 0}var widgetsHeight=0;if(line.widgets){for(var i=0;i<line.widgets.length;i++){if(line.widgets[i].height){widgetsHeight+=line.widgets[i].height}}}if(wrapping){return widgetsHeight+(Math.ceil(line.text.length/perLine)||1)*th}else{return widgetsHeight+th}}}function estimateLineHeights(cm){var doc=cm.doc,est=estimateHeight(cm);doc.iter((function(line){var estHeight=est(line);if(estHeight!=line.height){updateLineHeight(line,estHeight)}}))}function posFromMouse(cm,e,liberal,forRect){var display=cm.display;if(!liberal&&e_target(e).getAttribute("cm-not-content")=="true"){return null}var x,y,space=display.lineSpace.getBoundingClientRect();try{x=e.clientX-space.left;y=e.clientY-space.top}catch(e$1){return null}var coords=coordsChar(cm,x,y),line;if(forRect&&coords.xRel>0&&(line=getLine(cm.doc,coords.line).text).length==coords.ch){var colDiff=countColumn(line,line.length,cm.options.tabSize)-line.length;coords=Pos(coords.line,Math.max(0,Math.round((x-paddingH(cm.display).left)/charWidth(cm.display))-colDiff))}return coords}function findViewIndex(cm,n){if(n>=cm.display.viewTo){return null}n-=cm.display.viewFrom;if(n<0){return null}var view=cm.display.view;for(var i=0;i<view.length;i++){n-=view[i].size;if(n<0){return i}}}function regChange(cm,from,to,lendiff){if(from==null){from=cm.doc.first}if(to==null){to=cm.doc.first+cm.doc.size}if(!lendiff){lendiff=0}var display=cm.display;if(lendiff&&to<display.viewTo&&(display.updateLineNumbers==null||display.updateLineNumbers>from)){display.updateLineNumbers=from}cm.curOp.viewChanged=true;if(from>=display.viewTo){if(sawCollapsedSpans&&visualLineNo(cm.doc,from)<display.viewTo){resetView(cm)}}else if(to<=display.viewFrom){if(sawCollapsedSpans&&visualLineEndNo(cm.doc,to+lendiff)>display.viewFrom){resetView(cm)}else{display.viewFrom+=lendiff;display.viewTo+=lendiff}}else if(from<=display.viewFrom&&to>=display.viewTo){resetView(cm)}else if(from<=display.viewFrom){var cut=viewCuttingPoint(cm,to,to+lendiff,1);if(cut){display.view=display.view.slice(cut.index);display.viewFrom=cut.lineN;display.viewTo+=lendiff}else{resetView(cm)}}else if(to>=display.viewTo){var cut$1=viewCuttingPoint(cm,from,from,-1);if(cut$1){display.view=display.view.slice(0,cut$1.index);display.viewTo=cut$1.lineN}else{resetView(cm)}}else{var cutTop=viewCuttingPoint(cm,from,from,-1);var cutBot=viewCuttingPoint(cm,to,to+lendiff,1);if(cutTop&&cutBot){display.view=display.view.slice(0,cutTop.index).concat(buildViewArray(cm,cutTop.lineN,cutBot.lineN)).concat(display.view.slice(cutBot.index));display.viewTo+=lendiff}else{resetView(cm)}}var ext=display.externalMeasured;if(ext){if(to<ext.lineN){ext.lineN+=lendiff}else if(from<ext.lineN+ext.size){display.externalMeasured=null}}}function regLineChange(cm,line,type){cm.curOp.viewChanged=true;var display=cm.display,ext=cm.display.externalMeasured;if(ext&&line>=ext.lineN&&line<ext.lineN+ext.size){display.externalMeasured=null}if(line<display.viewFrom||line>=display.viewTo){return}var lineView=display.view[findViewIndex(cm,line)];if(lineView.node==null){return}var arr=lineView.changes||(lineView.changes=[]);if(indexOf(arr,type)==-1){arr.push(type)}}function resetView(cm){cm.display.viewFrom=cm.display.viewTo=cm.doc.first;cm.display.view=[];cm.display.viewOffset=0}function viewCuttingPoint(cm,oldN,newN,dir){var index=findViewIndex(cm,oldN),diff,view=cm.display.view;if(!sawCollapsedSpans||newN==cm.doc.first+cm.doc.size){return{index:index,lineN:newN}}var n=cm.display.viewFrom;for(var i=0;i<index;i++){n+=view[i].size}if(n!=oldN){if(dir>0){if(index==view.length-1){return null}diff=n+view[index].size-oldN;index++}else{diff=n-oldN}oldN+=diff;newN+=diff}while(visualLineNo(cm.doc,newN)!=newN){if(index==(dir<0?0:view.length-1)){return null}newN+=dir*view[index-(dir<0?1:0)].size;index+=dir}return{index:index,lineN:newN}}function adjustView(cm,from,to){var display=cm.display,view=display.view;if(view.length==0||from>=display.viewTo||to<=display.viewFrom){display.view=buildViewArray(cm,from,to);display.viewFrom=from}else{if(display.viewFrom>from){display.view=buildViewArray(cm,from,display.viewFrom).concat(display.view)}else if(display.viewFrom<from){display.view=display.view.slice(findViewIndex(cm,from))}display.viewFrom=from;if(display.viewTo<to){display.view=display.view.concat(buildViewArray(cm,display.viewTo,to))}else if(display.viewTo>to){display.view=display.view.slice(0,findViewIndex(cm,to))}}display.viewTo=to}function countDirtyView(cm){var view=cm.display.view,dirty=0;for(var i=0;i<view.length;i++){var lineView=view[i];if(!lineView.hidden&&(!lineView.node||lineView.changes)){++dirty}}return dirty}function updateSelection(cm){cm.display.input.showSelection(cm.display.input.prepareSelection())}function prepareSelection(cm,primary){if(primary===void 0)primary=true;var doc=cm.doc,result={};var curFragment=result.cursors=document.createDocumentFragment();var selFragment=result.selection=document.createDocumentFragment();var customCursor=cm.options.$customCursor;if(customCursor){primary=true}for(var i=0;i<doc.sel.ranges.length;i++){if(!primary&&i==doc.sel.primIndex){continue}var range=doc.sel.ranges[i];if(range.from().line>=cm.display.viewTo||range.to().line<cm.display.viewFrom){continue}var collapsed=range.empty();if(customCursor){var head=customCursor(cm,range);if(head){drawSelectionCursor(cm,head,curFragment)}}else if(collapsed||cm.options.showCursorWhenSelecting){drawSelectionCursor(cm,range.head,curFragment)}if(!collapsed){drawSelectionRange(cm,range,selFragment)}}return result}function drawSelectionCursor(cm,head,output){var pos=cursorCoords(cm,head,"div",null,null,!cm.options.singleCursorHeightPerLine);var cursor=output.appendChild(elt("div"," ","CodeMirror-cursor"));cursor.style.left=pos.left+"px";cursor.style.top=pos.top+"px";cursor.style.height=Math.max(0,pos.bottom-pos.top)*cm.options.cursorHeight+"px";if(/\bcm-fat-cursor\b/.test(cm.getWrapperElement().className)){var charPos=charCoords(cm,head,"div",null,null);var width=charPos.right-charPos.left;cursor.style.width=(width>0?width:cm.defaultCharWidth())+"px"}if(pos.other){var otherCursor=output.appendChild(elt("div"," ","CodeMirror-cursor CodeMirror-secondarycursor"));otherCursor.style.display="";otherCursor.style.left=pos.other.left+"px";otherCursor.style.top=pos.other.top+"px";otherCursor.style.height=(pos.other.bottom-pos.other.top)*.85+"px"}}function cmpCoords(a,b){return a.top-b.top||a.left-b.left}function drawSelectionRange(cm,range,output){var display=cm.display,doc=cm.doc;var fragment=document.createDocumentFragment();var padding=paddingH(cm.display),leftSide=padding.left;var rightSide=Math.max(display.sizerWidth,displayWidth(cm)-display.sizer.offsetLeft)-padding.right;var docLTR=doc.direction=="ltr";function add(left,top,width,bottom){if(top<0){top=0}top=Math.round(top);bottom=Math.round(bottom);fragment.appendChild(elt("div",null,"CodeMirror-selected","position: absolute; left: "+left+"px;\n                             top: "+top+"px; width: "+(width==null?rightSide-left:width)+"px;\n                             height: "+(bottom-top)+"px"))}function drawForLine(line,fromArg,toArg){var lineObj=getLine(doc,line);var lineLen=lineObj.text.length;var start,end;function coords(ch,bias){return charCoords(cm,Pos(line,ch),"div",lineObj,bias)}function wrapX(pos,dir,side){var extent=wrappedLineExtentChar(cm,lineObj,null,pos);var prop=dir=="ltr"==(side=="after")?"left":"right";var ch=side=="after"?extent.begin:extent.end-(/\s/.test(lineObj.text.charAt(extent.end-1))?2:1);return coords(ch,prop)[prop]}var order=getOrder(lineObj,doc.direction);iterateBidiSections(order,fromArg||0,toArg==null?lineLen:toArg,(function(from,to,dir,i){var ltr=dir=="ltr";var fromPos=coords(from,ltr?"left":"right");var toPos=coords(to-1,ltr?"right":"left");var openStart=fromArg==null&&from==0,openEnd=toArg==null&&to==lineLen;var first=i==0,last=!order||i==order.length-1;if(toPos.top-fromPos.top<=3){var openLeft=(docLTR?openStart:openEnd)&&first;var openRight=(docLTR?openEnd:openStart)&&last;var left=openLeft?leftSide:(ltr?fromPos:toPos).left;var right=openRight?rightSide:(ltr?toPos:fromPos).right;add(left,fromPos.top,right-left,fromPos.bottom)}else{var topLeft,topRight,botLeft,botRight;if(ltr){topLeft=docLTR&&openStart&&first?leftSide:fromPos.left;topRight=docLTR?rightSide:wrapX(from,dir,"before");botLeft=docLTR?leftSide:wrapX(to,dir,"after");botRight=docLTR&&openEnd&&last?rightSide:toPos.right}else{topLeft=!docLTR?leftSide:wrapX(from,dir,"before");topRight=!docLTR&&openStart&&first?rightSide:fromPos.right;botLeft=!docLTR&&openEnd&&last?leftSide:toPos.left;botRight=!docLTR?rightSide:wrapX(to,dir,"after")}add(topLeft,fromPos.top,topRight-topLeft,fromPos.bottom);if(fromPos.bottom<toPos.top){add(leftSide,fromPos.bottom,null,toPos.top)}add(botLeft,toPos.top,botRight-botLeft,toPos.bottom)}if(!start||cmpCoords(fromPos,start)<0){start=fromPos}if(cmpCoords(toPos,start)<0){start=toPos}if(!end||cmpCoords(fromPos,end)<0){end=fromPos}if(cmpCoords(toPos,end)<0){end=toPos}}));return{start:start,end:end}}var sFrom=range.from(),sTo=range.to();if(sFrom.line==sTo.line){drawForLine(sFrom.line,sFrom.ch,sTo.ch)}else{var fromLine=getLine(doc,sFrom.line),toLine=getLine(doc,sTo.line);var singleVLine=visualLine(fromLine)==visualLine(toLine);var leftEnd=drawForLine(sFrom.line,sFrom.ch,singleVLine?fromLine.text.length+1:null).end;var rightStart=drawForLine(sTo.line,singleVLine?0:null,sTo.ch).start;if(singleVLine){if(leftEnd.top<rightStart.top-2){add(leftEnd.right,leftEnd.top,null,leftEnd.bottom);add(leftSide,rightStart.top,rightStart.left,rightStart.bottom)}else{add(leftEnd.right,leftEnd.top,rightStart.left-leftEnd.right,leftEnd.bottom)}}if(leftEnd.bottom<rightStart.top){add(leftSide,leftEnd.bottom,null,rightStart.top)}}output.appendChild(fragment)}function restartBlink(cm){if(!cm.state.focused){return}var display=cm.display;clearInterval(display.blinker);var on=true;display.cursorDiv.style.visibility="";if(cm.options.cursorBlinkRate>0){display.blinker=setInterval((function(){if(!cm.hasFocus()){onBlur(cm)}display.cursorDiv.style.visibility=(on=!on)?"":"hidden"}),cm.options.cursorBlinkRate)}else if(cm.options.cursorBlinkRate<0){display.cursorDiv.style.visibility="hidden"}}function ensureFocus(cm){if(!cm.hasFocus()){cm.display.input.focus();if(!cm.state.focused){onFocus(cm)}}}function delayBlurEvent(cm){cm.state.delayingBlurEvent=true;setTimeout((function(){if(cm.state.delayingBlurEvent){cm.state.delayingBlurEvent=false;if(cm.state.focused){onBlur(cm)}}}),100)}function onFocus(cm,e){if(cm.state.delayingBlurEvent&&!cm.state.draggingText){cm.state.delayingBlurEvent=false}if(cm.options.readOnly=="nocursor"){return}if(!cm.state.focused){signal(cm,"focus",cm,e);cm.state.focused=true;addClass(cm.display.wrapper,"CodeMirror-focused");if(!cm.curOp&&cm.display.selForContextMenu!=cm.doc.sel){cm.display.input.reset();if(webkit){setTimeout((function(){return cm.display.input.reset(true)}),20)}}cm.display.input.receivedFocus()}restartBlink(cm)}function onBlur(cm,e){if(cm.state.delayingBlurEvent){return}if(cm.state.focused){signal(cm,"blur",cm,e);cm.state.focused=false;rmClass(cm.display.wrapper,"CodeMirror-focused")}clearInterval(cm.display.blinker);setTimeout((function(){if(!cm.state.focused){cm.display.shift=false}}),150)}function updateHeightsInViewport(cm){var display=cm.display;var prevBottom=display.lineDiv.offsetTop;var viewTop=Math.max(0,display.scroller.getBoundingClientRect().top);var oldHeight=display.lineDiv.getBoundingClientRect().top;var mustScroll=0;for(var i=0;i<display.view.length;i++){var cur=display.view[i],wrapping=cm.options.lineWrapping;var height=void 0,width=0;if(cur.hidden){continue}oldHeight+=cur.line.height;if(ie&&ie_version<8){var bot=cur.node.offsetTop+cur.node.offsetHeight;height=bot-prevBottom;prevBottom=bot}else{var box=cur.node.getBoundingClientRect();height=box.bottom-box.top;if(!wrapping&&cur.text.firstChild){width=cur.text.firstChild.getBoundingClientRect().right-box.left-1}}var diff=cur.line.height-height;if(diff>.005||diff<-.005){if(oldHeight<viewTop){mustScroll-=diff}updateLineHeight(cur.line,height);updateWidgetHeight(cur.line);if(cur.rest){for(var j=0;j<cur.rest.length;j++){updateWidgetHeight(cur.rest[j])}}}if(width>cm.display.sizerWidth){var chWidth=Math.ceil(width/charWidth(cm.display));if(chWidth>cm.display.maxLineLength){cm.display.maxLineLength=chWidth;cm.display.maxLine=cur.line;cm.display.maxLineChanged=true}}}if(Math.abs(mustScroll)>2){display.scroller.scrollTop+=mustScroll}}function updateWidgetHeight(line){if(line.widgets){for(var i=0;i<line.widgets.length;++i){var w=line.widgets[i],parent=w.node.parentNode;if(parent){w.height=parent.offsetHeight}}}}function visibleLines(display,doc,viewport){var top=viewport&&viewport.top!=null?Math.max(0,viewport.top):display.scroller.scrollTop;top=Math.floor(top-paddingTop(display));var bottom=viewport&&viewport.bottom!=null?viewport.bottom:top+display.wrapper.clientHeight;var from=lineAtHeight(doc,top),to=lineAtHeight(doc,bottom);if(viewport&&viewport.ensure){var ensureFrom=viewport.ensure.from.line,ensureTo=viewport.ensure.to.line;if(ensureFrom<from){from=ensureFrom;to=lineAtHeight(doc,heightAtLine(getLine(doc,ensureFrom))+display.wrapper.clientHeight)}else if(Math.min(ensureTo,doc.lastLine())>=to){from=lineAtHeight(doc,heightAtLine(getLine(doc,ensureTo))-display.wrapper.clientHeight);to=ensureTo}}return{from:from,to:Math.max(to,from+1)}}function maybeScrollWindow(cm,rect){if(signalDOMEvent(cm,"scrollCursorIntoView")){return}var display=cm.display,box=display.sizer.getBoundingClientRect(),doScroll=null;var doc=display.wrapper.ownerDocument;if(rect.top+box.top<0){doScroll=true}else if(rect.bottom+box.top>(doc.defaultView.innerHeight||doc.documentElement.clientHeight)){doScroll=false}if(doScroll!=null&&!phantom){var scrollNode=elt("div","​",null,"position: absolute;\n                         top: "+(rect.top-display.viewOffset-paddingTop(cm.display))+"px;\n                         height: "+(rect.bottom-rect.top+scrollGap(cm)+display.barHeight)+"px;\n                         left: "+rect.left+"px; width: "+Math.max(2,rect.right-rect.left)+"px;");cm.display.lineSpace.appendChild(scrollNode);scrollNode.scrollIntoView(doScroll);cm.display.lineSpace.removeChild(scrollNode)}}function scrollPosIntoView(cm,pos,end,margin){if(margin==null){margin=0}var rect;if(!cm.options.lineWrapping&&pos==end){end=pos.sticky=="before"?Pos(pos.line,pos.ch+1,"before"):pos;pos=pos.ch?Pos(pos.line,pos.sticky=="before"?pos.ch-1:pos.ch,"after"):pos}for(var limit=0;limit<5;limit++){var changed=false;var coords=cursorCoords(cm,pos);var endCoords=!end||end==pos?coords:cursorCoords(cm,end);rect={left:Math.min(coords.left,endCoords.left),top:Math.min(coords.top,endCoords.top)-margin,right:Math.max(coords.left,endCoords.left),bottom:Math.max(coords.bottom,endCoords.bottom)+margin};var scrollPos=calculateScrollPos(cm,rect);var startTop=cm.doc.scrollTop,startLeft=cm.doc.scrollLeft;if(scrollPos.scrollTop!=null){updateScrollTop(cm,scrollPos.scrollTop);if(Math.abs(cm.doc.scrollTop-startTop)>1){changed=true}}if(scrollPos.scrollLeft!=null){setScrollLeft(cm,scrollPos.scrollLeft);if(Math.abs(cm.doc.scrollLeft-startLeft)>1){changed=true}}if(!changed){break}}return rect}function scrollIntoView(cm,rect){var scrollPos=calculateScrollPos(cm,rect);if(scrollPos.scrollTop!=null){updateScrollTop(cm,scrollPos.scrollTop)}if(scrollPos.scrollLeft!=null){setScrollLeft(cm,scrollPos.scrollLeft)}}function calculateScrollPos(cm,rect){var display=cm.display,snapMargin=textHeight(cm.display);if(rect.top<0){rect.top=0}var screentop=cm.curOp&&cm.curOp.scrollTop!=null?cm.curOp.scrollTop:display.scroller.scrollTop;var screen=displayHeight(cm),result={};if(rect.bottom-rect.top>screen){rect.bottom=rect.top+screen}var docBottom=cm.doc.height+paddingVert(display);var atTop=rect.top<snapMargin,atBottom=rect.bottom>docBottom-snapMargin;if(rect.top<screentop){result.scrollTop=atTop?0:rect.top}else if(rect.bottom>screentop+screen){var newTop=Math.min(rect.top,(atBottom?docBottom:rect.bottom)-screen);if(newTop!=screentop){result.scrollTop=newTop}}var gutterSpace=cm.options.fixedGutter?0:display.gutters.offsetWidth;var screenleft=cm.curOp&&cm.curOp.scrollLeft!=null?cm.curOp.scrollLeft:display.scroller.scrollLeft-gutterSpace;var screenw=displayWidth(cm)-display.gutters.offsetWidth;var tooWide=rect.right-rect.left>screenw;if(tooWide){rect.right=rect.left+screenw}if(rect.left<10){result.scrollLeft=0}else if(rect.left<screenleft){result.scrollLeft=Math.max(0,rect.left+gutterSpace-(tooWide?0:10))}else if(rect.right>screenw+screenleft-3){result.scrollLeft=rect.right+(tooWide?0:10)-screenw}return result}function addToScrollTop(cm,top){if(top==null){return}resolveScrollToPos(cm);cm.curOp.scrollTop=(cm.curOp.scrollTop==null?cm.doc.scrollTop:cm.curOp.scrollTop)+top}function ensureCursorVisible(cm){resolveScrollToPos(cm);var cur=cm.getCursor();cm.curOp.scrollToPos={from:cur,to:cur,margin:cm.options.cursorScrollMargin}}function scrollToCoords(cm,x,y){if(x!=null||y!=null){resolveScrollToPos(cm)}if(x!=null){cm.curOp.scrollLeft=x}if(y!=null){cm.curOp.scrollTop=y}}function scrollToRange(cm,range){resolveScrollToPos(cm);cm.curOp.scrollToPos=range}function resolveScrollToPos(cm){var range=cm.curOp.scrollToPos;if(range){cm.curOp.scrollToPos=null;var from=estimateCoords(cm,range.from),to=estimateCoords(cm,range.to);scrollToCoordsRange(cm,from,to,range.margin)}}function scrollToCoordsRange(cm,from,to,margin){var sPos=calculateScrollPos(cm,{left:Math.min(from.left,to.left),top:Math.min(from.top,to.top)-margin,right:Math.max(from.right,to.right),bottom:Math.max(from.bottom,to.bottom)+margin});scrollToCoords(cm,sPos.scrollLeft,sPos.scrollTop)}function updateScrollTop(cm,val){if(Math.abs(cm.doc.scrollTop-val)<2){return}if(!gecko){updateDisplaySimple(cm,{top:val})}setScrollTop(cm,val,true);if(gecko){updateDisplaySimple(cm)}startWorker(cm,100)}function setScrollTop(cm,val,forceScroll){val=Math.max(0,Math.min(cm.display.scroller.scrollHeight-cm.display.scroller.clientHeight,val));if(cm.display.scroller.scrollTop==val&&!forceScroll){return}cm.doc.scrollTop=val;cm.display.scrollbars.setScrollTop(val);if(cm.display.scroller.scrollTop!=val){cm.display.scroller.scrollTop=val}}function setScrollLeft(cm,val,isScroller,forceScroll){val=Math.max(0,Math.min(val,cm.display.scroller.scrollWidth-cm.display.scroller.clientWidth));if((isScroller?val==cm.doc.scrollLeft:Math.abs(cm.doc.scrollLeft-val)<2)&&!forceScroll){return}cm.doc.scrollLeft=val;alignHorizontally(cm);if(cm.display.scroller.scrollLeft!=val){cm.display.scroller.scrollLeft=val}cm.display.scrollbars.setScrollLeft(val)}function measureForScrollbars(cm){var d=cm.display,gutterW=d.gutters.offsetWidth;var docH=Math.round(cm.doc.height+paddingVert(cm.display));return{clientHeight:d.scroller.clientHeight,viewHeight:d.wrapper.clientHeight,scrollWidth:d.scroller.scrollWidth,clientWidth:d.scroller.clientWidth,viewWidth:d.wrapper.clientWidth,barLeft:cm.options.fixedGutter?gutterW:0,docHeight:docH,scrollHeight:docH+scrollGap(cm)+d.barHeight,nativeBarWidth:d.nativeBarWidth,gutterWidth:gutterW}}var NativeScrollbars=function(place,scroll,cm){this.cm=cm;var vert=this.vert=elt("div",[elt("div",null,null,"min-width: 1px")],"CodeMirror-vscrollbar");var horiz=this.horiz=elt("div",[elt("div",null,null,"height: 100%; min-height: 1px")],"CodeMirror-hscrollbar");vert.tabIndex=horiz.tabIndex=-1;place(vert);place(horiz);on(vert,"scroll",(function(){if(vert.clientHeight){scroll(vert.scrollTop,"vertical")}}));on(horiz,"scroll",(function(){if(horiz.clientWidth){scroll(horiz.scrollLeft,"horizontal")}}));this.checkedZeroWidth=false;if(ie&&ie_version<8){this.horiz.style.minHeight=this.vert.style.minWidth="18px"}};NativeScrollbars.prototype.update=function(measure){var needsH=measure.scrollWidth>measure.clientWidth+1;var needsV=measure.scrollHeight>measure.clientHeight+1;var sWidth=measure.nativeBarWidth;if(needsV){this.vert.style.display="block";this.vert.style.bottom=needsH?sWidth+"px":"0";var totalHeight=measure.viewHeight-(needsH?sWidth:0);this.vert.firstChild.style.height=Math.max(0,measure.scrollHeight-measure.clientHeight+totalHeight)+"px"}else{this.vert.scrollTop=0;this.vert.style.display="";this.vert.firstChild.style.height="0"}if(needsH){this.horiz.style.display="block";this.horiz.style.right=needsV?sWidth+"px":"0";this.horiz.style.left=measure.barLeft+"px";var totalWidth=measure.viewWidth-measure.barLeft-(needsV?sWidth:0);this.horiz.firstChild.style.width=Math.max(0,measure.scrollWidth-measure.clientWidth+totalWidth)+"px"}else{this.horiz.style.display="";this.horiz.firstChild.style.width="0"}if(!this.checkedZeroWidth&&measure.clientHeight>0){if(sWidth==0){this.zeroWidthHack()}this.checkedZeroWidth=true}return{right:needsV?sWidth:0,bottom:needsH?sWidth:0}};NativeScrollbars.prototype.setScrollLeft=function(pos){if(this.horiz.scrollLeft!=pos){this.horiz.scrollLeft=pos}if(this.disableHoriz){this.enableZeroWidthBar(this.horiz,this.disableHoriz,"horiz")}};NativeScrollbars.prototype.setScrollTop=function(pos){if(this.vert.scrollTop!=pos){this.vert.scrollTop=pos}if(this.disableVert){this.enableZeroWidthBar(this.vert,this.disableVert,"vert")}};NativeScrollbars.prototype.zeroWidthHack=function(){var w=mac&&!mac_geMountainLion?"12px":"18px";this.horiz.style.height=this.vert.style.width=w;this.horiz.style.visibility=this.vert.style.visibility="hidden";this.disableHoriz=new Delayed;this.disableVert=new Delayed};NativeScrollbars.prototype.enableZeroWidthBar=function(bar,delay,type){bar.style.visibility="";function maybeDisable(){var box=bar.getBoundingClientRect();var elt=type=="vert"?document.elementFromPoint(box.right-1,(box.top+box.bottom)/2):document.elementFromPoint((box.right+box.left)/2,box.bottom-1);if(elt!=bar){bar.style.visibility="hidden"}else{delay.set(1e3,maybeDisable)}}delay.set(1e3,maybeDisable)};NativeScrollbars.prototype.clear=function(){var parent=this.horiz.parentNode;parent.removeChild(this.horiz);parent.removeChild(this.vert)};var NullScrollbars=function(){};NullScrollbars.prototype.update=function(){return{bottom:0,right:0}};NullScrollbars.prototype.setScrollLeft=function(){};NullScrollbars.prototype.setScrollTop=function(){};NullScrollbars.prototype.clear=function(){};function updateScrollbars(cm,measure){if(!measure){measure=measureForScrollbars(cm)}var startWidth=cm.display.barWidth,startHeight=cm.display.barHeight;updateScrollbarsInner(cm,measure);for(var i=0;i<4&&startWidth!=cm.display.barWidth||startHeight!=cm.display.barHeight;i++){if(startWidth!=cm.display.barWidth&&cm.options.lineWrapping){updateHeightsInViewport(cm)}updateScrollbarsInner(cm,measureForScrollbars(cm));startWidth=cm.display.barWidth;startHeight=cm.display.barHeight}}function updateScrollbarsInner(cm,measure){var d=cm.display;var sizes=d.scrollbars.update(measure);d.sizer.style.paddingRight=(d.barWidth=sizes.right)+"px";d.sizer.style.paddingBottom=(d.barHeight=sizes.bottom)+"px";d.heightForcer.style.borderBottom=sizes.bottom+"px solid transparent";if(sizes.right&&sizes.bottom){d.scrollbarFiller.style.display="block";d.scrollbarFiller.style.height=sizes.bottom+"px";d.scrollbarFiller.style.width=sizes.right+"px"}else{d.scrollbarFiller.style.display=""}if(sizes.bottom&&cm.options.coverGutterNextToScrollbar&&cm.options.fixedGutter){d.gutterFiller.style.display="block";d.gutterFiller.style.height=sizes.bottom+"px";d.gutterFiller.style.width=measure.gutterWidth+"px"}else{d.gutterFiller.style.display=""}}var scrollbarModel={native:NativeScrollbars,null:NullScrollbars};function initScrollbars(cm){if(cm.display.scrollbars){cm.display.scrollbars.clear();if(cm.display.scrollbars.addClass){rmClass(cm.display.wrapper,cm.display.scrollbars.addClass)}}cm.display.scrollbars=new scrollbarModel[cm.options.scrollbarStyle]((function(node){cm.display.wrapper.insertBefore(node,cm.display.scrollbarFiller);on(node,"mousedown",(function(){if(cm.state.focused){setTimeout((function(){return cm.display.input.focus()}),0)}}));node.setAttribute("cm-not-content","true")}),(function(pos,axis){if(axis=="horizontal"){setScrollLeft(cm,pos)}else{updateScrollTop(cm,pos)}}),cm);if(cm.display.scrollbars.addClass){addClass(cm.display.wrapper,cm.display.scrollbars.addClass)}}var nextOpId=0;function startOperation(cm){cm.curOp={cm:cm,viewChanged:false,startHeight:cm.doc.height,forceUpdate:false,updateInput:0,typing:false,changeObjs:null,cursorActivityHandlers:null,cursorActivityCalled:0,selectionChanged:false,updateMaxLine:false,scrollLeft:null,scrollTop:null,scrollToPos:null,focus:false,id:++nextOpId,markArrays:null};pushOperation(cm.curOp)}function endOperation(cm){var op=cm.curOp;if(op){finishOperation(op,(function(group){for(var i=0;i<group.ops.length;i++){group.ops[i].cm.curOp=null}endOperations(group)}))}}function endOperations(group){var ops=group.ops;for(var i=0;i<ops.length;i++){endOperation_R1(ops[i])}for(var i$1=0;i$1<ops.length;i$1++){endOperation_W1(ops[i$1])}for(var i$2=0;i$2<ops.length;i$2++){endOperation_R2(ops[i$2])}for(var i$3=0;i$3<ops.length;i$3++){endOperation_W2(ops[i$3])}for(var i$4=0;i$4<ops.length;i$4++){endOperation_finish(ops[i$4])}}function endOperation_R1(op){var cm=op.cm,display=cm.display;maybeClipScrollbars(cm);if(op.updateMaxLine){findMaxLine(cm)}op.mustUpdate=op.viewChanged||op.forceUpdate||op.scrollTop!=null||op.scrollToPos&&(op.scrollToPos.from.line<display.viewFrom||op.scrollToPos.to.line>=display.viewTo)||display.maxLineChanged&&cm.options.lineWrapping;op.update=op.mustUpdate&&new DisplayUpdate(cm,op.mustUpdate&&{top:op.scrollTop,ensure:op.scrollToPos},op.forceUpdate)}function endOperation_W1(op){op.updatedDisplay=op.mustUpdate&&updateDisplayIfNeeded(op.cm,op.update)}function endOperation_R2(op){var cm=op.cm,display=cm.display;if(op.updatedDisplay){updateHeightsInViewport(cm)}op.barMeasure=measureForScrollbars(cm);if(display.maxLineChanged&&!cm.options.lineWrapping){op.adjustWidthTo=measureChar(cm,display.maxLine,display.maxLine.text.length).left+3;cm.display.sizerWidth=op.adjustWidthTo;op.barMeasure.scrollWidth=Math.max(display.scroller.clientWidth,display.sizer.offsetLeft+op.adjustWidthTo+scrollGap(cm)+cm.display.barWidth);op.maxScrollLeft=Math.max(0,display.sizer.offsetLeft+op.adjustWidthTo-displayWidth(cm))}if(op.updatedDisplay||op.selectionChanged){op.preparedSelection=display.input.prepareSelection()}}function endOperation_W2(op){var cm=op.cm;if(op.adjustWidthTo!=null){cm.display.sizer.style.minWidth=op.adjustWidthTo+"px";if(op.maxScrollLeft<cm.doc.scrollLeft){setScrollLeft(cm,Math.min(cm.display.scroller.scrollLeft,op.maxScrollLeft),true)}cm.display.maxLineChanged=false}var takeFocus=op.focus&&op.focus==activeElt(doc(cm));if(op.preparedSelection){cm.display.input.showSelection(op.preparedSelection,takeFocus)}if(op.updatedDisplay||op.startHeight!=cm.doc.height){updateScrollbars(cm,op.barMeasure)}if(op.updatedDisplay){setDocumentHeight(cm,op.barMeasure)}if(op.selectionChanged){restartBlink(cm)}if(cm.state.focused&&op.updateInput){cm.display.input.reset(op.typing)}if(takeFocus){ensureFocus(op.cm)}}function endOperation_finish(op){var cm=op.cm,display=cm.display,doc=cm.doc;if(op.updatedDisplay){postUpdateDisplay(cm,op.update)}if(display.wheelStartX!=null&&(op.scrollTop!=null||op.scrollLeft!=null||op.scrollToPos)){display.wheelStartX=display.wheelStartY=null}if(op.scrollTop!=null){setScrollTop(cm,op.scrollTop,op.forceScroll)}if(op.scrollLeft!=null){setScrollLeft(cm,op.scrollLeft,true,true)}if(op.scrollToPos){var rect=scrollPosIntoView(cm,clipPos(doc,op.scrollToPos.from),clipPos(doc,op.scrollToPos.to),op.scrollToPos.margin);maybeScrollWindow(cm,rect)}var hidden=op.maybeHiddenMarkers,unhidden=op.maybeUnhiddenMarkers;if(hidden){for(var i=0;i<hidden.length;++i){if(!hidden[i].lines.length){signal(hidden[i],"hide")}}}if(unhidden){for(var i$1=0;i$1<unhidden.length;++i$1){if(unhidden[i$1].lines.length){signal(unhidden[i$1],"unhide")}}}if(display.wrapper.offsetHeight){doc.scrollTop=cm.display.scroller.scrollTop}if(op.changeObjs){signal(cm,"changes",cm,op.changeObjs)}if(op.update){op.update.finish()}}function runInOp(cm,f){if(cm.curOp){return f()}startOperation(cm);try{return f()}finally{endOperation(cm)}}function operation(cm,f){return function(){if(cm.curOp){return f.apply(cm,arguments)}startOperation(cm);try{return f.apply(cm,arguments)}finally{endOperation(cm)}}}function methodOp(f){return function(){if(this.curOp){return f.apply(this,arguments)}startOperation(this);try{return f.apply(this,arguments)}finally{endOperation(this)}}}function docMethodOp(f){return function(){var cm=this.cm;if(!cm||cm.curOp){return f.apply(this,arguments)}startOperation(cm);try{return f.apply(this,arguments)}finally{endOperation(cm)}}}function startWorker(cm,time){if(cm.doc.highlightFrontier<cm.display.viewTo){cm.state.highlight.set(time,bind(highlightWorker,cm))}}function highlightWorker(cm){var doc=cm.doc;if(doc.highlightFrontier>=cm.display.viewTo){return}var end=+new Date+cm.options.workTime;var context=getContextBefore(cm,doc.highlightFrontier);var changedLines=[];doc.iter(context.line,Math.min(doc.first+doc.size,cm.display.viewTo+500),(function(line){if(context.line>=cm.display.viewFrom){var oldStyles=line.styles;var resetState=line.text.length>cm.options.maxHighlightLength?copyState(doc.mode,context.state):null;var highlighted=highlightLine(cm,line,context,true);if(resetState){context.state=resetState}line.styles=highlighted.styles;var oldCls=line.styleClasses,newCls=highlighted.classes;if(newCls){line.styleClasses=newCls}else if(oldCls){line.styleClasses=null}var ischange=!oldStyles||oldStyles.length!=line.styles.length||oldCls!=newCls&&(!oldCls||!newCls||oldCls.bgClass!=newCls.bgClass||oldCls.textClass!=newCls.textClass);for(var i=0;!ischange&&i<oldStyles.length;++i){ischange=oldStyles[i]!=line.styles[i]}if(ischange){changedLines.push(context.line)}line.stateAfter=context.save();context.nextLine()}else{if(line.text.length<=cm.options.maxHighlightLength){processLine(cm,line.text,context)}line.stateAfter=context.line%5==0?context.save():null;context.nextLine()}if(+new Date>end){startWorker(cm,cm.options.workDelay);return true}}));doc.highlightFrontier=context.line;doc.modeFrontier=Math.max(doc.modeFrontier,context.line);if(changedLines.length){runInOp(cm,(function(){for(var i=0;i<changedLines.length;i++){regLineChange(cm,changedLines[i],"text")}}))}}var DisplayUpdate=function(cm,viewport,force){var display=cm.display;this.viewport=viewport;this.visible=visibleLines(display,cm.doc,viewport);this.editorIsHidden=!display.wrapper.offsetWidth;this.wrapperHeight=display.wrapper.clientHeight;this.wrapperWidth=display.wrapper.clientWidth;this.oldDisplayWidth=displayWidth(cm);this.force=force;this.dims=getDimensions(cm);this.events=[]};DisplayUpdate.prototype.signal=function(emitter,type){if(hasHandler(emitter,type)){this.events.push(arguments)}};DisplayUpdate.prototype.finish=function(){for(var i=0;i<this.events.length;i++){signal.apply(null,this.events[i])}};function maybeClipScrollbars(cm){var display=cm.display;if(!display.scrollbarsClipped&&display.scroller.offsetWidth){display.nativeBarWidth=display.scroller.offsetWidth-display.scroller.clientWidth;display.heightForcer.style.height=scrollGap(cm)+"px";display.sizer.style.marginBottom=-display.nativeBarWidth+"px";display.sizer.style.borderRightWidth=scrollGap(cm)+"px";display.scrollbarsClipped=true}}function selectionSnapshot(cm){if(cm.hasFocus()){return null}var active=activeElt(doc(cm));if(!active||!contains(cm.display.lineDiv,active)){return null}var result={activeElt:active};if(window.getSelection){var sel=win(cm).getSelection();if(sel.anchorNode&&sel.extend&&contains(cm.display.lineDiv,sel.anchorNode)){result.anchorNode=sel.anchorNode;result.anchorOffset=sel.anchorOffset;result.focusNode=sel.focusNode;result.focusOffset=sel.focusOffset}}return result}function restoreSelection(snapshot){if(!snapshot||!snapshot.activeElt||snapshot.activeElt==activeElt(snapshot.activeElt.ownerDocument)){return}snapshot.activeElt.focus();if(!/^(INPUT|TEXTAREA)$/.test(snapshot.activeElt.nodeName)&&snapshot.anchorNode&&contains(document.body,snapshot.anchorNode)&&contains(document.body,snapshot.focusNode)){var doc=snapshot.activeElt.ownerDocument;var sel=doc.defaultView.getSelection(),range=doc.createRange();range.setEnd(snapshot.anchorNode,snapshot.anchorOffset);range.collapse(false);sel.removeAllRanges();sel.addRange(range);sel.extend(snapshot.focusNode,snapshot.focusOffset)}}function updateDisplayIfNeeded(cm,update){var display=cm.display,doc=cm.doc;if(update.editorIsHidden){resetView(cm);return false}if(!update.force&&update.visible.from>=display.viewFrom&&update.visible.to<=display.viewTo&&(display.updateLineNumbers==null||display.updateLineNumbers>=display.viewTo)&&display.renderedView==display.view&&countDirtyView(cm)==0){return false}if(maybeUpdateLineNumberWidth(cm)){resetView(cm);update.dims=getDimensions(cm)}var end=doc.first+doc.size;var from=Math.max(update.visible.from-cm.options.viewportMargin,doc.first);var to=Math.min(end,update.visible.to+cm.options.viewportMargin);if(display.viewFrom<from&&from-display.viewFrom<20){from=Math.max(doc.first,display.viewFrom)}if(display.viewTo>to&&display.viewTo-to<20){to=Math.min(end,display.viewTo)}if(sawCollapsedSpans){from=visualLineNo(cm.doc,from);to=visualLineEndNo(cm.doc,to)}var different=from!=display.viewFrom||to!=display.viewTo||display.lastWrapHeight!=update.wrapperHeight||display.lastWrapWidth!=update.wrapperWidth;adjustView(cm,from,to);display.viewOffset=heightAtLine(getLine(cm.doc,display.viewFrom));cm.display.mover.style.top=display.viewOffset+"px";var toUpdate=countDirtyView(cm);if(!different&&toUpdate==0&&!update.force&&display.renderedView==display.view&&(display.updateLineNumbers==null||display.updateLineNumbers>=display.viewTo)){return false}var selSnapshot=selectionSnapshot(cm);if(toUpdate>4){display.lineDiv.style.display="none"}patchDisplay(cm,display.updateLineNumbers,update.dims);if(toUpdate>4){display.lineDiv.style.display=""}display.renderedView=display.view;restoreSelection(selSnapshot);removeChildren(display.cursorDiv);removeChildren(display.selectionDiv);display.gutters.style.height=display.sizer.style.minHeight=0;if(different){display.lastWrapHeight=update.wrapperHeight;display.lastWrapWidth=update.wrapperWidth;startWorker(cm,400)}display.updateLineNumbers=null;return true}function postUpdateDisplay(cm,update){var viewport=update.viewport;for(var first=true;;first=false){if(!first||!cm.options.lineWrapping||update.oldDisplayWidth==displayWidth(cm)){if(viewport&&viewport.top!=null){viewport={top:Math.min(cm.doc.height+paddingVert(cm.display)-displayHeight(cm),viewport.top)}}update.visible=visibleLines(cm.display,cm.doc,viewport);if(update.visible.from>=cm.display.viewFrom&&update.visible.to<=cm.display.viewTo){break}}else if(first){update.visible=visibleLines(cm.display,cm.doc,viewport)}if(!updateDisplayIfNeeded(cm,update)){break}updateHeightsInViewport(cm);var barMeasure=measureForScrollbars(cm);updateSelection(cm);updateScrollbars(cm,barMeasure);setDocumentHeight(cm,barMeasure);update.force=false}update.signal(cm,"update",cm);if(cm.display.viewFrom!=cm.display.reportedViewFrom||cm.display.viewTo!=cm.display.reportedViewTo){update.signal(cm,"viewportChange",cm,cm.display.viewFrom,cm.display.viewTo);cm.display.reportedViewFrom=cm.display.viewFrom;cm.display.reportedViewTo=cm.display.viewTo}}function updateDisplaySimple(cm,viewport){var update=new DisplayUpdate(cm,viewport);if(updateDisplayIfNeeded(cm,update)){updateHeightsInViewport(cm);postUpdateDisplay(cm,update);var barMeasure=measureForScrollbars(cm);updateSelection(cm);updateScrollbars(cm,barMeasure);setDocumentHeight(cm,barMeasure);update.finish()}}function patchDisplay(cm,updateNumbersFrom,dims){var display=cm.display,lineNumbers=cm.options.lineNumbers;var container=display.lineDiv,cur=container.firstChild;function rm(node){var next=node.nextSibling;if(webkit&&mac&&cm.display.currentWheelTarget==node){node.style.display="none"}else{node.parentNode.removeChild(node)}return next}var view=display.view,lineN=display.viewFrom;for(var i=0;i<view.length;i++){var lineView=view[i];if(lineView.hidden);else if(!lineView.node||lineView.node.parentNode!=container){var node=buildLineElement(cm,lineView,lineN,dims);container.insertBefore(node,cur)}else{while(cur!=lineView.node){cur=rm(cur)}var updateNumber=lineNumbers&&updateNumbersFrom!=null&&updateNumbersFrom<=lineN&&lineView.lineNumber;if(lineView.changes){if(indexOf(lineView.changes,"gutter")>-1){updateNumber=false}updateLineForChanges(cm,lineView,lineN,dims)}if(updateNumber){removeChildren(lineView.lineNumber);lineView.lineNumber.appendChild(document.createTextNode(lineNumberFor(cm.options,lineN)))}cur=lineView.node.nextSibling}lineN+=lineView.size}while(cur){cur=rm(cur)}}function updateGutterSpace(display){var width=display.gutters.offsetWidth;display.sizer.style.marginLeft=width+"px";signalLater(display,"gutterChanged",display)}function setDocumentHeight(cm,measure){cm.display.sizer.style.minHeight=measure.docHeight+"px";cm.display.heightForcer.style.top=measure.docHeight+"px";cm.display.gutters.style.height=measure.docHeight+cm.display.barHeight+scrollGap(cm)+"px"}function alignHorizontally(cm){var display=cm.display,view=display.view;if(!display.alignWidgets&&(!display.gutters.firstChild||!cm.options.fixedGutter)){return}var comp=compensateForHScroll(display)-display.scroller.scrollLeft+cm.doc.scrollLeft;var gutterW=display.gutters.offsetWidth,left=comp+"px";for(var i=0;i<view.length;i++){if(!view[i].hidden){if(cm.options.fixedGutter){if(view[i].gutter){view[i].gutter.style.left=left}if(view[i].gutterBackground){view[i].gutterBackground.style.left=left}}var align=view[i].alignable;if(align){for(var j=0;j<align.length;j++){align[j].style.left=left}}}}if(cm.options.fixedGutter){display.gutters.style.left=comp+gutterW+"px"}}function maybeUpdateLineNumberWidth(cm){if(!cm.options.lineNumbers){return false}var doc=cm.doc,last=lineNumberFor(cm.options,doc.first+doc.size-1),display=cm.display;if(last.length!=display.lineNumChars){var test=display.measure.appendChild(elt("div",[elt("div",last)],"CodeMirror-linenumber CodeMirror-gutter-elt"));var innerW=test.firstChild.offsetWidth,padding=test.offsetWidth-innerW;display.lineGutter.style.width="";display.lineNumInnerWidth=Math.max(innerW,display.lineGutter.offsetWidth-padding)+1;display.lineNumWidth=display.lineNumInnerWidth+padding;display.lineNumChars=display.lineNumInnerWidth?last.length:-1;display.lineGutter.style.width=display.lineNumWidth+"px";updateGutterSpace(cm.display);return true}return false}function getGutters(gutters,lineNumbers){var result=[],sawLineNumbers=false;for(var i=0;i<gutters.length;i++){var name=gutters[i],style=null;if(typeof name!="string"){style=name.style;name=name.className}if(name=="CodeMirror-linenumbers"){if(!lineNumbers){continue}else{sawLineNumbers=true}}result.push({className:name,style:style})}if(lineNumbers&&!sawLineNumbers){result.push({className:"CodeMirror-linenumbers",style:null})}return result}function renderGutters(display){var gutters=display.gutters,specs=display.gutterSpecs;removeChildren(gutters);display.lineGutter=null;for(var i=0;i<specs.length;++i){var ref=specs[i];var className=ref.className;var style=ref.style;var gElt=gutters.appendChild(elt("div",null,"CodeMirror-gutter "+className));if(style){gElt.style.cssText=style}if(className=="CodeMirror-linenumbers"){display.lineGutter=gElt;gElt.style.width=(display.lineNumWidth||1)+"px"}}gutters.style.display=specs.length?"":"none";updateGutterSpace(display)}function updateGutters(cm){renderGutters(cm.display);regChange(cm);alignHorizontally(cm)}function Display(place,doc,input,options){var d=this;this.input=input;d.scrollbarFiller=elt("div",null,"CodeMirror-scrollbar-filler");d.scrollbarFiller.setAttribute("cm-not-content","true");d.gutterFiller=elt("div",null,"CodeMirror-gutter-filler");d.gutterFiller.setAttribute("cm-not-content","true");d.lineDiv=eltP("div",null,"CodeMirror-code");d.selectionDiv=elt("div",null,null,"position: relative; z-index: 1");d.cursorDiv=elt("div",null,"CodeMirror-cursors");d.measure=elt("div",null,"CodeMirror-measure");d.lineMeasure=elt("div",null,"CodeMirror-measure");d.lineSpace=eltP("div",[d.measure,d.lineMeasure,d.selectionDiv,d.cursorDiv,d.lineDiv],null,"position: relative; outline: none");var lines=eltP("div",[d.lineSpace],"CodeMirror-lines");d.mover=elt("div",[lines],null,"position: relative");d.sizer=elt("div",[d.mover],"CodeMirror-sizer");d.sizerWidth=null;d.heightForcer=elt("div",null,null,"position: absolute; height: "+scrollerGap+"px; width: 1px;");d.gutters=elt("div",null,"CodeMirror-gutters");d.lineGutter=null;d.scroller=elt("div",[d.sizer,d.heightForcer,d.gutters],"CodeMirror-scroll");d.scroller.setAttribute("tabIndex","-1");d.wrapper=elt("div",[d.scrollbarFiller,d.gutterFiller,d.scroller],"CodeMirror");if(chrome&&chrome_version>=105){d.wrapper.style.clipPath="inset(0px)"}d.wrapper.setAttribute("translate","no");if(ie&&ie_version<8){d.gutters.style.zIndex=-1;d.scroller.style.paddingRight=0}if(!webkit&&!(gecko&&mobile)){d.scroller.draggable=true}if(place){if(place.appendChild){place.appendChild(d.wrapper)}else{place(d.wrapper)}}d.viewFrom=d.viewTo=doc.first;d.reportedViewFrom=d.reportedViewTo=doc.first;d.view=[];d.renderedView=null;d.externalMeasured=null;d.viewOffset=0;d.lastWrapHeight=d.lastWrapWidth=0;d.updateLineNumbers=null;d.nativeBarWidth=d.barHeight=d.barWidth=0;d.scrollbarsClipped=false;d.lineNumWidth=d.lineNumInnerWidth=d.lineNumChars=null;d.alignWidgets=false;d.cachedCharWidth=d.cachedTextHeight=d.cachedPaddingH=null;d.maxLine=null;d.maxLineLength=0;d.maxLineChanged=false;d.wheelDX=d.wheelDY=d.wheelStartX=d.wheelStartY=null;d.shift=false;d.selForContextMenu=null;d.activeTouch=null;d.gutterSpecs=getGutters(options.gutters,options.lineNumbers);renderGutters(d);input.init(d)}var wheelSamples=0,wheelPixelsPerUnit=null;if(ie){wheelPixelsPerUnit=-.53}else if(gecko){wheelPixelsPerUnit=15}else if(chrome){wheelPixelsPerUnit=-.7}else if(safari){wheelPixelsPerUnit=-1/3}function wheelEventDelta(e){var dx=e.wheelDeltaX,dy=e.wheelDeltaY;if(dx==null&&e.detail&&e.axis==e.HORIZONTAL_AXIS){dx=e.detail}if(dy==null&&e.detail&&e.axis==e.VERTICAL_AXIS){dy=e.detail}else if(dy==null){dy=e.wheelDelta}return{x:dx,y:dy}}function wheelEventPixels(e){var delta=wheelEventDelta(e);delta.x*=wheelPixelsPerUnit;delta.y*=wheelPixelsPerUnit;return delta}function onScrollWheel(cm,e){if(chrome&&chrome_version==102){if(cm.display.chromeScrollHack==null){cm.display.sizer.style.pointerEvents="none"}else{clearTimeout(cm.display.chromeScrollHack)}cm.display.chromeScrollHack=setTimeout((function(){cm.display.chromeScrollHack=null;cm.display.sizer.style.pointerEvents=""}),100)}var delta=wheelEventDelta(e),dx=delta.x,dy=delta.y;var pixelsPerUnit=wheelPixelsPerUnit;if(e.deltaMode===0){dx=e.deltaX;dy=e.deltaY;pixelsPerUnit=1}var display=cm.display,scroll=display.scroller;var canScrollX=scroll.scrollWidth>scroll.clientWidth;var canScrollY=scroll.scrollHeight>scroll.clientHeight;if(!(dx&&canScrollX||dy&&canScrollY)){return}if(dy&&mac&&webkit){outer:for(var cur=e.target,view=display.view;cur!=scroll;cur=cur.parentNode){for(var i=0;i<view.length;i++){if(view[i].node==cur){cm.display.currentWheelTarget=cur;break outer}}}}if(dx&&!gecko&&!presto&&pixelsPerUnit!=null){if(dy&&canScrollY){updateScrollTop(cm,Math.max(0,scroll.scrollTop+dy*pixelsPerUnit))}setScrollLeft(cm,Math.max(0,scroll.scrollLeft+dx*pixelsPerUnit));if(!dy||dy&&canScrollY){e_preventDefault(e)}display.wheelStartX=null;return}if(dy&&pixelsPerUnit!=null){var pixels=dy*pixelsPerUnit;var top=cm.doc.scrollTop,bot=top+display.wrapper.clientHeight;if(pixels<0){top=Math.max(0,top+pixels-50)}else{bot=Math.min(cm.doc.height,bot+pixels+50)}updateDisplaySimple(cm,{top:top,bottom:bot})}if(wheelSamples<20&&e.deltaMode!==0){if(display.wheelStartX==null){display.wheelStartX=scroll.scrollLeft;display.wheelStartY=scroll.scrollTop;display.wheelDX=dx;display.wheelDY=dy;setTimeout((function(){if(display.wheelStartX==null){return}var movedX=scroll.scrollLeft-display.wheelStartX;var movedY=scroll.scrollTop-display.wheelStartY;var sample=movedY&&display.wheelDY&&movedY/display.wheelDY||movedX&&display.wheelDX&&movedX/display.wheelDX;display.wheelStartX=display.wheelStartY=null;if(!sample){return}wheelPixelsPerUnit=(wheelPixelsPerUnit*wheelSamples+sample)/(wheelSamples+1);++wheelSamples}),200)}else{display.wheelDX+=dx;display.wheelDY+=dy}}}var Selection=function(ranges,primIndex){this.ranges=ranges;this.primIndex=primIndex};Selection.prototype.primary=function(){return this.ranges[this.primIndex]};Selection.prototype.equals=function(other){if(other==this){return true}if(other.primIndex!=this.primIndex||other.ranges.length!=this.ranges.length){return false}for(var i=0;i<this.ranges.length;i++){var here=this.ranges[i],there=other.ranges[i];if(!equalCursorPos(here.anchor,there.anchor)||!equalCursorPos(here.head,there.head)){return false}}return true};Selection.prototype.deepCopy=function(){var out=[];for(var i=0;i<this.ranges.length;i++){out[i]=new Range(copyPos(this.ranges[i].anchor),copyPos(this.ranges[i].head))}return new Selection(out,this.primIndex)};Selection.prototype.somethingSelected=function(){for(var i=0;i<this.ranges.length;i++){if(!this.ranges[i].empty()){return true}}return false};Selection.prototype.contains=function(pos,end){if(!end){end=pos}for(var i=0;i<this.ranges.length;i++){var range=this.ranges[i];if(cmp(end,range.from())>=0&&cmp(pos,range.to())<=0){return i}}return-1};var Range=function(anchor,head){this.anchor=anchor;this.head=head};Range.prototype.from=function(){return minPos(this.anchor,this.head)};Range.prototype.to=function(){return maxPos(this.anchor,this.head)};Range.prototype.empty=function(){return this.head.line==this.anchor.line&&this.head.ch==this.anchor.ch};function normalizeSelection(cm,ranges,primIndex){var mayTouch=cm&&cm.options.selectionsMayTouch;var prim=ranges[primIndex];ranges.sort((function(a,b){return cmp(a.from(),b.from())}));primIndex=indexOf(ranges,prim);for(var i=1;i<ranges.length;i++){var cur=ranges[i],prev=ranges[i-1];var diff=cmp(prev.to(),cur.from());if(mayTouch&&!cur.empty()?diff>0:diff>=0){var from=minPos(prev.from(),cur.from()),to=maxPos(prev.to(),cur.to());var inv=prev.empty()?cur.from()==cur.head:prev.from()==prev.head;if(i<=primIndex){--primIndex}ranges.splice(--i,2,new Range(inv?to:from,inv?from:to))}}return new Selection(ranges,primIndex)}function simpleSelection(anchor,head){return new Selection([new Range(anchor,head||anchor)],0)}function changeEnd(change){if(!change.text){return change.to}return Pos(change.from.line+change.text.length-1,lst(change.text).length+(change.text.length==1?change.from.ch:0))}function adjustForChange(pos,change){if(cmp(pos,change.from)<0){return pos}if(cmp(pos,change.to)<=0){return changeEnd(change)}var line=pos.line+change.text.length-(change.to.line-change.from.line)-1,ch=pos.ch;if(pos.line==change.to.line){ch+=changeEnd(change).ch-change.to.ch}return Pos(line,ch)}function computeSelAfterChange(doc,change){var out=[];for(var i=0;i<doc.sel.ranges.length;i++){var range=doc.sel.ranges[i];out.push(new Range(adjustForChange(range.anchor,change),adjustForChange(range.head,change)))}return normalizeSelection(doc.cm,out,doc.sel.primIndex)}function offsetPos(pos,old,nw){if(pos.line==old.line){return Pos(nw.line,pos.ch-old.ch+nw.ch)}else{return Pos(nw.line+(pos.line-old.line),pos.ch)}}function computeReplacedSel(doc,changes,hint){var out=[];var oldPrev=Pos(doc.first,0),newPrev=oldPrev;for(var i=0;i<changes.length;i++){var change=changes[i];var from=offsetPos(change.from,oldPrev,newPrev);var to=offsetPos(changeEnd(change),oldPrev,newPrev);oldPrev=change.to;newPrev=to;if(hint=="around"){var range=doc.sel.ranges[i],inv=cmp(range.head,range.anchor)<0;out[i]=new Range(inv?to:from,inv?from:to)}else{out[i]=new Range(from,from)}}return new Selection(out,doc.sel.primIndex)}function loadMode(cm){cm.doc.mode=getMode(cm.options,cm.doc.modeOption);resetModeState(cm)}function resetModeState(cm){cm.doc.iter((function(line){if(line.stateAfter){line.stateAfter=null}if(line.styles){line.styles=null}}));cm.doc.modeFrontier=cm.doc.highlightFrontier=cm.doc.first;startWorker(cm,100);cm.state.modeGen++;if(cm.curOp){regChange(cm)}}function isWholeLineUpdate(doc,change){return change.from.ch==0&&change.to.ch==0&&lst(change.text)==""&&(!doc.cm||doc.cm.options.wholeLineUpdateBefore)}function updateDoc(doc,change,markedSpans,estimateHeight){function spansFor(n){return markedSpans?markedSpans[n]:null}function update(line,text,spans){updateLine(line,text,spans,estimateHeight);signalLater(line,"change",line,change)}function linesFor(start,end){var result=[];for(var i=start;i<end;++i){result.push(new Line(text[i],spansFor(i),estimateHeight))}return result}var from=change.from,to=change.to,text=change.text;var firstLine=getLine(doc,from.line),lastLine=getLine(doc,to.line);var lastText=lst(text),lastSpans=spansFor(text.length-1),nlines=to.line-from.line;if(change.full){doc.insert(0,linesFor(0,text.length));doc.remove(text.length,doc.size-text.length)}else if(isWholeLineUpdate(doc,change)){var added=linesFor(0,text.length-1);update(lastLine,lastLine.text,lastSpans);if(nlines){doc.remove(from.line,nlines)}if(added.length){doc.insert(from.line,added)}}else if(firstLine==lastLine){if(text.length==1){update(firstLine,firstLine.text.slice(0,from.ch)+lastText+firstLine.text.slice(to.ch),lastSpans)}else{var added$1=linesFor(1,text.length-1);added$1.push(new Line(lastText+firstLine.text.slice(to.ch),lastSpans,estimateHeight));update(firstLine,firstLine.text.slice(0,from.ch)+text[0],spansFor(0));doc.insert(from.line+1,added$1)}}else if(text.length==1){update(firstLine,firstLine.text.slice(0,from.ch)+text[0]+lastLine.text.slice(to.ch),spansFor(0));doc.remove(from.line+1,nlines)}else{update(firstLine,firstLine.text.slice(0,from.ch)+text[0],spansFor(0));update(lastLine,lastText+lastLine.text.slice(to.ch),lastSpans);var added$2=linesFor(1,text.length-1);if(nlines>1){doc.remove(from.line+1,nlines-1)}doc.insert(from.line+1,added$2)}signalLater(doc,"change",doc,change)}function linkedDocs(doc,f,sharedHistOnly){function propagate(doc,skip,sharedHist){if(doc.linked){for(var i=0;i<doc.linked.length;++i){var rel=doc.linked[i];if(rel.doc==skip){continue}var shared=sharedHist&&rel.sharedHist;if(sharedHistOnly&&!shared){continue}f(rel.doc,shared);propagate(rel.doc,doc,shared)}}}propagate(doc,null,true)}function attachDoc(cm,doc){if(doc.cm){throw new Error("This document is already in use.")}cm.doc=doc;doc.cm=cm;estimateLineHeights(cm);loadMode(cm);setDirectionClass(cm);cm.options.direction=doc.direction;if(!cm.options.lineWrapping){findMaxLine(cm)}cm.options.mode=doc.modeOption;regChange(cm)}function setDirectionClass(cm){(cm.doc.direction=="rtl"?addClass:rmClass)(cm.display.lineDiv,"CodeMirror-rtl")}function directionChanged(cm){runInOp(cm,(function(){setDirectionClass(cm);regChange(cm)}))}function History(prev){this.done=[];this.undone=[];this.undoDepth=prev?prev.undoDepth:Infinity;this.lastModTime=this.lastSelTime=0;this.lastOp=this.lastSelOp=null;this.lastOrigin=this.lastSelOrigin=null;this.generation=this.maxGeneration=prev?prev.maxGeneration:1}function historyChangeFromChange(doc,change){var histChange={from:copyPos(change.from),to:changeEnd(change),text:getBetween(doc,change.from,change.to)};attachLocalSpans(doc,histChange,change.from.line,change.to.line+1);linkedDocs(doc,(function(doc){return attachLocalSpans(doc,histChange,change.from.line,change.to.line+1)}),true);return histChange}function clearSelectionEvents(array){while(array.length){var last=lst(array);if(last.ranges){array.pop()}else{break}}}function lastChangeEvent(hist,force){if(force){clearSelectionEvents(hist.done);return lst(hist.done)}else if(hist.done.length&&!lst(hist.done).ranges){return lst(hist.done)}else if(hist.done.length>1&&!hist.done[hist.done.length-2].ranges){hist.done.pop();return lst(hist.done)}}function addChangeToHistory(doc,change,selAfter,opId){var hist=doc.history;hist.undone.length=0;var time=+new Date,cur;var last;if((hist.lastOp==opId||hist.lastOrigin==change.origin&&change.origin&&(change.origin.charAt(0)=="+"&&hist.lastModTime>time-(doc.cm?doc.cm.options.historyEventDelay:500)||change.origin.charAt(0)=="*"))&&(cur=lastChangeEvent(hist,hist.lastOp==opId))){last=lst(cur.changes);if(cmp(change.from,change.to)==0&&cmp(change.from,last.to)==0){last.to=changeEnd(change)}else{cur.changes.push(historyChangeFromChange(doc,change))}}else{var before=lst(hist.done);if(!before||!before.ranges){pushSelectionToHistory(doc.sel,hist.done)}cur={changes:[historyChangeFromChange(doc,change)],generation:hist.generation};hist.done.push(cur);while(hist.done.length>hist.undoDepth){hist.done.shift();if(!hist.done[0].ranges){hist.done.shift()}}}hist.done.push(selAfter);hist.generation=++hist.maxGeneration;hist.lastModTime=hist.lastSelTime=time;hist.lastOp=hist.lastSelOp=opId;hist.lastOrigin=hist.lastSelOrigin=change.origin;if(!last){signal(doc,"historyAdded")}}function selectionEventCanBeMerged(doc,origin,prev,sel){var ch=origin.charAt(0);return ch=="*"||ch=="+"&&prev.ranges.length==sel.ranges.length&&prev.somethingSelected()==sel.somethingSelected()&&new Date-doc.history.lastSelTime<=(doc.cm?doc.cm.options.historyEventDelay:500)}function addSelectionToHistory(doc,sel,opId,options){var hist=doc.history,origin=options&&options.origin;if(opId==hist.lastSelOp||origin&&hist.lastSelOrigin==origin&&(hist.lastModTime==hist.lastSelTime&&hist.lastOrigin==origin||selectionEventCanBeMerged(doc,origin,lst(hist.done),sel))){hist.done[hist.done.length-1]=sel}else{pushSelectionToHistory(sel,hist.done)}hist.lastSelTime=+new Date;hist.lastSelOrigin=origin;hist.lastSelOp=opId;if(options&&options.clearRedo!==false){clearSelectionEvents(hist.undone)}}function pushSelectionToHistory(sel,dest){var top=lst(dest);if(!(top&&top.ranges&&top.equals(sel))){dest.push(sel)}}function attachLocalSpans(doc,change,from,to){var existing=change["spans_"+doc.id],n=0;doc.iter(Math.max(doc.first,from),Math.min(doc.first+doc.size,to),(function(line){if(line.markedSpans){(existing||(existing=change["spans_"+doc.id]={}))[n]=line.markedSpans}++n}))}function removeClearedSpans(spans){if(!spans){return null}var out;for(var i=0;i<spans.length;++i){if(spans[i].marker.explicitlyCleared){if(!out){out=spans.slice(0,i)}}else if(out){out.push(spans[i])}}return!out?spans:out.length?out:null}function getOldSpans(doc,change){var found=change["spans_"+doc.id];if(!found){return null}var nw=[];for(var i=0;i<change.text.length;++i){nw.push(removeClearedSpans(found[i]))}return nw}function mergeOldSpans(doc,change){var old=getOldSpans(doc,change);var stretched=stretchSpansOverChange(doc,change);if(!old){return stretched}if(!stretched){return old}for(var i=0;i<old.length;++i){var oldCur=old[i],stretchCur=stretched[i];if(oldCur&&stretchCur){spans:for(var j=0;j<stretchCur.length;++j){var span=stretchCur[j];for(var k=0;k<oldCur.length;++k){if(oldCur[k].marker==span.marker){continue spans}}oldCur.push(span)}}else if(stretchCur){old[i]=stretchCur}}return old}function copyHistoryArray(events,newGroup,instantiateSel){var copy=[];for(var i=0;i<events.length;++i){var event=events[i];if(event.ranges){copy.push(instantiateSel?Selection.prototype.deepCopy.call(event):event);continue}var changes=event.changes,newChanges=[];copy.push({changes:newChanges});for(var j=0;j<changes.length;++j){var change=changes[j],m=void 0;newChanges.push({from:change.from,to:change.to,text:change.text});if(newGroup){for(var prop in change){if(m=prop.match(/^spans_(\d+)$/)){if(indexOf(newGroup,Number(m[1]))>-1){lst(newChanges)[prop]=change[prop];delete change[prop]}}}}}}return copy}function extendRange(range,head,other,extend){if(extend){var anchor=range.anchor;if(other){var posBefore=cmp(head,anchor)<0;if(posBefore!=cmp(other,anchor)<0){anchor=head;head=other}else if(posBefore!=cmp(head,other)<0){head=other}}return new Range(anchor,head)}else{return new Range(other||head,head)}}function extendSelection(doc,head,other,options,extend){if(extend==null){extend=doc.cm&&(doc.cm.display.shift||doc.extend)}setSelection(doc,new Selection([extendRange(doc.sel.primary(),head,other,extend)],0),options)}function extendSelections(doc,heads,options){var out=[];var extend=doc.cm&&(doc.cm.display.shift||doc.extend);for(var i=0;i<doc.sel.ranges.length;i++){out[i]=extendRange(doc.sel.ranges[i],heads[i],null,extend)}var newSel=normalizeSelection(doc.cm,out,doc.sel.primIndex);setSelection(doc,newSel,options)}function replaceOneSelection(doc,i,range,options){var ranges=doc.sel.ranges.slice(0);ranges[i]=range;setSelection(doc,normalizeSelection(doc.cm,ranges,doc.sel.primIndex),options)}function setSimpleSelection(doc,anchor,head,options){setSelection(doc,simpleSelection(anchor,head),options)}function filterSelectionChange(doc,sel,options){var obj={ranges:sel.ranges,update:function(ranges){this.ranges=[];for(var i=0;i<ranges.length;i++){this.ranges[i]=new Range(clipPos(doc,ranges[i].anchor),clipPos(doc,ranges[i].head))}},origin:options&&options.origin};signal(doc,"beforeSelectionChange",doc,obj);if(doc.cm){signal(doc.cm,"beforeSelectionChange",doc.cm,obj)}if(obj.ranges!=sel.ranges){return normalizeSelection(doc.cm,obj.ranges,obj.ranges.length-1)}else{return sel}}function setSelectionReplaceHistory(doc,sel,options){var done=doc.history.done,last=lst(done);if(last&&last.ranges){done[done.length-1]=sel;setSelectionNoUndo(doc,sel,options)}else{setSelection(doc,sel,options)}}function setSelection(doc,sel,options){setSelectionNoUndo(doc,sel,options);addSelectionToHistory(doc,doc.sel,doc.cm?doc.cm.curOp.id:NaN,options)}function setSelectionNoUndo(doc,sel,options){if(hasHandler(doc,"beforeSelectionChange")||doc.cm&&hasHandler(doc.cm,"beforeSelectionChange")){sel=filterSelectionChange(doc,sel,options)}var bias=options&&options.bias||(cmp(sel.primary().head,doc.sel.primary().head)<0?-1:1);setSelectionInner(doc,skipAtomicInSelection(doc,sel,bias,true));if(!(options&&options.scroll===false)&&doc.cm&&doc.cm.getOption("readOnly")!="nocursor"){ensureCursorVisible(doc.cm)}}function setSelectionInner(doc,sel){if(sel.equals(doc.sel)){return}doc.sel=sel;if(doc.cm){doc.cm.curOp.updateInput=1;doc.cm.curOp.selectionChanged=true;signalCursorActivity(doc.cm)}signalLater(doc,"cursorActivity",doc)}function reCheckSelection(doc){setSelectionInner(doc,skipAtomicInSelection(doc,doc.sel,null,false))}function skipAtomicInSelection(doc,sel,bias,mayClear){var out;for(var i=0;i<sel.ranges.length;i++){var range=sel.ranges[i];var old=sel.ranges.length==doc.sel.ranges.length&&doc.sel.ranges[i];var newAnchor=skipAtomic(doc,range.anchor,old&&old.anchor,bias,mayClear);var newHead=range.head==range.anchor?newAnchor:skipAtomic(doc,range.head,old&&old.head,bias,mayClear);if(out||newAnchor!=range.anchor||newHead!=range.head){if(!out){out=sel.ranges.slice(0,i)}out[i]=new Range(newAnchor,newHead)}}return out?normalizeSelection(doc.cm,out,sel.primIndex):sel}function skipAtomicInner(doc,pos,oldPos,dir,mayClear){var line=getLine(doc,pos.line);if(line.markedSpans){for(var i=0;i<line.markedSpans.length;++i){var sp=line.markedSpans[i],m=sp.marker;var preventCursorLeft="selectLeft"in m?!m.selectLeft:m.inclusiveLeft;var preventCursorRight="selectRight"in m?!m.selectRight:m.inclusiveRight;if((sp.from==null||(preventCursorLeft?sp.from<=pos.ch:sp.from<pos.ch))&&(sp.to==null||(preventCursorRight?sp.to>=pos.ch:sp.to>pos.ch))){if(mayClear){signal(m,"beforeCursorEnter");if(m.explicitlyCleared){if(!line.markedSpans){break}else{--i;continue}}}if(!m.atomic){continue}if(oldPos){var near=m.find(dir<0?1:-1),diff=void 0;if(dir<0?preventCursorRight:preventCursorLeft){near=movePos(doc,near,-dir,near&&near.line==pos.line?line:null)}if(near&&near.line==pos.line&&(diff=cmp(near,oldPos))&&(dir<0?diff<0:diff>0)){return skipAtomicInner(doc,near,pos,dir,mayClear)}}var far=m.find(dir<0?-1:1);if(dir<0?preventCursorLeft:preventCursorRight){far=movePos(doc,far,dir,far.line==pos.line?line:null)}return far?skipAtomicInner(doc,far,pos,dir,mayClear):null}}}return pos}function skipAtomic(doc,pos,oldPos,bias,mayClear){var dir=bias||1;var found=skipAtomicInner(doc,pos,oldPos,dir,mayClear)||!mayClear&&skipAtomicInner(doc,pos,oldPos,dir,true)||skipAtomicInner(doc,pos,oldPos,-dir,mayClear)||!mayClear&&skipAtomicInner(doc,pos,oldPos,-dir,true);if(!found){doc.cantEdit=true;return Pos(doc.first,0)}return found}function movePos(doc,pos,dir,line){if(dir<0&&pos.ch==0){if(pos.line>doc.first){return clipPos(doc,Pos(pos.line-1))}else{return null}}else if(dir>0&&pos.ch==(line||getLine(doc,pos.line)).text.length){if(pos.line<doc.first+doc.size-1){return Pos(pos.line+1,0)}else{return null}}else{return new Pos(pos.line,pos.ch+dir)}}function selectAll(cm){cm.setSelection(Pos(cm.firstLine(),0),Pos(cm.lastLine()),sel_dontScroll)}function filterChange(doc,change,update){var obj={canceled:false,from:change.from,to:change.to,text:change.text,origin:change.origin,cancel:function(){return obj.canceled=true}};if(update){obj.update=function(from,to,text,origin){if(from){obj.from=clipPos(doc,from)}if(to){obj.to=clipPos(doc,to)}if(text){obj.text=text}if(origin!==undefined){obj.origin=origin}}}signal(doc,"beforeChange",doc,obj);if(doc.cm){signal(doc.cm,"beforeChange",doc.cm,obj)}if(obj.canceled){if(doc.cm){doc.cm.curOp.updateInput=2}return null}return{from:obj.from,to:obj.to,text:obj.text,origin:obj.origin}}function makeChange(doc,change,ignoreReadOnly){if(doc.cm){if(!doc.cm.curOp){return operation(doc.cm,makeChange)(doc,change,ignoreReadOnly)}if(doc.cm.state.suppressEdits){return}}if(hasHandler(doc,"beforeChange")||doc.cm&&hasHandler(doc.cm,"beforeChange")){change=filterChange(doc,change,true);if(!change){return}}var split=sawReadOnlySpans&&!ignoreReadOnly&&removeReadOnlyRanges(doc,change.from,change.to);if(split){for(var i=split.length-1;i>=0;--i){makeChangeInner(doc,{from:split[i].from,to:split[i].to,text:i?[""]:change.text,origin:change.origin})}}else{makeChangeInner(doc,change)}}function makeChangeInner(doc,change){if(change.text.length==1&&change.text[0]==""&&cmp(change.from,change.to)==0){return}var selAfter=computeSelAfterChange(doc,change);addChangeToHistory(doc,change,selAfter,doc.cm?doc.cm.curOp.id:NaN);makeChangeSingleDoc(doc,change,selAfter,stretchSpansOverChange(doc,change));var rebased=[];linkedDocs(doc,(function(doc,sharedHist){if(!sharedHist&&indexOf(rebased,doc.history)==-1){rebaseHist(doc.history,change);rebased.push(doc.history)}makeChangeSingleDoc(doc,change,null,stretchSpansOverChange(doc,change))}))}function makeChangeFromHistory(doc,type,allowSelectionOnly){var suppress=doc.cm&&doc.cm.state.suppressEdits;if(suppress&&!allowSelectionOnly){return}var hist=doc.history,event,selAfter=doc.sel;var source=type=="undo"?hist.done:hist.undone,dest=type=="undo"?hist.undone:hist.done;var i=0;for(;i<source.length;i++){event=source[i];if(allowSelectionOnly?event.ranges&&!event.equals(doc.sel):!event.ranges){break}}if(i==source.length){return}hist.lastOrigin=hist.lastSelOrigin=null;for(;;){event=source.pop();if(event.ranges){pushSelectionToHistory(event,dest);if(allowSelectionOnly&&!event.equals(doc.sel)){setSelection(doc,event,{clearRedo:false});return}selAfter=event}else if(suppress){source.push(event);return}else{break}}var antiChanges=[];pushSelectionToHistory(selAfter,dest);dest.push({changes:antiChanges,generation:hist.generation});hist.generation=event.generation||++hist.maxGeneration;var filter=hasHandler(doc,"beforeChange")||doc.cm&&hasHandler(doc.cm,"beforeChange");var loop=function(i){var change=event.changes[i];change.origin=type;if(filter&&!filterChange(doc,change,false)){source.length=0;return{}}antiChanges.push(historyChangeFromChange(doc,change));var after=i?computeSelAfterChange(doc,change):lst(source);makeChangeSingleDoc(doc,change,after,mergeOldSpans(doc,change));if(!i&&doc.cm){doc.cm.scrollIntoView({from:change.from,to:changeEnd(change)})}var rebased=[];linkedDocs(doc,(function(doc,sharedHist){if(!sharedHist&&indexOf(rebased,doc.history)==-1){rebaseHist(doc.history,change);rebased.push(doc.history)}makeChangeSingleDoc(doc,change,null,mergeOldSpans(doc,change))}))};for(var i$1=event.changes.length-1;i$1>=0;--i$1){var returned=loop(i$1);if(returned)return returned.v}}function shiftDoc(doc,distance){if(distance==0){return}doc.first+=distance;doc.sel=new Selection(map(doc.sel.ranges,(function(range){return new Range(Pos(range.anchor.line+distance,range.anchor.ch),Pos(range.head.line+distance,range.head.ch))})),doc.sel.primIndex);if(doc.cm){regChange(doc.cm,doc.first,doc.first-distance,distance);for(var d=doc.cm.display,l=d.viewFrom;l<d.viewTo;l++){regLineChange(doc.cm,l,"gutter")}}}function makeChangeSingleDoc(doc,change,selAfter,spans){if(doc.cm&&!doc.cm.curOp){return operation(doc.cm,makeChangeSingleDoc)(doc,change,selAfter,spans)}if(change.to.line<doc.first){shiftDoc(doc,change.text.length-1-(change.to.line-change.from.line));return}if(change.from.line>doc.lastLine()){return}if(change.from.line<doc.first){var shift=change.text.length-1-(doc.first-change.from.line);shiftDoc(doc,shift);change={from:Pos(doc.first,0),to:Pos(change.to.line+shift,change.to.ch),text:[lst(change.text)],origin:change.origin}}var last=doc.lastLine();if(change.to.line>last){change={from:change.from,to:Pos(last,getLine(doc,last).text.length),text:[change.text[0]],origin:change.origin}}change.removed=getBetween(doc,change.from,change.to);if(!selAfter){selAfter=computeSelAfterChange(doc,change)}if(doc.cm){makeChangeSingleDocInEditor(doc.cm,change,spans)}else{updateDoc(doc,change,spans)}setSelectionNoUndo(doc,selAfter,sel_dontScroll);if(doc.cantEdit&&skipAtomic(doc,Pos(doc.firstLine(),0))){doc.cantEdit=false}}function makeChangeSingleDocInEditor(cm,change,spans){var doc=cm.doc,display=cm.display,from=change.from,to=change.to;var recomputeMaxLength=false,checkWidthStart=from.line;if(!cm.options.lineWrapping){checkWidthStart=lineNo(visualLine(getLine(doc,from.line)));doc.iter(checkWidthStart,to.line+1,(function(line){if(line==display.maxLine){recomputeMaxLength=true;return true}}))}if(doc.sel.contains(change.from,change.to)>-1){signalCursorActivity(cm)}updateDoc(doc,change,spans,estimateHeight(cm));if(!cm.options.lineWrapping){doc.iter(checkWidthStart,from.line+change.text.length,(function(line){var len=lineLength(line);if(len>display.maxLineLength){display.maxLine=line;display.maxLineLength=len;display.maxLineChanged=true;recomputeMaxLength=false}}));if(recomputeMaxLength){cm.curOp.updateMaxLine=true}}retreatFrontier(doc,from.line);startWorker(cm,400);var lendiff=change.text.length-(to.line-from.line)-1;if(change.full){regChange(cm)}else if(from.line==to.line&&change.text.length==1&&!isWholeLineUpdate(cm.doc,change)){regLineChange(cm,from.line,"text")}else{regChange(cm,from.line,to.line+1,lendiff)}var changesHandler=hasHandler(cm,"changes"),changeHandler=hasHandler(cm,"change");if(changeHandler||changesHandler){var obj={from:from,to:to,text:change.text,removed:change.removed,origin:change.origin};if(changeHandler){signalLater(cm,"change",cm,obj)}if(changesHandler){(cm.curOp.changeObjs||(cm.curOp.changeObjs=[])).push(obj)}}cm.display.selForContextMenu=null}function replaceRange(doc,code,from,to,origin){var assign;if(!to){to=from}if(cmp(to,from)<0){assign=[to,from],from=assign[0],to=assign[1]}if(typeof code=="string"){code=doc.splitLines(code)}makeChange(doc,{from:from,to:to,text:code,origin:origin})}function rebaseHistSelSingle(pos,from,to,diff){if(to<pos.line){pos.line+=diff}else if(from<pos.line){pos.line=from;pos.ch=0}}function rebaseHistArray(array,from,to,diff){for(var i=0;i<array.length;++i){var sub=array[i],ok=true;if(sub.ranges){if(!sub.copied){sub=array[i]=sub.deepCopy();sub.copied=true}for(var j=0;j<sub.ranges.length;j++){rebaseHistSelSingle(sub.ranges[j].anchor,from,to,diff);rebaseHistSelSingle(sub.ranges[j].head,from,to,diff)}continue}for(var j$1=0;j$1<sub.changes.length;++j$1){var cur=sub.changes[j$1];if(to<cur.from.line){cur.from=Pos(cur.from.line+diff,cur.from.ch);cur.to=Pos(cur.to.line+diff,cur.to.ch)}else if(from<=cur.to.line){ok=false;break}}if(!ok){array.splice(0,i+1);i=0}}}function rebaseHist(hist,change){var from=change.from.line,to=change.to.line,diff=change.text.length-(to-from)-1;rebaseHistArray(hist.done,from,to,diff);rebaseHistArray(hist.undone,from,to,diff)}function changeLine(doc,handle,changeType,op){var no=handle,line=handle;if(typeof handle=="number"){line=getLine(doc,clipLine(doc,handle))}else{no=lineNo(handle)}if(no==null){return null}if(op(line,no)&&doc.cm){regLineChange(doc.cm,no,changeType)}return line}function LeafChunk(lines){this.lines=lines;this.parent=null;var height=0;for(var i=0;i<lines.length;++i){lines[i].parent=this;height+=lines[i].height}this.height=height}LeafChunk.prototype={chunkSize:function(){return this.lines.length},removeInner:function(at,n){for(var i=at,e=at+n;i<e;++i){var line=this.lines[i];this.height-=line.height;cleanUpLine(line);signalLater(line,"delete")}this.lines.splice(at,n)},collapse:function(lines){lines.push.apply(lines,this.lines)},insertInner:function(at,lines,height){this.height+=height;this.lines=this.lines.slice(0,at).concat(lines).concat(this.lines.slice(at));for(var i=0;i<lines.length;++i){lines[i].parent=this}},iterN:function(at,n,op){for(var e=at+n;at<e;++at){if(op(this.lines[at])){return true}}}};function BranchChunk(children){this.children=children;var size=0,height=0;for(var i=0;i<children.length;++i){var ch=children[i];size+=ch.chunkSize();height+=ch.height;ch.parent=this}this.size=size;this.height=height;this.parent=null}BranchChunk.prototype={chunkSize:function(){return this.size},removeInner:function(at,n){this.size-=n;for(var i=0;i<this.children.length;++i){var child=this.children[i],sz=child.chunkSize();if(at<sz){var rm=Math.min(n,sz-at),oldHeight=child.height;child.removeInner(at,rm);this.height-=oldHeight-child.height;if(sz==rm){this.children.splice(i--,1);child.parent=null}if((n-=rm)==0){break}at=0}else{at-=sz}}if(this.size-n<25&&(this.children.length>1||!(this.children[0]instanceof LeafChunk))){var lines=[];this.collapse(lines);this.children=[new LeafChunk(lines)];this.children[0].parent=this}},collapse:function(lines){for(var i=0;i<this.children.length;++i){this.children[i].collapse(lines)}},insertInner:function(at,lines,height){this.size+=lines.length;this.height+=height;for(var i=0;i<this.children.length;++i){var child=this.children[i],sz=child.chunkSize();if(at<=sz){child.insertInner(at,lines,height);if(child.lines&&child.lines.length>50){var remaining=child.lines.length%25+25;for(var pos=remaining;pos<child.lines.length;){var leaf=new LeafChunk(child.lines.slice(pos,pos+=25));child.height-=leaf.height;this.children.splice(++i,0,leaf);leaf.parent=this}child.lines=child.lines.slice(0,remaining);this.maybeSpill()}break}at-=sz}},maybeSpill:function(){if(this.children.length<=10){return}var me=this;do{var spilled=me.children.splice(me.children.length-5,5);var sibling=new BranchChunk(spilled);if(!me.parent){var copy=new BranchChunk(me.children);copy.parent=me;me.children=[copy,sibling];me=copy}else{me.size-=sibling.size;me.height-=sibling.height;var myIndex=indexOf(me.parent.children,me);me.parent.children.splice(myIndex+1,0,sibling)}sibling.parent=me.parent}while(me.children.length>10);me.parent.maybeSpill()},iterN:function(at,n,op){for(var i=0;i<this.children.length;++i){var child=this.children[i],sz=child.chunkSize();if(at<sz){var used=Math.min(n,sz-at);if(child.iterN(at,used,op)){return true}if((n-=used)==0){break}at=0}else{at-=sz}}}};var LineWidget=function(doc,node,options){if(options){for(var opt in options){if(options.hasOwnProperty(opt)){this[opt]=options[opt]}}}this.doc=doc;this.node=node};LineWidget.prototype.clear=function(){var cm=this.doc.cm,ws=this.line.widgets,line=this.line,no=lineNo(line);if(no==null||!ws){return}for(var i=0;i<ws.length;++i){if(ws[i]==this){ws.splice(i--,1)}}if(!ws.length){line.widgets=null}var height=widgetHeight(this);updateLineHeight(line,Math.max(0,line.height-height));if(cm){runInOp(cm,(function(){adjustScrollWhenAboveVisible(cm,line,-height);regLineChange(cm,no,"widget")}));signalLater(cm,"lineWidgetCleared",cm,this,no)}};LineWidget.prototype.changed=function(){var this$1=this;var oldH=this.height,cm=this.doc.cm,line=this.line;this.height=null;var diff=widgetHeight(this)-oldH;if(!diff){return}if(!lineIsHidden(this.doc,line)){updateLineHeight(line,line.height+diff)}if(cm){runInOp(cm,(function(){cm.curOp.forceUpdate=true;adjustScrollWhenAboveVisible(cm,line,diff);signalLater(cm,"lineWidgetChanged",cm,this$1,lineNo(line))}))}};eventMixin(LineWidget);function adjustScrollWhenAboveVisible(cm,line,diff){if(heightAtLine(line)<(cm.curOp&&cm.curOp.scrollTop||cm.doc.scrollTop)){addToScrollTop(cm,diff)}}function addLineWidget(doc,handle,node,options){var widget=new LineWidget(doc,node,options);var cm=doc.cm;if(cm&&widget.noHScroll){cm.display.alignWidgets=true}changeLine(doc,handle,"widget",(function(line){var widgets=line.widgets||(line.widgets=[]);if(widget.insertAt==null){widgets.push(widget)}else{widgets.splice(Math.min(widgets.length,Math.max(0,widget.insertAt)),0,widget)}widget.line=line;if(cm&&!lineIsHidden(doc,line)){var aboveVisible=heightAtLine(line)<doc.scrollTop;updateLineHeight(line,line.height+widgetHeight(widget));if(aboveVisible){addToScrollTop(cm,widget.height)}cm.curOp.forceUpdate=true}return true}));if(cm){signalLater(cm,"lineWidgetAdded",cm,widget,typeof handle=="number"?handle:lineNo(handle))}return widget}var nextMarkerId=0;var TextMarker=function(doc,type){this.lines=[];this.type=type;this.doc=doc;this.id=++nextMarkerId};TextMarker.prototype.clear=function(){if(this.explicitlyCleared){return}var cm=this.doc.cm,withOp=cm&&!cm.curOp;if(withOp){startOperation(cm)}if(hasHandler(this,"clear")){var found=this.find();if(found){signalLater(this,"clear",found.from,found.to)}}var min=null,max=null;for(var i=0;i<this.lines.length;++i){var line=this.lines[i];var span=getMarkedSpanFor(line.markedSpans,this);if(cm&&!this.collapsed){regLineChange(cm,lineNo(line),"text")}else if(cm){if(span.to!=null){max=lineNo(line)}if(span.from!=null){min=lineNo(line)}}line.markedSpans=removeMarkedSpan(line.markedSpans,span);if(span.from==null&&this.collapsed&&!lineIsHidden(this.doc,line)&&cm){updateLineHeight(line,textHeight(cm.display))}}if(cm&&this.collapsed&&!cm.options.lineWrapping){for(var i$1=0;i$1<this.lines.length;++i$1){var visual=visualLine(this.lines[i$1]),len=lineLength(visual);if(len>cm.display.maxLineLength){cm.display.maxLine=visual;cm.display.maxLineLength=len;cm.display.maxLineChanged=true}}}if(min!=null&&cm&&this.collapsed){regChange(cm,min,max+1)}this.lines.length=0;this.explicitlyCleared=true;if(this.atomic&&this.doc.cantEdit){this.doc.cantEdit=false;if(cm){reCheckSelection(cm.doc)}}if(cm){signalLater(cm,"markerCleared",cm,this,min,max)}if(withOp){endOperation(cm)}if(this.parent){this.parent.clear()}};TextMarker.prototype.find=function(side,lineObj){if(side==null&&this.type=="bookmark"){side=1}var from,to;for(var i=0;i<this.lines.length;++i){var line=this.lines[i];var span=getMarkedSpanFor(line.markedSpans,this);if(span.from!=null){from=Pos(lineObj?line:lineNo(line),span.from);if(side==-1){return from}}if(span.to!=null){to=Pos(lineObj?line:lineNo(line),span.to);if(side==1){return to}}}return from&&{from:from,to:to}};TextMarker.prototype.changed=function(){var this$1=this;var pos=this.find(-1,true),widget=this,cm=this.doc.cm;if(!pos||!cm){return}runInOp(cm,(function(){var line=pos.line,lineN=lineNo(pos.line);var view=findViewForLine(cm,lineN);if(view){clearLineMeasurementCacheFor(view);cm.curOp.selectionChanged=cm.curOp.forceUpdate=true}cm.curOp.updateMaxLine=true;if(!lineIsHidden(widget.doc,line)&&widget.height!=null){var oldHeight=widget.height;widget.height=null;var dHeight=widgetHeight(widget)-oldHeight;if(dHeight){updateLineHeight(line,line.height+dHeight)}}signalLater(cm,"markerChanged",cm,this$1)}))};TextMarker.prototype.attachLine=function(line){if(!this.lines.length&&this.doc.cm){var op=this.doc.cm.curOp;if(!op.maybeHiddenMarkers||indexOf(op.maybeHiddenMarkers,this)==-1){(op.maybeUnhiddenMarkers||(op.maybeUnhiddenMarkers=[])).push(this)}}this.lines.push(line)};TextMarker.prototype.detachLine=function(line){this.lines.splice(indexOf(this.lines,line),1);if(!this.lines.length&&this.doc.cm){var op=this.doc.cm.curOp;(op.maybeHiddenMarkers||(op.maybeHiddenMarkers=[])).push(this)}};eventMixin(TextMarker);function markText(doc,from,to,options,type){if(options&&options.shared){return markTextShared(doc,from,to,options,type)}if(doc.cm&&!doc.cm.curOp){return operation(doc.cm,markText)(doc,from,to,options,type)}var marker=new TextMarker(doc,type),diff=cmp(from,to);if(options){copyObj(options,marker,false)}if(diff>0||diff==0&&marker.clearWhenEmpty!==false){return marker}if(marker.replacedWith){marker.collapsed=true;marker.widgetNode=eltP("span",[marker.replacedWith],"CodeMirror-widget");if(!options.handleMouseEvents){marker.widgetNode.setAttribute("cm-ignore-events","true")}if(options.insertLeft){marker.widgetNode.insertLeft=true}}if(marker.collapsed){if(conflictingCollapsedRange(doc,from.line,from,to,marker)||from.line!=to.line&&conflictingCollapsedRange(doc,to.line,from,to,marker)){throw new Error("Inserting collapsed marker partially overlapping an existing one")}seeCollapsedSpans()}if(marker.addToHistory){addChangeToHistory(doc,{from:from,to:to,origin:"markText"},doc.sel,NaN)}var curLine=from.line,cm=doc.cm,updateMaxLine;doc.iter(curLine,to.line+1,(function(line){if(cm&&marker.collapsed&&!cm.options.lineWrapping&&visualLine(line)==cm.display.maxLine){updateMaxLine=true}if(marker.collapsed&&curLine!=from.line){updateLineHeight(line,0)}addMarkedSpan(line,new MarkedSpan(marker,curLine==from.line?from.ch:null,curLine==to.line?to.ch:null),doc.cm&&doc.cm.curOp);++curLine}));if(marker.collapsed){doc.iter(from.line,to.line+1,(function(line){if(lineIsHidden(doc,line)){updateLineHeight(line,0)}}))}if(marker.clearOnEnter){on(marker,"beforeCursorEnter",(function(){return marker.clear()}))}if(marker.readOnly){seeReadOnlySpans();if(doc.history.done.length||doc.history.undone.length){doc.clearHistory()}}if(marker.collapsed){marker.id=++nextMarkerId;marker.atomic=true}if(cm){if(updateMaxLine){cm.curOp.updateMaxLine=true}if(marker.collapsed){regChange(cm,from.line,to.line+1)}else if(marker.className||marker.startStyle||marker.endStyle||marker.css||marker.attributes||marker.title){for(var i=from.line;i<=to.line;i++){regLineChange(cm,i,"text")}}if(marker.atomic){reCheckSelection(cm.doc)}signalLater(cm,"markerAdded",cm,marker)}return marker}var SharedTextMarker=function(markers,primary){this.markers=markers;this.primary=primary;for(var i=0;i<markers.length;++i){markers[i].parent=this}};SharedTextMarker.prototype.clear=function(){if(this.explicitlyCleared){return}this.explicitlyCleared=true;for(var i=0;i<this.markers.length;++i){this.markers[i].clear()}signalLater(this,"clear")};SharedTextMarker.prototype.find=function(side,lineObj){return this.primary.find(side,lineObj)};eventMixin(SharedTextMarker);function markTextShared(doc,from,to,options,type){options=copyObj(options);options.shared=false;var markers=[markText(doc,from,to,options,type)],primary=markers[0];var widget=options.widgetNode;linkedDocs(doc,(function(doc){if(widget){options.widgetNode=widget.cloneNode(true)}markers.push(markText(doc,clipPos(doc,from),clipPos(doc,to),options,type));for(var i=0;i<doc.linked.length;++i){if(doc.linked[i].isParent){return}}primary=lst(markers)}));return new SharedTextMarker(markers,primary)}function findSharedMarkers(doc){return doc.findMarks(Pos(doc.first,0),doc.clipPos(Pos(doc.lastLine())),(function(m){return m.parent}))}function copySharedMarkers(doc,markers){for(var i=0;i<markers.length;i++){var marker=markers[i],pos=marker.find();var mFrom=doc.clipPos(pos.from),mTo=doc.clipPos(pos.to);if(cmp(mFrom,mTo)){var subMark=markText(doc,mFrom,mTo,marker.primary,marker.primary.type);marker.markers.push(subMark);subMark.parent=marker}}}function detachSharedMarkers(markers){var loop=function(i){var marker=markers[i],linked=[marker.primary.doc];linkedDocs(marker.primary.doc,(function(d){return linked.push(d)}));for(var j=0;j<marker.markers.length;j++){var subMarker=marker.markers[j];if(indexOf(linked,subMarker.doc)==-1){subMarker.parent=null;marker.markers.splice(j--,1)}}};for(var i=0;i<markers.length;i++)loop(i)}var nextDocId=0;var Doc=function(text,mode,firstLine,lineSep,direction){if(!(this instanceof Doc)){return new Doc(text,mode,firstLine,lineSep,direction)}if(firstLine==null){firstLine=0}BranchChunk.call(this,[new LeafChunk([new Line("",null)])]);this.first=firstLine;this.scrollTop=this.scrollLeft=0;this.cantEdit=false;this.cleanGeneration=1;this.modeFrontier=this.highlightFrontier=firstLine;var start=Pos(firstLine,0);this.sel=simpleSelection(start);this.history=new History(null);this.id=++nextDocId;this.modeOption=mode;this.lineSep=lineSep;this.direction=direction=="rtl"?"rtl":"ltr";this.extend=false;if(typeof text=="string"){text=this.splitLines(text)}updateDoc(this,{from:start,to:start,text:text});setSelection(this,simpleSelection(start),sel_dontScroll)};Doc.prototype=createObj(BranchChunk.prototype,{constructor:Doc,iter:function(from,to,op){if(op){this.iterN(from-this.first,to-from,op)}else{this.iterN(this.first,this.first+this.size,from)}},insert:function(at,lines){var height=0;for(var i=0;i<lines.length;++i){height+=lines[i].height}this.insertInner(at-this.first,lines,height)},remove:function(at,n){this.removeInner(at-this.first,n)},getValue:function(lineSep){var lines=getLines(this,this.first,this.first+this.size);if(lineSep===false){return lines}return lines.join(lineSep||this.lineSeparator())},setValue:docMethodOp((function(code){var top=Pos(this.first,0),last=this.first+this.size-1;makeChange(this,{from:top,to:Pos(last,getLine(this,last).text.length),text:this.splitLines(code),origin:"setValue",full:true},true);if(this.cm){scrollToCoords(this.cm,0,0)}setSelection(this,simpleSelection(top),sel_dontScroll)})),replaceRange:function(code,from,to,origin){from=clipPos(this,from);to=to?clipPos(this,to):from;replaceRange(this,code,from,to,origin)},getRange:function(from,to,lineSep){var lines=getBetween(this,clipPos(this,from),clipPos(this,to));if(lineSep===false){return lines}if(lineSep===""){return lines.join("")}return lines.join(lineSep||this.lineSeparator())},getLine:function(line){var l=this.getLineHandle(line);return l&&l.text},getLineHandle:function(line){if(isLine(this,line)){return getLine(this,line)}},getLineNumber:function(line){return lineNo(line)},getLineHandleVisualStart:function(line){if(typeof line=="number"){line=getLine(this,line)}return visualLine(line)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(pos){return clipPos(this,pos)},getCursor:function(start){var range=this.sel.primary(),pos;if(start==null||start=="head"){pos=range.head}else if(start=="anchor"){pos=range.anchor}else if(start=="end"||start=="to"||start===false){pos=range.to()}else{pos=range.from()}return pos},listSelections:function(){return this.sel.ranges},somethingSelected:function(){return this.sel.somethingSelected()},setCursor:docMethodOp((function(line,ch,options){setSimpleSelection(this,clipPos(this,typeof line=="number"?Pos(line,ch||0):line),null,options)})),setSelection:docMethodOp((function(anchor,head,options){setSimpleSelection(this,clipPos(this,anchor),clipPos(this,head||anchor),options)})),extendSelection:docMethodOp((function(head,other,options){extendSelection(this,clipPos(this,head),other&&clipPos(this,other),options)})),extendSelections:docMethodOp((function(heads,options){extendSelections(this,clipPosArray(this,heads),options)})),extendSelectionsBy:docMethodOp((function(f,options){var heads=map(this.sel.ranges,f);extendSelections(this,clipPosArray(this,heads),options)})),setSelections:docMethodOp((function(ranges,primary,options){if(!ranges.length){return}var out=[];for(var i=0;i<ranges.length;i++){out[i]=new Range(clipPos(this,ranges[i].anchor),clipPos(this,ranges[i].head||ranges[i].anchor))}if(primary==null){primary=Math.min(ranges.length-1,this.sel.primIndex)}setSelection(this,normalizeSelection(this.cm,out,primary),options)})),addSelection:docMethodOp((function(anchor,head,options){var ranges=this.sel.ranges.slice(0);ranges.push(new Range(clipPos(this,anchor),clipPos(this,head||anchor)));setSelection(this,normalizeSelection(this.cm,ranges,ranges.length-1),options)})),getSelection:function(lineSep){var ranges=this.sel.ranges,lines;for(var i=0;i<ranges.length;i++){var sel=getBetween(this,ranges[i].from(),ranges[i].to());lines=lines?lines.concat(sel):sel}if(lineSep===false){return lines}else{return lines.join(lineSep||this.lineSeparator())}},getSelections:function(lineSep){var parts=[],ranges=this.sel.ranges;for(var i=0;i<ranges.length;i++){var sel=getBetween(this,ranges[i].from(),ranges[i].to());if(lineSep!==false){sel=sel.join(lineSep||this.lineSeparator())}parts[i]=sel}return parts},replaceSelection:function(code,collapse,origin){var dup=[];for(var i=0;i<this.sel.ranges.length;i++){dup[i]=code}this.replaceSelections(dup,collapse,origin||"+input")},replaceSelections:docMethodOp((function(code,collapse,origin){var changes=[],sel=this.sel;for(var i=0;i<sel.ranges.length;i++){var range=sel.ranges[i];changes[i]={from:range.from(),to:range.to(),text:this.splitLines(code[i]),origin:origin}}var newSel=collapse&&collapse!="end"&&computeReplacedSel(this,changes,collapse);for(var i$1=changes.length-1;i$1>=0;i$1--){makeChange(this,changes[i$1])}if(newSel){setSelectionReplaceHistory(this,newSel)}else if(this.cm){ensureCursorVisible(this.cm)}})),undo:docMethodOp((function(){makeChangeFromHistory(this,"undo")})),redo:docMethodOp((function(){makeChangeFromHistory(this,"redo")})),undoSelection:docMethodOp((function(){makeChangeFromHistory(this,"undo",true)})),redoSelection:docMethodOp((function(){makeChangeFromHistory(this,"redo",true)})),setExtending:function(val){this.extend=val},getExtending:function(){return this.extend},historySize:function(){var hist=this.history,done=0,undone=0;for(var i=0;i<hist.done.length;i++){if(!hist.done[i].ranges){++done}}for(var i$1=0;i$1<hist.undone.length;i$1++){if(!hist.undone[i$1].ranges){++undone}}return{undo:done,redo:undone}},clearHistory:function(){var this$1=this;this.history=new History(this.history);linkedDocs(this,(function(doc){return doc.history=this$1.history}),true)},markClean:function(){this.cleanGeneration=this.changeGeneration(true)},changeGeneration:function(forceSplit){if(forceSplit){this.history.lastOp=this.history.lastSelOp=this.history.lastOrigin=null}return this.history.generation},isClean:function(gen){return this.history.generation==(gen||this.cleanGeneration)},getHistory:function(){return{done:copyHistoryArray(this.history.done),undone:copyHistoryArray(this.history.undone)}},setHistory:function(histData){var hist=this.history=new History(this.history);hist.done=copyHistoryArray(histData.done.slice(0),null,true);hist.undone=copyHistoryArray(histData.undone.slice(0),null,true)},setGutterMarker:docMethodOp((function(line,gutterID,value){return changeLine(this,line,"gutter",(function(line){var markers=line.gutterMarkers||(line.gutterMarkers={});markers[gutterID]=value;if(!value&&isEmpty(markers)){line.gutterMarkers=null}return true}))})),clearGutter:docMethodOp((function(gutterID){var this$1=this;this.iter((function(line){if(line.gutterMarkers&&line.gutterMarkers[gutterID]){changeLine(this$1,line,"gutter",(function(){line.gutterMarkers[gutterID]=null;if(isEmpty(line.gutterMarkers)){line.gutterMarkers=null}return true}))}}))})),lineInfo:function(line){var n;if(typeof line=="number"){if(!isLine(this,line)){return null}n=line;line=getLine(this,line);if(!line){return null}}else{n=lineNo(line);if(n==null){return null}}return{line:n,handle:line,text:line.text,gutterMarkers:line.gutterMarkers,textClass:line.textClass,bgClass:line.bgClass,wrapClass:line.wrapClass,widgets:line.widgets}},addLineClass:docMethodOp((function(handle,where,cls){return changeLine(this,handle,where=="gutter"?"gutter":"class",(function(line){var prop=where=="text"?"textClass":where=="background"?"bgClass":where=="gutter"?"gutterClass":"wrapClass";if(!line[prop]){line[prop]=cls}else if(classTest(cls).test(line[prop])){return false}else{line[prop]+=" "+cls}return true}))})),removeLineClass:docMethodOp((function(handle,where,cls){return changeLine(this,handle,where=="gutter"?"gutter":"class",(function(line){var prop=where=="text"?"textClass":where=="background"?"bgClass":where=="gutter"?"gutterClass":"wrapClass";var cur=line[prop];if(!cur){return false}else if(cls==null){line[prop]=null}else{var found=cur.match(classTest(cls));if(!found){return false}var end=found.index+found[0].length;line[prop]=cur.slice(0,found.index)+(!found.index||end==cur.length?"":" ")+cur.slice(end)||null}return true}))})),addLineWidget:docMethodOp((function(handle,node,options){return addLineWidget(this,handle,node,options)})),removeLineWidget:function(widget){widget.clear()},markText:function(from,to,options){return markText(this,clipPos(this,from),clipPos(this,to),options,options&&options.type||"range")},setBookmark:function(pos,options){var realOpts={replacedWith:options&&(options.nodeType==null?options.widget:options),insertLeft:options&&options.insertLeft,clearWhenEmpty:false,shared:options&&options.shared,handleMouseEvents:options&&options.handleMouseEvents};pos=clipPos(this,pos);return markText(this,pos,pos,realOpts,"bookmark")},findMarksAt:function(pos){pos=clipPos(this,pos);var markers=[],spans=getLine(this,pos.line).markedSpans;if(spans){for(var i=0;i<spans.length;++i){var span=spans[i];if((span.from==null||span.from<=pos.ch)&&(span.to==null||span.to>=pos.ch)){markers.push(span.marker.parent||span.marker)}}}return markers},findMarks:function(from,to,filter){from=clipPos(this,from);to=clipPos(this,to);var found=[],lineNo=from.line;this.iter(from.line,to.line+1,(function(line){var spans=line.markedSpans;if(spans){for(var i=0;i<spans.length;i++){var span=spans[i];if(!(span.to!=null&&lineNo==from.line&&from.ch>=span.to||span.from==null&&lineNo!=from.line||span.from!=null&&lineNo==to.line&&span.from>=to.ch)&&(!filter||filter(span.marker))){found.push(span.marker.parent||span.marker)}}}++lineNo}));return found},getAllMarks:function(){var markers=[];this.iter((function(line){var sps=line.markedSpans;if(sps){for(var i=0;i<sps.length;++i){if(sps[i].from!=null){markers.push(sps[i].marker)}}}}));return markers},posFromIndex:function(off){var ch,lineNo=this.first,sepSize=this.lineSeparator().length;this.iter((function(line){var sz=line.text.length+sepSize;if(sz>off){ch=off;return true}off-=sz;++lineNo}));return clipPos(this,Pos(lineNo,ch))},indexFromPos:function(coords){coords=clipPos(this,coords);var index=coords.ch;if(coords.line<this.first||coords.ch<0){return 0}var sepSize=this.lineSeparator().length;this.iter(this.first,coords.line,(function(line){index+=line.text.length+sepSize}));return index},copy:function(copyHistory){var doc=new Doc(getLines(this,this.first,this.first+this.size),this.modeOption,this.first,this.lineSep,this.direction);doc.scrollTop=this.scrollTop;doc.scrollLeft=this.scrollLeft;doc.sel=this.sel;doc.extend=false;if(copyHistory){doc.history.undoDepth=this.history.undoDepth;doc.setHistory(this.getHistory())}return doc},linkedDoc:function(options){if(!options){options={}}var from=this.first,to=this.first+this.size;if(options.from!=null&&options.from>from){from=options.from}if(options.to!=null&&options.to<to){to=options.to}var copy=new Doc(getLines(this,from,to),options.mode||this.modeOption,from,this.lineSep,this.direction);if(options.sharedHist){copy.history=this.history}(this.linked||(this.linked=[])).push({doc:copy,sharedHist:options.sharedHist});copy.linked=[{doc:this,isParent:true,sharedHist:options.sharedHist}];copySharedMarkers(copy,findSharedMarkers(this));return copy},unlinkDoc:function(other){if(other instanceof CodeMirror){other=other.doc}if(this.linked){for(var i=0;i<this.linked.length;++i){var link=this.linked[i];if(link.doc!=other){continue}this.linked.splice(i,1);other.unlinkDoc(this);detachSharedMarkers(findSharedMarkers(this));break}}if(other.history==this.history){var splitIds=[other.id];linkedDocs(other,(function(doc){return splitIds.push(doc.id)}),true);other.history=new History(null);other.history.done=copyHistoryArray(this.history.done,splitIds);other.history.undone=copyHistoryArray(this.history.undone,splitIds)}},iterLinkedDocs:function(f){linkedDocs(this,f)},getMode:function(){return this.mode},getEditor:function(){return this.cm},splitLines:function(str){if(this.lineSep){return str.split(this.lineSep)}return splitLinesAuto(str)},lineSeparator:function(){return this.lineSep||"\n"},setDirection:docMethodOp((function(dir){if(dir!="rtl"){dir="ltr"}if(dir==this.direction){return}this.direction=dir;this.iter((function(line){return line.order=null}));if(this.cm){directionChanged(this.cm)}}))});Doc.prototype.eachLine=Doc.prototype.iter;var lastDrop=0;function onDrop(e){var cm=this;clearDragCursor(cm);if(signalDOMEvent(cm,e)||eventInWidget(cm.display,e)){return}e_preventDefault(e);if(ie){lastDrop=+new Date}var pos=posFromMouse(cm,e,true),files=e.dataTransfer.files;if(!pos||cm.isReadOnly()){return}if(files&&files.length&&window.FileReader&&window.File){var n=files.length,text=Array(n),read=0;var markAsReadAndPasteIfAllFilesAreRead=function(){if(++read==n){operation(cm,(function(){pos=clipPos(cm.doc,pos);var change={from:pos,to:pos,text:cm.doc.splitLines(text.filter((function(t){return t!=null})).join(cm.doc.lineSeparator())),origin:"paste"};makeChange(cm.doc,change);setSelectionReplaceHistory(cm.doc,simpleSelection(clipPos(cm.doc,pos),clipPos(cm.doc,changeEnd(change))))}))()}};var readTextFromFile=function(file,i){if(cm.options.allowDropFileTypes&&indexOf(cm.options.allowDropFileTypes,file.type)==-1){markAsReadAndPasteIfAllFilesAreRead();return}var reader=new FileReader;reader.onerror=function(){return markAsReadAndPasteIfAllFilesAreRead()};reader.onload=function(){var content=reader.result;if(/[\x00-\x08\x0e-\x1f]{2}/.test(content)){markAsReadAndPasteIfAllFilesAreRead();return}text[i]=content;markAsReadAndPasteIfAllFilesAreRead()};reader.readAsText(file)};for(var i=0;i<files.length;i++){readTextFromFile(files[i],i)}}else{if(cm.state.draggingText&&cm.doc.sel.contains(pos)>-1){cm.state.draggingText(e);setTimeout((function(){return cm.display.input.focus()}),20);return}try{var text$1=e.dataTransfer.getData("Text");if(text$1){var selected;if(cm.state.draggingText&&!cm.state.draggingText.copy){selected=cm.listSelections()}setSelectionNoUndo(cm.doc,simpleSelection(pos,pos));if(selected){for(var i$1=0;i$1<selected.length;++i$1){replaceRange(cm.doc,"",selected[i$1].anchor,selected[i$1].head,"drag")}}cm.replaceSelection(text$1,"around","paste");cm.display.input.focus()}}catch(e$1){}}}function onDragStart(cm,e){if(ie&&(!cm.state.draggingText||+new Date-lastDrop<100)){e_stop(e);return}if(signalDOMEvent(cm,e)||eventInWidget(cm.display,e)){return}e.dataTransfer.setData("Text",cm.getSelection());e.dataTransfer.effectAllowed="copyMove";if(e.dataTransfer.setDragImage&&!safari){var img=elt("img",null,null,"position: fixed; left: 0; top: 0;");img.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==";if(presto){img.width=img.height=1;cm.display.wrapper.appendChild(img);img._top=img.offsetTop}e.dataTransfer.setDragImage(img,0,0);if(presto){img.parentNode.removeChild(img)}}}function onDragOver(cm,e){var pos=posFromMouse(cm,e);if(!pos){return}var frag=document.createDocumentFragment();drawSelectionCursor(cm,pos,frag);if(!cm.display.dragCursor){cm.display.dragCursor=elt("div",null,"CodeMirror-cursors CodeMirror-dragcursors");cm.display.lineSpace.insertBefore(cm.display.dragCursor,cm.display.cursorDiv)}removeChildrenAndAdd(cm.display.dragCursor,frag)}function clearDragCursor(cm){if(cm.display.dragCursor){cm.display.lineSpace.removeChild(cm.display.dragCursor);cm.display.dragCursor=null}}function forEachCodeMirror(f){if(!document.getElementsByClassName){return}var byClass=document.getElementsByClassName("CodeMirror"),editors=[];for(var i=0;i<byClass.length;i++){var cm=byClass[i].CodeMirror;if(cm){editors.push(cm)}}if(editors.length){editors[0].operation((function(){for(var i=0;i<editors.length;i++){f(editors[i])}}))}}var globalsRegistered=false;function ensureGlobalHandlers(){if(globalsRegistered){return}registerGlobalHandlers();globalsRegistered=true}function registerGlobalHandlers(){var resizeTimer;on(window,"resize",(function(){if(resizeTimer==null){resizeTimer=setTimeout((function(){resizeTimer=null;forEachCodeMirror(onResize)}),100)}}));on(window,"blur",(function(){return forEachCodeMirror(onBlur)}))}function onResize(cm){var d=cm.display;d.cachedCharWidth=d.cachedTextHeight=d.cachedPaddingH=null;d.scrollbarsClipped=false;cm.setSize()}var keyNames={3:"Pause",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",61:"=",91:"Mod",92:"Mod",93:"Mod",106:"*",107:"=",109:"-",110:".",111:"/",145:"ScrollLock",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",224:"Mod",63232:"Up",63233:"Down",63234:"Left",63235:"Right",63272:"Delete",63273:"Home",63275:"End",63276:"PageUp",63277:"PageDown",63302:"Insert"};for(var i=0;i<10;i++){keyNames[i+48]=keyNames[i+96]=String(i)}for(var i$1=65;i$1<=90;i$1++){keyNames[i$1]=String.fromCharCode(i$1)}for(var i$2=1;i$2<=12;i$2++){keyNames[i$2+111]=keyNames[i$2+63235]="F"+i$2}var keyMap={};keyMap.basic={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore","Shift-Backspace":"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite",Esc:"singleSelection"};keyMap.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Up":"goLineUp","Ctrl-Down":"goLineDown","Ctrl-Left":"goGroupLeft","Ctrl-Right":"goGroupRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delGroupBefore","Ctrl-Delete":"delGroupAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore","Ctrl-U":"undoSelection","Shift-Ctrl-U":"redoSelection","Alt-U":"redoSelection",fallthrough:"basic"};keyMap.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars","Ctrl-O":"openLine"};keyMap.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Home":"goDocStart","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Left":"goLineLeft","Cmd-Right":"goLineRight","Alt-Backspace":"delGroupBefore","Ctrl-Alt-Backspace":"delGroupAfter","Alt-Delete":"delGroupAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore","Cmd-Backspace":"delWrappedLineLeft","Cmd-Delete":"delWrappedLineRight","Cmd-U":"undoSelection","Shift-Cmd-U":"redoSelection","Ctrl-Up":"goDocStart","Ctrl-Down":"goDocEnd",fallthrough:["basic","emacsy"]};keyMap["default"]=mac?keyMap.macDefault:keyMap.pcDefault;function normalizeKeyName(name){var parts=name.split(/-(?!$)/);name=parts[parts.length-1];var alt,ctrl,shift,cmd;for(var i=0;i<parts.length-1;i++){var mod=parts[i];if(/^(cmd|meta|m)$/i.test(mod)){cmd=true}else if(/^a(lt)?$/i.test(mod)){alt=true}else if(/^(c|ctrl|control)$/i.test(mod)){ctrl=true}else if(/^s(hift)?$/i.test(mod)){shift=true}else{throw new Error("Unrecognized modifier name: "+mod)}}if(alt){name="Alt-"+name}if(ctrl){name="Ctrl-"+name}if(cmd){name="Cmd-"+name}if(shift){name="Shift-"+name}return name}function normalizeKeyMap(keymap){var copy={};for(var keyname in keymap){if(keymap.hasOwnProperty(keyname)){var value=keymap[keyname];if(/^(name|fallthrough|(de|at)tach)$/.test(keyname)){continue}if(value=="..."){delete keymap[keyname];continue}var keys=map(keyname.split(" "),normalizeKeyName);for(var i=0;i<keys.length;i++){var val=void 0,name=void 0;if(i==keys.length-1){name=keys.join(" ");val=value}else{name=keys.slice(0,i+1).join(" ");val="..."}var prev=copy[name];if(!prev){copy[name]=val}else if(prev!=val){throw new Error("Inconsistent bindings for "+name)}}delete keymap[keyname]}}for(var prop in copy){keymap[prop]=copy[prop]}return keymap}function lookupKey(key,map,handle,context){map=getKeyMap(map);var found=map.call?map.call(key,context):map[key];if(found===false){return"nothing"}if(found==="..."){return"multi"}if(found!=null&&handle(found)){return"handled"}if(map.fallthrough){if(Object.prototype.toString.call(map.fallthrough)!="[object Array]"){return lookupKey(key,map.fallthrough,handle,context)}for(var i=0;i<map.fallthrough.length;i++){var result=lookupKey(key,map.fallthrough[i],handle,context);if(result){return result}}}}function isModifierKey(value){var name=typeof value=="string"?value:keyNames[value.keyCode];return name=="Ctrl"||name=="Alt"||name=="Shift"||name=="Mod"}function addModifierNames(name,event,noShift){var base=name;if(event.altKey&&base!="Alt"){name="Alt-"+name}if((flipCtrlCmd?event.metaKey:event.ctrlKey)&&base!="Ctrl"){name="Ctrl-"+name}if((flipCtrlCmd?event.ctrlKey:event.metaKey)&&base!="Mod"){name="Cmd-"+name}if(!noShift&&event.shiftKey&&base!="Shift"){name="Shift-"+name}return name}function keyName(event,noShift){if(presto&&event.keyCode==34&&event["char"]){return false}var name=keyNames[event.keyCode];if(name==null||event.altGraphKey){return false}if(event.keyCode==3&&event.code){name=event.code}return addModifierNames(name,event,noShift)}function getKeyMap(val){return typeof val=="string"?keyMap[val]:val}function deleteNearSelection(cm,compute){var ranges=cm.doc.sel.ranges,kill=[];for(var i=0;i<ranges.length;i++){var toKill=compute(ranges[i]);while(kill.length&&cmp(toKill.from,lst(kill).to)<=0){var replaced=kill.pop();if(cmp(replaced.from,toKill.from)<0){toKill.from=replaced.from;break}}kill.push(toKill)}runInOp(cm,(function(){for(var i=kill.length-1;i>=0;i--){replaceRange(cm.doc,"",kill[i].from,kill[i].to,"+delete")}ensureCursorVisible(cm)}))}function moveCharLogically(line,ch,dir){var target=skipExtendingChars(line.text,ch+dir,dir);return target<0||target>line.text.length?null:target}function moveLogically(line,start,dir){var ch=moveCharLogically(line,start.ch,dir);return ch==null?null:new Pos(start.line,ch,dir<0?"after":"before")}function endOfLine(visually,cm,lineObj,lineNo,dir){if(visually){if(cm.doc.direction=="rtl"){dir=-dir}var order=getOrder(lineObj,cm.doc.direction);if(order){var part=dir<0?lst(order):order[0];var moveInStorageOrder=dir<0==(part.level==1);var sticky=moveInStorageOrder?"after":"before";var ch;if(part.level>0||cm.doc.direction=="rtl"){var prep=prepareMeasureForLine(cm,lineObj);ch=dir<0?lineObj.text.length-1:0;var targetTop=measureCharPrepared(cm,prep,ch).top;ch=findFirst((function(ch){return measureCharPrepared(cm,prep,ch).top==targetTop}),dir<0==(part.level==1)?part.from:part.to-1,ch);if(sticky=="before"){ch=moveCharLogically(lineObj,ch,1)}}else{ch=dir<0?part.to:part.from}return new Pos(lineNo,ch,sticky)}}return new Pos(lineNo,dir<0?lineObj.text.length:0,dir<0?"before":"after")}function moveVisually(cm,line,start,dir){var bidi=getOrder(line,cm.doc.direction);if(!bidi){return moveLogically(line,start,dir)}if(start.ch>=line.text.length){start.ch=line.text.length;start.sticky="before"}else if(start.ch<=0){start.ch=0;start.sticky="after"}var partPos=getBidiPartAt(bidi,start.ch,start.sticky),part=bidi[partPos];if(cm.doc.direction=="ltr"&&part.level%2==0&&(dir>0?part.to>start.ch:part.from<start.ch)){return moveLogically(line,start,dir)}var mv=function(pos,dir){return moveCharLogically(line,pos instanceof Pos?pos.ch:pos,dir)};var prep;var getWrappedLineExtent=function(ch){if(!cm.options.lineWrapping){return{begin:0,end:line.text.length}}prep=prep||prepareMeasureForLine(cm,line);return wrappedLineExtentChar(cm,line,prep,ch)};var wrappedLineExtent=getWrappedLineExtent(start.sticky=="before"?mv(start,-1):start.ch);if(cm.doc.direction=="rtl"||part.level==1){var moveInStorageOrder=part.level==1==dir<0;var ch=mv(start,moveInStorageOrder?1:-1);if(ch!=null&&(!moveInStorageOrder?ch>=part.from&&ch>=wrappedLineExtent.begin:ch<=part.to&&ch<=wrappedLineExtent.end)){var sticky=moveInStorageOrder?"before":"after";return new Pos(start.line,ch,sticky)}}var searchInVisualLine=function(partPos,dir,wrappedLineExtent){var getRes=function(ch,moveInStorageOrder){return moveInStorageOrder?new Pos(start.line,mv(ch,1),"before"):new Pos(start.line,ch,"after")};for(;partPos>=0&&partPos<bidi.length;partPos+=dir){var part=bidi[partPos];var moveInStorageOrder=dir>0==(part.level!=1);var ch=moveInStorageOrder?wrappedLineExtent.begin:mv(wrappedLineExtent.end,-1);if(part.from<=ch&&ch<part.to){return getRes(ch,moveInStorageOrder)}ch=moveInStorageOrder?part.from:mv(part.to,-1);if(wrappedLineExtent.begin<=ch&&ch<wrappedLineExtent.end){return getRes(ch,moveInStorageOrder)}}};var res=searchInVisualLine(partPos+dir,dir,wrappedLineExtent);if(res){return res}var nextCh=dir>0?wrappedLineExtent.end:mv(wrappedLineExtent.begin,-1);if(nextCh!=null&&!(dir>0&&nextCh==line.text.length)){res=searchInVisualLine(dir>0?0:bidi.length-1,dir,getWrappedLineExtent(nextCh));if(res){return res}}return null}var commands={selectAll:selectAll,singleSelection:function(cm){return cm.setSelection(cm.getCursor("anchor"),cm.getCursor("head"),sel_dontScroll)},killLine:function(cm){return deleteNearSelection(cm,(function(range){if(range.empty()){var len=getLine(cm.doc,range.head.line).text.length;if(range.head.ch==len&&range.head.line<cm.lastLine()){return{from:range.head,to:Pos(range.head.line+1,0)}}else{return{from:range.head,to:Pos(range.head.line,len)}}}else{return{from:range.from(),to:range.to()}}}))},deleteLine:function(cm){return deleteNearSelection(cm,(function(range){return{from:Pos(range.from().line,0),to:clipPos(cm.doc,Pos(range.to().line+1,0))}}))},delLineLeft:function(cm){return deleteNearSelection(cm,(function(range){return{from:Pos(range.from().line,0),to:range.from()}}))},delWrappedLineLeft:function(cm){return deleteNearSelection(cm,(function(range){var top=cm.charCoords(range.head,"div").top+5;var leftPos=cm.coordsChar({left:0,top:top},"div");return{from:leftPos,to:range.from()}}))},delWrappedLineRight:function(cm){return deleteNearSelection(cm,(function(range){var top=cm.charCoords(range.head,"div").top+5;var rightPos=cm.coordsChar({left:cm.display.lineDiv.offsetWidth+100,top:top},"div");return{from:range.from(),to:rightPos}}))},undo:function(cm){return cm.undo()},redo:function(cm){return cm.redo()},undoSelection:function(cm){return cm.undoSelection()},redoSelection:function(cm){return cm.redoSelection()},goDocStart:function(cm){return cm.extendSelection(Pos(cm.firstLine(),0))},goDocEnd:function(cm){return cm.extendSelection(Pos(cm.lastLine()))},goLineStart:function(cm){return cm.extendSelectionsBy((function(range){return lineStart(cm,range.head.line)}),{origin:"+move",bias:1})},goLineStartSmart:function(cm){return cm.extendSelectionsBy((function(range){return lineStartSmart(cm,range.head)}),{origin:"+move",bias:1})},goLineEnd:function(cm){return cm.extendSelectionsBy((function(range){return lineEnd(cm,range.head.line)}),{origin:"+move",bias:-1})},goLineRight:function(cm){return cm.extendSelectionsBy((function(range){var top=cm.cursorCoords(range.head,"div").top+5;return cm.coordsChar({left:cm.display.lineDiv.offsetWidth+100,top:top},"div")}),sel_move)},goLineLeft:function(cm){return cm.extendSelectionsBy((function(range){var top=cm.cursorCoords(range.head,"div").top+5;return cm.coordsChar({left:0,top:top},"div")}),sel_move)},goLineLeftSmart:function(cm){return cm.extendSelectionsBy((function(range){var top=cm.cursorCoords(range.head,"div").top+5;var pos=cm.coordsChar({left:0,top:top},"div");if(pos.ch<cm.getLine(pos.line).search(/\S/)){return lineStartSmart(cm,range.head)}return pos}),sel_move)},goLineUp:function(cm){return cm.moveV(-1,"line")},goLineDown:function(cm){return cm.moveV(1,"line")},goPageUp:function(cm){return cm.moveV(-1,"page")},goPageDown:function(cm){return cm.moveV(1,"page")},goCharLeft:function(cm){return cm.moveH(-1,"char")},goCharRight:function(cm){return cm.moveH(1,"char")},goColumnLeft:function(cm){return cm.moveH(-1,"column")},goColumnRight:function(cm){return cm.moveH(1,"column")},goWordLeft:function(cm){return cm.moveH(-1,"word")},goGroupRight:function(cm){return cm.moveH(1,"group")},goGroupLeft:function(cm){return cm.moveH(-1,"group")},goWordRight:function(cm){return cm.moveH(1,"word")},delCharBefore:function(cm){return cm.deleteH(-1,"codepoint")},delCharAfter:function(cm){return cm.deleteH(1,"char")},delWordBefore:function(cm){return cm.deleteH(-1,"word")},delWordAfter:function(cm){return cm.deleteH(1,"word")},delGroupBefore:function(cm){return cm.deleteH(-1,"group")},delGroupAfter:function(cm){return cm.deleteH(1,"group")},indentAuto:function(cm){return cm.indentSelection("smart")},indentMore:function(cm){return cm.indentSelection("add")},indentLess:function(cm){return cm.indentSelection("subtract")},insertTab:function(cm){return cm.replaceSelection("\t")},insertSoftTab:function(cm){var spaces=[],ranges=cm.listSelections(),tabSize=cm.options.tabSize;for(var i=0;i<ranges.length;i++){var pos=ranges[i].from();var col=countColumn(cm.getLine(pos.line),pos.ch,tabSize);spaces.push(spaceStr(tabSize-col%tabSize))}cm.replaceSelections(spaces)},defaultTab:function(cm){if(cm.somethingSelected()){cm.indentSelection("add")}else{cm.execCommand("insertTab")}},transposeChars:function(cm){return runInOp(cm,(function(){var ranges=cm.listSelections(),newSel=[];for(var i=0;i<ranges.length;i++){if(!ranges[i].empty()){continue}var cur=ranges[i].head,line=getLine(cm.doc,cur.line).text;if(line){if(cur.ch==line.length){cur=new Pos(cur.line,cur.ch-1)}if(cur.ch>0){cur=new Pos(cur.line,cur.ch+1);cm.replaceRange(line.charAt(cur.ch-1)+line.charAt(cur.ch-2),Pos(cur.line,cur.ch-2),cur,"+transpose")}else if(cur.line>cm.doc.first){var prev=getLine(cm.doc,cur.line-1).text;if(prev){cur=new Pos(cur.line,1);cm.replaceRange(line.charAt(0)+cm.doc.lineSeparator()+prev.charAt(prev.length-1),Pos(cur.line-1,prev.length-1),cur,"+transpose")}}}newSel.push(new Range(cur,cur))}cm.setSelections(newSel)}))},newlineAndIndent:function(cm){return runInOp(cm,(function(){var sels=cm.listSelections();for(var i=sels.length-1;i>=0;i--){cm.replaceRange(cm.doc.lineSeparator(),sels[i].anchor,sels[i].head,"+input")}sels=cm.listSelections();for(var i$1=0;i$1<sels.length;i$1++){cm.indentLine(sels[i$1].from().line,null,true)}ensureCursorVisible(cm)}))},openLine:function(cm){return cm.replaceSelection("\n","start")},toggleOverwrite:function(cm){return cm.toggleOverwrite()}};function lineStart(cm,lineN){var line=getLine(cm.doc,lineN);var visual=visualLine(line);if(visual!=line){lineN=lineNo(visual)}return endOfLine(true,cm,visual,lineN,1)}function lineEnd(cm,lineN){var line=getLine(cm.doc,lineN);var visual=visualLineEnd(line);if(visual!=line){lineN=lineNo(visual)}return endOfLine(true,cm,line,lineN,-1)}function lineStartSmart(cm,pos){var start=lineStart(cm,pos.line);var line=getLine(cm.doc,start.line);var order=getOrder(line,cm.doc.direction);if(!order||order[0].level==0){var firstNonWS=Math.max(start.ch,line.text.search(/\S/));var inWS=pos.line==start.line&&pos.ch<=firstNonWS&&pos.ch;return Pos(start.line,inWS?0:firstNonWS,start.sticky)}return start}function doHandleBinding(cm,bound,dropShift){if(typeof bound=="string"){bound=commands[bound];if(!bound){return false}}cm.display.input.ensurePolled();var prevShift=cm.display.shift,done=false;try{if(cm.isReadOnly()){cm.state.suppressEdits=true}if(dropShift){cm.display.shift=false}done=bound(cm)!=Pass}finally{cm.display.shift=prevShift;cm.state.suppressEdits=false}return done}function lookupKeyForEditor(cm,name,handle){for(var i=0;i<cm.state.keyMaps.length;i++){var result=lookupKey(name,cm.state.keyMaps[i],handle,cm);if(result){return result}}return cm.options.extraKeys&&lookupKey(name,cm.options.extraKeys,handle,cm)||lookupKey(name,cm.options.keyMap,handle,cm)}var stopSeq=new Delayed;function dispatchKey(cm,name,e,handle){var seq=cm.state.keySeq;if(seq){if(isModifierKey(name)){return"handled"}if(/\'$/.test(name)){cm.state.keySeq=null}else{stopSeq.set(50,(function(){if(cm.state.keySeq==seq){cm.state.keySeq=null;cm.display.input.reset()}}))}if(dispatchKeyInner(cm,seq+" "+name,e,handle)){return true}}return dispatchKeyInner(cm,name,e,handle)}function dispatchKeyInner(cm,name,e,handle){var result=lookupKeyForEditor(cm,name,handle);if(result=="multi"){cm.state.keySeq=name}if(result=="handled"){signalLater(cm,"keyHandled",cm,name,e)}if(result=="handled"||result=="multi"){e_preventDefault(e);restartBlink(cm)}return!!result}function handleKeyBinding(cm,e){var name=keyName(e,true);if(!name){return false}if(e.shiftKey&&!cm.state.keySeq){return dispatchKey(cm,"Shift-"+name,e,(function(b){return doHandleBinding(cm,b,true)}))||dispatchKey(cm,name,e,(function(b){if(typeof b=="string"?/^go[A-Z]/.test(b):b.motion){return doHandleBinding(cm,b)}}))}else{return dispatchKey(cm,name,e,(function(b){return doHandleBinding(cm,b)}))}}function handleCharBinding(cm,e,ch){return dispatchKey(cm,"'"+ch+"'",e,(function(b){return doHandleBinding(cm,b,true)}))}var lastStoppedKey=null;function onKeyDown(e){var cm=this;if(e.target&&e.target!=cm.display.input.getField()){return}cm.curOp.focus=activeElt(doc(cm));if(signalDOMEvent(cm,e)){return}if(ie&&ie_version<11&&e.keyCode==27){e.returnValue=false}var code=e.keyCode;cm.display.shift=code==16||e.shiftKey;var handled=handleKeyBinding(cm,e);if(presto){lastStoppedKey=handled?code:null;if(!handled&&code==88&&!hasCopyEvent&&(mac?e.metaKey:e.ctrlKey)){cm.replaceSelection("",null,"cut")}}if(gecko&&!mac&&!handled&&code==46&&e.shiftKey&&!e.ctrlKey&&document.execCommand){document.execCommand("cut")}if(code==18&&!/\bCodeMirror-crosshair\b/.test(cm.display.lineDiv.className)){showCrossHair(cm)}}function showCrossHair(cm){var lineDiv=cm.display.lineDiv;addClass(lineDiv,"CodeMirror-crosshair");function up(e){if(e.keyCode==18||!e.altKey){rmClass(lineDiv,"CodeMirror-crosshair");off(document,"keyup",up);off(document,"mouseover",up)}}on(document,"keyup",up);on(document,"mouseover",up)}function onKeyUp(e){if(e.keyCode==16){this.doc.sel.shift=false}signalDOMEvent(this,e)}function onKeyPress(e){var cm=this;if(e.target&&e.target!=cm.display.input.getField()){return}if(eventInWidget(cm.display,e)||signalDOMEvent(cm,e)||e.ctrlKey&&!e.altKey||mac&&e.metaKey){return}var keyCode=e.keyCode,charCode=e.charCode;if(presto&&keyCode==lastStoppedKey){lastStoppedKey=null;e_preventDefault(e);return}if(presto&&(!e.which||e.which<10)&&handleKeyBinding(cm,e)){return}var ch=String.fromCharCode(charCode==null?keyCode:charCode);if(ch=="\b"){return}if(handleCharBinding(cm,e,ch)){return}cm.display.input.onKeyPress(e)}var DOUBLECLICK_DELAY=400;var PastClick=function(time,pos,button){this.time=time;this.pos=pos;this.button=button};PastClick.prototype.compare=function(time,pos,button){return this.time+DOUBLECLICK_DELAY>time&&cmp(pos,this.pos)==0&&button==this.button};var lastClick,lastDoubleClick;function clickRepeat(pos,button){var now=+new Date;if(lastDoubleClick&&lastDoubleClick.compare(now,pos,button)){lastClick=lastDoubleClick=null;return"triple"}else if(lastClick&&lastClick.compare(now,pos,button)){lastDoubleClick=new PastClick(now,pos,button);lastClick=null;return"double"}else{lastClick=new PastClick(now,pos,button);lastDoubleClick=null;return"single"}}function onMouseDown(e){var cm=this,display=cm.display;if(signalDOMEvent(cm,e)||display.activeTouch&&display.input.supportsTouch()){return}display.input.ensurePolled();display.shift=e.shiftKey;if(eventInWidget(display,e)){if(!webkit){display.scroller.draggable=false;setTimeout((function(){return display.scroller.draggable=true}),100)}return}if(clickInGutter(cm,e)){return}var pos=posFromMouse(cm,e),button=e_button(e),repeat=pos?clickRepeat(pos,button):"single";win(cm).focus();if(button==1&&cm.state.selectingText){cm.state.selectingText(e)}if(pos&&handleMappedButton(cm,button,pos,repeat,e)){return}if(button==1){if(pos){leftButtonDown(cm,pos,repeat,e)}else if(e_target(e)==display.scroller){e_preventDefault(e)}}else if(button==2){if(pos){extendSelection(cm.doc,pos)}setTimeout((function(){return display.input.focus()}),20)}else if(button==3){if(captureRightClick){cm.display.input.onContextMenu(e)}else{delayBlurEvent(cm)}}}function handleMappedButton(cm,button,pos,repeat,event){var name="Click";if(repeat=="double"){name="Double"+name}else if(repeat=="triple"){name="Triple"+name}name=(button==1?"Left":button==2?"Middle":"Right")+name;return dispatchKey(cm,addModifierNames(name,event),event,(function(bound){if(typeof bound=="string"){bound=commands[bound]}if(!bound){return false}var done=false;try{if(cm.isReadOnly()){cm.state.suppressEdits=true}done=bound(cm,pos)!=Pass}finally{cm.state.suppressEdits=false}return done}))}function configureMouse(cm,repeat,event){var option=cm.getOption("configureMouse");var value=option?option(cm,repeat,event):{};if(value.unit==null){var rect=chromeOS?event.shiftKey&&event.metaKey:event.altKey;value.unit=rect?"rectangle":repeat=="single"?"char":repeat=="double"?"word":"line"}if(value.extend==null||cm.doc.extend){value.extend=cm.doc.extend||event.shiftKey}if(value.addNew==null){value.addNew=mac?event.metaKey:event.ctrlKey||event.altKey}if(value.moveOnDrag==null){value.moveOnDrag=!(mac?event.altKey:event.ctrlKey)}return value}function leftButtonDown(cm,pos,repeat,event){if(ie){setTimeout(bind(ensureFocus,cm),0)}else{cm.curOp.focus=activeElt(doc(cm))}var behavior=configureMouse(cm,repeat,event);var sel=cm.doc.sel,contained;if(cm.options.dragDrop&&dragAndDrop&&!cm.isReadOnly()&&repeat=="single"&&(contained=sel.contains(pos))>-1&&(cmp((contained=sel.ranges[contained]).from(),pos)<0||pos.xRel>0)&&(cmp(contained.to(),pos)>0||pos.xRel<0)){leftButtonStartDrag(cm,event,pos,behavior)}else{leftButtonSelect(cm,event,pos,behavior)}}function leftButtonStartDrag(cm,event,pos,behavior){var display=cm.display,moved=false;var dragEnd=operation(cm,(function(e){if(webkit){display.scroller.draggable=false}cm.state.draggingText=false;if(cm.state.delayingBlurEvent){if(cm.hasFocus()){cm.state.delayingBlurEvent=false}else{delayBlurEvent(cm)}}off(display.wrapper.ownerDocument,"mouseup",dragEnd);off(display.wrapper.ownerDocument,"mousemove",mouseMove);off(display.scroller,"dragstart",dragStart);off(display.scroller,"drop",dragEnd);if(!moved){e_preventDefault(e);if(!behavior.addNew){extendSelection(cm.doc,pos,null,null,behavior.extend)}if(webkit&&!safari||ie&&ie_version==9){setTimeout((function(){display.wrapper.ownerDocument.body.focus({preventScroll:true});display.input.focus()}),20)}else{display.input.focus()}}}));var mouseMove=function(e2){moved=moved||Math.abs(event.clientX-e2.clientX)+Math.abs(event.clientY-e2.clientY)>=10};var dragStart=function(){return moved=true};if(webkit){display.scroller.draggable=true}cm.state.draggingText=dragEnd;dragEnd.copy=!behavior.moveOnDrag;on(display.wrapper.ownerDocument,"mouseup",dragEnd);on(display.wrapper.ownerDocument,"mousemove",mouseMove);on(display.scroller,"dragstart",dragStart);on(display.scroller,"drop",dragEnd);cm.state.delayingBlurEvent=true;setTimeout((function(){return display.input.focus()}),20);if(display.scroller.dragDrop){display.scroller.dragDrop()}}function rangeForUnit(cm,pos,unit){if(unit=="char"){return new Range(pos,pos)}if(unit=="word"){return cm.findWordAt(pos)}if(unit=="line"){return new Range(Pos(pos.line,0),clipPos(cm.doc,Pos(pos.line+1,0)))}var result=unit(cm,pos);return new Range(result.from,result.to)}function leftButtonSelect(cm,event,start,behavior){if(ie){delayBlurEvent(cm)}var display=cm.display,doc$1=cm.doc;e_preventDefault(event);var ourRange,ourIndex,startSel=doc$1.sel,ranges=startSel.ranges;if(behavior.addNew&&!behavior.extend){ourIndex=doc$1.sel.contains(start);if(ourIndex>-1){ourRange=ranges[ourIndex]}else{ourRange=new Range(start,start)}}else{ourRange=doc$1.sel.primary();ourIndex=doc$1.sel.primIndex}if(behavior.unit=="rectangle"){if(!behavior.addNew){ourRange=new Range(start,start)}start=posFromMouse(cm,event,true,true);ourIndex=-1}else{var range=rangeForUnit(cm,start,behavior.unit);if(behavior.extend){ourRange=extendRange(ourRange,range.anchor,range.head,behavior.extend)}else{ourRange=range}}if(!behavior.addNew){ourIndex=0;setSelection(doc$1,new Selection([ourRange],0),sel_mouse);startSel=doc$1.sel}else if(ourIndex==-1){ourIndex=ranges.length;setSelection(doc$1,normalizeSelection(cm,ranges.concat([ourRange]),ourIndex),{scroll:false,origin:"*mouse"})}else if(ranges.length>1&&ranges[ourIndex].empty()&&behavior.unit=="char"&&!behavior.extend){setSelection(doc$1,normalizeSelection(cm,ranges.slice(0,ourIndex).concat(ranges.slice(ourIndex+1)),0),{scroll:false,origin:"*mouse"});startSel=doc$1.sel}else{replaceOneSelection(doc$1,ourIndex,ourRange,sel_mouse)}var lastPos=start;function extendTo(pos){if(cmp(lastPos,pos)==0){return}lastPos=pos;if(behavior.unit=="rectangle"){var ranges=[],tabSize=cm.options.tabSize;var startCol=countColumn(getLine(doc$1,start.line).text,start.ch,tabSize);var posCol=countColumn(getLine(doc$1,pos.line).text,pos.ch,tabSize);var left=Math.min(startCol,posCol),right=Math.max(startCol,posCol);for(var line=Math.min(start.line,pos.line),end=Math.min(cm.lastLine(),Math.max(start.line,pos.line));line<=end;line++){var text=getLine(doc$1,line).text,leftPos=findColumn(text,left,tabSize);if(left==right){ranges.push(new Range(Pos(line,leftPos),Pos(line,leftPos)))}else if(text.length>leftPos){ranges.push(new Range(Pos(line,leftPos),Pos(line,findColumn(text,right,tabSize))))}}if(!ranges.length){ranges.push(new Range(start,start))}setSelection(doc$1,normalizeSelection(cm,startSel.ranges.slice(0,ourIndex).concat(ranges),ourIndex),{origin:"*mouse",scroll:false});cm.scrollIntoView(pos)}else{var oldRange=ourRange;var range=rangeForUnit(cm,pos,behavior.unit);var anchor=oldRange.anchor,head;if(cmp(range.anchor,anchor)>0){head=range.head;anchor=minPos(oldRange.from(),range.anchor)}else{head=range.anchor;anchor=maxPos(oldRange.to(),range.head)}var ranges$1=startSel.ranges.slice(0);ranges$1[ourIndex]=bidiSimplify(cm,new Range(clipPos(doc$1,anchor),head));setSelection(doc$1,normalizeSelection(cm,ranges$1,ourIndex),sel_mouse)}}var editorSize=display.wrapper.getBoundingClientRect();var counter=0;function extend(e){var curCount=++counter;var cur=posFromMouse(cm,e,true,behavior.unit=="rectangle");if(!cur){return}if(cmp(cur,lastPos)!=0){cm.curOp.focus=activeElt(doc(cm));extendTo(cur);var visible=visibleLines(display,doc$1);if(cur.line>=visible.to||cur.line<visible.from){setTimeout(operation(cm,(function(){if(counter==curCount){extend(e)}})),150)}}else{var outside=e.clientY<editorSize.top?-20:e.clientY>editorSize.bottom?20:0;if(outside){setTimeout(operation(cm,(function(){if(counter!=curCount){return}display.scroller.scrollTop+=outside;extend(e)})),50)}}}function done(e){cm.state.selectingText=false;counter=Infinity;if(e){e_preventDefault(e);display.input.focus()}off(display.wrapper.ownerDocument,"mousemove",move);off(display.wrapper.ownerDocument,"mouseup",up);doc$1.history.lastSelOrigin=null}var move=operation(cm,(function(e){if(e.buttons===0||!e_button(e)){done(e)}else{extend(e)}}));var up=operation(cm,done);cm.state.selectingText=up;on(display.wrapper.ownerDocument,"mousemove",move);on(display.wrapper.ownerDocument,"mouseup",up)}function bidiSimplify(cm,range){var anchor=range.anchor;var head=range.head;var anchorLine=getLine(cm.doc,anchor.line);if(cmp(anchor,head)==0&&anchor.sticky==head.sticky){return range}var order=getOrder(anchorLine);if(!order){return range}var index=getBidiPartAt(order,anchor.ch,anchor.sticky),part=order[index];if(part.from!=anchor.ch&&part.to!=anchor.ch){return range}var boundary=index+(part.from==anchor.ch==(part.level!=1)?0:1);if(boundary==0||boundary==order.length){return range}var leftSide;if(head.line!=anchor.line){leftSide=(head.line-anchor.line)*(cm.doc.direction=="ltr"?1:-1)>0}else{var headIndex=getBidiPartAt(order,head.ch,head.sticky);var dir=headIndex-index||(head.ch-anchor.ch)*(part.level==1?-1:1);if(headIndex==boundary-1||headIndex==boundary){leftSide=dir<0}else{leftSide=dir>0}}var usePart=order[boundary+(leftSide?-1:0)];var from=leftSide==(usePart.level==1);var ch=from?usePart.from:usePart.to,sticky=from?"after":"before";return anchor.ch==ch&&anchor.sticky==sticky?range:new Range(new Pos(anchor.line,ch,sticky),head)}function gutterEvent(cm,e,type,prevent){var mX,mY;if(e.touches){mX=e.touches[0].clientX;mY=e.touches[0].clientY}else{try{mX=e.clientX;mY=e.clientY}catch(e$1){return false}}if(mX>=Math.floor(cm.display.gutters.getBoundingClientRect().right)){return false}if(prevent){e_preventDefault(e)}var display=cm.display;var lineBox=display.lineDiv.getBoundingClientRect();if(mY>lineBox.bottom||!hasHandler(cm,type)){return e_defaultPrevented(e)}mY-=lineBox.top-display.viewOffset;for(var i=0;i<cm.display.gutterSpecs.length;++i){var g=display.gutters.childNodes[i];if(g&&g.getBoundingClientRect().right>=mX){var line=lineAtHeight(cm.doc,mY);var gutter=cm.display.gutterSpecs[i];signal(cm,type,cm,line,gutter.className,e);return e_defaultPrevented(e)}}}function clickInGutter(cm,e){return gutterEvent(cm,e,"gutterClick",true)}function onContextMenu(cm,e){if(eventInWidget(cm.display,e)||contextMenuInGutter(cm,e)){return}if(signalDOMEvent(cm,e,"contextmenu")){return}if(!captureRightClick){cm.display.input.onContextMenu(e)}}function contextMenuInGutter(cm,e){if(!hasHandler(cm,"gutterContextMenu")){return false}return gutterEvent(cm,e,"gutterContextMenu",false)}function themeChanged(cm){cm.display.wrapper.className=cm.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+cm.options.theme.replace(/(^|\s)\s*/g," cm-s-");clearCaches(cm)}var Init={toString:function(){return"CodeMirror.Init"}};var defaults={};var optionHandlers={};function defineOptions(CodeMirror){var optionHandlers=CodeMirror.optionHandlers;function option(name,deflt,handle,notOnInit){CodeMirror.defaults[name]=deflt;if(handle){optionHandlers[name]=notOnInit?function(cm,val,old){if(old!=Init){handle(cm,val,old)}}:handle}}CodeMirror.defineOption=option;CodeMirror.Init=Init;option("value","",(function(cm,val){return cm.setValue(val)}),true);option("mode",null,(function(cm,val){cm.doc.modeOption=val;loadMode(cm)}),true);option("indentUnit",2,loadMode,true);option("indentWithTabs",false);option("smartIndent",true);option("tabSize",4,(function(cm){resetModeState(cm);clearCaches(cm);regChange(cm)}),true);option("lineSeparator",null,(function(cm,val){cm.doc.lineSep=val;if(!val){return}var newBreaks=[],lineNo=cm.doc.first;cm.doc.iter((function(line){for(var pos=0;;){var found=line.text.indexOf(val,pos);if(found==-1){break}pos=found+val.length;newBreaks.push(Pos(lineNo,found))}lineNo++}));for(var i=newBreaks.length-1;i>=0;i--){replaceRange(cm.doc,val,newBreaks[i],Pos(newBreaks[i].line,newBreaks[i].ch+val.length))}}));option("specialChars",/[\u0000-\u001f\u007f-\u009f\u00ad\u061c\u200b\u200e\u200f\u2028\u2029\u202d\u202e\u2066\u2067\u2069\ufeff\ufff9-\ufffc]/g,(function(cm,val,old){cm.state.specialChars=new RegExp(val.source+(val.test("\t")?"":"|\t"),"g");if(old!=Init){cm.refresh()}}));option("specialCharPlaceholder",defaultSpecialCharPlaceholder,(function(cm){return cm.refresh()}),true);option("electricChars",true);option("inputStyle",mobile?"contenteditable":"textarea",(function(){throw new Error("inputStyle can not (yet) be changed in a running editor")}),true);option("spellcheck",false,(function(cm,val){return cm.getInputField().spellcheck=val}),true);option("autocorrect",false,(function(cm,val){return cm.getInputField().autocorrect=val}),true);option("autocapitalize",false,(function(cm,val){return cm.getInputField().autocapitalize=val}),true);option("rtlMoveVisually",!windows);option("wholeLineUpdateBefore",true);option("theme","default",(function(cm){themeChanged(cm);updateGutters(cm)}),true);option("keyMap","default",(function(cm,val,old){var next=getKeyMap(val);var prev=old!=Init&&getKeyMap(old);if(prev&&prev.detach){prev.detach(cm,next)}if(next.attach){next.attach(cm,prev||null)}}));option("extraKeys",null);option("configureMouse",null);option("lineWrapping",false,wrappingChanged,true);option("gutters",[],(function(cm,val){cm.display.gutterSpecs=getGutters(val,cm.options.lineNumbers);updateGutters(cm)}),true);option("fixedGutter",true,(function(cm,val){cm.display.gutters.style.left=val?compensateForHScroll(cm.display)+"px":"0";cm.refresh()}),true);option("coverGutterNextToScrollbar",false,(function(cm){return updateScrollbars(cm)}),true);option("scrollbarStyle","native",(function(cm){initScrollbars(cm);updateScrollbars(cm);cm.display.scrollbars.setScrollTop(cm.doc.scrollTop);cm.display.scrollbars.setScrollLeft(cm.doc.scrollLeft)}),true);option("lineNumbers",false,(function(cm,val){cm.display.gutterSpecs=getGutters(cm.options.gutters,val);updateGutters(cm)}),true);option("firstLineNumber",1,updateGutters,true);option("lineNumberFormatter",(function(integer){return integer}),updateGutters,true);option("showCursorWhenSelecting",false,updateSelection,true);option("resetSelectionOnContextMenu",true);option("lineWiseCopyCut",true);option("pasteLinesPerSelection",true);option("selectionsMayTouch",false);option("readOnly",false,(function(cm,val){if(val=="nocursor"){onBlur(cm);cm.display.input.blur()}cm.display.input.readOnlyChanged(val)}));option("screenReaderLabel",null,(function(cm,val){val=val===""?null:val;cm.display.input.screenReaderLabelChanged(val)}));option("disableInput",false,(function(cm,val){if(!val){cm.display.input.reset()}}),true);option("dragDrop",true,dragDropChanged);option("allowDropFileTypes",null);option("cursorBlinkRate",530);option("cursorScrollMargin",0);option("cursorHeight",1,updateSelection,true);option("singleCursorHeightPerLine",true,updateSelection,true);option("workTime",100);option("workDelay",100);option("flattenSpans",true,resetModeState,true);option("addModeClass",false,resetModeState,true);option("pollInterval",100);option("undoDepth",200,(function(cm,val){return cm.doc.history.undoDepth=val}));option("historyEventDelay",1250);option("viewportMargin",10,(function(cm){return cm.refresh()}),true);option("maxHighlightLength",1e4,resetModeState,true);option("moveInputWithCursor",true,(function(cm,val){if(!val){cm.display.input.resetPosition()}}));option("tabindex",null,(function(cm,val){return cm.display.input.getField().tabIndex=val||""}));option("autofocus",null);option("direction","ltr",(function(cm,val){return cm.doc.setDirection(val)}),true);option("phrases",null)}function dragDropChanged(cm,value,old){var wasOn=old&&old!=Init;if(!value!=!wasOn){var funcs=cm.display.dragFunctions;var toggle=value?on:off;toggle(cm.display.scroller,"dragstart",funcs.start);toggle(cm.display.scroller,"dragenter",funcs.enter);toggle(cm.display.scroller,"dragover",funcs.over);toggle(cm.display.scroller,"dragleave",funcs.leave);toggle(cm.display.scroller,"drop",funcs.drop)}}function wrappingChanged(cm){if(cm.options.lineWrapping){addClass(cm.display.wrapper,"CodeMirror-wrap");cm.display.sizer.style.minWidth="";cm.display.sizerWidth=null}else{rmClass(cm.display.wrapper,"CodeMirror-wrap");findMaxLine(cm)}estimateLineHeights(cm);regChange(cm);clearCaches(cm);setTimeout((function(){return updateScrollbars(cm)}),100)}function CodeMirror(place,options){var this$1=this;if(!(this instanceof CodeMirror)){return new CodeMirror(place,options)}this.options=options=options?copyObj(options):{};copyObj(defaults,options,false);var doc=options.value;if(typeof doc=="string"){doc=new Doc(doc,options.mode,null,options.lineSeparator,options.direction)}else if(options.mode){doc.modeOption=options.mode}this.doc=doc;var input=new CodeMirror.inputStyles[options.inputStyle](this);var display=this.display=new Display(place,doc,input,options);display.wrapper.CodeMirror=this;themeChanged(this);if(options.lineWrapping){this.display.wrapper.className+=" CodeMirror-wrap"}initScrollbars(this);this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:false,delayingBlurEvent:false,focused:false,suppressEdits:false,pasteIncoming:-1,cutIncoming:-1,selectingText:false,draggingText:false,highlight:new Delayed,keySeq:null,specialChars:null};if(options.autofocus&&!mobile){display.input.focus()}if(ie&&ie_version<11){setTimeout((function(){return this$1.display.input.reset(true)}),20)}registerEventHandlers(this);ensureGlobalHandlers();startOperation(this);this.curOp.forceUpdate=true;attachDoc(this,doc);if(options.autofocus&&!mobile||this.hasFocus()){setTimeout((function(){if(this$1.hasFocus()&&!this$1.state.focused){onFocus(this$1)}}),20)}else{onBlur(this)}for(var opt in optionHandlers){if(optionHandlers.hasOwnProperty(opt)){optionHandlers[opt](this,options[opt],Init)}}maybeUpdateLineNumberWidth(this);if(options.finishInit){options.finishInit(this)}for(var i=0;i<initHooks.length;++i){initHooks[i](this)}endOperation(this);if(webkit&&options.lineWrapping&&getComputedStyle(display.lineDiv).textRendering=="optimizelegibility"){display.lineDiv.style.textRendering="auto"}}CodeMirror.defaults=defaults;CodeMirror.optionHandlers=optionHandlers;function registerEventHandlers(cm){var d=cm.display;on(d.scroller,"mousedown",operation(cm,onMouseDown));if(ie&&ie_version<11){on(d.scroller,"dblclick",operation(cm,(function(e){if(signalDOMEvent(cm,e)){return}var pos=posFromMouse(cm,e);if(!pos||clickInGutter(cm,e)||eventInWidget(cm.display,e)){return}e_preventDefault(e);var word=cm.findWordAt(pos);extendSelection(cm.doc,word.anchor,word.head)})))}else{on(d.scroller,"dblclick",(function(e){return signalDOMEvent(cm,e)||e_preventDefault(e)}))}on(d.scroller,"contextmenu",(function(e){return onContextMenu(cm,e)}));on(d.input.getField(),"contextmenu",(function(e){if(!d.scroller.contains(e.target)){onContextMenu(cm,e)}}));var touchFinished,prevTouch={end:0};function finishTouch(){if(d.activeTouch){touchFinished=setTimeout((function(){return d.activeTouch=null}),1e3);prevTouch=d.activeTouch;prevTouch.end=+new Date}}function isMouseLikeTouchEvent(e){if(e.touches.length!=1){return false}var touch=e.touches[0];return touch.radiusX<=1&&touch.radiusY<=1}function farAway(touch,other){if(other.left==null){return true}var dx=other.left-touch.left,dy=other.top-touch.top;return dx*dx+dy*dy>20*20}on(d.scroller,"touchstart",(function(e){if(!signalDOMEvent(cm,e)&&!isMouseLikeTouchEvent(e)&&!clickInGutter(cm,e)){d.input.ensurePolled();clearTimeout(touchFinished);var now=+new Date;d.activeTouch={start:now,moved:false,prev:now-prevTouch.end<=300?prevTouch:null};if(e.touches.length==1){d.activeTouch.left=e.touches[0].pageX;d.activeTouch.top=e.touches[0].pageY}}}));on(d.scroller,"touchmove",(function(){if(d.activeTouch){d.activeTouch.moved=true}}));on(d.scroller,"touchend",(function(e){var touch=d.activeTouch;if(touch&&!eventInWidget(d,e)&&touch.left!=null&&!touch.moved&&new Date-touch.start<300){var pos=cm.coordsChar(d.activeTouch,"page"),range;if(!touch.prev||farAway(touch,touch.prev)){range=new Range(pos,pos)}else if(!touch.prev.prev||farAway(touch,touch.prev.prev)){range=cm.findWordAt(pos)}else{range=new Range(Pos(pos.line,0),clipPos(cm.doc,Pos(pos.line+1,0)))}cm.setSelection(range.anchor,range.head);cm.focus();e_preventDefault(e)}finishTouch()}));on(d.scroller,"touchcancel",finishTouch);on(d.scroller,"scroll",(function(){if(d.scroller.clientHeight){updateScrollTop(cm,d.scroller.scrollTop);setScrollLeft(cm,d.scroller.scrollLeft,true);signal(cm,"scroll",cm)}}));on(d.scroller,"mousewheel",(function(e){return onScrollWheel(cm,e)}));on(d.scroller,"DOMMouseScroll",(function(e){return onScrollWheel(cm,e)}));on(d.wrapper,"scroll",(function(){return d.wrapper.scrollTop=d.wrapper.scrollLeft=0}));d.dragFunctions={enter:function(e){if(!signalDOMEvent(cm,e)){e_stop(e)}},over:function(e){if(!signalDOMEvent(cm,e)){onDragOver(cm,e);e_stop(e)}},start:function(e){return onDragStart(cm,e)},drop:operation(cm,onDrop),leave:function(e){if(!signalDOMEvent(cm,e)){clearDragCursor(cm)}}};var inp=d.input.getField();on(inp,"keyup",(function(e){return onKeyUp.call(cm,e)}));on(inp,"keydown",operation(cm,onKeyDown));on(inp,"keypress",operation(cm,onKeyPress));on(inp,"focus",(function(e){return onFocus(cm,e)}));on(inp,"blur",(function(e){return onBlur(cm,e)}))}var initHooks=[];CodeMirror.defineInitHook=function(f){return initHooks.push(f)};function indentLine(cm,n,how,aggressive){var doc=cm.doc,state;if(how==null){how="add"}if(how=="smart"){if(!doc.mode.indent){how="prev"}else{state=getContextBefore(cm,n).state}}var tabSize=cm.options.tabSize;var line=getLine(doc,n),curSpace=countColumn(line.text,null,tabSize);if(line.stateAfter){line.stateAfter=null}var curSpaceString=line.text.match(/^\s*/)[0],indentation;if(!aggressive&&!/\S/.test(line.text)){indentation=0;how="not"}else if(how=="smart"){indentation=doc.mode.indent(state,line.text.slice(curSpaceString.length),line.text);if(indentation==Pass||indentation>150){if(!aggressive){return}how="prev"}}if(how=="prev"){if(n>doc.first){indentation=countColumn(getLine(doc,n-1).text,null,tabSize)}else{indentation=0}}else if(how=="add"){indentation=curSpace+cm.options.indentUnit}else if(how=="subtract"){indentation=curSpace-cm.options.indentUnit}else if(typeof how=="number"){indentation=curSpace+how}indentation=Math.max(0,indentation);var indentString="",pos=0;if(cm.options.indentWithTabs){for(var i=Math.floor(indentation/tabSize);i;--i){pos+=tabSize;indentString+="\t"}}if(pos<indentation){indentString+=spaceStr(indentation-pos)}if(indentString!=curSpaceString){replaceRange(doc,indentString,Pos(n,0),Pos(n,curSpaceString.length),"+input");line.stateAfter=null;return true}else{for(var i$1=0;i$1<doc.sel.ranges.length;i$1++){var range=doc.sel.ranges[i$1];if(range.head.line==n&&range.head.ch<curSpaceString.length){var pos$1=Pos(n,curSpaceString.length);replaceOneSelection(doc,i$1,new Range(pos$1,pos$1));break}}}}var lastCopied=null;function setLastCopied(newLastCopied){lastCopied=newLastCopied}function applyTextInput(cm,inserted,deleted,sel,origin){var doc=cm.doc;cm.display.shift=false;if(!sel){sel=doc.sel}var recent=+new Date-200;var paste=origin=="paste"||cm.state.pasteIncoming>recent;var textLines=splitLinesAuto(inserted),multiPaste=null;if(paste&&sel.ranges.length>1){if(lastCopied&&lastCopied.text.join("\n")==inserted){if(sel.ranges.length%lastCopied.text.length==0){multiPaste=[];for(var i=0;i<lastCopied.text.length;i++){multiPaste.push(doc.splitLines(lastCopied.text[i]))}}}else if(textLines.length==sel.ranges.length&&cm.options.pasteLinesPerSelection){multiPaste=map(textLines,(function(l){return[l]}))}}var updateInput=cm.curOp.updateInput;for(var i$1=sel.ranges.length-1;i$1>=0;i$1--){var range=sel.ranges[i$1];var from=range.from(),to=range.to();if(range.empty()){if(deleted&&deleted>0){from=Pos(from.line,from.ch-deleted)}else if(cm.state.overwrite&&!paste){to=Pos(to.line,Math.min(getLine(doc,to.line).text.length,to.ch+lst(textLines).length))}else if(paste&&lastCopied&&lastCopied.lineWise&&lastCopied.text.join("\n")==textLines.join("\n")){from=to=Pos(from.line,0)}}var changeEvent={from:from,to:to,text:multiPaste?multiPaste[i$1%multiPaste.length]:textLines,origin:origin||(paste?"paste":cm.state.cutIncoming>recent?"cut":"+input")};makeChange(cm.doc,changeEvent);signalLater(cm,"inputRead",cm,changeEvent)}if(inserted&&!paste){triggerElectric(cm,inserted)}ensureCursorVisible(cm);if(cm.curOp.updateInput<2){cm.curOp.updateInput=updateInput}cm.curOp.typing=true;cm.state.pasteIncoming=cm.state.cutIncoming=-1}function handlePaste(e,cm){var pasted=e.clipboardData&&e.clipboardData.getData("Text");if(pasted){e.preventDefault();if(!cm.isReadOnly()&&!cm.options.disableInput&&cm.hasFocus()){runInOp(cm,(function(){return applyTextInput(cm,pasted,0,null,"paste")}))}return true}}function triggerElectric(cm,inserted){if(!cm.options.electricChars||!cm.options.smartIndent){return}var sel=cm.doc.sel;for(var i=sel.ranges.length-1;i>=0;i--){var range=sel.ranges[i];if(range.head.ch>100||i&&sel.ranges[i-1].head.line==range.head.line){continue}var mode=cm.getModeAt(range.head);var indented=false;if(mode.electricChars){for(var j=0;j<mode.electricChars.length;j++){if(inserted.indexOf(mode.electricChars.charAt(j))>-1){indented=indentLine(cm,range.head.line,"smart");break}}}else if(mode.electricInput){if(mode.electricInput.test(getLine(cm.doc,range.head.line).text.slice(0,range.head.ch))){indented=indentLine(cm,range.head.line,"smart")}}if(indented){signalLater(cm,"electricInput",cm,range.head.line)}}}function copyableRanges(cm){var text=[],ranges=[];for(var i=0;i<cm.doc.sel.ranges.length;i++){var line=cm.doc.sel.ranges[i].head.line;var lineRange={anchor:Pos(line,0),head:Pos(line+1,0)};ranges.push(lineRange);text.push(cm.getRange(lineRange.anchor,lineRange.head))}return{text:text,ranges:ranges}}function disableBrowserMagic(field,spellcheck,autocorrect,autocapitalize){field.setAttribute("autocorrect",autocorrect?"on":"off");field.setAttribute("autocapitalize",autocapitalize?"on":"off");field.setAttribute("spellcheck",!!spellcheck)}function hiddenTextarea(){var te=elt("textarea",null,null,"position: absolute; bottom: -1em; padding: 0; width: 1px; height: 1em; min-height: 1em; outline: none");var div=elt("div",[te],null,"overflow: hidden; position: relative; width: 3px; height: 0px;");if(webkit){te.style.width="1000px"}else{te.setAttribute("wrap","off")}if(ios){te.style.border="1px solid black"}return div}function addEditorMethods(CodeMirror){var optionHandlers=CodeMirror.optionHandlers;var helpers=CodeMirror.helpers={};CodeMirror.prototype={constructor:CodeMirror,focus:function(){win(this).focus();this.display.input.focus()},setOption:function(option,value){var options=this.options,old=options[option];if(options[option]==value&&option!="mode"){return}options[option]=value;if(optionHandlers.hasOwnProperty(option)){operation(this,optionHandlers[option])(this,value,old)}signal(this,"optionChange",this,option)},getOption:function(option){return this.options[option]},getDoc:function(){return this.doc},addKeyMap:function(map,bottom){this.state.keyMaps[bottom?"push":"unshift"](getKeyMap(map))},removeKeyMap:function(map){var maps=this.state.keyMaps;for(var i=0;i<maps.length;++i){if(maps[i]==map||maps[i].name==map){maps.splice(i,1);return true}}},addOverlay:methodOp((function(spec,options){var mode=spec.token?spec:CodeMirror.getMode(this.options,spec);if(mode.startState){throw new Error("Overlays may not be stateful.")}insertSorted(this.state.overlays,{mode:mode,modeSpec:spec,opaque:options&&options.opaque,priority:options&&options.priority||0},(function(overlay){return overlay.priority}));this.state.modeGen++;regChange(this)})),removeOverlay:methodOp((function(spec){var overlays=this.state.overlays;for(var i=0;i<overlays.length;++i){var cur=overlays[i].modeSpec;if(cur==spec||typeof spec=="string"&&cur.name==spec){overlays.splice(i,1);this.state.modeGen++;regChange(this);return}}})),indentLine:methodOp((function(n,dir,aggressive){if(typeof dir!="string"&&typeof dir!="number"){if(dir==null){dir=this.options.smartIndent?"smart":"prev"}else{dir=dir?"add":"subtract"}}if(isLine(this.doc,n)){indentLine(this,n,dir,aggressive)}})),indentSelection:methodOp((function(how){var ranges=this.doc.sel.ranges,end=-1;for(var i=0;i<ranges.length;i++){var range=ranges[i];if(!range.empty()){var from=range.from(),to=range.to();var start=Math.max(end,from.line);end=Math.min(this.lastLine(),to.line-(to.ch?0:1))+1;for(var j=start;j<end;++j){indentLine(this,j,how)}var newRanges=this.doc.sel.ranges;if(from.ch==0&&ranges.length==newRanges.length&&newRanges[i].from().ch>0){replaceOneSelection(this.doc,i,new Range(from,newRanges[i].to()),sel_dontScroll)}}else if(range.head.line>end){indentLine(this,range.head.line,how,true);end=range.head.line;if(i==this.doc.sel.primIndex){ensureCursorVisible(this)}}}})),getTokenAt:function(pos,precise){return takeToken(this,pos,precise)},getLineTokens:function(line,precise){return takeToken(this,Pos(line),precise,true)},getTokenTypeAt:function(pos){pos=clipPos(this.doc,pos);var styles=getLineStyles(this,getLine(this.doc,pos.line));var before=0,after=(styles.length-1)/2,ch=pos.ch;var type;if(ch==0){type=styles[2]}else{for(;;){var mid=before+after>>1;if((mid?styles[mid*2-1]:0)>=ch){after=mid}else if(styles[mid*2+1]<ch){before=mid+1}else{type=styles[mid*2+2];break}}}var cut=type?type.indexOf("overlay "):-1;return cut<0?type:cut==0?null:type.slice(0,cut-1)},getModeAt:function(pos){var mode=this.doc.mode;if(!mode.innerMode){return mode}return CodeMirror.innerMode(mode,this.getTokenAt(pos).state).mode},getHelper:function(pos,type){return this.getHelpers(pos,type)[0]},getHelpers:function(pos,type){var found=[];if(!helpers.hasOwnProperty(type)){return found}var help=helpers[type],mode=this.getModeAt(pos);if(typeof mode[type]=="string"){if(help[mode[type]]){found.push(help[mode[type]])}}else if(mode[type]){for(var i=0;i<mode[type].length;i++){var val=help[mode[type][i]];if(val){found.push(val)}}}else if(mode.helperType&&help[mode.helperType]){found.push(help[mode.helperType])}else if(help[mode.name]){found.push(help[mode.name])}for(var i$1=0;i$1<help._global.length;i$1++){var cur=help._global[i$1];if(cur.pred(mode,this)&&indexOf(found,cur.val)==-1){found.push(cur.val)}}return found},getStateAfter:function(line,precise){var doc=this.doc;line=clipLine(doc,line==null?doc.first+doc.size-1:line);return getContextBefore(this,line+1,precise).state},cursorCoords:function(start,mode){var pos,range=this.doc.sel.primary();if(start==null){pos=range.head}else if(typeof start=="object"){pos=clipPos(this.doc,start)}else{pos=start?range.from():range.to()}return cursorCoords(this,pos,mode||"page")},charCoords:function(pos,mode){return charCoords(this,clipPos(this.doc,pos),mode||"page")},coordsChar:function(coords,mode){coords=fromCoordSystem(this,coords,mode||"page");return coordsChar(this,coords.left,coords.top)},lineAtHeight:function(height,mode){height=fromCoordSystem(this,{top:height,left:0},mode||"page").top;return lineAtHeight(this.doc,height+this.display.viewOffset)},heightAtLine:function(line,mode,includeWidgets){var end=false,lineObj;if(typeof line=="number"){var last=this.doc.first+this.doc.size-1;if(line<this.doc.first){line=this.doc.first}else if(line>last){line=last;end=true}lineObj=getLine(this.doc,line)}else{lineObj=line}return intoCoordSystem(this,lineObj,{top:0,left:0},mode||"page",includeWidgets||end).top+(end?this.doc.height-heightAtLine(lineObj):0)},defaultTextHeight:function(){return textHeight(this.display)},defaultCharWidth:function(){return charWidth(this.display)},getViewport:function(){return{from:this.display.viewFrom,to:this.display.viewTo}},addWidget:function(pos,node,scroll,vert,horiz){var display=this.display;pos=cursorCoords(this,clipPos(this.doc,pos));var top=pos.bottom,left=pos.left;node.style.position="absolute";node.setAttribute("cm-ignore-events","true");this.display.input.setUneditable(node);display.sizer.appendChild(node);if(vert=="over"){top=pos.top}else if(vert=="above"||vert=="near"){var vspace=Math.max(display.wrapper.clientHeight,this.doc.height),hspace=Math.max(display.sizer.clientWidth,display.lineSpace.clientWidth);if((vert=="above"||pos.bottom+node.offsetHeight>vspace)&&pos.top>node.offsetHeight){top=pos.top-node.offsetHeight}else if(pos.bottom+node.offsetHeight<=vspace){top=pos.bottom}if(left+node.offsetWidth>hspace){left=hspace-node.offsetWidth}}node.style.top=top+"px";node.style.left=node.style.right="";if(horiz=="right"){left=display.sizer.clientWidth-node.offsetWidth;node.style.right="0px"}else{if(horiz=="left"){left=0}else if(horiz=="middle"){left=(display.sizer.clientWidth-node.offsetWidth)/2}node.style.left=left+"px"}if(scroll){scrollIntoView(this,{left:left,top:top,right:left+node.offsetWidth,bottom:top+node.offsetHeight})}},triggerOnKeyDown:methodOp(onKeyDown),triggerOnKeyPress:methodOp(onKeyPress),triggerOnKeyUp:onKeyUp,triggerOnMouseDown:methodOp(onMouseDown),execCommand:function(cmd){if(commands.hasOwnProperty(cmd)){return commands[cmd].call(null,this)}},triggerElectric:methodOp((function(text){triggerElectric(this,text)})),findPosH:function(from,amount,unit,visually){var dir=1;if(amount<0){dir=-1;amount=-amount}var cur=clipPos(this.doc,from);for(var i=0;i<amount;++i){cur=findPosH(this.doc,cur,dir,unit,visually);if(cur.hitSide){break}}return cur},moveH:methodOp((function(dir,unit){var this$1=this;this.extendSelectionsBy((function(range){if(this$1.display.shift||this$1.doc.extend||range.empty()){return findPosH(this$1.doc,range.head,dir,unit,this$1.options.rtlMoveVisually)}else{return dir<0?range.from():range.to()}}),sel_move)})),deleteH:methodOp((function(dir,unit){var sel=this.doc.sel,doc=this.doc;if(sel.somethingSelected()){doc.replaceSelection("",null,"+delete")}else{deleteNearSelection(this,(function(range){var other=findPosH(doc,range.head,dir,unit,false);return dir<0?{from:other,to:range.head}:{from:range.head,to:other}}))}})),findPosV:function(from,amount,unit,goalColumn){var dir=1,x=goalColumn;if(amount<0){dir=-1;amount=-amount}var cur=clipPos(this.doc,from);for(var i=0;i<amount;++i){var coords=cursorCoords(this,cur,"div");if(x==null){x=coords.left}else{coords.left=x}cur=findPosV(this,coords,dir,unit);if(cur.hitSide){break}}return cur},moveV:methodOp((function(dir,unit){var this$1=this;var doc=this.doc,goals=[];var collapse=!this.display.shift&&!doc.extend&&doc.sel.somethingSelected();doc.extendSelectionsBy((function(range){if(collapse){return dir<0?range.from():range.to()}var headPos=cursorCoords(this$1,range.head,"div");if(range.goalColumn!=null){headPos.left=range.goalColumn}goals.push(headPos.left);var pos=findPosV(this$1,headPos,dir,unit);if(unit=="page"&&range==doc.sel.primary()){addToScrollTop(this$1,charCoords(this$1,pos,"div").top-headPos.top)}return pos}),sel_move);if(goals.length){for(var i=0;i<doc.sel.ranges.length;i++){doc.sel.ranges[i].goalColumn=goals[i]}}})),findWordAt:function(pos){var doc=this.doc,line=getLine(doc,pos.line).text;var start=pos.ch,end=pos.ch;if(line){var helper=this.getHelper(pos,"wordChars");if((pos.sticky=="before"||end==line.length)&&start){--start}else{++end}var startChar=line.charAt(start);var check=isWordChar(startChar,helper)?function(ch){return isWordChar(ch,helper)}:/\s/.test(startChar)?function(ch){return/\s/.test(ch)}:function(ch){return!/\s/.test(ch)&&!isWordChar(ch)};while(start>0&&check(line.charAt(start-1))){--start}while(end<line.length&&check(line.charAt(end))){++end}}return new Range(Pos(pos.line,start),Pos(pos.line,end))},toggleOverwrite:function(value){if(value!=null&&value==this.state.overwrite){return}if(this.state.overwrite=!this.state.overwrite){addClass(this.display.cursorDiv,"CodeMirror-overwrite")}else{rmClass(this.display.cursorDiv,"CodeMirror-overwrite")}signal(this,"overwriteToggle",this,this.state.overwrite)},hasFocus:function(){return this.display.input.getField()==activeElt(doc(this))},isReadOnly:function(){return!!(this.options.readOnly||this.doc.cantEdit)},scrollTo:methodOp((function(x,y){scrollToCoords(this,x,y)})),getScrollInfo:function(){var scroller=this.display.scroller;return{left:scroller.scrollLeft,top:scroller.scrollTop,height:scroller.scrollHeight-scrollGap(this)-this.display.barHeight,width:scroller.scrollWidth-scrollGap(this)-this.display.barWidth,clientHeight:displayHeight(this),clientWidth:displayWidth(this)}},scrollIntoView:methodOp((function(range,margin){if(range==null){range={from:this.doc.sel.primary().head,to:null};if(margin==null){margin=this.options.cursorScrollMargin}}else if(typeof range=="number"){range={from:Pos(range,0),to:null}}else if(range.from==null){range={from:range,to:null}}if(!range.to){range.to=range.from}range.margin=margin||0;if(range.from.line!=null){scrollToRange(this,range)}else{scrollToCoordsRange(this,range.from,range.to,range.margin)}})),setSize:methodOp((function(width,height){var this$1=this;var interpret=function(val){return typeof val=="number"||/^\d+$/.test(String(val))?val+"px":val};if(width!=null){this.display.wrapper.style.width=interpret(width)}if(height!=null){this.display.wrapper.style.height=interpret(height)}if(this.options.lineWrapping){clearLineMeasurementCache(this)}var lineNo=this.display.viewFrom;this.doc.iter(lineNo,this.display.viewTo,(function(line){if(line.widgets){for(var i=0;i<line.widgets.length;i++){if(line.widgets[i].noHScroll){regLineChange(this$1,lineNo,"widget");break}}}++lineNo}));this.curOp.forceUpdate=true;signal(this,"refresh",this)})),operation:function(f){return runInOp(this,f)},startOperation:function(){return startOperation(this)},endOperation:function(){return endOperation(this)},refresh:methodOp((function(){var oldHeight=this.display.cachedTextHeight;regChange(this);this.curOp.forceUpdate=true;clearCaches(this);scrollToCoords(this,this.doc.scrollLeft,this.doc.scrollTop);updateGutterSpace(this.display);if(oldHeight==null||Math.abs(oldHeight-textHeight(this.display))>.5||this.options.lineWrapping){estimateLineHeights(this)}signal(this,"refresh",this)})),swapDoc:methodOp((function(doc){var old=this.doc;old.cm=null;if(this.state.selectingText){this.state.selectingText()}attachDoc(this,doc);clearCaches(this);this.display.input.reset();scrollToCoords(this,doc.scrollLeft,doc.scrollTop);this.curOp.forceScroll=true;signalLater(this,"swapDoc",this,old);return old})),phrase:function(phraseText){var phrases=this.options.phrases;return phrases&&Object.prototype.hasOwnProperty.call(phrases,phraseText)?phrases[phraseText]:phraseText},getInputField:function(){return this.display.input.getField()},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}};eventMixin(CodeMirror);CodeMirror.registerHelper=function(type,name,value){if(!helpers.hasOwnProperty(type)){helpers[type]=CodeMirror[type]={_global:[]}}helpers[type][name]=value};CodeMirror.registerGlobalHelper=function(type,name,predicate,value){CodeMirror.registerHelper(type,name,value);helpers[type]._global.push({pred:predicate,val:value})}}function findPosH(doc,pos,dir,unit,visually){var oldPos=pos;var origDir=dir;var lineObj=getLine(doc,pos.line);var lineDir=visually&&doc.direction=="rtl"?-dir:dir;function findNextLine(){var l=pos.line+lineDir;if(l<doc.first||l>=doc.first+doc.size){return false}pos=new Pos(l,pos.ch,pos.sticky);return lineObj=getLine(doc,l)}function moveOnce(boundToLine){var next;if(unit=="codepoint"){var ch=lineObj.text.charCodeAt(pos.ch+(dir>0?0:-1));if(isNaN(ch)){next=null}else{var astral=dir>0?ch>=55296&&ch<56320:ch>=56320&&ch<57343;next=new Pos(pos.line,Math.max(0,Math.min(lineObj.text.length,pos.ch+dir*(astral?2:1))),-dir)}}else if(visually){next=moveVisually(doc.cm,lineObj,pos,dir)}else{next=moveLogically(lineObj,pos,dir)}if(next==null){if(!boundToLine&&findNextLine()){pos=endOfLine(visually,doc.cm,lineObj,pos.line,lineDir)}else{return false}}else{pos=next}return true}if(unit=="char"||unit=="codepoint"){moveOnce()}else if(unit=="column"){moveOnce(true)}else if(unit=="word"||unit=="group"){var sawType=null,group=unit=="group";var helper=doc.cm&&doc.cm.getHelper(pos,"wordChars");for(var first=true;;first=false){if(dir<0&&!moveOnce(!first)){break}var cur=lineObj.text.charAt(pos.ch)||"\n";var type=isWordChar(cur,helper)?"w":group&&cur=="\n"?"n":!group||/\s/.test(cur)?null:"p";if(group&&!first&&!type){type="s"}if(sawType&&sawType!=type){if(dir<0){dir=1;moveOnce();pos.sticky="after"}break}if(type){sawType=type}if(dir>0&&!moveOnce(!first)){break}}}var result=skipAtomic(doc,pos,oldPos,origDir,true);if(equalCursorPos(oldPos,result)){result.hitSide=true}return result}function findPosV(cm,pos,dir,unit){var doc=cm.doc,x=pos.left,y;if(unit=="page"){var pageSize=Math.min(cm.display.wrapper.clientHeight,win(cm).innerHeight||doc(cm).documentElement.clientHeight);var moveAmount=Math.max(pageSize-.5*textHeight(cm.display),3);y=(dir>0?pos.bottom:pos.top)+dir*moveAmount}else if(unit=="line"){y=dir>0?pos.bottom+3:pos.top-3}var target;for(;;){target=coordsChar(cm,x,y);if(!target.outside){break}if(dir<0?y<=0:y>=doc.height){target.hitSide=true;break}y+=dir*5}return target}var ContentEditableInput=function(cm){this.cm=cm;this.lastAnchorNode=this.lastAnchorOffset=this.lastFocusNode=this.lastFocusOffset=null;this.polling=new Delayed;this.composing=null;this.gracePeriod=false;this.readDOMTimeout=null};ContentEditableInput.prototype.init=function(display){var this$1=this;var input=this,cm=input.cm;var div=input.div=display.lineDiv;div.contentEditable=true;disableBrowserMagic(div,cm.options.spellcheck,cm.options.autocorrect,cm.options.autocapitalize);function belongsToInput(e){for(var t=e.target;t;t=t.parentNode){if(t==div){return true}if(/\bCodeMirror-(?:line)?widget\b/.test(t.className)){break}}return false}on(div,"paste",(function(e){if(!belongsToInput(e)||signalDOMEvent(cm,e)||handlePaste(e,cm)){return}if(ie_version<=11){setTimeout(operation(cm,(function(){return this$1.updateFromDOM()})),20)}}));on(div,"compositionstart",(function(e){this$1.composing={data:e.data,done:false}}));on(div,"compositionupdate",(function(e){if(!this$1.composing){this$1.composing={data:e.data,done:false}}}));on(div,"compositionend",(function(e){if(this$1.composing){if(e.data!=this$1.composing.data){this$1.readFromDOMSoon()}this$1.composing.done=true}}));on(div,"touchstart",(function(){return input.forceCompositionEnd()}));on(div,"input",(function(){if(!this$1.composing){this$1.readFromDOMSoon()}}));function onCopyCut(e){if(!belongsToInput(e)||signalDOMEvent(cm,e)){return}if(cm.somethingSelected()){setLastCopied({lineWise:false,text:cm.getSelections()});if(e.type=="cut"){cm.replaceSelection("",null,"cut")}}else if(!cm.options.lineWiseCopyCut){return}else{var ranges=copyableRanges(cm);setLastCopied({lineWise:true,text:ranges.text});if(e.type=="cut"){cm.operation((function(){cm.setSelections(ranges.ranges,0,sel_dontScroll);cm.replaceSelection("",null,"cut")}))}}if(e.clipboardData){e.clipboardData.clearData();var content=lastCopied.text.join("\n");e.clipboardData.setData("Text",content);if(e.clipboardData.getData("Text")==content){e.preventDefault();return}}var kludge=hiddenTextarea(),te=kludge.firstChild;disableBrowserMagic(te);cm.display.lineSpace.insertBefore(kludge,cm.display.lineSpace.firstChild);te.value=lastCopied.text.join("\n");var hadFocus=activeElt(div.ownerDocument);selectInput(te);setTimeout((function(){cm.display.lineSpace.removeChild(kludge);hadFocus.focus();if(hadFocus==div){input.showPrimarySelection()}}),50)}on(div,"copy",onCopyCut);on(div,"cut",onCopyCut)};ContentEditableInput.prototype.screenReaderLabelChanged=function(label){if(label){this.div.setAttribute("aria-label",label)}else{this.div.removeAttribute("aria-label")}};ContentEditableInput.prototype.prepareSelection=function(){var result=prepareSelection(this.cm,false);result.focus=activeElt(this.div.ownerDocument)==this.div;return result};ContentEditableInput.prototype.showSelection=function(info,takeFocus){if(!info||!this.cm.display.view.length){return}if(info.focus||takeFocus){this.showPrimarySelection()}this.showMultipleSelections(info)};ContentEditableInput.prototype.getSelection=function(){return this.cm.display.wrapper.ownerDocument.getSelection()};ContentEditableInput.prototype.showPrimarySelection=function(){var sel=this.getSelection(),cm=this.cm,prim=cm.doc.sel.primary();var from=prim.from(),to=prim.to();if(cm.display.viewTo==cm.display.viewFrom||from.line>=cm.display.viewTo||to.line<cm.display.viewFrom){sel.removeAllRanges();return}var curAnchor=domToPos(cm,sel.anchorNode,sel.anchorOffset);var curFocus=domToPos(cm,sel.focusNode,sel.focusOffset);if(curAnchor&&!curAnchor.bad&&curFocus&&!curFocus.bad&&cmp(minPos(curAnchor,curFocus),from)==0&&cmp(maxPos(curAnchor,curFocus),to)==0){return}var view=cm.display.view;var start=from.line>=cm.display.viewFrom&&posToDOM(cm,from)||{node:view[0].measure.map[2],offset:0};var end=to.line<cm.display.viewTo&&posToDOM(cm,to);if(!end){var measure=view[view.length-1].measure;var map=measure.maps?measure.maps[measure.maps.length-1]:measure.map;end={node:map[map.length-1],offset:map[map.length-2]-map[map.length-3]}}if(!start||!end){sel.removeAllRanges();return}var old=sel.rangeCount&&sel.getRangeAt(0),rng;try{rng=range(start.node,start.offset,end.offset,end.node)}catch(e){}if(rng){if(!gecko&&cm.state.focused){sel.collapse(start.node,start.offset);if(!rng.collapsed){sel.removeAllRanges();sel.addRange(rng)}}else{sel.removeAllRanges();sel.addRange(rng)}if(old&&sel.anchorNode==null){sel.addRange(old)}else if(gecko){this.startGracePeriod()}}this.rememberSelection()};ContentEditableInput.prototype.startGracePeriod=function(){var this$1=this;clearTimeout(this.gracePeriod);this.gracePeriod=setTimeout((function(){this$1.gracePeriod=false;if(this$1.selectionChanged()){this$1.cm.operation((function(){return this$1.cm.curOp.selectionChanged=true}))}}),20)};ContentEditableInput.prototype.showMultipleSelections=function(info){removeChildrenAndAdd(this.cm.display.cursorDiv,info.cursors);removeChildrenAndAdd(this.cm.display.selectionDiv,info.selection)};ContentEditableInput.prototype.rememberSelection=function(){var sel=this.getSelection();this.lastAnchorNode=sel.anchorNode;this.lastAnchorOffset=sel.anchorOffset;this.lastFocusNode=sel.focusNode;this.lastFocusOffset=sel.focusOffset};ContentEditableInput.prototype.selectionInEditor=function(){var sel=this.getSelection();if(!sel.rangeCount){return false}var node=sel.getRangeAt(0).commonAncestorContainer;return contains(this.div,node)};ContentEditableInput.prototype.focus=function(){if(this.cm.options.readOnly!="nocursor"){if(!this.selectionInEditor()||activeElt(this.div.ownerDocument)!=this.div){this.showSelection(this.prepareSelection(),true)}this.div.focus()}};ContentEditableInput.prototype.blur=function(){this.div.blur()};ContentEditableInput.prototype.getField=function(){return this.div};ContentEditableInput.prototype.supportsTouch=function(){return true};ContentEditableInput.prototype.receivedFocus=function(){var this$1=this;var input=this;if(this.selectionInEditor()){setTimeout((function(){return this$1.pollSelection()}),20)}else{runInOp(this.cm,(function(){return input.cm.curOp.selectionChanged=true}))}function poll(){if(input.cm.state.focused){input.pollSelection();input.polling.set(input.cm.options.pollInterval,poll)}}this.polling.set(this.cm.options.pollInterval,poll)};ContentEditableInput.prototype.selectionChanged=function(){var sel=this.getSelection();return sel.anchorNode!=this.lastAnchorNode||sel.anchorOffset!=this.lastAnchorOffset||sel.focusNode!=this.lastFocusNode||sel.focusOffset!=this.lastFocusOffset};ContentEditableInput.prototype.pollSelection=function(){if(this.readDOMTimeout!=null||this.gracePeriod||!this.selectionChanged()){return}var sel=this.getSelection(),cm=this.cm;if(android&&chrome&&this.cm.display.gutterSpecs.length&&isInGutter(sel.anchorNode)){this.cm.triggerOnKeyDown({type:"keydown",keyCode:8,preventDefault:Math.abs});this.blur();this.focus();return}if(this.composing){return}this.rememberSelection();var anchor=domToPos(cm,sel.anchorNode,sel.anchorOffset);var head=domToPos(cm,sel.focusNode,sel.focusOffset);if(anchor&&head){runInOp(cm,(function(){setSelection(cm.doc,simpleSelection(anchor,head),sel_dontScroll);if(anchor.bad||head.bad){cm.curOp.selectionChanged=true}}))}};ContentEditableInput.prototype.pollContent=function(){if(this.readDOMTimeout!=null){clearTimeout(this.readDOMTimeout);this.readDOMTimeout=null}var cm=this.cm,display=cm.display,sel=cm.doc.sel.primary();var from=sel.from(),to=sel.to();if(from.ch==0&&from.line>cm.firstLine()){from=Pos(from.line-1,getLine(cm.doc,from.line-1).length)}if(to.ch==getLine(cm.doc,to.line).text.length&&to.line<cm.lastLine()){to=Pos(to.line+1,0)}if(from.line<display.viewFrom||to.line>display.viewTo-1){return false}var fromIndex,fromLine,fromNode;if(from.line==display.viewFrom||(fromIndex=findViewIndex(cm,from.line))==0){fromLine=lineNo(display.view[0].line);fromNode=display.view[0].node}else{fromLine=lineNo(display.view[fromIndex].line);fromNode=display.view[fromIndex-1].node.nextSibling}var toIndex=findViewIndex(cm,to.line);var toLine,toNode;if(toIndex==display.view.length-1){toLine=display.viewTo-1;toNode=display.lineDiv.lastChild}else{toLine=lineNo(display.view[toIndex+1].line)-1;toNode=display.view[toIndex+1].node.previousSibling}if(!fromNode){return false}var newText=cm.doc.splitLines(domTextBetween(cm,fromNode,toNode,fromLine,toLine));var oldText=getBetween(cm.doc,Pos(fromLine,0),Pos(toLine,getLine(cm.doc,toLine).text.length));while(newText.length>1&&oldText.length>1){if(lst(newText)==lst(oldText)){newText.pop();oldText.pop();toLine--}else if(newText[0]==oldText[0]){newText.shift();oldText.shift();fromLine++}else{break}}var cutFront=0,cutEnd=0;var newTop=newText[0],oldTop=oldText[0],maxCutFront=Math.min(newTop.length,oldTop.length);while(cutFront<maxCutFront&&newTop.charCodeAt(cutFront)==oldTop.charCodeAt(cutFront)){++cutFront}var newBot=lst(newText),oldBot=lst(oldText);var maxCutEnd=Math.min(newBot.length-(newText.length==1?cutFront:0),oldBot.length-(oldText.length==1?cutFront:0));while(cutEnd<maxCutEnd&&newBot.charCodeAt(newBot.length-cutEnd-1)==oldBot.charCodeAt(oldBot.length-cutEnd-1)){++cutEnd}if(newText.length==1&&oldText.length==1&&fromLine==from.line){while(cutFront&&cutFront>from.ch&&newBot.charCodeAt(newBot.length-cutEnd-1)==oldBot.charCodeAt(oldBot.length-cutEnd-1)){cutFront--;cutEnd++}}newText[newText.length-1]=newBot.slice(0,newBot.length-cutEnd).replace(/^\u200b+/,"");newText[0]=newText[0].slice(cutFront).replace(/\u200b+$/,"");var chFrom=Pos(fromLine,cutFront);var chTo=Pos(toLine,oldText.length?lst(oldText).length-cutEnd:0);if(newText.length>1||newText[0]||cmp(chFrom,chTo)){replaceRange(cm.doc,newText,chFrom,chTo,"+input");return true}};ContentEditableInput.prototype.ensurePolled=function(){this.forceCompositionEnd()};ContentEditableInput.prototype.reset=function(){this.forceCompositionEnd()};ContentEditableInput.prototype.forceCompositionEnd=function(){if(!this.composing){return}clearTimeout(this.readDOMTimeout);this.composing=null;this.updateFromDOM();this.div.blur();this.div.focus()};ContentEditableInput.prototype.readFromDOMSoon=function(){var this$1=this;if(this.readDOMTimeout!=null){return}this.readDOMTimeout=setTimeout((function(){this$1.readDOMTimeout=null;if(this$1.composing){if(this$1.composing.done){this$1.composing=null}else{return}}this$1.updateFromDOM()}),80)};ContentEditableInput.prototype.updateFromDOM=function(){var this$1=this;if(this.cm.isReadOnly()||!this.pollContent()){runInOp(this.cm,(function(){return regChange(this$1.cm)}))}};ContentEditableInput.prototype.setUneditable=function(node){node.contentEditable="false"};ContentEditableInput.prototype.onKeyPress=function(e){if(e.charCode==0||this.composing){return}e.preventDefault();if(!this.cm.isReadOnly()){operation(this.cm,applyTextInput)(this.cm,String.fromCharCode(e.charCode==null?e.keyCode:e.charCode),0)}};ContentEditableInput.prototype.readOnlyChanged=function(val){this.div.contentEditable=String(val!="nocursor")};ContentEditableInput.prototype.onContextMenu=function(){};ContentEditableInput.prototype.resetPosition=function(){};ContentEditableInput.prototype.needsContentAttribute=true;function posToDOM(cm,pos){var view=findViewForLine(cm,pos.line);if(!view||view.hidden){return null}var line=getLine(cm.doc,pos.line);var info=mapFromLineView(view,line,pos.line);var order=getOrder(line,cm.doc.direction),side="left";if(order){var partPos=getBidiPartAt(order,pos.ch);side=partPos%2?"right":"left"}var result=nodeAndOffsetInLineMap(info.map,pos.ch,side);result.offset=result.collapse=="right"?result.end:result.start;return result}function isInGutter(node){for(var scan=node;scan;scan=scan.parentNode){if(/CodeMirror-gutter-wrapper/.test(scan.className)){return true}}return false}function badPos(pos,bad){if(bad){pos.bad=true}return pos}function domTextBetween(cm,from,to,fromLine,toLine){var text="",closing=false,lineSep=cm.doc.lineSeparator(),extraLinebreak=false;function recognizeMarker(id){return function(marker){return marker.id==id}}function close(){if(closing){text+=lineSep;if(extraLinebreak){text+=lineSep}closing=extraLinebreak=false}}function addText(str){if(str){close();text+=str}}function walk(node){if(node.nodeType==1){var cmText=node.getAttribute("cm-text");if(cmText){addText(cmText);return}var markerID=node.getAttribute("cm-marker"),range;if(markerID){var found=cm.findMarks(Pos(fromLine,0),Pos(toLine+1,0),recognizeMarker(+markerID));if(found.length&&(range=found[0].find(0))){addText(getBetween(cm.doc,range.from,range.to).join(lineSep))}return}if(node.getAttribute("contenteditable")=="false"){return}var isBlock=/^(pre|div|p|li|table|br)$/i.test(node.nodeName);if(!/^br$/i.test(node.nodeName)&&node.textContent.length==0){return}if(isBlock){close()}for(var i=0;i<node.childNodes.length;i++){walk(node.childNodes[i])}if(/^(pre|p)$/i.test(node.nodeName)){extraLinebreak=true}if(isBlock){closing=true}}else if(node.nodeType==3){addText(node.nodeValue.replace(/\u200b/g,"").replace(/\u00a0/g," "))}}for(;;){walk(from);if(from==to){break}from=from.nextSibling;extraLinebreak=false}return text}function domToPos(cm,node,offset){var lineNode;if(node==cm.display.lineDiv){lineNode=cm.display.lineDiv.childNodes[offset];if(!lineNode){return badPos(cm.clipPos(Pos(cm.display.viewTo-1)),true)}node=null;offset=0}else{for(lineNode=node;;lineNode=lineNode.parentNode){if(!lineNode||lineNode==cm.display.lineDiv){return null}if(lineNode.parentNode&&lineNode.parentNode==cm.display.lineDiv){break}}}for(var i=0;i<cm.display.view.length;i++){var lineView=cm.display.view[i];if(lineView.node==lineNode){return locateNodeInLineView(lineView,node,offset)}}}function locateNodeInLineView(lineView,node,offset){var wrapper=lineView.text.firstChild,bad=false;if(!node||!contains(wrapper,node)){return badPos(Pos(lineNo(lineView.line),0),true)}if(node==wrapper){bad=true;node=wrapper.childNodes[offset];offset=0;if(!node){var line=lineView.rest?lst(lineView.rest):lineView.line;return badPos(Pos(lineNo(line),line.text.length),bad)}}var textNode=node.nodeType==3?node:null,topNode=node;if(!textNode&&node.childNodes.length==1&&node.firstChild.nodeType==3){textNode=node.firstChild;if(offset){offset=textNode.nodeValue.length}}while(topNode.parentNode!=wrapper){topNode=topNode.parentNode}var measure=lineView.measure,maps=measure.maps;function find(textNode,topNode,offset){for(var i=-1;i<(maps?maps.length:0);i++){var map=i<0?measure.map:maps[i];for(var j=0;j<map.length;j+=3){var curNode=map[j+2];if(curNode==textNode||curNode==topNode){var line=lineNo(i<0?lineView.line:lineView.rest[i]);var ch=map[j]+offset;if(offset<0||curNode!=textNode){ch=map[j+(offset?1:0)]}return Pos(line,ch)}}}}var found=find(textNode,topNode,offset);if(found){return badPos(found,bad)}for(var after=topNode.nextSibling,dist=textNode?textNode.nodeValue.length-offset:0;after;after=after.nextSibling){found=find(after,after.firstChild,0);if(found){return badPos(Pos(found.line,found.ch-dist),bad)}else{dist+=after.textContent.length}}for(var before=topNode.previousSibling,dist$1=offset;before;before=before.previousSibling){found=find(before,before.firstChild,-1);if(found){return badPos(Pos(found.line,found.ch+dist$1),bad)}else{dist$1+=before.textContent.length}}}var TextareaInput=function(cm){this.cm=cm;this.prevInput="";this.pollingFast=false;this.polling=new Delayed;this.hasSelection=false;this.composing=null;this.resetting=false};TextareaInput.prototype.init=function(display){var this$1=this;var input=this,cm=this.cm;this.createField(display);var te=this.textarea;display.wrapper.insertBefore(this.wrapper,display.wrapper.firstChild);if(ios){te.style.width="0px"}on(te,"input",(function(){if(ie&&ie_version>=9&&this$1.hasSelection){this$1.hasSelection=null}input.poll()}));on(te,"paste",(function(e){if(signalDOMEvent(cm,e)||handlePaste(e,cm)){return}cm.state.pasteIncoming=+new Date;input.fastPoll()}));function prepareCopyCut(e){if(signalDOMEvent(cm,e)){return}if(cm.somethingSelected()){setLastCopied({lineWise:false,text:cm.getSelections()})}else if(!cm.options.lineWiseCopyCut){return}else{var ranges=copyableRanges(cm);setLastCopied({lineWise:true,text:ranges.text});if(e.type=="cut"){cm.setSelections(ranges.ranges,null,sel_dontScroll)}else{input.prevInput="";te.value=ranges.text.join("\n");selectInput(te)}}if(e.type=="cut"){cm.state.cutIncoming=+new Date}}on(te,"cut",prepareCopyCut);on(te,"copy",prepareCopyCut);on(display.scroller,"paste",(function(e){if(eventInWidget(display,e)||signalDOMEvent(cm,e)){return}if(!te.dispatchEvent){cm.state.pasteIncoming=+new Date;input.focus();return}var event=new Event("paste");event.clipboardData=e.clipboardData;te.dispatchEvent(event)}));on(display.lineSpace,"selectstart",(function(e){if(!eventInWidget(display,e)){e_preventDefault(e)}}));on(te,"compositionstart",(function(){var start=cm.getCursor("from");if(input.composing){input.composing.range.clear()}input.composing={start:start,range:cm.markText(start,cm.getCursor("to"),{className:"CodeMirror-composing"})}}));on(te,"compositionend",(function(){if(input.composing){input.poll();input.composing.range.clear();input.composing=null}}))};TextareaInput.prototype.createField=function(_display){this.wrapper=hiddenTextarea();this.textarea=this.wrapper.firstChild;var opts=this.cm.options;disableBrowserMagic(this.textarea,opts.spellcheck,opts.autocorrect,opts.autocapitalize)};TextareaInput.prototype.screenReaderLabelChanged=function(label){if(label){this.textarea.setAttribute("aria-label",label)}else{this.textarea.removeAttribute("aria-label")}};TextareaInput.prototype.prepareSelection=function(){var cm=this.cm,display=cm.display,doc=cm.doc;var result=prepareSelection(cm);if(cm.options.moveInputWithCursor){var headPos=cursorCoords(cm,doc.sel.primary().head,"div");var wrapOff=display.wrapper.getBoundingClientRect(),lineOff=display.lineDiv.getBoundingClientRect();result.teTop=Math.max(0,Math.min(display.wrapper.clientHeight-10,headPos.top+lineOff.top-wrapOff.top));result.teLeft=Math.max(0,Math.min(display.wrapper.clientWidth-10,headPos.left+lineOff.left-wrapOff.left))}return result};TextareaInput.prototype.showSelection=function(drawn){var cm=this.cm,display=cm.display;removeChildrenAndAdd(display.cursorDiv,drawn.cursors);removeChildrenAndAdd(display.selectionDiv,drawn.selection);if(drawn.teTop!=null){this.wrapper.style.top=drawn.teTop+"px";this.wrapper.style.left=drawn.teLeft+"px"}};TextareaInput.prototype.reset=function(typing){if(this.contextMenuPending||this.composing&&typing){return}var cm=this.cm;this.resetting=true;if(cm.somethingSelected()){this.prevInput="";var content=cm.getSelection();this.textarea.value=content;if(cm.state.focused){selectInput(this.textarea)}if(ie&&ie_version>=9){this.hasSelection=content}}else if(!typing){this.prevInput=this.textarea.value="";if(ie&&ie_version>=9){this.hasSelection=null}}this.resetting=false};TextareaInput.prototype.getField=function(){return this.textarea};TextareaInput.prototype.supportsTouch=function(){return false};TextareaInput.prototype.focus=function(){if(this.cm.options.readOnly!="nocursor"&&(!mobile||activeElt(this.textarea.ownerDocument)!=this.textarea)){try{this.textarea.focus()}catch(e){}}};TextareaInput.prototype.blur=function(){this.textarea.blur()};TextareaInput.prototype.resetPosition=function(){this.wrapper.style.top=this.wrapper.style.left=0};TextareaInput.prototype.receivedFocus=function(){this.slowPoll()};TextareaInput.prototype.slowPoll=function(){var this$1=this;if(this.pollingFast){return}this.polling.set(this.cm.options.pollInterval,(function(){this$1.poll();if(this$1.cm.state.focused){this$1.slowPoll()}}))};TextareaInput.prototype.fastPoll=function(){var missed=false,input=this;input.pollingFast=true;function p(){var changed=input.poll();if(!changed&&!missed){missed=true;input.polling.set(60,p)}else{input.pollingFast=false;input.slowPoll()}}input.polling.set(20,p)};TextareaInput.prototype.poll=function(){var this$1=this;var cm=this.cm,input=this.textarea,prevInput=this.prevInput;if(this.contextMenuPending||this.resetting||!cm.state.focused||hasSelection(input)&&!prevInput&&!this.composing||cm.isReadOnly()||cm.options.disableInput||cm.state.keySeq){return false}var text=input.value;if(text==prevInput&&!cm.somethingSelected()){return false}if(ie&&ie_version>=9&&this.hasSelection===text||mac&&/[\uf700-\uf7ff]/.test(text)){cm.display.input.reset();return false}if(cm.doc.sel==cm.display.selForContextMenu){var first=text.charCodeAt(0);if(first==8203&&!prevInput){prevInput="​"}if(first==8666){this.reset();return this.cm.execCommand("undo")}}var same=0,l=Math.min(prevInput.length,text.length);while(same<l&&prevInput.charCodeAt(same)==text.charCodeAt(same)){++same}runInOp(cm,(function(){applyTextInput(cm,text.slice(same),prevInput.length-same,null,this$1.composing?"*compose":null);if(text.length>1e3||text.indexOf("\n")>-1){input.value=this$1.prevInput=""}else{this$1.prevInput=text}if(this$1.composing){this$1.composing.range.clear();this$1.composing.range=cm.markText(this$1.composing.start,cm.getCursor("to"),{className:"CodeMirror-composing"})}}));return true};TextareaInput.prototype.ensurePolled=function(){if(this.pollingFast&&this.poll()){this.pollingFast=false}};TextareaInput.prototype.onKeyPress=function(){if(ie&&ie_version>=9){this.hasSelection=null}this.fastPoll()};TextareaInput.prototype.onContextMenu=function(e){var input=this,cm=input.cm,display=cm.display,te=input.textarea;if(input.contextMenuPending){input.contextMenuPending()}var pos=posFromMouse(cm,e),scrollPos=display.scroller.scrollTop;if(!pos||presto){return}var reset=cm.options.resetSelectionOnContextMenu;if(reset&&cm.doc.sel.contains(pos)==-1){operation(cm,setSelection)(cm.doc,simpleSelection(pos),sel_dontScroll)}var oldCSS=te.style.cssText,oldWrapperCSS=input.wrapper.style.cssText;var wrapperBox=input.wrapper.offsetParent.getBoundingClientRect();input.wrapper.style.cssText="position: static";te.style.cssText="position: absolute; width: 30px; height: 30px;\n      top: "+(e.clientY-wrapperBox.top-5)+"px; left: "+(e.clientX-wrapperBox.left-5)+"px;\n      z-index: 1000; background: "+(ie?"rgba(255, 255, 255, .05)":"transparent")+";\n      outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);";var oldScrollY;if(webkit){oldScrollY=te.ownerDocument.defaultView.scrollY}display.input.focus();if(webkit){te.ownerDocument.defaultView.scrollTo(null,oldScrollY)}display.input.reset();if(!cm.somethingSelected()){te.value=input.prevInput=" "}input.contextMenuPending=rehide;display.selForContextMenu=cm.doc.sel;clearTimeout(display.detectingSelectAll);function prepareSelectAllHack(){if(te.selectionStart!=null){var selected=cm.somethingSelected();var extval="​"+(selected?te.value:"");te.value="⇚";te.value=extval;input.prevInput=selected?"":"​";te.selectionStart=1;te.selectionEnd=extval.length;display.selForContextMenu=cm.doc.sel}}function rehide(){if(input.contextMenuPending!=rehide){return}input.contextMenuPending=false;input.wrapper.style.cssText=oldWrapperCSS;te.style.cssText=oldCSS;if(ie&&ie_version<9){display.scrollbars.setScrollTop(display.scroller.scrollTop=scrollPos)}if(te.selectionStart!=null){if(!ie||ie&&ie_version<9){prepareSelectAllHack()}var i=0,poll=function(){if(display.selForContextMenu==cm.doc.sel&&te.selectionStart==0&&te.selectionEnd>0&&input.prevInput=="​"){operation(cm,selectAll)(cm)}else if(i++<10){display.detectingSelectAll=setTimeout(poll,500)}else{display.selForContextMenu=null;display.input.reset()}};display.detectingSelectAll=setTimeout(poll,200)}}if(ie&&ie_version>=9){prepareSelectAllHack()}if(captureRightClick){e_stop(e);var mouseup=function(){off(window,"mouseup",mouseup);setTimeout(rehide,20)};on(window,"mouseup",mouseup)}else{setTimeout(rehide,50)}};TextareaInput.prototype.readOnlyChanged=function(val){if(!val){this.reset()}this.textarea.disabled=val=="nocursor";this.textarea.readOnly=!!val};TextareaInput.prototype.setUneditable=function(){};TextareaInput.prototype.needsContentAttribute=false;function fromTextArea(textarea,options){options=options?copyObj(options):{};options.value=textarea.value;if(!options.tabindex&&textarea.tabIndex){options.tabindex=textarea.tabIndex}if(!options.placeholder&&textarea.placeholder){options.placeholder=textarea.placeholder}if(options.autofocus==null){var hasFocus=activeElt(textarea.ownerDocument);options.autofocus=hasFocus==textarea||textarea.getAttribute("autofocus")!=null&&hasFocus==document.body}function save(){textarea.value=cm.getValue()}var realSubmit;if(textarea.form){on(textarea.form,"submit",save);if(!options.leaveSubmitMethodAlone){var form=textarea.form;realSubmit=form.submit;try{var wrappedSubmit=form.submit=function(){save();form.submit=realSubmit;form.submit();form.submit=wrappedSubmit}}catch(e){}}}options.finishInit=function(cm){cm.save=save;cm.getTextArea=function(){return textarea};cm.toTextArea=function(){cm.toTextArea=isNaN;save();textarea.parentNode.removeChild(cm.getWrapperElement());textarea.style.display="";if(textarea.form){off(textarea.form,"submit",save);if(!options.leaveSubmitMethodAlone&&typeof textarea.form.submit=="function"){textarea.form.submit=realSubmit}}}};textarea.style.display="none";var cm=CodeMirror((function(node){return textarea.parentNode.insertBefore(node,textarea.nextSibling)}),options);return cm}function addLegacyProps(CodeMirror){CodeMirror.off=off;CodeMirror.on=on;CodeMirror.wheelEventPixels=wheelEventPixels;CodeMirror.Doc=Doc;CodeMirror.splitLines=splitLinesAuto;CodeMirror.countColumn=countColumn;CodeMirror.findColumn=findColumn;CodeMirror.isWordChar=isWordCharBasic;CodeMirror.Pass=Pass;CodeMirror.signal=signal;CodeMirror.Line=Line;CodeMirror.changeEnd=changeEnd;CodeMirror.scrollbarModel=scrollbarModel;CodeMirror.Pos=Pos;CodeMirror.cmpPos=cmp;CodeMirror.modes=modes;CodeMirror.mimeModes=mimeModes;CodeMirror.resolveMode=resolveMode;CodeMirror.getMode=getMode;CodeMirror.modeExtensions=modeExtensions;CodeMirror.extendMode=extendMode;CodeMirror.copyState=copyState;CodeMirror.startState=startState;CodeMirror.innerMode=innerMode;CodeMirror.commands=commands;CodeMirror.keyMap=keyMap;CodeMirror.keyName=keyName;CodeMirror.isModifierKey=isModifierKey;CodeMirror.lookupKey=lookupKey;CodeMirror.normalizeKeyMap=normalizeKeyMap;CodeMirror.StringStream=StringStream;CodeMirror.SharedTextMarker=SharedTextMarker;CodeMirror.TextMarker=TextMarker;CodeMirror.LineWidget=LineWidget;CodeMirror.e_preventDefault=e_preventDefault;CodeMirror.e_stopPropagation=e_stopPropagation;CodeMirror.e_stop=e_stop;CodeMirror.addClass=addClass;CodeMirror.contains=contains;CodeMirror.rmClass=rmClass;CodeMirror.keyNames=keyNames}defineOptions(CodeMirror);addEditorMethods(CodeMirror);var dontDelegate="iter insert remove copy getEditor constructor".split(" ");for(var prop in Doc.prototype){if(Doc.prototype.hasOwnProperty(prop)&&indexOf(dontDelegate,prop)<0){CodeMirror.prototype[prop]=function(method){return function(){return method.apply(this.doc,arguments)}}(Doc.prototype[prop])}}eventMixin(Doc);CodeMirror.inputStyles={textarea:TextareaInput,contenteditable:ContentEditableInput};CodeMirror.defineMode=function(name){if(!CodeMirror.defaults.mode&&name!="null"){CodeMirror.defaults.mode=name}defineMode.apply(this,arguments)};CodeMirror.defineMIME=defineMIME;CodeMirror.defineMode("null",(function(){return{token:function(stream){return stream.skipToEnd()}}}));CodeMirror.defineMIME("text/plain","null");CodeMirror.defineExtension=function(name,func){CodeMirror.prototype[name]=func};CodeMirror.defineDocExtension=function(name,func){Doc.prototype[name]=func};CodeMirror.fromTextArea=fromTextArea;addLegacyProps(CodeMirror);CodeMirror.version="5.65.15";return CodeMirror}));(function(mod){if(typeof exports=="object"&&typeof module=="object")mod(require("../lib/codemirror"),require("../addon/search/searchcursor"),require("../addon/edit/matchbrackets"));else if(typeof define=="function"&&define.amd)define(["../lib/codemirror","../addon/search/searchcursor","../addon/edit/matchbrackets"],mod);else mod(CodeMirror)})((function(CodeMirror){"use strict";var cmds=CodeMirror.commands;var Pos=CodeMirror.Pos;function findPosSubword(doc,start,dir){if(dir<0&&start.ch==0)return doc.clipPos(Pos(start.line-1));var line=doc.getLine(start.line);if(dir>0&&start.ch>=line.length)return doc.clipPos(Pos(start.line+1,0));var state="start",type,startPos=start.ch;for(var pos=startPos,e=dir<0?0:line.length,i=0;pos!=e;pos+=dir,i++){var next=line.charAt(dir<0?pos-1:pos);var cat=next!="_"&&CodeMirror.isWordChar(next)?"w":"o";if(cat=="w"&&next.toUpperCase()==next)cat="W";if(state=="start"){if(cat!="o"){state="in";type=cat}else startPos=pos+dir}else if(state=="in"){if(type!=cat){if(type=="w"&&cat=="W"&&dir<0)pos--;if(type=="W"&&cat=="w"&&dir>0){if(pos==startPos+1){type="w";continue}else pos--}break}}}return Pos(start.line,pos)}function moveSubword(cm,dir){cm.extendSelectionsBy((function(range){if(cm.display.shift||cm.doc.extend||range.empty())return findPosSubword(cm.doc,range.head,dir);else return dir<0?range.from():range.to()}))}cmds.goSubwordLeft=function(cm){moveSubword(cm,-1)};cmds.goSubwordRight=function(cm){moveSubword(cm,1)};cmds.scrollLineUp=function(cm){var info=cm.getScrollInfo();if(!cm.somethingSelected()){var visibleBottomLine=cm.lineAtHeight(info.top+info.clientHeight,"local");if(cm.getCursor().line>=visibleBottomLine)cm.execCommand("goLineUp")}cm.scrollTo(null,info.top-cm.defaultTextHeight())};cmds.scrollLineDown=function(cm){var info=cm.getScrollInfo();if(!cm.somethingSelected()){var visibleTopLine=cm.lineAtHeight(info.top,"local")+1;if(cm.getCursor().line<=visibleTopLine)cm.execCommand("goLineDown")}cm.scrollTo(null,info.top+cm.defaultTextHeight())};cmds.splitSelectionByLine=function(cm){var ranges=cm.listSelections(),lineRanges=[];for(var i=0;i<ranges.length;i++){var from=ranges[i].from(),to=ranges[i].to();for(var line=from.line;line<=to.line;++line)if(!(to.line>from.line&&line==to.line&&to.ch==0))lineRanges.push({anchor:line==from.line?from:Pos(line,0),head:line==to.line?to:Pos(line)})}cm.setSelections(lineRanges,0)};cmds.singleSelectionTop=function(cm){var range=cm.listSelections()[0];cm.setSelection(range.anchor,range.head,{scroll:false})};cmds.selectLine=function(cm){var ranges=cm.listSelections(),extended=[];for(var i=0;i<ranges.length;i++){var range=ranges[i];extended.push({anchor:Pos(range.from().line,0),head:Pos(range.to().line+1,0)})}cm.setSelections(extended)};function insertLine(cm,above){if(cm.isReadOnly())return CodeMirror.Pass;cm.operation((function(){var len=cm.listSelections().length,newSelection=[],last=-1;for(var i=0;i<len;i++){var head=cm.listSelections()[i].head;if(head.line<=last)continue;var at=Pos(head.line+(above?0:1),0);cm.replaceRange("\n",at,null,"+insertLine");cm.indentLine(at.line,null,true);newSelection.push({head:at,anchor:at});last=head.line+1}cm.setSelections(newSelection)}));cm.execCommand("indentAuto")}cmds.insertLineAfter=function(cm){return insertLine(cm,false)};cmds.insertLineBefore=function(cm){return insertLine(cm,true)};function wordAt(cm,pos){var start=pos.ch,end=start,line=cm.getLine(pos.line);while(start&&CodeMirror.isWordChar(line.charAt(start-1)))--start;while(end<line.length&&CodeMirror.isWordChar(line.charAt(end)))++end;return{from:Pos(pos.line,start),to:Pos(pos.line,end),word:line.slice(start,end)}}cmds.selectNextOccurrence=function(cm){var from=cm.getCursor("from"),to=cm.getCursor("to");var fullWord=cm.state.sublimeFindFullWord==cm.doc.sel;if(CodeMirror.cmpPos(from,to)==0){var word=wordAt(cm,from);if(!word.word)return;cm.setSelection(word.from,word.to);fullWord=true}else{var text=cm.getRange(from,to);var query=fullWord?new RegExp("\\b"+text+"\\b"):text;var cur=cm.getSearchCursor(query,to);var found=cur.findNext();if(!found){cur=cm.getSearchCursor(query,Pos(cm.firstLine(),0));found=cur.findNext()}if(!found||isSelectedRange(cm.listSelections(),cur.from(),cur.to()))return;cm.addSelection(cur.from(),cur.to())}if(fullWord)cm.state.sublimeFindFullWord=cm.doc.sel};cmds.skipAndSelectNextOccurrence=function(cm){var prevAnchor=cm.getCursor("anchor"),prevHead=cm.getCursor("head");cmds.selectNextOccurrence(cm);if(CodeMirror.cmpPos(prevAnchor,prevHead)!=0){cm.doc.setSelections(cm.doc.listSelections().filter((function(sel){return sel.anchor!=prevAnchor||sel.head!=prevHead})))}};function addCursorToSelection(cm,dir){var ranges=cm.listSelections(),newRanges=[];for(var i=0;i<ranges.length;i++){var range=ranges[i];var newAnchor=cm.findPosV(range.anchor,dir,"line",range.anchor.goalColumn);var newHead=cm.findPosV(range.head,dir,"line",range.head.goalColumn);newAnchor.goalColumn=range.anchor.goalColumn!=null?range.anchor.goalColumn:cm.cursorCoords(range.anchor,"div").left;newHead.goalColumn=range.head.goalColumn!=null?range.head.goalColumn:cm.cursorCoords(range.head,"div").left;var newRange={anchor:newAnchor,head:newHead};newRanges.push(range);newRanges.push(newRange)}cm.setSelections(newRanges)}cmds.addCursorToPrevLine=function(cm){addCursorToSelection(cm,-1)};cmds.addCursorToNextLine=function(cm){addCursorToSelection(cm,1)};function isSelectedRange(ranges,from,to){for(var i=0;i<ranges.length;i++)if(CodeMirror.cmpPos(ranges[i].from(),from)==0&&CodeMirror.cmpPos(ranges[i].to(),to)==0)return true;return false}var mirror="(){}[]";function selectBetweenBrackets(cm){var ranges=cm.listSelections(),newRanges=[];for(var i=0;i<ranges.length;i++){var range=ranges[i],pos=range.head,opening=cm.scanForBracket(pos,-1);if(!opening)return false;for(;;){var closing=cm.scanForBracket(pos,1);if(!closing)return false;if(closing.ch==mirror.charAt(mirror.indexOf(opening.ch)+1)){var startPos=Pos(opening.pos.line,opening.pos.ch+1);if(CodeMirror.cmpPos(startPos,range.from())==0&&CodeMirror.cmpPos(closing.pos,range.to())==0){opening=cm.scanForBracket(opening.pos,-1);if(!opening)return false}else{newRanges.push({anchor:startPos,head:closing.pos});break}}pos=Pos(closing.pos.line,closing.pos.ch+1)}}cm.setSelections(newRanges);return true}cmds.selectScope=function(cm){selectBetweenBrackets(cm)||cm.execCommand("selectAll")};cmds.selectBetweenBrackets=function(cm){if(!selectBetweenBrackets(cm))return CodeMirror.Pass};function puncType(type){return!type?null:/\bpunctuation\b/.test(type)?type:undefined}cmds.goToBracket=function(cm){cm.extendSelectionsBy((function(range){var next=cm.scanForBracket(range.head,1,puncType(cm.getTokenTypeAt(range.head)));if(next&&CodeMirror.cmpPos(next.pos,range.head)!=0)return next.pos;var prev=cm.scanForBracket(range.head,-1,puncType(cm.getTokenTypeAt(Pos(range.head.line,range.head.ch+1))));return prev&&Pos(prev.pos.line,prev.pos.ch+1)||range.head}))};cmds.swapLineUp=function(cm){if(cm.isReadOnly())return CodeMirror.Pass;var ranges=cm.listSelections(),linesToMove=[],at=cm.firstLine()-1,newSels=[];for(var i=0;i<ranges.length;i++){var range=ranges[i],from=range.from().line-1,to=range.to().line;newSels.push({anchor:Pos(range.anchor.line-1,range.anchor.ch),head:Pos(range.head.line-1,range.head.ch)});if(range.to().ch==0&&!range.empty())--to;if(from>at)linesToMove.push(from,to);else if(linesToMove.length)linesToMove[linesToMove.length-1]=to;at=to}cm.operation((function(){for(var i=0;i<linesToMove.length;i+=2){var from=linesToMove[i],to=linesToMove[i+1];var line=cm.getLine(from);cm.replaceRange("",Pos(from,0),Pos(from+1,0),"+swapLine");if(to>cm.lastLine())cm.replaceRange("\n"+line,Pos(cm.lastLine()),null,"+swapLine");else cm.replaceRange(line+"\n",Pos(to,0),null,"+swapLine")}cm.setSelections(newSels);cm.scrollIntoView()}))};cmds.swapLineDown=function(cm){if(cm.isReadOnly())return CodeMirror.Pass;var ranges=cm.listSelections(),linesToMove=[],at=cm.lastLine()+1;for(var i=ranges.length-1;i>=0;i--){var range=ranges[i],from=range.to().line+1,to=range.from().line;if(range.to().ch==0&&!range.empty())from--;if(from<at)linesToMove.push(from,to);else if(linesToMove.length)linesToMove[linesToMove.length-1]=to;at=to}cm.operation((function(){for(var i=linesToMove.length-2;i>=0;i-=2){var from=linesToMove[i],to=linesToMove[i+1];var line=cm.getLine(from);if(from==cm.lastLine())cm.replaceRange("",Pos(from-1),Pos(from),"+swapLine");else cm.replaceRange("",Pos(from,0),Pos(from+1,0),"+swapLine");cm.replaceRange(line+"\n",Pos(to,0),null,"+swapLine")}cm.scrollIntoView()}))};cmds.toggleCommentIndented=function(cm){cm.toggleComment({indent:true})};cmds.joinLines=function(cm){var ranges=cm.listSelections(),joined=[];for(var i=0;i<ranges.length;i++){var range=ranges[i],from=range.from();var start=from.line,end=range.to().line;while(i<ranges.length-1&&ranges[i+1].from().line==end)end=ranges[++i].to().line;joined.push({start:start,end:end,anchor:!range.empty()&&from})}cm.operation((function(){var offset=0,ranges=[];for(var i=0;i<joined.length;i++){var obj=joined[i];var anchor=obj.anchor&&Pos(obj.anchor.line-offset,obj.anchor.ch),head;for(var line=obj.start;line<=obj.end;line++){var actual=line-offset;if(line==obj.end)head=Pos(actual,cm.getLine(actual).length+1);if(actual<cm.lastLine()){cm.replaceRange(" ",Pos(actual),Pos(actual+1,/^\s*/.exec(cm.getLine(actual+1))[0].length));++offset}}ranges.push({anchor:anchor||head,head:head})}cm.setSelections(ranges,0)}))};cmds.duplicateLine=function(cm){cm.operation((function(){var rangeCount=cm.listSelections().length;for(var i=0;i<rangeCount;i++){var range=cm.listSelections()[i];if(range.empty())cm.replaceRange(cm.getLine(range.head.line)+"\n",Pos(range.head.line,0));else cm.replaceRange(cm.getRange(range.from(),range.to()),range.from())}cm.scrollIntoView()}))};function sortLines(cm,caseSensitive,direction){if(cm.isReadOnly())return CodeMirror.Pass;var ranges=cm.listSelections(),toSort=[],selected;for(var i=0;i<ranges.length;i++){var range=ranges[i];if(range.empty())continue;var from=range.from().line,to=range.to().line;while(i<ranges.length-1&&ranges[i+1].from().line==to)to=ranges[++i].to().line;if(!ranges[i].to().ch)to--;toSort.push(from,to)}if(toSort.length)selected=true;else toSort.push(cm.firstLine(),cm.lastLine());cm.operation((function(){var ranges=[];for(var i=0;i<toSort.length;i+=2){var from=toSort[i],to=toSort[i+1];var start=Pos(from,0),end=Pos(to);var lines=cm.getRange(start,end,false);if(caseSensitive)lines.sort((function(a,b){return a<b?-direction:a==b?0:direction}));else lines.sort((function(a,b){var au=a.toUpperCase(),bu=b.toUpperCase();if(au!=bu){a=au;b=bu}return a<b?-direction:a==b?0:direction}));cm.replaceRange(lines,start,end);if(selected)ranges.push({anchor:start,head:Pos(to+1,0)})}if(selected)cm.setSelections(ranges,0)}))}cmds.sortLines=function(cm){sortLines(cm,true,1)};cmds.reverseSortLines=function(cm){sortLines(cm,true,-1)};cmds.sortLinesInsensitive=function(cm){sortLines(cm,false,1)};cmds.reverseSortLinesInsensitive=function(cm){sortLines(cm,false,-1)};cmds.nextBookmark=function(cm){var marks=cm.state.sublimeBookmarks;if(marks)while(marks.length){var current=marks.shift();var found=current.find();if(found){marks.push(current);return cm.setSelection(found.from,found.to)}}};cmds.prevBookmark=function(cm){var marks=cm.state.sublimeBookmarks;if(marks)while(marks.length){marks.unshift(marks.pop());var found=marks[marks.length-1].find();if(!found)marks.pop();else return cm.setSelection(found.from,found.to)}};cmds.toggleBookmark=function(cm){var ranges=cm.listSelections();var marks=cm.state.sublimeBookmarks||(cm.state.sublimeBookmarks=[]);for(var i=0;i<ranges.length;i++){var from=ranges[i].from(),to=ranges[i].to();var found=ranges[i].empty()?cm.findMarksAt(from):cm.findMarks(from,to);for(var j=0;j<found.length;j++){if(found[j].sublimeBookmark){found[j].clear();for(var k=0;k<marks.length;k++)if(marks[k]==found[j])marks.splice(k--,1);break}}if(j==found.length)marks.push(cm.markText(from,to,{sublimeBookmark:true,clearWhenEmpty:false}))}};cmds.clearBookmarks=function(cm){var marks=cm.state.sublimeBookmarks;if(marks)for(var i=0;i<marks.length;i++)marks[i].clear();marks.length=0};cmds.selectBookmarks=function(cm){var marks=cm.state.sublimeBookmarks,ranges=[];if(marks)for(var i=0;i<marks.length;i++){var found=marks[i].find();if(!found)marks.splice(i--,0);else ranges.push({anchor:found.from,head:found.to})}if(ranges.length)cm.setSelections(ranges,0)};function modifyWordOrSelection(cm,mod){cm.operation((function(){var ranges=cm.listSelections(),indices=[],replacements=[];for(var i=0;i<ranges.length;i++){var range=ranges[i];if(range.empty()){indices.push(i);replacements.push("")}else replacements.push(mod(cm.getRange(range.from(),range.to())))}cm.replaceSelections(replacements,"around","case");for(var i=indices.length-1,at;i>=0;i--){var range=ranges[indices[i]];if(at&&CodeMirror.cmpPos(range.head,at)>0)continue;var word=wordAt(cm,range.head);at=word.from;cm.replaceRange(mod(word.word),word.from,word.to)}}))}cmds.smartBackspace=function(cm){if(cm.somethingSelected())return CodeMirror.Pass;cm.operation((function(){var cursors=cm.listSelections();var indentUnit=cm.getOption("indentUnit");for(var i=cursors.length-1;i>=0;i--){var cursor=cursors[i].head;var toStartOfLine=cm.getRange({line:cursor.line,ch:0},cursor);var column=CodeMirror.countColumn(toStartOfLine,null,cm.getOption("tabSize"));var deletePos=cm.findPosH(cursor,-1,"char",false);if(toStartOfLine&&!/\S/.test(toStartOfLine)&&column%indentUnit==0){var prevIndent=new Pos(cursor.line,CodeMirror.findColumn(toStartOfLine,column-indentUnit,indentUnit));if(prevIndent.ch!=cursor.ch)deletePos=prevIndent}cm.replaceRange("",deletePos,cursor,"+delete")}}))};cmds.delLineRight=function(cm){cm.operation((function(){var ranges=cm.listSelections();for(var i=ranges.length-1;i>=0;i--)cm.replaceRange("",ranges[i].anchor,Pos(ranges[i].to().line),"+delete");cm.scrollIntoView()}))};cmds.upcaseAtCursor=function(cm){modifyWordOrSelection(cm,(function(str){return str.toUpperCase()}))};cmds.downcaseAtCursor=function(cm){modifyWordOrSelection(cm,(function(str){return str.toLowerCase()}))};cmds.setSublimeMark=function(cm){if(cm.state.sublimeMark)cm.state.sublimeMark.clear();cm.state.sublimeMark=cm.setBookmark(cm.getCursor())};cmds.selectToSublimeMark=function(cm){var found=cm.state.sublimeMark&&cm.state.sublimeMark.find();if(found)cm.setSelection(cm.getCursor(),found)};cmds.deleteToSublimeMark=function(cm){var found=cm.state.sublimeMark&&cm.state.sublimeMark.find();if(found){var from=cm.getCursor(),to=found;if(CodeMirror.cmpPos(from,to)>0){var tmp=to;to=from;from=tmp}cm.state.sublimeKilled=cm.getRange(from,to);cm.replaceRange("",from,to)}};cmds.swapWithSublimeMark=function(cm){var found=cm.state.sublimeMark&&cm.state.sublimeMark.find();if(found){cm.state.sublimeMark.clear();cm.state.sublimeMark=cm.setBookmark(cm.getCursor());cm.setCursor(found)}};cmds.sublimeYank=function(cm){if(cm.state.sublimeKilled!=null)cm.replaceSelection(cm.state.sublimeKilled,null,"paste")};cmds.showInCenter=function(cm){var pos=cm.cursorCoords(null,"local");cm.scrollTo(null,(pos.top+pos.bottom)/2-cm.getScrollInfo().clientHeight/2)};function getTarget(cm){var from=cm.getCursor("from"),to=cm.getCursor("to");if(CodeMirror.cmpPos(from,to)==0){var word=wordAt(cm,from);if(!word.word)return;from=word.from;to=word.to}return{from:from,to:to,query:cm.getRange(from,to),word:word}}function findAndGoTo(cm,forward){var target=getTarget(cm);if(!target)return;var query=target.query;var cur=cm.getSearchCursor(query,forward?target.to:target.from);if(forward?cur.findNext():cur.findPrevious()){cm.setSelection(cur.from(),cur.to())}else{cur=cm.getSearchCursor(query,forward?Pos(cm.firstLine(),0):cm.clipPos(Pos(cm.lastLine())));if(forward?cur.findNext():cur.findPrevious())cm.setSelection(cur.from(),cur.to());else if(target.word)cm.setSelection(target.from,target.to)}}cmds.findUnder=function(cm){findAndGoTo(cm,true)};cmds.findUnderPrevious=function(cm){findAndGoTo(cm,false)};cmds.findAllUnder=function(cm){var target=getTarget(cm);if(!target)return;var cur=cm.getSearchCursor(target.query);var matches=[];var primaryIndex=-1;while(cur.findNext()){matches.push({anchor:cur.from(),head:cur.to()});if(cur.from().line<=target.from.line&&cur.from().ch<=target.from.ch)primaryIndex++}cm.setSelections(matches,primaryIndex)};var keyMap=CodeMirror.keyMap;keyMap.macSublime={"Cmd-Left":"goLineStartSmart","Shift-Tab":"indentLess","Shift-Ctrl-K":"deleteLine","Alt-Q":"wrapLines","Ctrl-Left":"goSubwordLeft","Ctrl-Right":"goSubwordRight","Ctrl-Alt-Up":"scrollLineUp","Ctrl-Alt-Down":"scrollLineDown","Cmd-L":"selectLine","Shift-Cmd-L":"splitSelectionByLine",Esc:"singleSelectionTop","Cmd-Enter":"insertLineAfter","Shift-Cmd-Enter":"insertLineBefore","Cmd-D":"selectNextOccurrence","Shift-Cmd-Space":"selectScope","Shift-Cmd-M":"selectBetweenBrackets","Cmd-M":"goToBracket","Cmd-Ctrl-Up":"swapLineUp","Cmd-Ctrl-Down":"swapLineDown","Cmd-/":"toggleCommentIndented","Cmd-J":"joinLines","Shift-Cmd-D":"duplicateLine",F5:"sortLines","Shift-F5":"reverseSortLines","Cmd-F5":"sortLinesInsensitive","Shift-Cmd-F5":"reverseSortLinesInsensitive",F2:"nextBookmark","Shift-F2":"prevBookmark","Cmd-F2":"toggleBookmark","Shift-Cmd-F2":"clearBookmarks","Alt-F2":"selectBookmarks",Backspace:"smartBackspace","Cmd-K Cmd-D":"skipAndSelectNextOccurrence","Cmd-K Cmd-K":"delLineRight","Cmd-K Cmd-U":"upcaseAtCursor","Cmd-K Cmd-L":"downcaseAtCursor","Cmd-K Cmd-Space":"setSublimeMark","Cmd-K Cmd-A":"selectToSublimeMark","Cmd-K Cmd-W":"deleteToSublimeMark","Cmd-K Cmd-X":"swapWithSublimeMark","Cmd-K Cmd-Y":"sublimeYank","Cmd-K Cmd-C":"showInCenter","Cmd-K Cmd-G":"clearBookmarks","Cmd-K Cmd-Backspace":"delLineLeft","Cmd-K Cmd-1":"foldAll","Cmd-K Cmd-0":"unfoldAll","Cmd-K Cmd-J":"unfoldAll","Ctrl-Shift-Up":"addCursorToPrevLine","Ctrl-Shift-Down":"addCursorToNextLine","Cmd-F3":"findUnder","Shift-Cmd-F3":"findUnderPrevious","Alt-F3":"findAllUnder","Shift-Cmd-[":"fold","Shift-Cmd-]":"unfold","Cmd-I":"findIncremental","Shift-Cmd-I":"findIncrementalReverse","Cmd-H":"replace",F3:"findNext","Shift-F3":"findPrev",fallthrough:"macDefault"};CodeMirror.normalizeKeyMap(keyMap.macSublime);keyMap.pcSublime={"Shift-Tab":"indentLess","Shift-Ctrl-K":"deleteLine","Alt-Q":"wrapLines","Ctrl-T":"transposeChars","Alt-Left":"goSubwordLeft","Alt-Right":"goSubwordRight","Ctrl-Up":"scrollLineUp","Ctrl-Down":"scrollLineDown","Ctrl-L":"selectLine","Shift-Ctrl-L":"splitSelectionByLine",Esc:"singleSelectionTop","Ctrl-Enter":"insertLineAfter","Shift-Ctrl-Enter":"insertLineBefore","Ctrl-D":"selectNextOccurrence","Shift-Ctrl-Space":"selectScope","Shift-Ctrl-M":"selectBetweenBrackets","Ctrl-M":"goToBracket","Shift-Ctrl-Up":"swapLineUp","Shift-Ctrl-Down":"swapLineDown","Ctrl-/":"toggleCommentIndented","Ctrl-J":"joinLines","Shift-Ctrl-D":"duplicateLine",F9:"sortLines","Shift-F9":"reverseSortLines","Ctrl-F9":"sortLinesInsensitive","Shift-Ctrl-F9":"reverseSortLinesInsensitive",F2:"nextBookmark","Shift-F2":"prevBookmark","Ctrl-F2":"toggleBookmark","Shift-Ctrl-F2":"clearBookmarks","Alt-F2":"selectBookmarks",Backspace:"smartBackspace","Ctrl-K Ctrl-D":"skipAndSelectNextOccurrence","Ctrl-K Ctrl-K":"delLineRight","Ctrl-K Ctrl-U":"upcaseAtCursor","Ctrl-K Ctrl-L":"downcaseAtCursor","Ctrl-K Ctrl-Space":"setSublimeMark","Ctrl-K Ctrl-A":"selectToSublimeMark","Ctrl-K Ctrl-W":"deleteToSublimeMark","Ctrl-K Ctrl-X":"swapWithSublimeMark","Ctrl-K Ctrl-Y":"sublimeYank","Ctrl-K Ctrl-C":"showInCenter","Ctrl-K Ctrl-G":"clearBookmarks","Ctrl-K Ctrl-Backspace":"delLineLeft","Ctrl-K Ctrl-1":"foldAll","Ctrl-K Ctrl-0":"unfoldAll","Ctrl-K Ctrl-J":"unfoldAll","Ctrl-Alt-Up":"addCursorToPrevLine","Ctrl-Alt-Down":"addCursorToNextLine","Ctrl-F3":"findUnder","Shift-Ctrl-F3":"findUnderPrevious","Alt-F3":"findAllUnder","Shift-Ctrl-[":"fold","Shift-Ctrl-]":"unfold","Ctrl-I":"findIncremental","Shift-Ctrl-I":"findIncrementalReverse","Ctrl-H":"replace",F3:"findNext","Shift-F3":"findPrev",fallthrough:"pcDefault"};CodeMirror.normalizeKeyMap(keyMap.pcSublime);var mac=keyMap.default==keyMap.macDefault;keyMap.sublime=mac?keyMap.macSublime:keyMap.pcSublime}));(function(mod){if(typeof exports=="object"&&typeof module=="object")mod(require("../../lib/codemirror"),require("./searchcursor"),require("../scroll/annotatescrollbar"));else if(typeof define=="function"&&define.amd)define(["../../lib/codemirror","./searchcursor","../scroll/annotatescrollbar"],mod);else mod(CodeMirror)})((function(CodeMirror){"use strict";CodeMirror.defineExtension("showMatchesOnScrollbar",(function(query,caseFold,options){if(typeof options=="string")options={className:options};if(!options)options={};return new SearchAnnotation(this,query,caseFold,options)}));function SearchAnnotation(cm,query,caseFold,options){this.cm=cm;this.options=options;var annotateOptions={listenForChanges:false};for(var prop in options)annotateOptions[prop]=options[prop];if(!annotateOptions.className)annotateOptions.className="CodeMirror-search-match";this.annotation=cm.annotateScrollbar(annotateOptions);this.query=query;this.caseFold=caseFold;this.gap={from:cm.firstLine(),to:cm.lastLine()+1};this.matches=[];this.update=null;this.findMatches();this.annotation.update(this.matches);var self=this;cm.on("change",this.changeHandler=function(_cm,change){self.onChange(change)})}var MAX_MATCHES=1e3;SearchAnnotation.prototype.findMatches=function(){if(!this.gap)return;for(var i=0;i<this.matches.length;i++){var match=this.matches[i];if(match.from.line>=this.gap.to)break;if(match.to.line>=this.gap.from)this.matches.splice(i--,1)}var cursor=this.cm.getSearchCursor(this.query,CodeMirror.Pos(this.gap.from,0),{caseFold:this.caseFold,multiline:this.options.multiline});var maxMatches=this.options&&this.options.maxMatches||MAX_MATCHES;while(cursor.findNext()){var match={from:cursor.from(),to:cursor.to()};if(match.from.line>=this.gap.to)break;this.matches.splice(i++,0,match);if(this.matches.length>maxMatches)break}this.gap=null};function offsetLine(line,changeStart,sizeChange){if(line<=changeStart)return line;return Math.max(changeStart,line+sizeChange)}SearchAnnotation.prototype.onChange=function(change){var startLine=change.from.line;var endLine=CodeMirror.changeEnd(change).line;var sizeChange=endLine-change.to.line;if(this.gap){this.gap.from=Math.min(offsetLine(this.gap.from,startLine,sizeChange),change.from.line);this.gap.to=Math.max(offsetLine(this.gap.to,startLine,sizeChange),change.from.line)}else{this.gap={from:change.from.line,to:endLine+1}}if(sizeChange)for(var i=0;i<this.matches.length;i++){var match=this.matches[i];var newFrom=offsetLine(match.from.line,startLine,sizeChange);if(newFrom!=match.from.line)match.from=CodeMirror.Pos(newFrom,match.from.ch);var newTo=offsetLine(match.to.line,startLine,sizeChange);if(newTo!=match.to.line)match.to=CodeMirror.Pos(newTo,match.to.ch)}clearTimeout(this.update);var self=this;this.update=setTimeout((function(){self.updateAfterChange()}),250)};SearchAnnotation.prototype.updateAfterChange=function(){this.findMatches();this.annotation.update(this.matches)};SearchAnnotation.prototype.clear=function(){this.cm.off("change",this.changeHandler);this.annotation.clear()}}));(function(mod){if(typeof exports=="object"&&typeof module=="object")mod(require("../../lib/codemirror"),require("./foldcode"));else if(typeof define=="function"&&define.amd)define(["../../lib/codemirror","./foldcode"],mod);else mod(CodeMirror)})((function(CodeMirror){"use strict";CodeMirror.defineOption("foldGutter",false,(function(cm,val,old){if(old&&old!=CodeMirror.Init){cm.clearGutter(cm.state.foldGutter.options.gutter);cm.state.foldGutter=null;cm.off("gutterClick",onGutterClick);cm.off("changes",onChange);cm.off("viewportChange",onViewportChange);cm.off("fold",onFold);cm.off("unfold",onFold);cm.off("swapDoc",onChange);cm.off("optionChange",optionChange)}if(val){cm.state.foldGutter=new State(parseOptions(val));updateInViewport(cm);cm.on("gutterClick",onGutterClick);cm.on("changes",onChange);cm.on("viewportChange",onViewportChange);cm.on("fold",onFold);cm.on("unfold",onFold);cm.on("swapDoc",onChange);cm.on("optionChange",optionChange)}}));var Pos=CodeMirror.Pos;function State(options){this.options=options;this.from=this.to=0}function parseOptions(opts){if(opts===true)opts={};if(opts.gutter==null)opts.gutter="CodeMirror-foldgutter";if(opts.indicatorOpen==null)opts.indicatorOpen="CodeMirror-foldgutter-open";if(opts.indicatorFolded==null)opts.indicatorFolded="CodeMirror-foldgutter-folded";return opts}function isFolded(cm,line){var marks=cm.findMarks(Pos(line,0),Pos(line+1,0));for(var i=0;i<marks.length;++i){if(marks[i].__isFold){var fromPos=marks[i].find(-1);if(fromPos&&fromPos.line===line)return marks[i]}}}function marker(spec){if(typeof spec=="string"){var elt=document.createElement("div");elt.className=spec+" CodeMirror-guttermarker-subtle";return elt}else{return spec.cloneNode(true)}}function updateFoldInfo(cm,from,to){var opts=cm.state.foldGutter.options,cur=from-1;var minSize=cm.foldOption(opts,"minFoldSize");var func=cm.foldOption(opts,"rangeFinder");var clsFolded=typeof opts.indicatorFolded=="string"&&classTest(opts.indicatorFolded);var clsOpen=typeof opts.indicatorOpen=="string"&&classTest(opts.indicatorOpen);cm.eachLine(from,to,(function(line){++cur;var mark=null;var old=line.gutterMarkers;if(old)old=old[opts.gutter];if(isFolded(cm,cur)){if(clsFolded&&old&&clsFolded.test(old.className))return;mark=marker(opts.indicatorFolded)}else{var pos=Pos(cur,0);var range=func&&func(cm,pos);if(range&&range.to.line-range.from.line>=minSize){if(clsOpen&&old&&clsOpen.test(old.className))return;mark=marker(opts.indicatorOpen)}}if(!mark&&!old)return;cm.setGutterMarker(line,opts.gutter,mark)}))}function classTest(cls){return new RegExp("(^|\\s)"+cls+"(?:$|\\s)\\s*")}function updateInViewport(cm){var vp=cm.getViewport(),state=cm.state.foldGutter;if(!state)return;cm.operation((function(){updateFoldInfo(cm,vp.from,vp.to)}));state.from=vp.from;state.to=vp.to}function onGutterClick(cm,line,gutter){var state=cm.state.foldGutter;if(!state)return;var opts=state.options;if(gutter!=opts.gutter)return;var folded=isFolded(cm,line);if(folded)folded.clear();else cm.foldCode(Pos(line,0),opts)}function optionChange(cm,option){if(option=="mode")onChange(cm)}function onChange(cm){var state=cm.state.foldGutter;if(!state)return;var opts=state.options;state.from=state.to=0;clearTimeout(state.changeUpdate);state.changeUpdate=setTimeout((function(){updateInViewport(cm)}),opts.foldOnChangeTimeSpan||600)}function onViewportChange(cm){var state=cm.state.foldGutter;if(!state)return;var opts=state.options;clearTimeout(state.changeUpdate);state.changeUpdate=setTimeout((function(){var vp=cm.getViewport();if(state.from==state.to||vp.from-state.to>20||state.from-vp.to>20){updateInViewport(cm)}else{cm.operation((function(){if(vp.from<state.from){updateFoldInfo(cm,vp.from,state.from);state.from=vp.from}if(vp.to>state.to){updateFoldInfo(cm,state.to,vp.to);state.to=vp.to}}))}}),opts.updateViewportTimeSpan||400)}function onFold(cm,from){var state=cm.state.foldGutter;if(!state)return;var line=from.line;if(line>=state.from&&line<state.to)updateFoldInfo(cm,line,line+1)}}));(function(mod){if(typeof exports=="object"&&typeof module=="object")mod(require("../../lib/codemirror"),require("../dialog/dialog"));else if(typeof define=="function"&&define.amd)define(["../../lib/codemirror","../dialog/dialog"],mod);else mod(CodeMirror)})((function(CodeMirror){"use strict";CodeMirror.defineOption("search",{bottom:false});function dialog(cm,text,shortText,deflt,f){if(cm.openDialog)cm.openDialog(text,f,{value:deflt,selectValueOnOpen:true,bottom:cm.options.search.bottom});else f(prompt(shortText,deflt))}function getJumpDialog(cm){return cm.phrase("Jump to line:")+' <input type="text" style="width: 10em" class="CodeMirror-search-field"/> <span style="color: #888" class="CodeMirror-search-hint">'+cm.phrase("(Use line:column or scroll% syntax)")+"</span>"}function interpretLine(cm,string){var num=Number(string);if(/^[-+]/.test(string))return cm.getCursor().line+num;else return num-1}CodeMirror.commands.jumpToLine=function(cm){var cur=cm.getCursor();dialog(cm,getJumpDialog(cm),cm.phrase("Jump to line:"),cur.line+1+":"+cur.ch,(function(posStr){if(!posStr)return;var match;if(match=/^\s*([\+\-]?\d+)\s*\:\s*(\d+)\s*$/.exec(posStr)){cm.setCursor(interpretLine(cm,match[1]),Number(match[2]))}else if(match=/^\s*([\+\-]?\d+(\.\d+)?)\%\s*/.exec(posStr)){var line=Math.round(cm.lineCount()*Number(match[1])/100);if(/^[-+]/.test(match[1]))line=cur.line+line+1;cm.setCursor(line-1,cur.ch)}else if(match=/^\s*\:?\s*([\+\-]?\d+)\s*/.exec(posStr)){cm.setCursor(interpretLine(cm,match[1]),cur.ch)}}))};CodeMirror.keyMap["default"]["Alt-G"]="jumpToLine"}));(function(mod){if(typeof exports=="object"&&typeof module=="object")mod(require("../../lib/codemirror"));else if(typeof define=="function"&&define.amd)define(["../../lib/codemirror"],mod);else mod(CodeMirror)})((function(CodeMirror){"use strict";var noOptions={};var nonWS=/[^\s\u00a0]/;var Pos=CodeMirror.Pos,cmp=CodeMirror.cmpPos;function firstNonWS(str){var found=str.search(nonWS);return found==-1?0:found}CodeMirror.commands.toggleComment=function(cm){cm.toggleComment()};CodeMirror.defineExtension("toggleComment",(function(options){if(!options)options=noOptions;var cm=this;var minLine=Infinity,ranges=this.listSelections(),mode=null;for(var i=ranges.length-1;i>=0;i--){var from=ranges[i].from(),to=ranges[i].to();if(from.line>=minLine)continue;if(to.line>=minLine)to=Pos(minLine,0);minLine=from.line;if(mode==null){if(cm.uncomment(from,to,options))mode="un";else{cm.lineComment(from,to,options);mode="line"}}else if(mode=="un"){cm.uncomment(from,to,options)}else{cm.lineComment(from,to,options)}}}));function probablyInsideString(cm,pos,line){return/\bstring\b/.test(cm.getTokenTypeAt(Pos(pos.line,0)))&&!/^[\'\"\`]/.test(line)}function getMode(cm,pos){var mode=cm.getMode();return mode.useInnerComments===false||!mode.innerMode?mode:cm.getModeAt(pos)}CodeMirror.defineExtension("lineComment",(function(from,to,options){if(!options)options=noOptions;var self=this,mode=getMode(self,from);var firstLine=self.getLine(from.line);if(firstLine==null||probablyInsideString(self,from,firstLine))return;var commentString=options.lineComment||mode.lineComment;if(!commentString){if(options.blockCommentStart||mode.blockCommentStart){options.fullLines=true;self.blockComment(from,to,options)}return}var end=Math.min(to.ch!=0||to.line==from.line?to.line+1:to.line,self.lastLine()+1);var pad=options.padding==null?" ":options.padding;var blankLines=options.commentBlankLines||from.line==to.line;self.operation((function(){if(options.indent){var baseString=null;for(var i=from.line;i<end;++i){var line=self.getLine(i);var whitespace=line.search(nonWS)===-1?line:line.slice(0,firstNonWS(line));if(baseString==null||baseString.length>whitespace.length){baseString=whitespace}}for(var i=from.line;i<end;++i){var line=self.getLine(i),cut=baseString.length;if(!blankLines&&!nonWS.test(line))continue;if(line.slice(0,cut)!=baseString)cut=firstNonWS(line);self.replaceRange(baseString+commentString+pad,Pos(i,0),Pos(i,cut))}}else{for(var i=from.line;i<end;++i){if(blankLines||nonWS.test(self.getLine(i)))self.replaceRange(commentString+pad,Pos(i,0))}}}))}));CodeMirror.defineExtension("blockComment",(function(from,to,options){if(!options)options=noOptions;var self=this,mode=getMode(self,from);var startString=options.blockCommentStart||mode.blockCommentStart;var endString=options.blockCommentEnd||mode.blockCommentEnd;if(!startString||!endString){if((options.lineComment||mode.lineComment)&&options.fullLines!=false)self.lineComment(from,to,options);return}if(/\bcomment\b/.test(self.getTokenTypeAt(Pos(from.line,0))))return;var end=Math.min(to.line,self.lastLine());if(end!=from.line&&to.ch==0&&nonWS.test(self.getLine(end)))--end;var pad=options.padding==null?" ":options.padding;if(from.line>end)return;self.operation((function(){if(options.fullLines!=false){var lastLineHasText=nonWS.test(self.getLine(end));self.replaceRange(pad+endString,Pos(end));self.replaceRange(startString+pad,Pos(from.line,0));var lead=options.blockCommentLead||mode.blockCommentLead;if(lead!=null)for(var i=from.line+1;i<=end;++i)if(i!=end||lastLineHasText)self.replaceRange(lead+pad,Pos(i,0))}else{var atCursor=cmp(self.getCursor("to"),to)==0,empty=!self.somethingSelected();self.replaceRange(endString,to);if(atCursor)self.setSelection(empty?to:self.getCursor("from"),to);self.replaceRange(startString,from)}}))}));CodeMirror.defineExtension("uncomment",(function(from,to,options){if(!options)options=noOptions;var self=this,mode=getMode(self,from);var end=Math.min(to.ch!=0||to.line==from.line?to.line:to.line-1,self.lastLine()),start=Math.min(from.line,end);var lineString=options.lineComment||mode.lineComment,lines=[];var pad=options.padding==null?" ":options.padding,didSomething;lineComment:{if(!lineString)break lineComment;for(var i=start;i<=end;++i){var line=self.getLine(i);var found=line.indexOf(lineString);if(found>-1&&!/comment/.test(self.getTokenTypeAt(Pos(i,found+1))))found=-1;if(found==-1&&nonWS.test(line))break lineComment;if(found>-1&&nonWS.test(line.slice(0,found)))break lineComment;lines.push(line)}self.operation((function(){for(var i=start;i<=end;++i){var line=lines[i-start];var pos=line.indexOf(lineString),endPos=pos+lineString.length;if(pos<0)continue;if(line.slice(endPos,endPos+pad.length)==pad)endPos+=pad.length;didSomething=true;self.replaceRange("",Pos(i,pos),Pos(i,endPos))}}));if(didSomething)return true}var startString=options.blockCommentStart||mode.blockCommentStart;var endString=options.blockCommentEnd||mode.blockCommentEnd;if(!startString||!endString)return false;var lead=options.blockCommentLead||mode.blockCommentLead;var startLine=self.getLine(start),open=startLine.indexOf(startString);if(open==-1)return false;var endLine=end==start?startLine:self.getLine(end);var close=endLine.indexOf(endString,end==start?open+startString.length:0);var insideStart=Pos(start,open+1),insideEnd=Pos(end,close+1);if(close==-1||!/comment/.test(self.getTokenTypeAt(insideStart))||!/comment/.test(self.getTokenTypeAt(insideEnd))||self.getRange(insideStart,insideEnd,"\n").indexOf(endString)>-1)return false;var lastStart=startLine.lastIndexOf(startString,from.ch);var firstEnd=lastStart==-1?-1:startLine.slice(0,from.ch).indexOf(endString,lastStart+startString.length);if(lastStart!=-1&&firstEnd!=-1&&firstEnd+endString.length!=from.ch)return false;firstEnd=endLine.indexOf(endString,to.ch);var almostLastStart=endLine.slice(to.ch).lastIndexOf(startString,firstEnd-to.ch);lastStart=firstEnd==-1||almostLastStart==-1?-1:to.ch+almostLastStart;if(firstEnd!=-1&&lastStart!=-1&&lastStart!=to.ch)return false;self.operation((function(){self.replaceRange("",Pos(end,close-(pad&&endLine.slice(close-pad.length,close)==pad?pad.length:0)),Pos(end,close+endString.length));var openEnd=open+startString.length;if(pad&&startLine.slice(openEnd,openEnd+pad.length)==pad)openEnd+=pad.length;self.replaceRange("",Pos(start,open),Pos(start,openEnd));if(lead)for(var i=start+1;i<=end;++i){var line=self.getLine(i),found=line.indexOf(lead);if(found==-1||nonWS.test(line.slice(0,found)))continue;var foundEnd=found+lead.length;if(pad&&line.slice(foundEnd,foundEnd+pad.length)==pad)foundEnd+=pad.length;self.replaceRange("",Pos(i,found),Pos(i,foundEnd))}}));return true}))}));(function(mod){if(typeof exports=="object"&&typeof module=="object")mod(require("../../lib/codemirror"),require("./matchesonscrollbar"));else if(typeof define=="function"&&define.amd)define(["../../lib/codemirror","./matchesonscrollbar"],mod);else mod(CodeMirror)})((function(CodeMirror){"use strict";var defaults={style:"matchhighlight",minChars:2,delay:100,wordsOnly:false,annotateScrollbar:false,showToken:false,trim:true};function State(options){this.options={};for(var name in defaults)this.options[name]=(options&&options.hasOwnProperty(name)?options:defaults)[name];this.overlay=this.timeout=null;this.matchesonscroll=null;this.active=false}CodeMirror.defineOption("highlightSelectionMatches",false,(function(cm,val,old){if(old&&old!=CodeMirror.Init){removeOverlay(cm);clearTimeout(cm.state.matchHighlighter.timeout);cm.state.matchHighlighter=null;cm.off("cursorActivity",cursorActivity);cm.off("focus",onFocus)}if(val){var state=cm.state.matchHighlighter=new State(val);if(cm.hasFocus()){state.active=true;highlightMatches(cm)}else{cm.on("focus",onFocus)}cm.on("cursorActivity",cursorActivity)}}));function cursorActivity(cm){var state=cm.state.matchHighlighter;if(state.active||cm.hasFocus())scheduleHighlight(cm,state)}function onFocus(cm){var state=cm.state.matchHighlighter;if(!state.active){state.active=true;scheduleHighlight(cm,state)}}function scheduleHighlight(cm,state){clearTimeout(state.timeout);state.timeout=setTimeout((function(){highlightMatches(cm)}),state.options.delay)}function addOverlay(cm,query,hasBoundary,style){var state=cm.state.matchHighlighter;cm.addOverlay(state.overlay=makeOverlay(query,hasBoundary,style));if(state.options.annotateScrollbar&&cm.showMatchesOnScrollbar){var searchFor=hasBoundary?new RegExp((/\w/.test(query.charAt(0))?"\\b":"")+query.replace(/[\\\[.+*?(){|^$]/g,"\\$&")+(/\w/.test(query.charAt(query.length-1))?"\\b":"")):query;state.matchesonscroll=cm.showMatchesOnScrollbar(searchFor,false,{className:"CodeMirror-selection-highlight-scrollbar"})}}function removeOverlay(cm){var state=cm.state.matchHighlighter;if(state.overlay){cm.removeOverlay(state.overlay);state.overlay=null;if(state.matchesonscroll){state.matchesonscroll.clear();state.matchesonscroll=null}}}function highlightMatches(cm){cm.operation((function(){var state=cm.state.matchHighlighter;removeOverlay(cm);if(!cm.somethingSelected()&&state.options.showToken){var re=state.options.showToken===true?/[\w$]/:state.options.showToken;var cur=cm.getCursor(),line=cm.getLine(cur.line),start=cur.ch,end=start;while(start&&re.test(line.charAt(start-1)))--start;while(end<line.length&&re.test(line.charAt(end)))++end;if(start<end)addOverlay(cm,line.slice(start,end),re,state.options.style);return}var from=cm.getCursor("from"),to=cm.getCursor("to");if(from.line!=to.line)return;if(state.options.wordsOnly&&!isWord(cm,from,to))return;var selection=cm.getRange(from,to);if(state.options.trim)selection=selection.replace(/^\s+|\s+$/g,"");if(selection.length>=state.options.minChars)addOverlay(cm,selection,false,state.options.style)}))}function isWord(cm,from,to){var str=cm.getRange(from,to);if(str.match(/^\w+$/)!==null){if(from.ch>0){var pos={line:from.line,ch:from.ch-1};var chr=cm.getRange(pos,from);if(chr.match(/\W/)===null)return false}if(to.ch<cm.getLine(from.line).length){var pos={line:to.line,ch:to.ch+1};var chr=cm.getRange(to,pos);if(chr.match(/\W/)===null)return false}return true}else return false}function boundariesAround(stream,re){return(!stream.start||!re.test(stream.string.charAt(stream.start-1)))&&(stream.pos==stream.string.length||!re.test(stream.string.charAt(stream.pos)))}function makeOverlay(query,hasBoundary,style){return{token:function(stream){if(stream.match(query)&&(!hasBoundary||boundariesAround(stream,hasBoundary)))return style;stream.next();stream.skipTo(query.charAt(0))||stream.skipToEnd()}}}}));(function(mod){if(typeof exports=="object"&&typeof module=="object")mod(require("../../lib/codemirror"));else if(typeof define=="function"&&define.amd)define(["../../lib/codemirror"],mod);else mod(CodeMirror)})((function(CodeMirror){function dialogDiv(cm,template,bottom){var wrap=cm.getWrapperElement();var dialog;dialog=wrap.appendChild(document.createElement("div"));if(bottom)dialog.className="CodeMirror-dialog CodeMirror-dialog-bottom";else dialog.className="CodeMirror-dialog CodeMirror-dialog-top";if(typeof template=="string"){dialog.innerHTML=template}else{dialog.appendChild(template)}CodeMirror.addClass(wrap,"dialog-opened");return dialog}function closeNotification(cm,newVal){if(cm.state.currentNotificationClose)cm.state.currentNotificationClose();cm.state.currentNotificationClose=newVal}CodeMirror.defineExtension("openDialog",(function(template,callback,options){if(!options)options={};closeNotification(this,null);var dialog=dialogDiv(this,template,options.bottom);var closed=false,me=this;function close(newVal){if(typeof newVal=="string"){inp.value=newVal}else{if(closed)return;closed=true;CodeMirror.rmClass(dialog.parentNode,"dialog-opened");dialog.parentNode.removeChild(dialog);me.focus();if(options.onClose)options.onClose(dialog)}}var inp=dialog.getElementsByTagName("input")[0],button;if(inp){inp.focus();if(options.value){inp.value=options.value;if(options.selectValueOnOpen!==false){inp.select()}}if(options.onInput)CodeMirror.on(inp,"input",(function(e){options.onInput(e,inp.value,close)}));if(options.onKeyUp)CodeMirror.on(inp,"keyup",(function(e){options.onKeyUp(e,inp.value,close)}));CodeMirror.on(inp,"keydown",(function(e){if(options&&options.onKeyDown&&options.onKeyDown(e,inp.value,close)){return}if(e.keyCode==27||options.closeOnEnter!==false&&e.keyCode==13){inp.blur();CodeMirror.e_stop(e);close()}if(e.keyCode==13)callback(inp.value,e)}));if(options.closeOnBlur!==false)CodeMirror.on(dialog,"focusout",(function(evt){if(evt.relatedTarget!==null)close()}))}else if(button=dialog.getElementsByTagName("button")[0]){CodeMirror.on(button,"click",(function(){close();me.focus()}));if(options.closeOnBlur!==false)CodeMirror.on(button,"blur",close);button.focus()}return close}));CodeMirror.defineExtension("openConfirm",(function(template,callbacks,options){closeNotification(this,null);var dialog=dialogDiv(this,template,options&&options.bottom);var buttons=dialog.getElementsByTagName("button");var closed=false,me=this,blurring=1;function close(){if(closed)return;closed=true;CodeMirror.rmClass(dialog.parentNode,"dialog-opened");dialog.parentNode.removeChild(dialog);me.focus()}buttons[0].focus();for(var i=0;i<buttons.length;++i){var b=buttons[i];(function(callback){CodeMirror.on(b,"click",(function(e){CodeMirror.e_preventDefault(e);close();if(callback)callback(me)}))})(callbacks[i]);CodeMirror.on(b,"blur",(function(){--blurring;setTimeout((function(){if(blurring<=0)close()}),200)}));CodeMirror.on(b,"focus",(function(){++blurring}))}}));CodeMirror.defineExtension("openNotification",(function(template,options){closeNotification(this,close);var dialog=dialogDiv(this,template,options&&options.bottom);var closed=false,doneTimer;var duration=options&&typeof options.duration!=="undefined"?options.duration:5e3;function close(){if(closed)return;closed=true;clearTimeout(doneTimer);CodeMirror.rmClass(dialog.parentNode,"dialog-opened");dialog.parentNode.removeChild(dialog)}CodeMirror.on(dialog,"click",(function(e){CodeMirror.e_preventDefault(e);close()}));if(duration)doneTimer=setTimeout(close,duration);return close}))}));(function(mod){if(typeof exports=="object"&&typeof module=="object")mod(require("../../lib/codemirror"));else if(typeof define=="function"&&define.amd)define(["../../lib/codemirror"],mod);else mod(CodeMirror)})((function(CodeMirror){"use strict";function lineIndent(cm,lineNo){var text=cm.getLine(lineNo);var spaceTo=text.search(/\S/);if(spaceTo==-1||/\bcomment\b/.test(cm.getTokenTypeAt(CodeMirror.Pos(lineNo,spaceTo+1))))return-1;return CodeMirror.countColumn(text,null,cm.getOption("tabSize"))}CodeMirror.registerHelper("fold","indent",(function(cm,start){var myIndent=lineIndent(cm,start.line);if(myIndent<0)return;var lastLineInFold=null;for(var i=start.line+1,end=cm.lastLine();i<=end;++i){var indent=lineIndent(cm,i);if(indent==-1){}else if(indent>myIndent){lastLineInFold=i}else{break}}if(lastLineInFold)return{from:CodeMirror.Pos(start.line,cm.getLine(start.line).length),to:CodeMirror.Pos(lastLineInFold,cm.getLine(lastLineInFold).length)}}))}));(function(mod){if(typeof exports=="object"&&typeof module=="object")mod(require("../../lib/codemirror"));else if(typeof define=="function"&&define.amd)define(["../../lib/codemirror"],mod);else mod(CodeMirror)})((function(CodeMirror){"use strict";var Pos=CodeMirror.Pos;function regexpFlags(regexp){var flags=regexp.flags;return flags!=null?flags:(regexp.ignoreCase?"i":"")+(regexp.global?"g":"")+(regexp.multiline?"m":"")}function ensureFlags(regexp,flags){var current=regexpFlags(regexp),target=current;for(var i=0;i<flags.length;i++)if(target.indexOf(flags.charAt(i))==-1)target+=flags.charAt(i);return current==target?regexp:new RegExp(regexp.source,target)}function maybeMultiline(regexp){return/\\s|\\n|\n|\\W|\\D|\[\^/.test(regexp.source)}function searchRegexpForward(doc,regexp,start){regexp=ensureFlags(regexp,"g");for(var line=start.line,ch=start.ch,last=doc.lastLine();line<=last;line++,ch=0){regexp.lastIndex=ch;var string=doc.getLine(line),match=regexp.exec(string);if(match)return{from:Pos(line,match.index),to:Pos(line,match.index+match[0].length),match:match}}}function searchRegexpForwardMultiline(doc,regexp,start){if(!maybeMultiline(regexp))return searchRegexpForward(doc,regexp,start);regexp=ensureFlags(regexp,"gm");var string,chunk=1;for(var line=start.line,last=doc.lastLine();line<=last;){for(var i=0;i<chunk;i++){if(line>last)break;var curLine=doc.getLine(line++);string=string==null?curLine:string+"\n"+curLine}chunk=chunk*2;regexp.lastIndex=start.ch;var match=regexp.exec(string);if(match){var before=string.slice(0,match.index).split("\n"),inside=match[0].split("\n");var startLine=start.line+before.length-1,startCh=before[before.length-1].length;return{from:Pos(startLine,startCh),to:Pos(startLine+inside.length-1,inside.length==1?startCh+inside[0].length:inside[inside.length-1].length),match:match}}}}function lastMatchIn(string,regexp,endMargin){var match,from=0;while(from<=string.length){regexp.lastIndex=from;var newMatch=regexp.exec(string);if(!newMatch)break;var end=newMatch.index+newMatch[0].length;if(end>string.length-endMargin)break;if(!match||end>match.index+match[0].length)match=newMatch;from=newMatch.index+1}return match}function searchRegexpBackward(doc,regexp,start){regexp=ensureFlags(regexp,"g");for(var line=start.line,ch=start.ch,first=doc.firstLine();line>=first;line--,ch=-1){var string=doc.getLine(line);var match=lastMatchIn(string,regexp,ch<0?0:string.length-ch);if(match)return{from:Pos(line,match.index),to:Pos(line,match.index+match[0].length),match:match}}}function searchRegexpBackwardMultiline(doc,regexp,start){if(!maybeMultiline(regexp))return searchRegexpBackward(doc,regexp,start);regexp=ensureFlags(regexp,"gm");var string,chunkSize=1,endMargin=doc.getLine(start.line).length-start.ch;for(var line=start.line,first=doc.firstLine();line>=first;){for(var i=0;i<chunkSize&&line>=first;i++){var curLine=doc.getLine(line--);string=string==null?curLine:curLine+"\n"+string}chunkSize*=2;var match=lastMatchIn(string,regexp,endMargin);if(match){var before=string.slice(0,match.index).split("\n"),inside=match[0].split("\n");var startLine=line+before.length,startCh=before[before.length-1].length;return{from:Pos(startLine,startCh),to:Pos(startLine+inside.length-1,inside.length==1?startCh+inside[0].length:inside[inside.length-1].length),match:match}}}}var doFold,noFold;if(String.prototype.normalize){doFold=function(str){return str.normalize("NFD").toLowerCase()};noFold=function(str){return str.normalize("NFD")}}else{doFold=function(str){return str.toLowerCase()};noFold=function(str){return str}}function adjustPos(orig,folded,pos,foldFunc){if(orig.length==folded.length)return pos;for(var min=0,max=pos+Math.max(0,orig.length-folded.length);;){if(min==max)return min;var mid=min+max>>1;var len=foldFunc(orig.slice(0,mid)).length;if(len==pos)return mid;else if(len>pos)max=mid;else min=mid+1}}function searchStringForward(doc,query,start,caseFold){if(!query.length)return null;var fold=caseFold?doFold:noFold;var lines=fold(query).split(/\r|\n\r?/);search:for(var line=start.line,ch=start.ch,last=doc.lastLine()+1-lines.length;line<=last;line++,ch=0){var orig=doc.getLine(line).slice(ch),string=fold(orig);if(lines.length==1){var found=string.indexOf(lines[0]);if(found==-1)continue search;var start=adjustPos(orig,string,found,fold)+ch;return{from:Pos(line,adjustPos(orig,string,found,fold)+ch),to:Pos(line,adjustPos(orig,string,found+lines[0].length,fold)+ch)}}else{var cutFrom=string.length-lines[0].length;if(string.slice(cutFrom)!=lines[0])continue search;for(var i=1;i<lines.length-1;i++)if(fold(doc.getLine(line+i))!=lines[i])continue search;var end=doc.getLine(line+lines.length-1),endString=fold(end),lastLine=lines[lines.length-1];if(endString.slice(0,lastLine.length)!=lastLine)continue search;return{from:Pos(line,adjustPos(orig,string,cutFrom,fold)+ch),to:Pos(line+lines.length-1,adjustPos(end,endString,lastLine.length,fold))}}}}function searchStringBackward(doc,query,start,caseFold){if(!query.length)return null;var fold=caseFold?doFold:noFold;var lines=fold(query).split(/\r|\n\r?/);search:for(var line=start.line,ch=start.ch,first=doc.firstLine()-1+lines.length;line>=first;line--,ch=-1){var orig=doc.getLine(line);if(ch>-1)orig=orig.slice(0,ch);var string=fold(orig);if(lines.length==1){var found=string.lastIndexOf(lines[0]);if(found==-1)continue search;return{from:Pos(line,adjustPos(orig,string,found,fold)),to:Pos(line,adjustPos(orig,string,found+lines[0].length,fold))}}else{var lastLine=lines[lines.length-1];if(string.slice(0,lastLine.length)!=lastLine)continue search;for(var i=1,start=line-lines.length+1;i<lines.length-1;i++)if(fold(doc.getLine(start+i))!=lines[i])continue search;var top=doc.getLine(line+1-lines.length),topString=fold(top);if(topString.slice(topString.length-lines[0].length)!=lines[0])continue search;return{from:Pos(line+1-lines.length,adjustPos(top,topString,top.length-lines[0].length,fold)),to:Pos(line,adjustPos(orig,string,lastLine.length,fold))}}}}function SearchCursor(doc,query,pos,options){this.atOccurrence=false;this.afterEmptyMatch=false;this.doc=doc;pos=pos?doc.clipPos(pos):Pos(0,0);this.pos={from:pos,to:pos};var caseFold;if(typeof options=="object"){caseFold=options.caseFold}else{caseFold=options;options=null}if(typeof query=="string"){if(caseFold==null)caseFold=false;this.matches=function(reverse,pos){return(reverse?searchStringBackward:searchStringForward)(doc,query,pos,caseFold)}}else{query=ensureFlags(query,"gm");if(!options||options.multiline!==false)this.matches=function(reverse,pos){return(reverse?searchRegexpBackwardMultiline:searchRegexpForwardMultiline)(doc,query,pos)};else this.matches=function(reverse,pos){return(reverse?searchRegexpBackward:searchRegexpForward)(doc,query,pos)}}}SearchCursor.prototype={findNext:function(){return this.find(false)},findPrevious:function(){return this.find(true)},find:function(reverse){var head=this.doc.clipPos(reverse?this.pos.from:this.pos.to);if(this.afterEmptyMatch&&this.atOccurrence){head=Pos(head.line,head.ch);if(reverse){head.ch--;if(head.ch<0){head.line--;head.ch=(this.doc.getLine(head.line)||"").length}}else{head.ch++;if(head.ch>(this.doc.getLine(head.line)||"").length){head.ch=0;head.line++}}if(CodeMirror.cmpPos(head,this.doc.clipPos(head))!=0){return this.atOccurrence=false}}var result=this.matches(reverse,head);this.afterEmptyMatch=result&&CodeMirror.cmpPos(result.from,result.to)==0;if(result){this.pos=result;this.atOccurrence=true;return this.pos.match||true}else{var end=Pos(reverse?this.doc.firstLine():this.doc.lastLine()+1,0);this.pos={from:end,to:end};return this.atOccurrence=false}},from:function(){if(this.atOccurrence)return this.pos.from},to:function(){if(this.atOccurrence)return this.pos.to},replace:function(newText,origin){if(!this.atOccurrence)return;var lines=CodeMirror.splitLines(newText);this.doc.replaceRange(lines,this.pos.from,this.pos.to,origin);this.pos.to=Pos(this.pos.from.line+lines.length-1,lines[lines.length-1].length+(lines.length==1?this.pos.from.ch:0))}};CodeMirror.defineExtension("getSearchCursor",(function(query,pos,caseFold){return new SearchCursor(this.doc,query,pos,caseFold)}));CodeMirror.defineDocExtension("getSearchCursor",(function(query,pos,caseFold){return new SearchCursor(this,query,pos,caseFold)}));CodeMirror.defineExtension("selectMatches",(function(query,caseFold){var ranges=[];var cur=this.getSearchCursor(query,this.getCursor("from"),caseFold);while(cur.findNext()){if(CodeMirror.cmpPos(cur.to(),this.getCursor("to"))>0)break;ranges.push({anchor:cur.from(),head:cur.to()})}if(ranges.length)this.setSelections(ranges,0)}))}));(function(mod){if(typeof exports=="object"&&typeof module=="object")mod(require("../../lib/codemirror"));else if(typeof define=="function"&&define.amd)define(["../../lib/codemirror"],mod);else mod(CodeMirror)})((function(CodeMirror){"use strict";CodeMirror.defineMode("javascript",(function(config,parserConfig){var indentUnit=config.indentUnit;var statementIndent=parserConfig.statementIndent;var jsonldMode=parserConfig.jsonld;var jsonMode=parserConfig.json||jsonldMode;var trackScope=parserConfig.trackScope!==false;var isTS=parserConfig.typescript;var wordRE=parserConfig.wordCharacters||/[\w$\xa1-\uffff]/;var keywords=function(){function kw(type){return{type:type,style:"keyword"}}var A=kw("keyword a"),B=kw("keyword b"),C=kw("keyword c"),D=kw("keyword d");var operator=kw("operator"),atom={type:"atom",style:"atom"};return{if:kw("if"),while:A,with:A,else:B,do:B,try:B,finally:B,return:D,break:D,continue:D,new:kw("new"),delete:C,void:C,throw:C,debugger:kw("debugger"),var:kw("var"),const:kw("var"),let:kw("var"),function:kw("function"),catch:kw("catch"),for:kw("for"),switch:kw("switch"),case:kw("case"),default:kw("default"),in:operator,typeof:operator,instanceof:operator,true:atom,false:atom,null:atom,undefined:atom,NaN:atom,Infinity:atom,this:kw("this"),class:kw("class"),super:kw("atom"),yield:C,export:kw("export"),import:kw("import"),extends:C,await:C}}();var isOperatorChar=/[+\-*&%=<>!?|~^@]/;var isJsonldKeyword=/^@(context|id|value|language|type|container|list|set|reverse|index|base|vocab|graph)"/;function readRegexp(stream){var escaped=false,next,inSet=false;while((next=stream.next())!=null){if(!escaped){if(next=="/"&&!inSet)return;if(next=="[")inSet=true;else if(inSet&&next=="]")inSet=false}escaped=!escaped&&next=="\\"}}var type,content;function ret(tp,style,cont){type=tp;content=cont;return style}function tokenBase(stream,state){var ch=stream.next();if(ch=='"'||ch=="'"){state.tokenize=tokenString(ch);return state.tokenize(stream,state)}else if(ch=="."&&stream.match(/^\d[\d_]*(?:[eE][+\-]?[\d_]+)?/)){return ret("number","number")}else if(ch=="."&&stream.match("..")){return ret("spread","meta")}else if(/[\[\]{}\(\),;\:\.]/.test(ch)){return ret(ch)}else if(ch=="="&&stream.eat(">")){return ret("=>","operator")}else if(ch=="0"&&stream.match(/^(?:x[\dA-Fa-f_]+|o[0-7_]+|b[01_]+)n?/)){return ret("number","number")}else if(/\d/.test(ch)){stream.match(/^[\d_]*(?:n|(?:\.[\d_]*)?(?:[eE][+\-]?[\d_]+)?)?/);return ret("number","number")}else if(ch=="/"){if(stream.eat("*")){state.tokenize=tokenComment;return tokenComment(stream,state)}else if(stream.eat("/")){stream.skipToEnd();return ret("comment","comment")}else if(expressionAllowed(stream,state,1)){readRegexp(stream);stream.match(/^\b(([gimyus])(?![gimyus]*\2))+\b/);return ret("regexp","string-2")}else{stream.eat("=");return ret("operator","operator",stream.current())}}else if(ch=="`"){state.tokenize=tokenQuasi;return tokenQuasi(stream,state)}else if(ch=="#"&&stream.peek()=="!"){stream.skipToEnd();return ret("meta","meta")}else if(ch=="#"&&stream.eatWhile(wordRE)){return ret("variable","property")}else if(ch=="<"&&stream.match("!--")||ch=="-"&&stream.match("->")&&!/\S/.test(stream.string.slice(0,stream.start))){stream.skipToEnd();return ret("comment","comment")}else if(isOperatorChar.test(ch)){if(ch!=">"||!state.lexical||state.lexical.type!=">"){if(stream.eat("=")){if(ch=="!"||ch=="=")stream.eat("=")}else if(/[<>*+\-|&?]/.test(ch)){stream.eat(ch);if(ch==">")stream.eat(ch)}}if(ch=="?"&&stream.eat("."))return ret(".");return ret("operator","operator",stream.current())}else if(wordRE.test(ch)){stream.eatWhile(wordRE);var word=stream.current();if(state.lastType!="."){if(keywords.propertyIsEnumerable(word)){var kw=keywords[word];return ret(kw.type,kw.style,word)}if(word=="async"&&stream.match(/^(\s|\/\*([^*]|\*(?!\/))*?\*\/)*[\[\(\w]/,false))return ret("async","keyword",word)}return ret("variable","variable",word)}}function tokenString(quote){return function(stream,state){var escaped=false,next;if(jsonldMode&&stream.peek()=="@"&&stream.match(isJsonldKeyword)){state.tokenize=tokenBase;return ret("jsonld-keyword","meta")}while((next=stream.next())!=null){if(next==quote&&!escaped)break;escaped=!escaped&&next=="\\"}if(!escaped)state.tokenize=tokenBase;return ret("string","string")}}function tokenComment(stream,state){var maybeEnd=false,ch;while(ch=stream.next()){if(ch=="/"&&maybeEnd){state.tokenize=tokenBase;break}maybeEnd=ch=="*"}return ret("comment","comment")}function tokenQuasi(stream,state){var escaped=false,next;while((next=stream.next())!=null){if(!escaped&&(next=="`"||next=="$"&&stream.eat("{"))){state.tokenize=tokenBase;break}escaped=!escaped&&next=="\\"}return ret("quasi","string-2",stream.current())}var brackets="([{}])";function findFatArrow(stream,state){if(state.fatArrowAt)state.fatArrowAt=null;var arrow=stream.string.indexOf("=>",stream.start);if(arrow<0)return;if(isTS){var m=/:\s*(?:\w+(?:<[^>]*>|\[\])?|\{[^}]*\})\s*$/.exec(stream.string.slice(stream.start,arrow));if(m)arrow=m.index}var depth=0,sawSomething=false;for(var pos=arrow-1;pos>=0;--pos){var ch=stream.string.charAt(pos);var bracket=brackets.indexOf(ch);if(bracket>=0&&bracket<3){if(!depth){++pos;break}if(--depth==0){if(ch=="(")sawSomething=true;break}}else if(bracket>=3&&bracket<6){++depth}else if(wordRE.test(ch)){sawSomething=true}else if(/["'\/`]/.test(ch)){for(;;--pos){if(pos==0)return;var next=stream.string.charAt(pos-1);if(next==ch&&stream.string.charAt(pos-2)!="\\"){pos--;break}}}else if(sawSomething&&!depth){++pos;break}}if(sawSomething&&!depth)state.fatArrowAt=pos}var atomicTypes={atom:true,number:true,variable:true,string:true,regexp:true,this:true,import:true,"jsonld-keyword":true};function JSLexical(indented,column,type,align,prev,info){this.indented=indented;this.column=column;this.type=type;this.prev=prev;this.info=info;if(align!=null)this.align=align}function inScope(state,varname){if(!trackScope)return false;for(var v=state.localVars;v;v=v.next)if(v.name==varname)return true;for(var cx=state.context;cx;cx=cx.prev){for(var v=cx.vars;v;v=v.next)if(v.name==varname)return true}}function parseJS(state,style,type,content,stream){var cc=state.cc;cx.state=state;cx.stream=stream;cx.marked=null,cx.cc=cc;cx.style=style;if(!state.lexical.hasOwnProperty("align"))state.lexical.align=true;while(true){var combinator=cc.length?cc.pop():jsonMode?expression:statement;if(combinator(type,content)){while(cc.length&&cc[cc.length-1].lex)cc.pop()();if(cx.marked)return cx.marked;if(type=="variable"&&inScope(state,content))return"variable-2";return style}}}var cx={state:null,column:null,marked:null,cc:null};function pass(){for(var i=arguments.length-1;i>=0;i--)cx.cc.push(arguments[i])}function cont(){pass.apply(null,arguments);return true}function inList(name,list){for(var v=list;v;v=v.next)if(v.name==name)return true;return false}function register(varname){var state=cx.state;cx.marked="def";if(!trackScope)return;if(state.context){if(state.lexical.info=="var"&&state.context&&state.context.block){var newContext=registerVarScoped(varname,state.context);if(newContext!=null){state.context=newContext;return}}else if(!inList(varname,state.localVars)){state.localVars=new Var(varname,state.localVars);return}}if(parserConfig.globalVars&&!inList(varname,state.globalVars))state.globalVars=new Var(varname,state.globalVars)}function registerVarScoped(varname,context){if(!context){return null}else if(context.block){var inner=registerVarScoped(varname,context.prev);if(!inner)return null;if(inner==context.prev)return context;return new Context(inner,context.vars,true)}else if(inList(varname,context.vars)){return context}else{return new Context(context.prev,new Var(varname,context.vars),false)}}function isModifier(name){return name=="public"||name=="private"||name=="protected"||name=="abstract"||name=="readonly"}function Context(prev,vars,block){this.prev=prev;this.vars=vars;this.block=block}function Var(name,next){this.name=name;this.next=next}var defaultVars=new Var("this",new Var("arguments",null));function pushcontext(){cx.state.context=new Context(cx.state.context,cx.state.localVars,false);cx.state.localVars=defaultVars}function pushblockcontext(){cx.state.context=new Context(cx.state.context,cx.state.localVars,true);cx.state.localVars=null}pushcontext.lex=pushblockcontext.lex=true;function popcontext(){cx.state.localVars=cx.state.context.vars;cx.state.context=cx.state.context.prev}popcontext.lex=true;function pushlex(type,info){var result=function(){var state=cx.state,indent=state.indented;if(state.lexical.type=="stat")indent=state.lexical.indented;else for(var outer=state.lexical;outer&&outer.type==")"&&outer.align;outer=outer.prev)indent=outer.indented;state.lexical=new JSLexical(indent,cx.stream.column(),type,null,state.lexical,info)};result.lex=true;return result}function poplex(){var state=cx.state;if(state.lexical.prev){if(state.lexical.type==")")state.indented=state.lexical.indented;state.lexical=state.lexical.prev}}poplex.lex=true;function expect(wanted){function exp(type){if(type==wanted)return cont();else if(wanted==";"||type=="}"||type==")"||type=="]")return pass();else return cont(exp)}return exp}function statement(type,value){if(type=="var")return cont(pushlex("vardef",value),vardef,expect(";"),poplex);if(type=="keyword a")return cont(pushlex("form"),parenExpr,statement,poplex);if(type=="keyword b")return cont(pushlex("form"),statement,poplex);if(type=="keyword d")return cx.stream.match(/^\s*$/,false)?cont():cont(pushlex("stat"),maybeexpression,expect(";"),poplex);if(type=="debugger")return cont(expect(";"));if(type=="{")return cont(pushlex("}"),pushblockcontext,block,poplex,popcontext);if(type==";")return cont();if(type=="if"){if(cx.state.lexical.info=="else"&&cx.state.cc[cx.state.cc.length-1]==poplex)cx.state.cc.pop()();return cont(pushlex("form"),parenExpr,statement,poplex,maybeelse)}if(type=="function")return cont(functiondef);if(type=="for")return cont(pushlex("form"),pushblockcontext,forspec,statement,popcontext,poplex);if(type=="class"||isTS&&value=="interface"){cx.marked="keyword";return cont(pushlex("form",type=="class"?type:value),className,poplex)}if(type=="variable"){if(isTS&&value=="declare"){cx.marked="keyword";return cont(statement)}else if(isTS&&(value=="module"||value=="enum"||value=="type")&&cx.stream.match(/^\s*\w/,false)){cx.marked="keyword";if(value=="enum")return cont(enumdef);else if(value=="type")return cont(typename,expect("operator"),typeexpr,expect(";"));else return cont(pushlex("form"),pattern,expect("{"),pushlex("}"),block,poplex,poplex)}else if(isTS&&value=="namespace"){cx.marked="keyword";return cont(pushlex("form"),expression,statement,poplex)}else if(isTS&&value=="abstract"){cx.marked="keyword";return cont(statement)}else{return cont(pushlex("stat"),maybelabel)}}if(type=="switch")return cont(pushlex("form"),parenExpr,expect("{"),pushlex("}","switch"),pushblockcontext,block,poplex,poplex,popcontext);if(type=="case")return cont(expression,expect(":"));if(type=="default")return cont(expect(":"));if(type=="catch")return cont(pushlex("form"),pushcontext,maybeCatchBinding,statement,poplex,popcontext);if(type=="export")return cont(pushlex("stat"),afterExport,poplex);if(type=="import")return cont(pushlex("stat"),afterImport,poplex);if(type=="async")return cont(statement);if(value=="@")return cont(expression,statement);return pass(pushlex("stat"),expression,expect(";"),poplex)}function maybeCatchBinding(type){if(type=="(")return cont(funarg,expect(")"))}function expression(type,value){return expressionInner(type,value,false)}function expressionNoComma(type,value){return expressionInner(type,value,true)}function parenExpr(type){if(type!="(")return pass();return cont(pushlex(")"),maybeexpression,expect(")"),poplex)}function expressionInner(type,value,noComma){if(cx.state.fatArrowAt==cx.stream.start){var body=noComma?arrowBodyNoComma:arrowBody;if(type=="(")return cont(pushcontext,pushlex(")"),commasep(funarg,")"),poplex,expect("=>"),body,popcontext);else if(type=="variable")return pass(pushcontext,pattern,expect("=>"),body,popcontext)}var maybeop=noComma?maybeoperatorNoComma:maybeoperatorComma;if(atomicTypes.hasOwnProperty(type))return cont(maybeop);if(type=="function")return cont(functiondef,maybeop);if(type=="class"||isTS&&value=="interface"){cx.marked="keyword";return cont(pushlex("form"),classExpression,poplex)}if(type=="keyword c"||type=="async")return cont(noComma?expressionNoComma:expression);if(type=="(")return cont(pushlex(")"),maybeexpression,expect(")"),poplex,maybeop);if(type=="operator"||type=="spread")return cont(noComma?expressionNoComma:expression);if(type=="[")return cont(pushlex("]"),arrayLiteral,poplex,maybeop);if(type=="{")return contCommasep(objprop,"}",null,maybeop);if(type=="quasi")return pass(quasi,maybeop);if(type=="new")return cont(maybeTarget(noComma));return cont()}function maybeexpression(type){if(type.match(/[;\}\)\],]/))return pass();return pass(expression)}function maybeoperatorComma(type,value){if(type==",")return cont(maybeexpression);return maybeoperatorNoComma(type,value,false)}function maybeoperatorNoComma(type,value,noComma){var me=noComma==false?maybeoperatorComma:maybeoperatorNoComma;var expr=noComma==false?expression:expressionNoComma;if(type=="=>")return cont(pushcontext,noComma?arrowBodyNoComma:arrowBody,popcontext);if(type=="operator"){if(/\+\+|--/.test(value)||isTS&&value=="!")return cont(me);if(isTS&&value=="<"&&cx.stream.match(/^([^<>]|<[^<>]*>)*>\s*\(/,false))return cont(pushlex(">"),commasep(typeexpr,">"),poplex,me);if(value=="?")return cont(expression,expect(":"),expr);return cont(expr)}if(type=="quasi"){return pass(quasi,me)}if(type==";")return;if(type=="(")return contCommasep(expressionNoComma,")","call",me);if(type==".")return cont(property,me);if(type=="[")return cont(pushlex("]"),maybeexpression,expect("]"),poplex,me);if(isTS&&value=="as"){cx.marked="keyword";return cont(typeexpr,me)}if(type=="regexp"){cx.state.lastType=cx.marked="operator";cx.stream.backUp(cx.stream.pos-cx.stream.start-1);return cont(expr)}}function quasi(type,value){if(type!="quasi")return pass();if(value.slice(value.length-2)!="${")return cont(quasi);return cont(maybeexpression,continueQuasi)}function continueQuasi(type){if(type=="}"){cx.marked="string-2";cx.state.tokenize=tokenQuasi;return cont(quasi)}}function arrowBody(type){findFatArrow(cx.stream,cx.state);return pass(type=="{"?statement:expression)}function arrowBodyNoComma(type){findFatArrow(cx.stream,cx.state);return pass(type=="{"?statement:expressionNoComma)}function maybeTarget(noComma){return function(type){if(type==".")return cont(noComma?targetNoComma:target);else if(type=="variable"&&isTS)return cont(maybeTypeArgs,noComma?maybeoperatorNoComma:maybeoperatorComma);else return pass(noComma?expressionNoComma:expression)}}function target(_,value){if(value=="target"){cx.marked="keyword";return cont(maybeoperatorComma)}}function targetNoComma(_,value){if(value=="target"){cx.marked="keyword";return cont(maybeoperatorNoComma)}}function maybelabel(type){if(type==":")return cont(poplex,statement);return pass(maybeoperatorComma,expect(";"),poplex)}function property(type){if(type=="variable"){cx.marked="property";return cont()}}function objprop(type,value){if(type=="async"){cx.marked="property";return cont(objprop)}else if(type=="variable"||cx.style=="keyword"){cx.marked="property";if(value=="get"||value=="set")return cont(getterSetter);var m;if(isTS&&cx.state.fatArrowAt==cx.stream.start&&(m=cx.stream.match(/^\s*:\s*/,false)))cx.state.fatArrowAt=cx.stream.pos+m[0].length;return cont(afterprop)}else if(type=="number"||type=="string"){cx.marked=jsonldMode?"property":cx.style+" property";return cont(afterprop)}else if(type=="jsonld-keyword"){return cont(afterprop)}else if(isTS&&isModifier(value)){cx.marked="keyword";return cont(objprop)}else if(type=="["){return cont(expression,maybetype,expect("]"),afterprop)}else if(type=="spread"){return cont(expressionNoComma,afterprop)}else if(value=="*"){cx.marked="keyword";return cont(objprop)}else if(type==":"){return pass(afterprop)}}function getterSetter(type){if(type!="variable")return pass(afterprop);cx.marked="property";return cont(functiondef)}function afterprop(type){if(type==":")return cont(expressionNoComma);if(type=="(")return pass(functiondef)}function commasep(what,end,sep){function proceed(type,value){if(sep?sep.indexOf(type)>-1:type==","){var lex=cx.state.lexical;if(lex.info=="call")lex.pos=(lex.pos||0)+1;return cont((function(type,value){if(type==end||value==end)return pass();return pass(what)}),proceed)}if(type==end||value==end)return cont();if(sep&&sep.indexOf(";")>-1)return pass(what);return cont(expect(end))}return function(type,value){if(type==end||value==end)return cont();return pass(what,proceed)}}function contCommasep(what,end,info){for(var i=3;i<arguments.length;i++)cx.cc.push(arguments[i]);return cont(pushlex(end,info),commasep(what,end),poplex)}function block(type){if(type=="}")return cont();return pass(statement,block)}function maybetype(type,value){if(isTS){if(type==":")return cont(typeexpr);if(value=="?")return cont(maybetype)}}function maybetypeOrIn(type,value){if(isTS&&(type==":"||value=="in"))return cont(typeexpr)}function mayberettype(type){if(isTS&&type==":"){if(cx.stream.match(/^\s*\w+\s+is\b/,false))return cont(expression,isKW,typeexpr);else return cont(typeexpr)}}function isKW(_,value){if(value=="is"){cx.marked="keyword";return cont()}}function typeexpr(type,value){if(value=="keyof"||value=="typeof"||value=="infer"||value=="readonly"){cx.marked="keyword";return cont(value=="typeof"?expressionNoComma:typeexpr)}if(type=="variable"||value=="void"){cx.marked="type";return cont(afterType)}if(value=="|"||value=="&")return cont(typeexpr);if(type=="string"||type=="number"||type=="atom")return cont(afterType);if(type=="[")return cont(pushlex("]"),commasep(typeexpr,"]",","),poplex,afterType);if(type=="{")return cont(pushlex("}"),typeprops,poplex,afterType);if(type=="(")return cont(commasep(typearg,")"),maybeReturnType,afterType);if(type=="<")return cont(commasep(typeexpr,">"),typeexpr);if(type=="quasi"){return pass(quasiType,afterType)}}function maybeReturnType(type){if(type=="=>")return cont(typeexpr)}function typeprops(type){if(type.match(/[\}\)\]]/))return cont();if(type==","||type==";")return cont(typeprops);return pass(typeprop,typeprops)}function typeprop(type,value){if(type=="variable"||cx.style=="keyword"){cx.marked="property";return cont(typeprop)}else if(value=="?"||type=="number"||type=="string"){return cont(typeprop)}else if(type==":"){return cont(typeexpr)}else if(type=="["){return cont(expect("variable"),maybetypeOrIn,expect("]"),typeprop)}else if(type=="("){return pass(functiondecl,typeprop)}else if(!type.match(/[;\}\)\],]/)){return cont()}}function quasiType(type,value){if(type!="quasi")return pass();if(value.slice(value.length-2)!="${")return cont(quasiType);return cont(typeexpr,continueQuasiType)}function continueQuasiType(type){if(type=="}"){cx.marked="string-2";cx.state.tokenize=tokenQuasi;return cont(quasiType)}}function typearg(type,value){if(type=="variable"&&cx.stream.match(/^\s*[?:]/,false)||value=="?")return cont(typearg);if(type==":")return cont(typeexpr);if(type=="spread")return cont(typearg);return pass(typeexpr)}function afterType(type,value){if(value=="<")return cont(pushlex(">"),commasep(typeexpr,">"),poplex,afterType);if(value=="|"||type=="."||value=="&")return cont(typeexpr);if(type=="[")return cont(typeexpr,expect("]"),afterType);if(value=="extends"||value=="implements"){cx.marked="keyword";return cont(typeexpr)}if(value=="?")return cont(typeexpr,expect(":"),typeexpr)}function maybeTypeArgs(_,value){if(value=="<")return cont(pushlex(">"),commasep(typeexpr,">"),poplex,afterType)}function typeparam(){return pass(typeexpr,maybeTypeDefault)}function maybeTypeDefault(_,value){if(value=="=")return cont(typeexpr)}function vardef(_,value){if(value=="enum"){cx.marked="keyword";return cont(enumdef)}return pass(pattern,maybetype,maybeAssign,vardefCont)}function pattern(type,value){if(isTS&&isModifier(value)){cx.marked="keyword";return cont(pattern)}if(type=="variable"){register(value);return cont()}if(type=="spread")return cont(pattern);if(type=="[")return contCommasep(eltpattern,"]");if(type=="{")return contCommasep(proppattern,"}")}function proppattern(type,value){if(type=="variable"&&!cx.stream.match(/^\s*:/,false)){register(value);return cont(maybeAssign)}if(type=="variable")cx.marked="property";if(type=="spread")return cont(pattern);if(type=="}")return pass();if(type=="[")return cont(expression,expect("]"),expect(":"),proppattern);return cont(expect(":"),pattern,maybeAssign)}function eltpattern(){return pass(pattern,maybeAssign)}function maybeAssign(_type,value){if(value=="=")return cont(expressionNoComma)}function vardefCont(type){if(type==",")return cont(vardef)}function maybeelse(type,value){if(type=="keyword b"&&value=="else")return cont(pushlex("form","else"),statement,poplex)}function forspec(type,value){if(value=="await")return cont(forspec);if(type=="(")return cont(pushlex(")"),forspec1,poplex)}function forspec1(type){if(type=="var")return cont(vardef,forspec2);if(type=="variable")return cont(forspec2);return pass(forspec2)}function forspec2(type,value){if(type==")")return cont();if(type==";")return cont(forspec2);if(value=="in"||value=="of"){cx.marked="keyword";return cont(expression,forspec2)}return pass(expression,forspec2)}function functiondef(type,value){if(value=="*"){cx.marked="keyword";return cont(functiondef)}if(type=="variable"){register(value);return cont(functiondef)}if(type=="(")return cont(pushcontext,pushlex(")"),commasep(funarg,")"),poplex,mayberettype,statement,popcontext);if(isTS&&value=="<")return cont(pushlex(">"),commasep(typeparam,">"),poplex,functiondef)}function functiondecl(type,value){if(value=="*"){cx.marked="keyword";return cont(functiondecl)}if(type=="variable"){register(value);return cont(functiondecl)}if(type=="(")return cont(pushcontext,pushlex(")"),commasep(funarg,")"),poplex,mayberettype,popcontext);if(isTS&&value=="<")return cont(pushlex(">"),commasep(typeparam,">"),poplex,functiondecl)}function typename(type,value){if(type=="keyword"||type=="variable"){cx.marked="type";return cont(typename)}else if(value=="<"){return cont(pushlex(">"),commasep(typeparam,">"),poplex)}}function funarg(type,value){if(value=="@")cont(expression,funarg);if(type=="spread")return cont(funarg);if(isTS&&isModifier(value)){cx.marked="keyword";return cont(funarg)}if(isTS&&type=="this")return cont(maybetype,maybeAssign);return pass(pattern,maybetype,maybeAssign)}function classExpression(type,value){if(type=="variable")return className(type,value);return classNameAfter(type,value)}function className(type,value){if(type=="variable"){register(value);return cont(classNameAfter)}}function classNameAfter(type,value){if(value=="<")return cont(pushlex(">"),commasep(typeparam,">"),poplex,classNameAfter);if(value=="extends"||value=="implements"||isTS&&type==","){if(value=="implements")cx.marked="keyword";return cont(isTS?typeexpr:expression,classNameAfter)}if(type=="{")return cont(pushlex("}"),classBody,poplex)}function classBody(type,value){if(type=="async"||type=="variable"&&(value=="static"||value=="get"||value=="set"||isTS&&isModifier(value))&&cx.stream.match(/^\s+#?[\w$\xa1-\uffff]/,false)){cx.marked="keyword";return cont(classBody)}if(type=="variable"||cx.style=="keyword"){cx.marked="property";return cont(classfield,classBody)}if(type=="number"||type=="string")return cont(classfield,classBody);if(type=="[")return cont(expression,maybetype,expect("]"),classfield,classBody);if(value=="*"){cx.marked="keyword";return cont(classBody)}if(isTS&&type=="(")return pass(functiondecl,classBody);if(type==";"||type==",")return cont(classBody);if(type=="}")return cont();if(value=="@")return cont(expression,classBody)}function classfield(type,value){if(value=="!")return cont(classfield);if(value=="?")return cont(classfield);if(type==":")return cont(typeexpr,maybeAssign);if(value=="=")return cont(expressionNoComma);var context=cx.state.lexical.prev,isInterface=context&&context.info=="interface";return pass(isInterface?functiondecl:functiondef)}function afterExport(type,value){if(value=="*"){cx.marked="keyword";return cont(maybeFrom,expect(";"))}if(value=="default"){cx.marked="keyword";return cont(expression,expect(";"))}if(type=="{")return cont(commasep(exportField,"}"),maybeFrom,expect(";"));return pass(statement)}function exportField(type,value){if(value=="as"){cx.marked="keyword";return cont(expect("variable"))}if(type=="variable")return pass(expressionNoComma,exportField)}function afterImport(type){if(type=="string")return cont();if(type=="(")return pass(expression);if(type==".")return pass(maybeoperatorComma);return pass(importSpec,maybeMoreImports,maybeFrom)}function importSpec(type,value){if(type=="{")return contCommasep(importSpec,"}");if(type=="variable")register(value);if(value=="*")cx.marked="keyword";return cont(maybeAs)}function maybeMoreImports(type){if(type==",")return cont(importSpec,maybeMoreImports)}function maybeAs(_type,value){if(value=="as"){cx.marked="keyword";return cont(importSpec)}}function maybeFrom(_type,value){if(value=="from"){cx.marked="keyword";return cont(expression)}}function arrayLiteral(type){if(type=="]")return cont();return pass(commasep(expressionNoComma,"]"))}function enumdef(){return pass(pushlex("form"),pattern,expect("{"),pushlex("}"),commasep(enummember,"}"),poplex,poplex)}function enummember(){return pass(pattern,maybeAssign)}function isContinuedStatement(state,textAfter){return state.lastType=="operator"||state.lastType==","||isOperatorChar.test(textAfter.charAt(0))||/[,.]/.test(textAfter.charAt(0))}function expressionAllowed(stream,state,backUp){return state.tokenize==tokenBase&&/^(?:operator|sof|keyword [bcd]|case|new|export|default|spread|[\[{}\(,;:]|=>)$/.test(state.lastType)||state.lastType=="quasi"&&/\{\s*$/.test(stream.string.slice(0,stream.pos-(backUp||0)))}return{startState:function(basecolumn){var state={tokenize:tokenBase,lastType:"sof",cc:[],lexical:new JSLexical((basecolumn||0)-indentUnit,0,"block",false),localVars:parserConfig.localVars,context:parserConfig.localVars&&new Context(null,null,false),indented:basecolumn||0};if(parserConfig.globalVars&&typeof parserConfig.globalVars=="object")state.globalVars=parserConfig.globalVars;return state},token:function(stream,state){if(stream.sol()){if(!state.lexical.hasOwnProperty("align"))state.lexical.align=false;state.indented=stream.indentation();findFatArrow(stream,state)}if(state.tokenize!=tokenComment&&stream.eatSpace())return null;var style=state.tokenize(stream,state);if(type=="comment")return style;state.lastType=type=="operator"&&(content=="++"||content=="--")?"incdec":type;return parseJS(state,style,type,content,stream)},indent:function(state,textAfter){if(state.tokenize==tokenComment||state.tokenize==tokenQuasi)return CodeMirror.Pass;if(state.tokenize!=tokenBase)return 0;var firstChar=textAfter&&textAfter.charAt(0),lexical=state.lexical,top;if(!/^\s*else\b/.test(textAfter))for(var i=state.cc.length-1;i>=0;--i){var c=state.cc[i];if(c==poplex)lexical=lexical.prev;else if(c!=maybeelse&&c!=popcontext)break}while((lexical.type=="stat"||lexical.type=="form")&&(firstChar=="}"||(top=state.cc[state.cc.length-1])&&(top==maybeoperatorComma||top==maybeoperatorNoComma)&&!/^[,\.=+\-*:?[\(]/.test(textAfter)))lexical=lexical.prev;if(statementIndent&&lexical.type==")"&&lexical.prev.type=="stat")lexical=lexical.prev;var type=lexical.type,closing=firstChar==type;if(type=="vardef")return lexical.indented+(state.lastType=="operator"||state.lastType==","?lexical.info.length+1:0);else if(type=="form"&&firstChar=="{")return lexical.indented;else if(type=="form")return lexical.indented+indentUnit;else if(type=="stat")return lexical.indented+(isContinuedStatement(state,textAfter)?statementIndent||indentUnit:0);else if(lexical.info=="switch"&&!closing&&parserConfig.doubleIndentSwitch!=false)return lexical.indented+(/^(?:case|default)\b/.test(textAfter)?indentUnit:2*indentUnit);else if(lexical.align)return lexical.column+(closing?0:1);else return lexical.indented+(closing?0:indentUnit)},electricInput:/^\s*(?:case .*?:|default:|\{|\})$/,blockCommentStart:jsonMode?null:"/*",blockCommentEnd:jsonMode?null:"*/",blockCommentContinue:jsonMode?null:" * ",lineComment:jsonMode?null:"//",fold:"brace",closeBrackets:"()[]{}''\"\"``",helperType:jsonMode?"json":"javascript",jsonldMode:jsonldMode,jsonMode:jsonMode,expressionAllowed:expressionAllowed,skipExpression:function(state){parseJS(state,"atom","atom","true",new CodeMirror.StringStream("",2,null))}}}));CodeMirror.registerHelper("wordChars","javascript",/[\w$]/);CodeMirror.defineMIME("text/javascript","javascript");CodeMirror.defineMIME("text/ecmascript","javascript");CodeMirror.defineMIME("application/javascript","javascript");CodeMirror.defineMIME("application/x-javascript","javascript");CodeMirror.defineMIME("application/ecmascript","javascript");CodeMirror.defineMIME("application/json",{name:"javascript",json:true});CodeMirror.defineMIME("application/x-json",{name:"javascript",json:true});CodeMirror.defineMIME("application/manifest+json",{name:"javascript",json:true});CodeMirror.defineMIME("application/ld+json",{name:"javascript",jsonld:true});CodeMirror.defineMIME("text/typescript",{name:"javascript",typescript:true});CodeMirror.defineMIME("application/typescript",{name:"javascript",typescript:true})}));(function(mod){if(typeof exports=="object"&&typeof module=="object")mod(require("../../lib/codemirror"));else if(typeof define=="function"&&define.amd)define(["../../lib/codemirror"],mod);else mod(CodeMirror)})((function(CodeMirror){"use strict";CodeMirror.defineExtension("annotateScrollbar",(function(options){if(typeof options=="string")options={className:options};return new Annotation(this,options)}));CodeMirror.defineOption("scrollButtonHeight",0);function Annotation(cm,options){this.cm=cm;this.options=options;this.buttonHeight=options.scrollButtonHeight||cm.getOption("scrollButtonHeight");this.annotations=[];this.doRedraw=this.doUpdate=null;this.div=cm.getWrapperElement().appendChild(document.createElement("div"));this.div.style.cssText="position: absolute; right: 0; top: 0; z-index: 7; pointer-events: none";this.computeScale();function scheduleRedraw(delay){clearTimeout(self.doRedraw);self.doRedraw=setTimeout((function(){self.redraw()}),delay)}var self=this;cm.on("refresh",this.resizeHandler=function(){clearTimeout(self.doUpdate);self.doUpdate=setTimeout((function(){if(self.computeScale())scheduleRedraw(20)}),100)});cm.on("markerAdded",this.resizeHandler);cm.on("markerCleared",this.resizeHandler);if(options.listenForChanges!==false)cm.on("changes",this.changeHandler=function(){scheduleRedraw(250)})}Annotation.prototype.computeScale=function(){var cm=this.cm;var hScale=(cm.getWrapperElement().clientHeight-cm.display.barHeight-this.buttonHeight*2)/cm.getScrollerElement().scrollHeight;if(hScale!=this.hScale){this.hScale=hScale;return true}};Annotation.prototype.update=function(annotations){this.annotations=annotations;this.redraw()};Annotation.prototype.redraw=function(compute){if(compute!==false)this.computeScale();var cm=this.cm,hScale=this.hScale;var frag=document.createDocumentFragment(),anns=this.annotations;var wrapping=cm.getOption("lineWrapping");var singleLineH=wrapping&&cm.defaultTextHeight()*1.5;var curLine=null,curLineObj=null;function getY(pos,top){if(curLine!=pos.line){curLine=pos.line;curLineObj=cm.getLineHandle(pos.line);var visual=cm.getLineHandleVisualStart(curLineObj);if(visual!=curLineObj){curLine=cm.getLineNumber(visual);curLineObj=visual}}if(curLineObj.widgets&&curLineObj.widgets.length||wrapping&&curLineObj.height>singleLineH)return cm.charCoords(pos,"local")[top?"top":"bottom"];var topY=cm.heightAtLine(curLineObj,"local");return topY+(top?0:curLineObj.height)}var lastLine=cm.lastLine();if(cm.display.barWidth)for(var i=0,nextTop;i<anns.length;i++){var ann=anns[i];if(ann.to.line>lastLine)continue;var top=nextTop||getY(ann.from,true)*hScale;var bottom=getY(ann.to,false)*hScale;while(i<anns.length-1){if(anns[i+1].to.line>lastLine)break;nextTop=getY(anns[i+1].from,true)*hScale;if(nextTop>bottom+.9)break;ann=anns[++i];bottom=getY(ann.to,false)*hScale}if(bottom==top)continue;var height=Math.max(bottom-top,3);var elt=frag.appendChild(document.createElement("div"));elt.style.cssText="position: absolute; right: 0px; width: "+Math.max(cm.display.barWidth-1,2)+"px; top: "+(top+this.buttonHeight)+"px; height: "+height+"px";elt.className=this.options.className;if(ann.id){elt.setAttribute("annotation-id",ann.id)}}this.div.textContent="";this.div.appendChild(frag)};Annotation.prototype.clear=function(){this.cm.off("refresh",this.resizeHandler);this.cm.off("markerAdded",this.resizeHandler);this.cm.off("markerCleared",this.resizeHandler);if(this.changeHandler)this.cm.off("changes",this.changeHandler);this.div.parentNode.removeChild(this.div)}}));(function(mod){if(typeof exports=="object"&&typeof module=="object")mod(require("../../lib/codemirror"));else if(typeof define=="function"&&define.amd)define(["../../lib/codemirror"],mod);else mod(CodeMirror)})((function(CodeMirror){"use strict";function doFold(cm,pos,options,force){if(options&&options.call){var finder=options;options=null}else{var finder=getOption(cm,options,"rangeFinder")}if(typeof pos=="number")pos=CodeMirror.Pos(pos,0);var minSize=getOption(cm,options,"minFoldSize");function getRange(allowFolded){var range=finder(cm,pos);if(!range||range.to.line-range.from.line<minSize)return null;if(force==="fold")return range;var marks=cm.findMarksAt(range.from);for(var i=0;i<marks.length;++i){if(marks[i].__isFold){if(!allowFolded)return null;range.cleared=true;marks[i].clear()}}return range}var range=getRange(true);if(getOption(cm,options,"scanUp"))while(!range&&pos.line>cm.firstLine()){pos=CodeMirror.Pos(pos.line-1,0);range=getRange(false)}if(!range||range.cleared||force==="unfold")return;var myWidget=makeWidget(cm,options,range);CodeMirror.on(myWidget,"mousedown",(function(e){myRange.clear();CodeMirror.e_preventDefault(e)}));var myRange=cm.markText(range.from,range.to,{replacedWith:myWidget,clearOnEnter:getOption(cm,options,"clearOnEnter"),__isFold:true});myRange.on("clear",(function(from,to){CodeMirror.signal(cm,"unfold",cm,from,to)}));CodeMirror.signal(cm,"fold",cm,range.from,range.to)}function makeWidget(cm,options,range){var widget=getOption(cm,options,"widget");if(typeof widget=="function"){widget=widget(range.from,range.to)}if(typeof widget=="string"){var text=document.createTextNode(widget);widget=document.createElement("span");widget.appendChild(text);widget.className="CodeMirror-foldmarker"}else if(widget){widget=widget.cloneNode(true)}return widget}CodeMirror.newFoldFunction=function(rangeFinder,widget){return function(cm,pos){doFold(cm,pos,{rangeFinder:rangeFinder,widget:widget})}};CodeMirror.defineExtension("foldCode",(function(pos,options,force){doFold(this,pos,options,force)}));CodeMirror.defineExtension("isFolded",(function(pos){var marks=this.findMarksAt(pos);for(var i=0;i<marks.length;++i)if(marks[i].__isFold)return true}));CodeMirror.commands.toggleFold=function(cm){cm.foldCode(cm.getCursor())};CodeMirror.commands.fold=function(cm){cm.foldCode(cm.getCursor(),null,"fold")};CodeMirror.commands.unfold=function(cm){cm.foldCode(cm.getCursor(),{scanUp:false},"unfold")};CodeMirror.commands.foldAll=function(cm){cm.operation((function(){for(var i=cm.firstLine(),e=cm.lastLine();i<=e;i++)cm.foldCode(CodeMirror.Pos(i,0),{scanUp:false},"fold")}))};CodeMirror.commands.unfoldAll=function(cm){cm.operation((function(){for(var i=cm.firstLine(),e=cm.lastLine();i<=e;i++)cm.foldCode(CodeMirror.Pos(i,0),{scanUp:false},"unfold")}))};CodeMirror.registerHelper("fold","combine",(function(){var funcs=Array.prototype.slice.call(arguments,0);return function(cm,start){for(var i=0;i<funcs.length;++i){var found=funcs[i](cm,start);if(found)return found}}}));CodeMirror.registerHelper("fold","auto",(function(cm,start){var helpers=cm.getHelpers(start,"fold");for(var i=0;i<helpers.length;i++){var cur=helpers[i](cm,start);if(cur)return cur}}));var defaultOptions={rangeFinder:CodeMirror.fold.auto,widget:"↔",minFoldSize:0,scanUp:false,clearOnEnter:true};CodeMirror.defineOption("foldOptions",null);function getOption(cm,options,name){if(options&&options[name]!==undefined)return options[name];var editorOptions=cm.options.foldOptions;if(editorOptions&&editorOptions[name]!==undefined)return editorOptions[name];return defaultOptions[name]}CodeMirror.defineExtension("foldOption",(function(options,name){return getOption(this,options,name)}))}));(function(mod){"use strict";if(typeof exports==="object"&&typeof module==="object")mod(require("codemirror"));else if(typeof define==="function"&&define.amd)define(["codemirror"],mod);else mod(CodeMirror)})((function(CodeMirror){"use strict";var cmEleToSearch=new Map;var ESCAPE_SPECIAL_CHARS=/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g;CodeMirror.defineOption("searchbox",false,(function(cm){function ctrlFHandler(){var cmEle=cm.display.wrapper;var Search=cmEleToSearch.get(cmEle);if(!Search||!cmEle.parentElement.contains(Search.searchBox)){cmEleToSearch.set(cmEle,new SearchBox(cm));Search=cmEleToSearch.get(cmEle)}var isReplace=false;if(cmEle.parentElement.querySelector("[action=toggleReplace]")){isReplace=cmEle.parentElement.querySelector("[action=toggleReplace]").innerText==="-"}Search.show(cm.getSelection(),isReplace)}cm.addKeyMap({"Ctrl-F":ctrlFHandler,Esc:function(){var Search=cmEleToSearch.get(cm.display.wrapper);if(!Search||!Search.isVisible())return CodeMirror.Pass;Search.hide();if(typeof event!=="undefined")event.stopPropagation()},"Cmd-F":ctrlFHandler})}));function SearchBox(cm){var self=this;init();function initElements(el){self.searchBox=el.querySelector(".ace_search_form");self.replaceBox=el.querySelector(".ace_replace_form");self.searchOptions=el.querySelector(".ace_search_options");self.regExpOption=el.querySelector("[action=toggleRegexpMode]");self.caseSensitiveOption=el.querySelector("[action=toggleCaseSensitive]");self.wholeWordOption=el.querySelector("[action=toggleWholeWords]");self.searchInput=self.searchBox.querySelector(".ace_search_field");self.replaceInput=self.replaceBox.querySelector(".ace_search_field")}function init(){var el=self.element=addHtml();addStyle();initElements(el);bindKeys();el.addEventListener("mousedown",(function(e){setTimeout((function(){self.activeInput.focus()}),0);e.stopPropagation()}));el.addEventListener("click",(function(e){var t=e.target||e.srcElement;var action=t.getAttribute("action");if(action&&self[action])self[action]();else if(self.commands[action])self.commands[action]();e.stopPropagation()}));self.searchInput.addEventListener("input",(function(){self.$onChange.schedule(20)}));self.searchInput.addEventListener("focus",(function(){self.activeInput=self.searchInput}));self.replaceInput.addEventListener("focus",(function(){self.activeInput=self.replaceInput}));self.$onChange=delayedCall((function(){self.find(false,false)}))}function bindKeys(){var sb=self,obj={"Ctrl-F|Cmd-F|Command-Alt-F":function(){sb.searchInput.focus();sb.searchInput.select()},"Ctrl-H":function(){sb.replaceBox.style.display="";sb.replaceInput.focus();sb.replaceInput.select()},"Ctrl-G|Cmd-G":function(){sb.findNext()},"Ctrl-Shift-G|Cmd-Shift-G":function(){sb.findPrev()},Esc:function(){setTimeout((function(){sb.hide()}))},"Shift-Enter":function(){if(sb.activeInput===sb.replaceInput)sb.replace();sb.findPrev()},Enter:function(){if(sb.activeInput===sb.replaceInput)sb.replace();sb.findNext()},"Alt-Enter":function(){if(sb.activeInput===sb.replaceInput)sb.replaceAll();sb.findAll()},Tab:function(){if(self.activeInput===self.replaceInput)self.searchInput.focus();else self.replaceInput.focus()}};self.element.addEventListener("keydown",(function(event){Object.keys(obj).some((function(name){var is=key(name,event);if(is){event.stopPropagation();event.preventDefault();obj[name](event)}return is}))}))}this.commands={toggleRegexpMode:function(){self.regExpOption.checked=!self.regExpOption.checked;self.$syncOptions()},toggleCaseSensitive:function(){self.caseSensitiveOption.checked=!self.caseSensitiveOption.checked;self.$syncOptions()},toggleWholeWords:function(){self.wholeWordOption.checked=!self.wholeWordOption.checked;self.$syncOptions()}};this.$syncOptions=function(){setCssClass(this.regExpOption,"checked",this.regExpOption.checked);setCssClass(this.wholeWordOption,"checked",this.wholeWordOption.checked);setCssClass(this.caseSensitiveOption,"checked",this.caseSensitiveOption.checked);this.find(false,false)};this.find=function(skipCurrent,backwards){var value=this.searchInput.value,options={skipCurrent:skipCurrent,backwards:backwards,regExp:this.regExpOption.checked,caseSensitive:this.caseSensitiveOption.checked,wholeWord:this.wholeWordOption.checked};find(value,options,(function(searchCursor){var current=searchCursor.matches(false,searchCursor.from());cm.setSelection(current.from,current.to)}))};function find(value,options,callback){if(!value){clearSearch(cm);updateCount();setCssClass(self.searchBox,"ace_nomatch",false);return}var done,noMatch,searchCursor,next,prev,matches,cursor,position,val=value,o=options,is=true,caseSensitive=o.caseSensitive,regExp=o.regExp,wholeWord=o.wholeWord;if(regExp){val=val.replace(ESCAPE_SPECIAL_CHARS,"\\$&")}if(wholeWord){if(caseSensitive){val=val=RegExp("\\b"+val+"\\b")}else{val=RegExp("\\b"+val+"\\b","i")}}if(regExp){val=RegExp(val)}clearSearch(cm);doSearch(cm,val,caseSensitive);updateCount();if(o.backwards)position=o.skipCurrent?"from":"to";else position=o.skipCurrent?"to":"from";cursor=cm.getCursor(position);searchCursor=cm.getSearchCursor(val,cursor,!caseSensitive);next=searchCursor.findNext.bind(searchCursor),prev=searchCursor.findPrevious.bind(searchCursor),matches=searchCursor.matches.bind(searchCursor);if(o.backwards&&!prev()){is=next();if(is){cm.setCursor(cm.doc.size-1,0);find(value,options,callback);done=true}}else if(!o.backwards&&!next()){is=prev();if(is){cm.setCursor(0,0);find(value,options,callback);done=true}}noMatch=!is&&self.searchInput.value;setCssClass(self.searchBox,"ace_nomatch",noMatch);if(!done&&is)callback(searchCursor)}this.findNext=function(){this.find(true,false)};this.findPrev=function(){this.find(true,true)};this.findAll=function(){var value=this.searchInput.value,range,noMatch=!range&&this.searchInput.value;setCssClass(this.searchBox,"ace_nomatch",noMatch);if(cm.showMatchesOnScrollbar)cm.showMatchesOnScrollbar(value);this.hide()};this.replace=function(){var readOnly=cm.getOption("readOnly"),isSelection=!!cm.getSelection();if(!readOnly&&isSelection)cm.replaceSelection(this.replaceInput.value,"start");updateCount()};this.replaceAndFindNext=function(){var readOnly=cm.getOption("readOnly");if(!readOnly){this.replace();this.findNext()}};this.replaceAll=function(){var value,cursor,from=this.searchInput.value,to=this.replaceInput.value,reg=RegExp(from.replace(ESCAPE_SPECIAL_CHARS,"\\$&"),this.caseSensitiveOption.checked?"g":"gi");if(this.wholeWordOption.checked&&!this.regExpOption.checked){if(this.caseSensitiveOption.checked){reg=RegExp("\\b"+from+"\\b","g")}else{reg=RegExp("\\b"+from+"\\b","gi")}}if(!cm.getOption("readOnly")&&cm.getSelection()){cursor=cm.getCursor();value=cm.getValue();value=value.replace(reg,to);cm.setValue(value);cm.setCursor(cursor)}updateCount()};this.toggleReplace=function(){var cmEle=cm.display.wrapper;if(cmEle.parentElement.querySelector("[action=toggleReplace]").innerText==="+"){cmEle.parentElement.querySelector("[action=toggleReplace]").innerText="-";this.replaceBox.style.display="";this.isReplace=true}else{cmEle.parentElement.querySelector("[action=toggleReplace]").innerText="+";this.replaceBox.style.display="none";this.isReplace=false}};this.hide=function(){clearSearch(cm);var cmEle=cm.getWrapperElement();cmEleToSearch.set(cmEle,null);cmEle.removeChild(this.element);cm.focus();if(cmEle.parentElement.querySelector(".code-editor-buttons-ctn"))document.querySelector(".code-editor-buttons-ctn").style.display="";if(cmEle.parentElement.querySelector(".toggle-wrap-button-html"))document.querySelector(".toggle-wrap-button-html").style.display=""};this.isVisible=function(){var is=this.element.style.display==="";return is};this.show=function(value,isReplace){this.element.style.display="";if(!isReplace){this.replaceBox.style.display=isReplace?"":"none"}this.isReplace=isReplace;if(value){this.searchInput.value=value;this.find(false,false)}this.searchInput.focus();this.searchInput.select();var cmEle=cm.getWrapperElement();if(cmEle.parentElement.querySelector(".code-editor-buttons-ctn"))document.querySelector(".code-editor-buttons-ctn").style.display="none";if(cmEle.parentElement.querySelector(".toggle-wrap-button-html"))document.querySelector(".toggle-wrap-button-html").style.display="none"};this.isFocused=function(){var el=document.activeElement;return el===this.searchInput||el===this.replaceInput};function doSearch(cm,value,caseSensitive){var state=getSearchState(cm);var query=value;if(query&&query!==state.queryText){startSearch(cm,state,query,caseSensitive);state.posFrom=state.posTo=cm.getCursor()}}function parseString(string){return string.replace(/\\([nrt\\])/g,(function(match,ch){if(ch=="n")return"\n";if(ch=="r")return"\r";if(ch=="t")return"\t";if(ch=="\\")return"\\";return match}))}function parseQuery(query){var reStr=typeof query==="object"?query.toString():query;var isRE=reStr.match(/^\/(.*)\/([a-z]*)$/);if(isRE){try{query=new RegExp(isRE[1],isRE[2].indexOf("i")==-1?"":"i")}catch(e){}}else{query=parseString(query)}if(typeof query=="string"?query=="":query.test(""))query=/x^/;return query}function startSearch(cm,state,query,caseSensitive){state.queryText=query;state.query=parseQuery(query);cm.removeOverlay(state.overlay,queryCaseInsensitive(state.query,caseSensitive));state.overlay=searchOverlay(state.query,queryCaseInsensitive(state.query,caseSensitive));cm.addOverlay(state.overlay);if(cm.showMatchesOnScrollbar){if(state.annotate){state.annotate.clear();state.annotate=null}state.annotate=cm.showMatchesOnScrollbar(state.query,queryCaseInsensitive(state.query,caseSensitive))}}function queryCaseInsensitive(query,caseSensitive){return typeof query=="string"&&!caseSensitive}function searchOverlay(query,caseInsensitive){if(typeof query=="string")query=new RegExp(query.replace(ESCAPE_SPECIAL_CHARS,"\\$&"),caseInsensitive?"gi":"g");else if(!query.global)query=new RegExp(query.source,query.ignoreCase?"gi":"g");return{token:function(stream){query.lastIndex=stream.pos;var match=query.exec(stream.string);if(match&&match.index==stream.pos){stream.pos+=match[0].length||1;return"searching"}else if(match){stream.pos=match.index}else{stream.skipToEnd()}}}}function SearchState(){this.posFrom=this.posTo=this.lastQuery=this.query=null;this.overlay=null}function getSearchState(cm){return cm.state.search||(cm.state.search=new SearchState)}function clearSearch(cm){cm.operation((function(){var state=getSearchState(cm);state.lastQuery=state.query;if(!state.query)return;state.query=state.queryText=null;cm.removeOverlay(state.overlay);if(state.annotate){state.annotate.clear();state.annotate=null}}))}function updateCount(){var val=self.searchInput.value;var matches=[];if(val){val=val.replace(ESCAPE_SPECIAL_CHARS,"\\$&");var reg;if(self.caseSensitiveOption.checked){reg=RegExp(val,"g")}else{reg=RegExp(val,"gi")}if(self.wholeWordOption.checked){if(self.caseSensitiveOption.checked){reg=RegExp("\\b"+val+"\\b","g")}else{reg=RegExp("\\b"+val+"\\b","gi")}}if(self.regExpOption.checked){reg=RegExp(val,"gi")}matches=cm.getValue().match(reg)}var count=matches?matches.length:0;var cmEle=cm.display.wrapper;var countEle=cmEle.parentElement.querySelector(".ace_search_counter");if(countEle){countEle.innerText=count+" matches found."}if(count===0){}}function addStyle(){let isDarkMode=window.matchMedia("(prefers-color-scheme: dark)")?.matches;var style=document.createElement("style"),css=[".ace_search {",`background-color: ${isDarkMode?"#2c2c2c":"#ddd"};`,`border: 1px solid ${isDarkMode?"#575757":"#cbcbcb"};`,"border-top: 0 none;","max-width: 325px;","overflow: hidden;","margin: 0;","padding: 4px;","padding-right: 6px;","padding-bottom: 0;","position: absolute;","top: 0px;","z-index: 99;","white-space: normal;","font-size: 12px;","}",".ace_search.left {","border-left: 0 none;","border-radius: 0px 0px 5px 0px;","left: 0;","}",".ace_search.right {","border-radius: 0px 0px 0px 5px;","border-right: 0 none;","right: 0;","}",".ace_search_form, .ace_replace_form {","border-radius: 3px;",`border: 1px solid ${isDarkMode?"#575757":"#cbcbcb"};`,"float: left;","margin-bottom: 4px;","overflow: hidden;","}",".ace_search_form.ace_nomatch {","outline: 1px solid #c54832;","}",".ace_search_field {",`background-color: ${isDarkMode?"#272727":"white"};`,`border-right: 1px solid ${isDarkMode?"#575757":"#cbcbcb"};`,"border: 0 none;","-webkit-box-sizing: border-box;","-moz-box-sizing: border-box;","box-sizing: border-box;","float: left;","height: 22px;","outline: 0;","padding: 0 7px;","width: 238px;","margin: 0;","}",".ace_searchbtn, .ace_replacebtn { border:none !important; }",".ace_searchbtn,",".ace_replacebtn {",`background: ${isDarkMode?"#2c2c2c":"#fff"};`,"border: 0 none;",`border-left: 1px solid ${isDarkMode?"#575757":"#dcdcdc"};`,"cursor: pointer;","float: left;","height: 22px;","padding: 0 5px;","margin: 0;","position: relative;","width:27px","}",`.ace_searchbtn:hover, .ace_replacebtn:hover { background-color:${isDarkMode?"#3c3c3c":"#dcdcdc"}; border:none !important; }`,".ace_searchbtn:last-child,",".ace_replacebtn:last-child {","border-top-right-radius: 3px;","border-bottom-right-radius: 3px;","}",".ace_searchbtn:disabled {","background: none;","cursor: default;","}",".ace_searchbtn {","background-position: 50% 50%;","background-repeat: no-repeat;","width: 27px;","}",".ace_searchbtn.prev {","background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAFCAYAAAB4ka1VAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAADFJREFUeNpiSU1NZUAC/6E0I0yACYskCpsJiySKIiY0SUZk40FyTEgCjGgKwTRAgAEAQJUIPCE+qfkAAAAASUVORK5CYII=);    ","}",".ace_searchbtn.next {","background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAFCAYAAAB4ka1VAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAADRJREFUeNpiTE1NZQCC/0DMyIAKwGJMUAYDEo3M/s+EpvM/mkKwCQxYjIeLMaELoLMBAgwAU7UJObTKsvAAAAAASUVORK5CYII=);    ","}",".ace_searchbtn_close {","background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAcCAYAAABRVo5BAAAAZ0lEQVR42u2SUQrAMAhDvazn8OjZBilCkYVVxiis8H4CT0VrAJb4WHT3C5xU2a2IQZXJjiQIRMdkEoJ5Q2yMqpfDIo+XY4k6h+YXOyKqTIj5REaxloNAd0xiKmAtsTHqW8sR2W5f7gCu5nWFUpVjZwAAAABJRU5ErkJggg==) no-repeat 50% 0;","border-radius: 50%;","border: 0 none;","color: #656565;","cursor: pointer;","float: right;","font: 16px/16px Arial;","height: 14px;","margin: 5px 1px 9px 5px;","padding: 0;","text-align: center;","width: 14px;","}",".ace_searchbtn_close:hover {","background-color: #656565;","background-position: 50% 100%;","color: white;","}",".ace_replacebtn.prev {","width: 54px","}",".ace_replacebtn.next {","width: 27px","}",".ace_button {","margin-left: 2px;","cursor: pointer;","-webkit-user-select: none;","-moz-user-select: none;","-o-user-select: none;","-ms-user-select: none;","user-select: none;","overflow: hidden;","opacity: 0.7;",`border: 1px solid ${isDarkMode?"#575757":"rgba(100,100,100,0.23)"};`,"padding: 1.4px;","-moz-box-sizing: border-box;","box-sizing:    border-box;",`color: ${isDarkMode?"white":"black"};`,`border-radius: 3px;`,"}",".ace_button:hover {",`background-color: ${isDarkMode?"#4a4a4a":"#eee"};`,"opacity:1;","}",".ace_button:active {","}",".ace_button.checked {","border-color: #3399ff;","opacity:1;","}",".ace_search_options{","clear: both;","margin: 4px 0;","text-align: right;","-webkit-user-select: none;","-moz-user-select: none;","-o-user-select: none;","-ms-user-select: none;","user-select: none;","}",".replace_toggle{","float: left;","margin-top: -2px;","padding: 0 5px;","border-radius: 3px;","margin-left: 0;",isDarkMode?"border-color:#575757;":""," }",".ace_search_counter{","float: left;","font-family: arial;","padding: 0 8px;","}","button svg,path {","pointer-events: none;","}"].join("");style.setAttribute("data-name","js-searchbox");style.textContent=css;document.head.appendChild(style)}function addHtml(){var elSearch,el=cm.getWrapperElement(),div=document.createElement("div"),html=['<div class="ace_search right">','<button type="button" action="hide" class="ace_searchbtn_close"></button>','<div class="ace_search_form">','<input class="ace_search_field" placeholder="Search for" spellcheck="false" autocomplete="one-time-code"></input>','<button type="button" action="findPrev" class="ace_searchbtn prev"></button>','<button type="button" action="findNext" class="ace_searchbtn next"></button>',"</div>",'<div class="ace_replace_form">','<input class="ace_search_field" placeholder="Replace with" spellcheck="false"></input>','<button type="button" action="replaceAndFindNext" title="Replace" class="ace_replacebtn">','<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">','<path fill-rule="evenodd" clip-rule="evenodd" d="M3.221 3.739L5.482 6.008L7.7 3.784L7 3.084L5.988 4.091L5.98 2.491C5.97909 2.35567 6.03068 2.22525 6.12392 2.12716C6.21716 2.02908 6.3448 1.97095 6.48 1.965H8V1H6.48C6.28496 1.00026 6.09189 1.03902 5.91186 1.11405C5.73183 1.18908 5.56838 1.29892 5.43088 1.43725C5.29338 1.57558 5.18455 1.73969 5.11061 1.92018C5.03667 2.10066 4.99908 2.29396 5 2.489V4.1L3.927 3.033L3.221 3.739ZM9.89014 5.53277H9.90141C10.0836 5.84426 10.3521 6 10.707 6C11.0995 6 11.4131 5.83236 11.6479 5.49708C11.8826 5.1618 12 4.71728 12 4.16353C12 3.65304 11.8995 3.2507 11.6986 2.95652C11.4977 2.66234 11.2113 2.51525 10.8394 2.51525C10.4338 2.51525 10.1211 2.70885 9.90141 3.09604H9.89014V1H9V5.91888H9.89014V5.53277ZM9.87606 4.47177V4.13108C9.87606 3.88449 9.93427 3.6844 10.0507 3.53082C10.169 3.37724 10.3174 3.30045 10.4958 3.30045C10.6854 3.30045 10.831 3.37833 10.9324 3.53407C11.0357 3.68765 11.0873 3.9018 11.0873 4.17651C11.0873 4.50746 11.031 4.76379 10.9183 4.94549C10.8075 5.12503 10.6507 5.2148 10.4479 5.2148C10.2808 5.2148 10.1437 5.14449 10.0366 5.00389C9.92958 4.86329 9.87606 4.68592 9.87606 4.47177ZM9 12.7691C8.74433 12.923 8.37515 13 7.89247 13C7.32855 13 6.87216 12.8225 6.5233 12.4674C6.17443 12.1124 6 11.6543 6 11.0931C6 10.4451 6.18638 9.93484 6.55914 9.5624C6.93429 9.18747 7.43489 9.00001 8.06093 9.00001C8.49343 9.00001 8.80645 9.0596 9 9.17878V10.1769C8.76344 9.99319 8.4994 9.90132 8.20789 9.90132C7.88292 9.90132 7.62485 10.0006 7.43369 10.1993C7.24492 10.3954 7.15054 10.6673 7.15054 11.0149C7.15054 11.3526 7.24134 11.6183 7.42294 11.8119C7.60454 12.0031 7.85424 12.0987 8.17204 12.0987C8.454 12.0987 8.72999 12.0068 9 11.8231V12.7691ZM4 7L3 8V14L4 15H11L12 14V8L11 7H4ZM4 8H5H10H11V9V13V14H10H5H4V13V9V8Z" fill="#656565"/>',"</svg></button>",'<button type="button" action="replaceAll" title="Replace All" class="ace_replacebtn">','<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">','<path fill-rule="evenodd" clip-rule="evenodd" d="M11.6009 2.67683C11.7474 2.36708 11.9559 2.2122 12.2263 2.2122C12.4742 2.2122 12.6651 2.32987 12.7991 2.56522C12.933 2.80056 13 3.12243 13 3.53082C13 3.97383 12.9218 4.32944 12.7653 4.59766C12.6088 4.86589 12.3997 5 12.138 5C11.9014 5 11.7224 4.87541 11.6009 4.62622H11.5934V4.93511H11V1H11.5934V2.67683H11.6009ZM11.584 3.77742C11.584 3.94873 11.6197 4.09063 11.6911 4.20311C11.7624 4.3156 11.8538 4.37184 11.9653 4.37184C12.1005 4.37184 12.205 4.30002 12.2789 4.15639C12.354 4.01103 12.3915 3.80597 12.3915 3.54121C12.3915 3.32144 12.3571 3.15012 12.2883 3.02726C12.2207 2.90266 12.1236 2.84036 11.9972 2.84036C11.8782 2.84036 11.7793 2.9018 11.7005 3.02466C11.6228 3.14752 11.584 3.30759 11.584 3.50487V3.77742ZM4.11969 7.695L2 5.56781L2.66188 4.90594L3.66781 5.90625V4.39594C3.66695 4.21309 3.70219 4.03187 3.7715 3.86266C3.84082 3.69346 3.94286 3.53961 4.07176 3.40992C4.20066 3.28023 4.3539 3.17727 4.52268 3.10692C4.69146 3.03658 4.87246 3.00024 5.05531 3H7.39906V3.90469H5.05531C4.92856 3.91026 4.8089 3.96476 4.72149 4.05672C4.63408 4.14868 4.58571 4.27094 4.58656 4.39781L4.59406 5.89781L5.54281 4.95375L6.19906 5.61L4.11969 7.695ZM9.3556 4.93017H10V3.22067C10 2.40689 9.68534 2 9.05603 2C8.92098 2 8.77083 2.02421 8.6056 2.07263C8.44181 2.12104 8.3125 2.17691 8.21767 2.24022V2.90503C8.45474 2.70205 8.70474 2.60056 8.96767 2.60056C9.22917 2.60056 9.35991 2.75698 9.35991 3.06983L8.76078 3.17318C8.25359 3.25885 8 3.57914 8 4.13408C8 4.39665 8.06106 4.60708 8.18319 4.76536C8.30675 4.92179 8.47557 5 8.68966 5C8.97989 5 9.19899 4.83985 9.34698 4.51955H9.3556V4.93017ZM9.35991 3.57542V3.76816C9.35991 3.9432 9.31968 4.08845 9.23922 4.20391C9.15876 4.3175 9.0546 4.3743 8.92672 4.3743C8.83477 4.3743 8.76149 4.34264 8.7069 4.27933C8.65374 4.21415 8.62716 4.13128 8.62716 4.03073C8.62716 3.80912 8.73779 3.6797 8.95905 3.64246L9.35991 3.57542ZM7 12.9302H6.3556V12.5196H6.34698C6.19899 12.8399 5.97989 13 5.68966 13C5.47557 13 5.30675 12.9218 5.18319 12.7654C5.06106 12.6071 5 12.3966 5 12.1341C5 11.5791 5.25359 11.2588 5.76078 11.1732L6.35991 11.0698C6.35991 10.757 6.22917 10.6006 5.96767 10.6006C5.70474 10.6006 5.45474 10.702 5.21767 10.905V10.2402C5.3125 10.1769 5.44181 10.121 5.6056 10.0726C5.77083 10.0242 5.92098 10 6.05603 10C6.68534 10 7 10.4069 7 11.2207V12.9302ZM6.35991 11.7682V11.5754L5.95905 11.6425C5.73779 11.6797 5.62716 11.8091 5.62716 12.0307C5.62716 12.1313 5.65374 12.2142 5.7069 12.2793C5.76149 12.3426 5.83477 12.3743 5.92672 12.3743C6.0546 12.3743 6.15876 12.3175 6.23922 12.2039C6.31968 12.0885 6.35991 11.9432 6.35991 11.7682ZM9.26165 13C9.58343 13 9.82955 12.9423 10 12.8268V12.1173C9.81999 12.2551 9.636 12.324 9.44803 12.324C9.23616 12.324 9.06969 12.2523 8.94863 12.1089C8.82756 11.9637 8.76702 11.7644 8.76702 11.5112C8.76702 11.2505 8.82995 11.0466 8.95579 10.8994C9.08323 10.7505 9.25528 10.676 9.47192 10.676C9.66627 10.676 9.84229 10.7449 10 10.8827V10.1341C9.87097 10.0447 9.66229 10 9.37395 10C8.95659 10 8.62286 10.1406 8.37276 10.4218C8.12425 10.7011 8 11.0838 8 11.5698C8 11.9907 8.11629 12.3343 8.34887 12.6006C8.58144 12.8669 8.8857 13 9.26165 13ZM2 9L3 8H12L13 9V14L12 15H3L2 14V9ZM3 9V14H12V9H3ZM6 7L7 6H14L15 7V12L14 13V12V7H7H6Z" fill="#656565"/>',"</svg></button>","</div>",'<div class="ace_search_options">','<span action="toggleReplace" class="ace_button replace_toggle">+</span>','<span class="ace_search_counter">0 matches found.</span>','<span action="toggleRegexpMode" title="RegExp Search"></span>','<span action="toggleCaseSensitive" class="ace_button" title="CaseSensitive Search">Aa</span>','<span action="toggleWholeWords" title="Whole Word Search"></span>',"</div>","</div>"].join("");div.innerHTML=html;elSearch=div.firstChild;el.appendChild(elSearch);return elSearch}}function setCssClass(el,className,condition){var list=el.classList;list[condition?"add":"remove"](className)}function delayedCall(fcn,defaultTimeout){var timer,callback=function(){timer=null;fcn()},_self=function(timeout){if(!timer)timer=setTimeout(callback,timeout||defaultTimeout)};_self.delay=function(timeout){timer&&clearTimeout(timer);timer=setTimeout(callback,timeout||defaultTimeout)};_self.schedule=_self;_self.call=function(){this.cancel();fcn()};_self.cancel=function(){timer&&clearTimeout(timer);timer=null};_self.isPending=function(){return timer};return _self}function key(str,event){var right,KEY={BACKSPACE:8,TAB:9,ENTER:13,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,UP:38,DOWN:40,INSERT:45,DELETE:46,INSERT_MAC:96,ASTERISK:106,PLUS:107,MINUS:109,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,SLASH:191,TRA:192,BACKSLASH:220};keyCheck(str,event);right=str.split("|").some((function(combination){var wrong;wrong=combination.split("-").some((function(key){var right;switch(key){case"Ctrl":right=event.ctrlKey;break;case"Shift":right=event.shiftKey;break;case"Alt":right=event.altKey;break;case"Cmd":right=event.metaKey;break;default:if(key.length===1)right=event.keyCode===key.charCodeAt(0);else Object.keys(KEY).some((function(name){var up=key.toUpperCase();if(up===name)right=event.keyCode===KEY[name]}));break}return!right}));return!wrong}));return right}function keyCheck(str,event){if(typeof str!=="string")throw Error("str should be string!");if(typeof event!=="object")throw Error("event should be object!")}}));(function(mod){if(typeof exports=="object"&&typeof module=="object")mod(require("../../lib/codemirror"));else if(typeof define=="function"&&define.amd)define(["../../lib/codemirror"],mod);else mod(CodeMirror)})((function(CodeMirror){"use strict";var htmlConfig={autoSelfClosers:{area:true,base:true,br:true,col:true,command:true,embed:true,frame:true,hr:true,img:true,input:true,keygen:true,link:true,meta:true,param:true,source:true,track:true,wbr:true,menuitem:true},implicitlyClosed:{dd:true,li:true,optgroup:true,option:true,p:true,rp:true,rt:true,tbody:true,td:true,tfoot:true,th:true,tr:true},contextGrabbers:{dd:{dd:true,dt:true},dt:{dd:true,dt:true},li:{li:true},option:{option:true,optgroup:true},optgroup:{optgroup:true},p:{address:true,article:true,aside:true,blockquote:true,dir:true,div:true,dl:true,fieldset:true,footer:true,form:true,h1:true,h2:true,h3:true,h4:true,h5:true,h6:true,header:true,hgroup:true,hr:true,menu:true,nav:true,ol:true,p:true,pre:true,section:true,table:true,ul:true},rp:{rp:true,rt:true},rt:{rp:true,rt:true},tbody:{tbody:true,tfoot:true},td:{td:true,th:true},tfoot:{tbody:true},th:{td:true,th:true},thead:{tbody:true,tfoot:true},tr:{tr:true}},doNotIndent:{pre:true},allowUnquoted:true,allowMissing:true,caseFold:true};var xmlConfig={autoSelfClosers:{},implicitlyClosed:{},contextGrabbers:{},doNotIndent:{},allowUnquoted:false,allowMissing:false,allowMissingTagName:false,caseFold:false};CodeMirror.defineMode("xml",(function(editorConf,config_){var indentUnit=editorConf.indentUnit;var config={};var defaults=config_.htmlMode?htmlConfig:xmlConfig;for(var prop in defaults)config[prop]=defaults[prop];for(var prop in config_)config[prop]=config_[prop];var type,setStyle;function inText(stream,state){function chain(parser){state.tokenize=parser;return parser(stream,state)}var ch=stream.next();if(ch=="<"){if(stream.eat("!")){if(stream.eat("[")){if(stream.match("CDATA["))return chain(inBlock("atom","]]>"));else return null}else if(stream.match("--")){return chain(inBlock("comment","--\x3e"))}else if(stream.match("DOCTYPE",true,true)){stream.eatWhile(/[\w\._\-]/);return chain(doctype(1))}else{return null}}else if(stream.eat("?")){stream.eatWhile(/[\w\._\-]/);state.tokenize=inBlock("meta","?>");return"meta"}else{type=stream.eat("/")?"closeTag":"openTag";state.tokenize=inTag;return"tag bracket"}}else if(ch=="&"){var ok;if(stream.eat("#")){if(stream.eat("x")){ok=stream.eatWhile(/[a-fA-F\d]/)&&stream.eat(";")}else{ok=stream.eatWhile(/[\d]/)&&stream.eat(";")}}else{ok=stream.eatWhile(/[\w\.\-:]/)&&stream.eat(";")}return ok?"atom":"error"}else{stream.eatWhile(/[^&<]/);return null}}inText.isInText=true;function inTag(stream,state){var ch=stream.next();if(ch==">"||ch=="/"&&stream.eat(">")){state.tokenize=inText;type=ch==">"?"endTag":"selfcloseTag";return"tag bracket"}else if(ch=="="){type="equals";return null}else if(ch=="<"){state.tokenize=inText;state.state=baseState;state.tagName=state.tagStart=null;var next=state.tokenize(stream,state);return next?next+" tag error":"tag error"}else if(/[\'\"]/.test(ch)){state.tokenize=inAttribute(ch);state.stringStartCol=stream.column();return state.tokenize(stream,state)}else{stream.match(/^[^\s\u00a0=<>\"\']*[^\s\u00a0=<>\"\'\/]/);return"word"}}function inAttribute(quote){var closure=function(stream,state){while(!stream.eol()){if(stream.next()==quote){state.tokenize=inTag;break}}return"string"};closure.isInAttribute=true;return closure}function inBlock(style,terminator){return function(stream,state){while(!stream.eol()){if(stream.match(terminator)){state.tokenize=inText;break}stream.next()}return style}}function doctype(depth){return function(stream,state){var ch;while((ch=stream.next())!=null){if(ch=="<"){state.tokenize=doctype(depth+1);return state.tokenize(stream,state)}else if(ch==">"){if(depth==1){state.tokenize=inText;break}else{state.tokenize=doctype(depth-1);return state.tokenize(stream,state)}}}return"meta"}}function lower(tagName){return tagName&&tagName.toLowerCase()}function Context(state,tagName,startOfLine){this.prev=state.context;this.tagName=tagName||"";this.indent=state.indented;this.startOfLine=startOfLine;if(config.doNotIndent.hasOwnProperty(tagName)||state.context&&state.context.noIndent)this.noIndent=true}function popContext(state){if(state.context)state.context=state.context.prev}function maybePopContext(state,nextTagName){var parentTagName;while(true){if(!state.context){return}parentTagName=state.context.tagName;if(!config.contextGrabbers.hasOwnProperty(lower(parentTagName))||!config.contextGrabbers[lower(parentTagName)].hasOwnProperty(lower(nextTagName))){return}popContext(state)}}function baseState(type,stream,state){if(type=="openTag"){state.tagStart=stream.column();return tagNameState}else if(type=="closeTag"){return closeTagNameState}else{return baseState}}function tagNameState(type,stream,state){if(type=="word"){state.tagName=stream.current();setStyle="tag";return attrState}else if(config.allowMissingTagName&&type=="endTag"){setStyle="tag bracket";return attrState(type,stream,state)}else{setStyle="error";return tagNameState}}function closeTagNameState(type,stream,state){if(type=="word"){var tagName=stream.current();if(state.context&&state.context.tagName!=tagName&&config.implicitlyClosed.hasOwnProperty(lower(state.context.tagName)))popContext(state);if(state.context&&state.context.tagName==tagName||config.matchClosing===false){setStyle="tag";return closeState}else{setStyle="tag error";return closeStateErr}}else if(config.allowMissingTagName&&type=="endTag"){setStyle="tag bracket";return closeState(type,stream,state)}else{setStyle="error";return closeStateErr}}function closeState(type,_stream,state){if(type!="endTag"){setStyle="error";return closeState}popContext(state);return baseState}function closeStateErr(type,stream,state){setStyle="error";return closeState(type,stream,state)}function attrState(type,_stream,state){if(type=="word"){setStyle="attribute";return attrEqState}else if(type=="endTag"||type=="selfcloseTag"){var tagName=state.tagName,tagStart=state.tagStart;state.tagName=state.tagStart=null;if(type=="selfcloseTag"||config.autoSelfClosers.hasOwnProperty(lower(tagName))){maybePopContext(state,tagName)}else{maybePopContext(state,tagName);state.context=new Context(state,tagName,tagStart==state.indented)}return baseState}setStyle="error";return attrState}function attrEqState(type,stream,state){if(type=="equals")return attrValueState;if(!config.allowMissing)setStyle="error";return attrState(type,stream,state)}function attrValueState(type,stream,state){if(type=="string")return attrContinuedState;if(type=="word"&&config.allowUnquoted){setStyle="string";return attrState}setStyle="error";return attrState(type,stream,state)}function attrContinuedState(type,stream,state){if(type=="string")return attrContinuedState;return attrState(type,stream,state)}return{startState:function(baseIndent){var state={tokenize:inText,state:baseState,indented:baseIndent||0,tagName:null,tagStart:null,context:null};if(baseIndent!=null)state.baseIndent=baseIndent;return state},token:function(stream,state){if(!state.tagName&&stream.sol())state.indented=stream.indentation();if(stream.eatSpace())return null;type=null;var style=state.tokenize(stream,state);if((style||type)&&style!="comment"){setStyle=null;state.state=state.state(type||style,stream,state);if(setStyle)style=setStyle=="error"?style+" error":setStyle}return style},indent:function(state,textAfter,fullLine){var context=state.context;if(state.tokenize.isInAttribute){if(state.tagStart==state.indented)return state.stringStartCol+1;else return state.indented+indentUnit}if(context&&context.noIndent)return CodeMirror.Pass;if(state.tokenize!=inTag&&state.tokenize!=inText)return fullLine?fullLine.match(/^(\s*)/)[0].length:0;if(state.tagName){if(config.multilineTagIndentPastTag!==false)return state.tagStart+state.tagName.length+2;else return state.tagStart+indentUnit*(config.multilineTagIndentFactor||1)}if(config.alignCDATA&&/<!\[CDATA\[/.test(textAfter))return 0;var tagAfter=textAfter&&/^<(\/)?([\w_:\.-]*)/.exec(textAfter);if(tagAfter&&tagAfter[1]){while(context){if(context.tagName==tagAfter[2]){context=context.prev;break}else if(config.implicitlyClosed.hasOwnProperty(lower(context.tagName))){context=context.prev}else{break}}}else if(tagAfter){while(context){var grabbers=config.contextGrabbers[lower(context.tagName)];if(grabbers&&grabbers.hasOwnProperty(lower(tagAfter[2])))context=context.prev;else break}}while(context&&context.prev&&!context.startOfLine)context=context.prev;if(context)return context.indent+indentUnit;else return state.baseIndent||0},electricInput:/<\/[\s\w:]+>$/,blockCommentStart:"\x3c!--",blockCommentEnd:"--\x3e",configuration:config.htmlMode?"html":"xml",helperType:config.htmlMode?"html":"xml",skipAttribute:function(state){if(state.state==attrValueState)state.state=attrState},xmlCurrentTag:function(state){return state.tagName?{name:state.tagName,close:state.type=="closeTag"}:null},xmlCurrentContext:function(state){var context=[];for(var cx=state.context;cx;cx=cx.prev)context.push(cx.tagName);return context.reverse()}}}));CodeMirror.defineMIME("text/xml","xml");CodeMirror.defineMIME("application/xml","xml");if(!CodeMirror.mimeModes.hasOwnProperty("text/html"))CodeMirror.defineMIME("text/html",{name:"xml",htmlMode:true})}));(function(mod){if(typeof exports=="object"&&typeof module=="object")mod(require("../../lib/codemirror"),require("../xml/xml"),require("../javascript/javascript"),require("../css/css"));else if(typeof define=="function"&&define.amd)define(["../../lib/codemirror","../xml/xml","../javascript/javascript","../css/css"],mod);else mod(CodeMirror)})((function(CodeMirror){"use strict";var defaultTags={script:[["lang",/(javascript|babel)/i,"javascript"],["type",/^(?:text|application)\/(?:x-)?(?:java|ecma)script$|^module$|^$/i,"javascript"],["type",/./,"text/plain"],[null,null,"javascript"]],style:[["lang",/^css$/i,"css"],["type",/^(text\/)?(x-)?(stylesheet|css)$/i,"css"],["type",/./,"text/plain"],[null,null,"css"]]};function maybeBackup(stream,pat,style){var cur=stream.current(),close=cur.search(pat);if(close>-1){stream.backUp(cur.length-close)}else if(cur.match(/<\/?$/)){stream.backUp(cur.length);if(!stream.match(pat,false))stream.match(cur)}return style}var attrRegexpCache={};function getAttrRegexp(attr){var regexp=attrRegexpCache[attr];if(regexp)return regexp;return attrRegexpCache[attr]=new RegExp("\\s+"+attr+"\\s*=\\s*('|\")?([^'\"]+)('|\")?\\s*")}function getAttrValue(text,attr){var match=text.match(getAttrRegexp(attr));return match?/^\s*(.*?)\s*$/.exec(match[2])[1]:""}function getTagRegexp(tagName,anchored){return new RegExp((anchored?"^":"")+"</\\s*"+tagName+"\\s*>","i")}function addTags(from,to){for(var tag in from){var dest=to[tag]||(to[tag]=[]);var source=from[tag];for(var i=source.length-1;i>=0;i--)dest.unshift(source[i])}}function findMatchingMode(tagInfo,tagText){for(var i=0;i<tagInfo.length;i++){var spec=tagInfo[i];if(!spec[0]||spec[1].test(getAttrValue(tagText,spec[0])))return spec[2]}}CodeMirror.defineMode("htmlmixed",(function(config,parserConfig){var htmlMode=CodeMirror.getMode(config,{name:"xml",htmlMode:true,multilineTagIndentFactor:parserConfig.multilineTagIndentFactor,multilineTagIndentPastTag:parserConfig.multilineTagIndentPastTag,allowMissingTagName:parserConfig.allowMissingTagName});var tags={};var configTags=parserConfig&&parserConfig.tags,configScript=parserConfig&&parserConfig.scriptTypes;addTags(defaultTags,tags);if(configTags)addTags(configTags,tags);if(configScript)for(var i=configScript.length-1;i>=0;i--)tags.script.unshift(["type",configScript[i].matches,configScript[i].mode]);function html(stream,state){var style=htmlMode.token(stream,state.htmlState),tag=/\btag\b/.test(style),tagName;if(tag&&!/[<>\s\/]/.test(stream.current())&&(tagName=state.htmlState.tagName&&state.htmlState.tagName.toLowerCase())&&tags.hasOwnProperty(tagName)){state.inTag=tagName+" "}else if(state.inTag&&tag&&/>$/.test(stream.current())){var inTag=/^([\S]+) (.*)/.exec(state.inTag);state.inTag=null;var modeSpec=stream.current()==">"&&findMatchingMode(tags[inTag[1]],inTag[2]);var mode=CodeMirror.getMode(config,modeSpec);var endTagA=getTagRegexp(inTag[1],true),endTag=getTagRegexp(inTag[1],false);state.token=function(stream,state){if(stream.match(endTagA,false)){state.token=html;state.localState=state.localMode=null;return null}return maybeBackup(stream,endTag,state.localMode.token(stream,state.localState))};state.localMode=mode;state.localState=CodeMirror.startState(mode,htmlMode.indent(state.htmlState,"",""))}else if(state.inTag){state.inTag+=stream.current();if(stream.eol())state.inTag+=" "}return style}return{startState:function(){var state=CodeMirror.startState(htmlMode);return{token:html,inTag:null,localMode:null,localState:null,htmlState:state}},copyState:function(state){var local;if(state.localState){local=CodeMirror.copyState(state.localMode,state.localState)}return{token:state.token,inTag:state.inTag,localMode:state.localMode,localState:local,htmlState:CodeMirror.copyState(htmlMode,state.htmlState)}},token:function(stream,state){return state.token(stream,state)},indent:function(state,textAfter,line){if(!state.localMode||/^\s*<\//.test(textAfter))return htmlMode.indent(state.htmlState,textAfter,line);else if(state.localMode.indent)return state.localMode.indent(state.localState,textAfter,line);else return CodeMirror.Pass},innerMode:function(state){return{state:state.localState||state.htmlState,mode:state.localMode||htmlMode}}}}),"xml","javascript","css");CodeMirror.defineMIME("text/html","htmlmixed")}));(function(mod){if(typeof exports=="object"&&typeof module=="object")mod(require("../../lib/codemirror"));else if(typeof define=="function"&&define.amd)define(["../../lib/codemirror"],mod);else mod(CodeMirror)})((function(CodeMirror){"use strict";CodeMirror.defineMode("css",(function(config,parserConfig){var inline=parserConfig.inline;if(!parserConfig.propertyKeywords)parserConfig=CodeMirror.resolveMode("text/css");var indentUnit=config.indentUnit,tokenHooks=parserConfig.tokenHooks,documentTypes=parserConfig.documentTypes||{},mediaTypes=parserConfig.mediaTypes||{},mediaFeatures=parserConfig.mediaFeatures||{},mediaValueKeywords=parserConfig.mediaValueKeywords||{},propertyKeywords=parserConfig.propertyKeywords||{},nonStandardPropertyKeywords=parserConfig.nonStandardPropertyKeywords||{},fontProperties=parserConfig.fontProperties||{},counterDescriptors=parserConfig.counterDescriptors||{},colorKeywords=parserConfig.colorKeywords||{},valueKeywords=parserConfig.valueKeywords||{},allowNested=parserConfig.allowNested,lineComment=parserConfig.lineComment,supportsAtComponent=parserConfig.supportsAtComponent===true,highlightNonStandardPropertyKeywords=config.highlightNonStandardPropertyKeywords!==false;var type,override;function ret(style,tp){type=tp;return style}function tokenBase(stream,state){var ch=stream.next();if(tokenHooks[ch]){var result=tokenHooks[ch](stream,state);if(result!==false)return result}if(ch=="@"){stream.eatWhile(/[\w\\\-]/);return ret("def",stream.current())}else if(ch=="="||(ch=="~"||ch=="|")&&stream.eat("=")){return ret(null,"compare")}else if(ch=='"'||ch=="'"){state.tokenize=tokenString(ch);return state.tokenize(stream,state)}else if(ch=="#"){stream.eatWhile(/[\w\\\-]/);return ret("atom","hash")}else if(ch=="!"){stream.match(/^\s*\w*/);return ret("keyword","important")}else if(/\d/.test(ch)||ch=="."&&stream.eat(/\d/)){stream.eatWhile(/[\w.%]/);return ret("number","unit")}else if(ch==="-"){if(/[\d.]/.test(stream.peek())){stream.eatWhile(/[\w.%]/);return ret("number","unit")}else if(stream.match(/^-[\w\\\-]*/)){stream.eatWhile(/[\w\\\-]/);if(stream.match(/^\s*:/,false))return ret("variable-2","variable-definition");return ret("variable-2","variable")}else if(stream.match(/^\w+-/)){return ret("meta","meta")}}else if(/[,+>*\/]/.test(ch)){return ret(null,"select-op")}else if(ch=="."&&stream.match(/^-?[_a-z][_a-z0-9-]*/i)){return ret("qualifier","qualifier")}else if(/[:;{}\[\]\(\)]/.test(ch)){return ret(null,ch)}else if(stream.match(/^[\w-.]+(?=\()/)){if(/^(url(-prefix)?|domain|regexp)$/i.test(stream.current())){state.tokenize=tokenParenthesized}return ret("variable callee","variable")}else if(/[\w\\\-]/.test(ch)){stream.eatWhile(/[\w\\\-]/);return ret("property","word")}else{return ret(null,null)}}function tokenString(quote){return function(stream,state){var escaped=false,ch;while((ch=stream.next())!=null){if(ch==quote&&!escaped){if(quote==")")stream.backUp(1);break}escaped=!escaped&&ch=="\\"}if(ch==quote||!escaped&&quote!=")")state.tokenize=null;return ret("string","string")}}function tokenParenthesized(stream,state){stream.next();if(!stream.match(/^\s*[\"\')]/,false))state.tokenize=tokenString(")");else state.tokenize=null;return ret(null,"(")}function Context(type,indent,prev){this.type=type;this.indent=indent;this.prev=prev}function pushContext(state,stream,type,indent){state.context=new Context(type,stream.indentation()+(indent===false?0:indentUnit),state.context);return type}function popContext(state){if(state.context.prev)state.context=state.context.prev;return state.context.type}function pass(type,stream,state){return states[state.context.type](type,stream,state)}function popAndPass(type,stream,state,n){for(var i=n||1;i>0;i--)state.context=state.context.prev;return pass(type,stream,state)}function wordAsValue(stream){var word=stream.current().toLowerCase();if(valueKeywords.hasOwnProperty(word))override="atom";else if(colorKeywords.hasOwnProperty(word))override="keyword";else override="variable"}var states={};states.top=function(type,stream,state){if(type=="{"){return pushContext(state,stream,"block")}else if(type=="}"&&state.context.prev){return popContext(state)}else if(supportsAtComponent&&/@component/i.test(type)){return pushContext(state,stream,"atComponentBlock")}else if(/^@(-moz-)?document$/i.test(type)){return pushContext(state,stream,"documentTypes")}else if(/^@(media|supports|(-moz-)?document|import)$/i.test(type)){return pushContext(state,stream,"atBlock")}else if(/^@(font-face|counter-style)/i.test(type)){state.stateArg=type;return"restricted_atBlock_before"}else if(/^@(-(moz|ms|o|webkit)-)?keyframes$/i.test(type)){return"keyframes"}else if(type&&type.charAt(0)=="@"){return pushContext(state,stream,"at")}else if(type=="hash"){override="builtin"}else if(type=="word"){override="tag"}else if(type=="variable-definition"){return"maybeprop"}else if(type=="interpolation"){return pushContext(state,stream,"interpolation")}else if(type==":"){return"pseudo"}else if(allowNested&&type=="("){return pushContext(state,stream,"parens")}return state.context.type};states.block=function(type,stream,state){if(type=="word"){var word=stream.current().toLowerCase();if(propertyKeywords.hasOwnProperty(word)){override="property";return"maybeprop"}else if(nonStandardPropertyKeywords.hasOwnProperty(word)){override=highlightNonStandardPropertyKeywords?"string-2":"property";return"maybeprop"}else if(allowNested){override=stream.match(/^\s*:(?:\s|$)/,false)?"property":"tag";return"block"}else{override+=" error";return"maybeprop"}}else if(type=="meta"){return"block"}else if(!allowNested&&(type=="hash"||type=="qualifier")){override="error";return"block"}else{return states.top(type,stream,state)}};states.maybeprop=function(type,stream,state){if(type==":")return pushContext(state,stream,"prop");return pass(type,stream,state)};states.prop=function(type,stream,state){if(type==";")return popContext(state);if(type=="{"&&allowNested)return pushContext(state,stream,"propBlock");if(type=="}"||type=="{")return popAndPass(type,stream,state);if(type=="(")return pushContext(state,stream,"parens");if(type=="hash"&&!/^#([0-9a-fA-F]{3,4}|[0-9a-fA-F]{6}|[0-9a-fA-F]{8})$/.test(stream.current())){override+=" error"}else if(type=="word"){wordAsValue(stream)}else if(type=="interpolation"){return pushContext(state,stream,"interpolation")}return"prop"};states.propBlock=function(type,_stream,state){if(type=="}")return popContext(state);if(type=="word"){override="property";return"maybeprop"}return state.context.type};states.parens=function(type,stream,state){if(type=="{"||type=="}")return popAndPass(type,stream,state);if(type==")")return popContext(state);if(type=="(")return pushContext(state,stream,"parens");if(type=="interpolation")return pushContext(state,stream,"interpolation");if(type=="word")wordAsValue(stream);return"parens"};states.pseudo=function(type,stream,state){if(type=="meta")return"pseudo";if(type=="word"){override="variable-3";return state.context.type}return pass(type,stream,state)};states.documentTypes=function(type,stream,state){if(type=="word"&&documentTypes.hasOwnProperty(stream.current())){override="tag";return state.context.type}else{return states.atBlock(type,stream,state)}};states.atBlock=function(type,stream,state){if(type=="(")return pushContext(state,stream,"atBlock_parens");if(type=="}"||type==";")return popAndPass(type,stream,state);if(type=="{")return popContext(state)&&pushContext(state,stream,allowNested?"block":"top");if(type=="interpolation")return pushContext(state,stream,"interpolation");if(type=="word"){var word=stream.current().toLowerCase();if(word=="only"||word=="not"||word=="and"||word=="or")override="keyword";else if(mediaTypes.hasOwnProperty(word))override="attribute";else if(mediaFeatures.hasOwnProperty(word))override="property";else if(mediaValueKeywords.hasOwnProperty(word))override="keyword";else if(propertyKeywords.hasOwnProperty(word))override="property";else if(nonStandardPropertyKeywords.hasOwnProperty(word))override=highlightNonStandardPropertyKeywords?"string-2":"property";else if(valueKeywords.hasOwnProperty(word))override="atom";else if(colorKeywords.hasOwnProperty(word))override="keyword";else override="error"}return state.context.type};states.atComponentBlock=function(type,stream,state){if(type=="}")return popAndPass(type,stream,state);if(type=="{")return popContext(state)&&pushContext(state,stream,allowNested?"block":"top",false);if(type=="word")override="error";return state.context.type};states.atBlock_parens=function(type,stream,state){if(type==")")return popContext(state);if(type=="{"||type=="}")return popAndPass(type,stream,state,2);return states.atBlock(type,stream,state)};states.restricted_atBlock_before=function(type,stream,state){if(type=="{")return pushContext(state,stream,"restricted_atBlock");if(type=="word"&&state.stateArg=="@counter-style"){override="variable";return"restricted_atBlock_before"}return pass(type,stream,state)};states.restricted_atBlock=function(type,stream,state){if(type=="}"){state.stateArg=null;return popContext(state)}if(type=="word"){if(state.stateArg=="@font-face"&&!fontProperties.hasOwnProperty(stream.current().toLowerCase())||state.stateArg=="@counter-style"&&!counterDescriptors.hasOwnProperty(stream.current().toLowerCase()))override="error";else override="property";return"maybeprop"}return"restricted_atBlock"};states.keyframes=function(type,stream,state){if(type=="word"){override="variable";return"keyframes"}if(type=="{")return pushContext(state,stream,"top");return pass(type,stream,state)};states.at=function(type,stream,state){if(type==";")return popContext(state);if(type=="{"||type=="}")return popAndPass(type,stream,state);if(type=="word")override="tag";else if(type=="hash")override="builtin";return"at"};states.interpolation=function(type,stream,state){if(type=="}")return popContext(state);if(type=="{"||type==";")return popAndPass(type,stream,state);if(type=="word")override="variable";else if(type!="variable"&&type!="("&&type!=")")override="error";return"interpolation"};return{startState:function(base){return{tokenize:null,state:inline?"block":"top",stateArg:null,context:new Context(inline?"block":"top",base||0,null)}},token:function(stream,state){if(!state.tokenize&&stream.eatSpace())return null;var style=(state.tokenize||tokenBase)(stream,state);if(style&&typeof style=="object"){type=style[1];style=style[0]}override=style;if(type!="comment")state.state=states[state.state](type,stream,state);return override},indent:function(state,textAfter){var cx=state.context,ch=textAfter&&textAfter.charAt(0);var indent=cx.indent;if(cx.type=="prop"&&(ch=="}"||ch==")"))cx=cx.prev;if(cx.prev){if(ch=="}"&&(cx.type=="block"||cx.type=="top"||cx.type=="interpolation"||cx.type=="restricted_atBlock")){cx=cx.prev;indent=cx.indent}else if(ch==")"&&(cx.type=="parens"||cx.type=="atBlock_parens")||ch=="{"&&(cx.type=="at"||cx.type=="atBlock")){indent=Math.max(0,cx.indent-indentUnit)}}return indent},electricChars:"}",blockCommentStart:"/*",blockCommentEnd:"*/",blockCommentContinue:" * ",lineComment:lineComment,fold:"brace"}}));function keySet(array){var keys={};for(var i=0;i<array.length;++i){keys[array[i].toLowerCase()]=true}return keys}var documentTypes_=["domain","regexp","url","url-prefix"],documentTypes=keySet(documentTypes_);var mediaTypes_=["all","aural","braille","handheld","print","projection","screen","tty","tv","embossed"],mediaTypes=keySet(mediaTypes_);var mediaFeatures_=["width","min-width","max-width","height","min-height","max-height","device-width","min-device-width","max-device-width","device-height","min-device-height","max-device-height","aspect-ratio","min-aspect-ratio","max-aspect-ratio","device-aspect-ratio","min-device-aspect-ratio","max-device-aspect-ratio","color","min-color","max-color","color-index","min-color-index","max-color-index","monochrome","min-monochrome","max-monochrome","resolution","min-resolution","max-resolution","scan","grid","orientation","device-pixel-ratio","min-device-pixel-ratio","max-device-pixel-ratio","pointer","any-pointer","hover","any-hover","prefers-color-scheme","dynamic-range","video-dynamic-range"],mediaFeatures=keySet(mediaFeatures_);var mediaValueKeywords_=["landscape","portrait","none","coarse","fine","on-demand","hover","interlace","progressive","dark","light","standard","high"],mediaValueKeywords=keySet(mediaValueKeywords_);var propertyKeywords_=["align-content","align-items","align-self","alignment-adjust","alignment-baseline","all","anchor-point","animation","animation-delay","animation-direction","animation-duration","animation-fill-mode","animation-iteration-count","animation-name","animation-play-state","animation-timing-function","appearance","azimuth","backdrop-filter","backface-visibility","background","background-attachment","background-blend-mode","background-clip","background-color","background-image","background-origin","background-position","background-position-x","background-position-y","background-repeat","background-size","baseline-shift","binding","bleed","block-size","bookmark-label","bookmark-level","bookmark-state","bookmark-target","border","border-bottom","border-bottom-color","border-bottom-left-radius","border-bottom-right-radius","border-bottom-style","border-bottom-width","border-collapse","border-color","border-image","border-image-outset","border-image-repeat","border-image-slice","border-image-source","border-image-width","border-left","border-left-color","border-left-style","border-left-width","border-radius","border-right","border-right-color","border-right-style","border-right-width","border-spacing","border-style","border-top","border-top-color","border-top-left-radius","border-top-right-radius","border-top-style","border-top-width","border-width","bottom","box-decoration-break","box-shadow","box-sizing","break-after","break-before","break-inside","caption-side","caret-color","clear","clip","color","color-profile","column-count","column-fill","column-gap","column-rule","column-rule-color","column-rule-style","column-rule-width","column-span","column-width","columns","contain","content","counter-increment","counter-reset","crop","cue","cue-after","cue-before","cursor","direction","display","dominant-baseline","drop-initial-after-adjust","drop-initial-after-align","drop-initial-before-adjust","drop-initial-before-align","drop-initial-size","drop-initial-value","elevation","empty-cells","fit","fit-content","fit-position","flex","flex-basis","flex-direction","flex-flow","flex-grow","flex-shrink","flex-wrap","float","float-offset","flow-from","flow-into","font","font-family","font-feature-settings","font-kerning","font-language-override","font-optical-sizing","font-size","font-size-adjust","font-stretch","font-style","font-synthesis","font-variant","font-variant-alternates","font-variant-caps","font-variant-east-asian","font-variant-ligatures","font-variant-numeric","font-variant-position","font-variation-settings","font-weight","gap","grid","grid-area","grid-auto-columns","grid-auto-flow","grid-auto-rows","grid-column","grid-column-end","grid-column-gap","grid-column-start","grid-gap","grid-row","grid-row-end","grid-row-gap","grid-row-start","grid-template","grid-template-areas","grid-template-columns","grid-template-rows","hanging-punctuation","height","hyphens","icon","image-orientation","image-rendering","image-resolution","inline-box-align","inset","inset-block","inset-block-end","inset-block-start","inset-inline","inset-inline-end","inset-inline-start","isolation","justify-content","justify-items","justify-self","left","letter-spacing","line-break","line-height","line-height-step","line-stacking","line-stacking-ruby","line-stacking-shift","line-stacking-strategy","list-style","list-style-image","list-style-position","list-style-type","margin","margin-bottom","margin-left","margin-right","margin-top","marks","marquee-direction","marquee-loop","marquee-play-count","marquee-speed","marquee-style","mask-clip","mask-composite","mask-image","mask-mode","mask-origin","mask-position","mask-repeat","mask-size","mask-type","max-block-size","max-height","max-inline-size","max-width","min-block-size","min-height","min-inline-size","min-width","mix-blend-mode","move-to","nav-down","nav-index","nav-left","nav-right","nav-up","object-fit","object-position","offset","offset-anchor","offset-distance","offset-path","offset-position","offset-rotate","opacity","order","orphans","outline","outline-color","outline-offset","outline-style","outline-width","overflow","overflow-style","overflow-wrap","overflow-x","overflow-y","padding","padding-bottom","padding-left","padding-right","padding-top","page","page-break-after","page-break-before","page-break-inside","page-policy","pause","pause-after","pause-before","perspective","perspective-origin","pitch","pitch-range","place-content","place-items","place-self","play-during","position","presentation-level","punctuation-trim","quotes","region-break-after","region-break-before","region-break-inside","region-fragment","rendering-intent","resize","rest","rest-after","rest-before","richness","right","rotate","rotation","rotation-point","row-gap","ruby-align","ruby-overhang","ruby-position","ruby-span","scale","scroll-behavior","scroll-margin","scroll-margin-block","scroll-margin-block-end","scroll-margin-block-start","scroll-margin-bottom","scroll-margin-inline","scroll-margin-inline-end","scroll-margin-inline-start","scroll-margin-left","scroll-margin-right","scroll-margin-top","scroll-padding","scroll-padding-block","scroll-padding-block-end","scroll-padding-block-start","scroll-padding-bottom","scroll-padding-inline","scroll-padding-inline-end","scroll-padding-inline-start","scroll-padding-left","scroll-padding-right","scroll-padding-top","scroll-snap-align","scroll-snap-type","shape-image-threshold","shape-inside","shape-margin","shape-outside","size","speak","speak-as","speak-header","speak-numeral","speak-punctuation","speech-rate","stress","string-set","tab-size","table-layout","target","target-name","target-new","target-position","text-align","text-align-last","text-combine-upright","text-decoration","text-decoration-color","text-decoration-line","text-decoration-skip","text-decoration-skip-ink","text-decoration-style","text-emphasis","text-emphasis-color","text-emphasis-position","text-emphasis-style","text-height","text-indent","text-justify","text-orientation","text-outline","text-overflow","text-rendering","text-shadow","text-size-adjust","text-space-collapse","text-transform","text-underline-position","text-wrap","top","touch-action","transform","transform-origin","transform-style","transition","transition-delay","transition-duration","transition-property","transition-timing-function","translate","unicode-bidi","user-select","vertical-align","visibility","voice-balance","voice-duration","voice-family","voice-pitch","voice-range","voice-rate","voice-stress","voice-volume","volume","white-space","widows","width","will-change","word-break","word-spacing","word-wrap","writing-mode","z-index","clip-path","clip-rule","mask","enable-background","filter","flood-color","flood-opacity","lighting-color","stop-color","stop-opacity","pointer-events","color-interpolation","color-interpolation-filters","color-rendering","fill","fill-opacity","fill-rule","image-rendering","marker","marker-end","marker-mid","marker-start","paint-order","shape-rendering","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","text-rendering","baseline-shift","dominant-baseline","glyph-orientation-horizontal","glyph-orientation-vertical","text-anchor","writing-mode"],propertyKeywords=keySet(propertyKeywords_);var nonStandardPropertyKeywords_=["accent-color","aspect-ratio","border-block","border-block-color","border-block-end","border-block-end-color","border-block-end-style","border-block-end-width","border-block-start","border-block-start-color","border-block-start-style","border-block-start-width","border-block-style","border-block-width","border-inline","border-inline-color","border-inline-end","border-inline-end-color","border-inline-end-style","border-inline-end-width","border-inline-start","border-inline-start-color","border-inline-start-style","border-inline-start-width","border-inline-style","border-inline-width","content-visibility","margin-block","margin-block-end","margin-block-start","margin-inline","margin-inline-end","margin-inline-start","overflow-anchor","overscroll-behavior","padding-block","padding-block-end","padding-block-start","padding-inline","padding-inline-end","padding-inline-start","scroll-snap-stop","scrollbar-3d-light-color","scrollbar-arrow-color","scrollbar-base-color","scrollbar-dark-shadow-color","scrollbar-face-color","scrollbar-highlight-color","scrollbar-shadow-color","scrollbar-track-color","searchfield-cancel-button","searchfield-decoration","searchfield-results-button","searchfield-results-decoration","shape-inside","zoom"],nonStandardPropertyKeywords=keySet(nonStandardPropertyKeywords_);var fontProperties_=["font-display","font-family","src","unicode-range","font-variant","font-feature-settings","font-stretch","font-weight","font-style"],fontProperties=keySet(fontProperties_);var counterDescriptors_=["additive-symbols","fallback","negative","pad","prefix","range","speak-as","suffix","symbols","system"],counterDescriptors=keySet(counterDescriptors_);var colorKeywords_=["aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkgrey","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkslategrey","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","grey","green","greenyellow","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightgrey","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightslategrey","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","rebeccapurple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","slategrey","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen"],colorKeywords=keySet(colorKeywords_);var valueKeywords_=["above","absolute","activeborder","additive","activecaption","afar","after-white-space","ahead","alias","all","all-scroll","alphabetic","alternate","always","amharic","amharic-abegede","antialiased","appworkspace","arabic-indic","armenian","asterisks","attr","auto","auto-flow","avoid","avoid-column","avoid-page","avoid-region","axis-pan","background","backwards","baseline","below","bidi-override","binary","bengali","blink","block","block-axis","blur","bold","bolder","border","border-box","both","bottom","break","break-all","break-word","brightness","bullets","button","buttonface","buttonhighlight","buttonshadow","buttontext","calc","cambodian","capitalize","caps-lock-indicator","caption","captiontext","caret","cell","center","checkbox","circle","cjk-decimal","cjk-earthly-branch","cjk-heavenly-stem","cjk-ideographic","clear","clip","close-quote","col-resize","collapse","color","color-burn","color-dodge","column","column-reverse","compact","condensed","conic-gradient","contain","content","contents","content-box","context-menu","continuous","contrast","copy","counter","counters","cover","crop","cross","crosshair","cubic-bezier","currentcolor","cursive","cyclic","darken","dashed","decimal","decimal-leading-zero","default","default-button","dense","destination-atop","destination-in","destination-out","destination-over","devanagari","difference","disc","discard","disclosure-closed","disclosure-open","document","dot-dash","dot-dot-dash","dotted","double","down","drop-shadow","e-resize","ease","ease-in","ease-in-out","ease-out","element","ellipse","ellipsis","embed","end","ethiopic","ethiopic-abegede","ethiopic-abegede-am-et","ethiopic-abegede-gez","ethiopic-abegede-ti-er","ethiopic-abegede-ti-et","ethiopic-halehame-aa-er","ethiopic-halehame-aa-et","ethiopic-halehame-am-et","ethiopic-halehame-gez","ethiopic-halehame-om-et","ethiopic-halehame-sid-et","ethiopic-halehame-so-et","ethiopic-halehame-ti-er","ethiopic-halehame-ti-et","ethiopic-halehame-tig","ethiopic-numeric","ew-resize","exclusion","expanded","extends","extra-condensed","extra-expanded","fantasy","fast","fill","fill-box","fixed","flat","flex","flex-end","flex-start","footnotes","forwards","from","geometricPrecision","georgian","grayscale","graytext","grid","groove","gujarati","gurmukhi","hand","hangul","hangul-consonant","hard-light","hebrew","help","hidden","hide","higher","highlight","highlighttext","hiragana","hiragana-iroha","horizontal","hsl","hsla","hue","hue-rotate","icon","ignore","inactiveborder","inactivecaption","inactivecaptiontext","infinite","infobackground","infotext","inherit","initial","inline","inline-axis","inline-block","inline-flex","inline-grid","inline-table","inset","inside","intrinsic","invert","italic","japanese-formal","japanese-informal","justify","kannada","katakana","katakana-iroha","keep-all","khmer","korean-hangul-formal","korean-hanja-formal","korean-hanja-informal","landscape","lao","large","larger","left","level","lighter","lighten","line-through","linear","linear-gradient","lines","list-item","listbox","listitem","local","logical","loud","lower","lower-alpha","lower-armenian","lower-greek","lower-hexadecimal","lower-latin","lower-norwegian","lower-roman","lowercase","ltr","luminosity","malayalam","manipulation","match","matrix","matrix3d","media-play-button","media-slider","media-sliderthumb","media-volume-slider","media-volume-sliderthumb","medium","menu","menulist","menulist-button","menutext","message-box","middle","min-intrinsic","mix","mongolian","monospace","move","multiple","multiple_mask_images","multiply","myanmar","n-resize","narrower","ne-resize","nesw-resize","no-close-quote","no-drop","no-open-quote","no-repeat","none","normal","not-allowed","nowrap","ns-resize","numbers","numeric","nw-resize","nwse-resize","oblique","octal","opacity","open-quote","optimizeLegibility","optimizeSpeed","oriya","oromo","outset","outside","outside-shape","overlay","overline","padding","padding-box","painted","page","paused","persian","perspective","pinch-zoom","plus-darker","plus-lighter","pointer","polygon","portrait","pre","pre-line","pre-wrap","preserve-3d","progress","push-button","radial-gradient","radio","read-only","read-write","read-write-plaintext-only","rectangle","region","relative","repeat","repeating-linear-gradient","repeating-radial-gradient","repeating-conic-gradient","repeat-x","repeat-y","reset","reverse","rgb","rgba","ridge","right","rotate","rotate3d","rotateX","rotateY","rotateZ","round","row","row-resize","row-reverse","rtl","run-in","running","s-resize","sans-serif","saturate","saturation","scale","scale3d","scaleX","scaleY","scaleZ","screen","scroll","scrollbar","scroll-position","se-resize","searchfield","searchfield-cancel-button","searchfield-decoration","searchfield-results-button","searchfield-results-decoration","self-start","self-end","semi-condensed","semi-expanded","separate","sepia","serif","show","sidama","simp-chinese-formal","simp-chinese-informal","single","skew","skewX","skewY","skip-white-space","slide","slider-horizontal","slider-vertical","sliderthumb-horizontal","sliderthumb-vertical","slow","small","small-caps","small-caption","smaller","soft-light","solid","somali","source-atop","source-in","source-out","source-over","space","space-around","space-between","space-evenly","spell-out","square","square-button","start","static","status-bar","stretch","stroke","stroke-box","sub","subpixel-antialiased","svg_masks","super","sw-resize","symbolic","symbols","system-ui","table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row","table-row-group","tamil","telugu","text","text-bottom","text-top","textarea","textfield","thai","thick","thin","threeddarkshadow","threedface","threedhighlight","threedlightshadow","threedshadow","tibetan","tigre","tigrinya-er","tigrinya-er-abegede","tigrinya-et","tigrinya-et-abegede","to","top","trad-chinese-formal","trad-chinese-informal","transform","translate","translate3d","translateX","translateY","translateZ","transparent","ultra-condensed","ultra-expanded","underline","unidirectional-pan","unset","up","upper-alpha","upper-armenian","upper-greek","upper-hexadecimal","upper-latin","upper-norwegian","upper-roman","uppercase","urdu","url","var","vertical","vertical-text","view-box","visible","visibleFill","visiblePainted","visibleStroke","visual","w-resize","wait","wave","wider","window","windowframe","windowtext","words","wrap","wrap-reverse","x-large","x-small","xor","xx-large","xx-small"],valueKeywords=keySet(valueKeywords_);var allWords=documentTypes_.concat(mediaTypes_).concat(mediaFeatures_).concat(mediaValueKeywords_).concat(propertyKeywords_).concat(nonStandardPropertyKeywords_).concat(colorKeywords_).concat(valueKeywords_);CodeMirror.registerHelper("hintWords","css",allWords);function tokenCComment(stream,state){var maybeEnd=false,ch;while((ch=stream.next())!=null){if(maybeEnd&&ch=="/"){state.tokenize=null;break}maybeEnd=ch=="*"}return["comment","comment"]}CodeMirror.defineMIME("text/css",{documentTypes:documentTypes,mediaTypes:mediaTypes,mediaFeatures:mediaFeatures,mediaValueKeywords:mediaValueKeywords,propertyKeywords:propertyKeywords,nonStandardPropertyKeywords:nonStandardPropertyKeywords,fontProperties:fontProperties,counterDescriptors:counterDescriptors,colorKeywords:colorKeywords,valueKeywords:valueKeywords,tokenHooks:{"/":function(stream,state){if(!stream.eat("*"))return false;state.tokenize=tokenCComment;return tokenCComment(stream,state)}},name:"css"});CodeMirror.defineMIME("text/x-scss",{mediaTypes:mediaTypes,mediaFeatures:mediaFeatures,mediaValueKeywords:mediaValueKeywords,propertyKeywords:propertyKeywords,nonStandardPropertyKeywords:nonStandardPropertyKeywords,colorKeywords:colorKeywords,valueKeywords:valueKeywords,fontProperties:fontProperties,allowNested:true,lineComment:"//",tokenHooks:{"/":function(stream,state){if(stream.eat("/")){stream.skipToEnd();return["comment","comment"]}else if(stream.eat("*")){state.tokenize=tokenCComment;return tokenCComment(stream,state)}else{return["operator","operator"]}},":":function(stream){if(stream.match(/^\s*\{/,false))return[null,null];return false},$:function(stream){stream.match(/^[\w-]+/);if(stream.match(/^\s*:/,false))return["variable-2","variable-definition"];return["variable-2","variable"]},"#":function(stream){if(!stream.eat("{"))return false;return[null,"interpolation"]}},name:"css",helperType:"scss"});CodeMirror.defineMIME("text/x-less",{mediaTypes:mediaTypes,mediaFeatures:mediaFeatures,mediaValueKeywords:mediaValueKeywords,propertyKeywords:propertyKeywords,nonStandardPropertyKeywords:nonStandardPropertyKeywords,colorKeywords:colorKeywords,valueKeywords:valueKeywords,fontProperties:fontProperties,allowNested:true,lineComment:"//",tokenHooks:{"/":function(stream,state){if(stream.eat("/")){stream.skipToEnd();return["comment","comment"]}else if(stream.eat("*")){state.tokenize=tokenCComment;return tokenCComment(stream,state)}else{return["operator","operator"]}},"@":function(stream){if(stream.eat("{"))return[null,"interpolation"];if(stream.match(/^(charset|document|font-face|import|(-(moz|ms|o|webkit)-)?keyframes|media|namespace|page|supports)\b/i,false))return false;stream.eatWhile(/[\w\\\-]/);if(stream.match(/^\s*:/,false))return["variable-2","variable-definition"];return["variable-2","variable"]},"&":function(){return["atom","atom"]}},name:"css",helperType:"less"});CodeMirror.defineMIME("text/x-gss",{documentTypes:documentTypes,mediaTypes:mediaTypes,mediaFeatures:mediaFeatures,propertyKeywords:propertyKeywords,nonStandardPropertyKeywords:nonStandardPropertyKeywords,fontProperties:fontProperties,counterDescriptors:counterDescriptors,colorKeywords:colorKeywords,valueKeywords:valueKeywords,supportsAtComponent:true,tokenHooks:{"/":function(stream,state){if(!stream.eat("*"))return false;state.tokenize=tokenCComment;return tokenCComment(stream,state)}},name:"css",helperType:"gss"})}));(function(mod){if(typeof exports=="object"&&typeof module=="object")mod(require("../../lib/codemirror"));else if(typeof define=="function"&&define.amd)define(["../../lib/codemirror"],mod);else mod(CodeMirror)})((function(CodeMirror){"use strict";var WRAP_CLASS="CodeMirror-activeline";var BACK_CLASS="CodeMirror-activeline-background";var GUTT_CLASS="CodeMirror-activeline-gutter";CodeMirror.defineOption("styleActiveLine",false,(function(cm,val,old){var prev=old==CodeMirror.Init?false:old;if(val==prev)return;if(prev){cm.off("beforeSelectionChange",selectionChange);clearActiveLines(cm);delete cm.state.activeLines}if(val){cm.state.activeLines=[];updateActiveLines(cm,cm.listSelections());cm.on("beforeSelectionChange",selectionChange)}}));function clearActiveLines(cm){for(var i=0;i<cm.state.activeLines.length;i++){cm.removeLineClass(cm.state.activeLines[i],"wrap",WRAP_CLASS);cm.removeLineClass(cm.state.activeLines[i],"background",BACK_CLASS);cm.removeLineClass(cm.state.activeLines[i],"gutter",GUTT_CLASS)}}function sameArray(a,b){if(a.length!=b.length)return false;for(var i=0;i<a.length;i++)if(a[i]!=b[i])return false;return true}function updateActiveLines(cm,ranges){var active=[];for(var i=0;i<ranges.length;i++){var range=ranges[i];var option=cm.getOption("styleActiveLine");if(typeof option=="object"&&option.nonEmpty?range.anchor.line!=range.head.line:!range.empty())continue;var line=cm.getLineHandleVisualStart(range.head.line);if(active[active.length-1]!=line)active.push(line)}if(sameArray(cm.state.activeLines,active))return;cm.operation((function(){clearActiveLines(cm);for(var i=0;i<active.length;i++){cm.addLineClass(active[i],"wrap",WRAP_CLASS);cm.addLineClass(active[i],"background",BACK_CLASS);cm.addLineClass(active[i],"gutter",GUTT_CLASS)}cm.state.activeLines=active}))}function selectionChange(cm,sel){updateActiveLines(cm,sel.ranges)}}));(function(mod){if(typeof exports=="object"&&typeof module=="object")mod(require("../../lib/codemirror"));else if(typeof define=="function"&&define.amd)define(["../../lib/codemirror"],mod);else mod(CodeMirror)})((function(CodeMirror){var nonspace=/\S/g;var repeat=String.prototype.repeat||function(n){return Array(n+1).join(this)};function continueComment(cm){if(cm.getOption("disableInput"))return CodeMirror.Pass;var ranges=cm.listSelections(),mode,inserts=[];for(var i=0;i<ranges.length;i++){var pos=ranges[i].head;if(!/\bcomment\b/.test(cm.getTokenTypeAt(pos)))return CodeMirror.Pass;var modeHere=cm.getModeAt(pos);if(!mode)mode=modeHere;else if(mode!=modeHere)return CodeMirror.Pass;var insert=null,line,found;var blockStart=mode.blockCommentStart,lineCmt=mode.lineComment;if(blockStart&&mode.blockCommentContinue){line=cm.getLine(pos.line);var end=line.lastIndexOf(mode.blockCommentEnd,pos.ch-mode.blockCommentEnd.length);if(end!=-1&&end==pos.ch-mode.blockCommentEnd.length||lineCmt&&(found=line.lastIndexOf(lineCmt,pos.ch-1))>-1&&/\bcomment\b/.test(cm.getTokenTypeAt({line:pos.line,ch:found+1}))){}else if(pos.ch>=blockStart.length&&(found=line.lastIndexOf(blockStart,pos.ch-blockStart.length))>-1&&found>end){if(nonspaceAfter(0,line)>=found){insert=line.slice(0,found)}else{var tabSize=cm.options.tabSize,numTabs;found=CodeMirror.countColumn(line,found,tabSize);insert=!cm.options.indentWithTabs?repeat.call(" ",found):repeat.call("\t",numTabs=Math.floor(found/tabSize))+repeat.call(" ",found-tabSize*numTabs)}}else if((found=line.indexOf(mode.blockCommentContinue))>-1&&found<=pos.ch&&found<=nonspaceAfter(0,line)){insert=line.slice(0,found)}if(insert!=null)insert+=mode.blockCommentContinue}if(insert==null&&lineCmt&&continueLineCommentEnabled(cm)){if(line==null)line=cm.getLine(pos.line);found=line.indexOf(lineCmt);if(!pos.ch&&!found)insert="";else if(found>-1&&nonspaceAfter(0,line)>=found){insert=nonspaceAfter(pos.ch,line)>-1;if(!insert){var next=cm.getLine(pos.line+1)||"",nextFound=next.indexOf(lineCmt);insert=nextFound>-1&&nonspaceAfter(0,next)>=nextFound||null}if(insert){insert=line.slice(0,found)+lineCmt+line.slice(found+lineCmt.length).match(/^\s*/)[0]}}}if(insert==null)return CodeMirror.Pass;inserts[i]="\n"+insert}cm.operation((function(){for(var i=ranges.length-1;i>=0;i--)cm.replaceRange(inserts[i],ranges[i].from(),ranges[i].to(),"+insert")}))}function nonspaceAfter(ch,str){nonspace.lastIndex=ch;var m=nonspace.exec(str);return m?m.index:-1}function continueLineCommentEnabled(cm){var opt=cm.getOption("continueComments");if(opt&&typeof opt=="object")return opt.continueLineComment!==false;return true}CodeMirror.defineOption("continueComments",null,(function(cm,val,prev){if(prev&&prev!=CodeMirror.Init)cm.removeKeyMap("continueComment");if(val){var key="Enter";if(typeof val=="string")key=val;else if(typeof val=="object"&&val.key)key=val.key;var map={name:"continueComment"};map[key]=continueComment;cm.addKeyMap(map)}}))}));(function(mod){if(typeof exports=="object"&&typeof module=="object")mod(require("../../lib/codemirror"));else if(typeof define=="function"&&define.amd)define(["../../lib/codemirror"],mod);else mod(CodeMirror)})((function(CodeMirror){"use strict";CodeMirror.defineOption("selectionPointer",false,(function(cm,val){var data=cm.state.selectionPointer;if(data){CodeMirror.off(cm.getWrapperElement(),"mousemove",data.mousemove);CodeMirror.off(cm.getWrapperElement(),"mouseout",data.mouseout);CodeMirror.off(window,"scroll",data.windowScroll);cm.off("cursorActivity",reset);cm.off("scroll",reset);cm.state.selectionPointer=null;cm.display.lineDiv.style.cursor=""}if(val){data=cm.state.selectionPointer={value:typeof val=="string"?val:"default",mousemove:function(event){mousemove(cm,event)},mouseout:function(event){mouseout(cm,event)},windowScroll:function(){reset(cm)},rects:null,mouseX:null,mouseY:null,willUpdate:false};CodeMirror.on(cm.getWrapperElement(),"mousemove",data.mousemove);CodeMirror.on(cm.getWrapperElement(),"mouseout",data.mouseout);CodeMirror.on(window,"scroll",data.windowScroll);cm.on("cursorActivity",reset);cm.on("scroll",reset)}}));function mousemove(cm,event){var data=cm.state.selectionPointer;if(event.buttons==null?event.which:event.buttons){data.mouseX=data.mouseY=null}else{data.mouseX=event.clientX;data.mouseY=event.clientY}scheduleUpdate(cm)}function mouseout(cm,event){if(!cm.getWrapperElement().contains(event.relatedTarget)){var data=cm.state.selectionPointer;data.mouseX=data.mouseY=null;scheduleUpdate(cm)}}function reset(cm){cm.state.selectionPointer.rects=null;scheduleUpdate(cm)}function scheduleUpdate(cm){if(!cm.state.selectionPointer.willUpdate){cm.state.selectionPointer.willUpdate=true;setTimeout((function(){update(cm);cm.state.selectionPointer.willUpdate=false}),50)}}function update(cm){var data=cm.state.selectionPointer;if(!data)return;if(data.rects==null&&data.mouseX!=null){data.rects=[];if(cm.somethingSelected()){for(var sel=cm.display.selectionDiv.firstChild;sel;sel=sel.nextSibling)data.rects.push(sel.getBoundingClientRect())}}var inside=false;if(data.mouseX!=null)for(var i=0;i<data.rects.length;i++){var rect=data.rects[i];if(rect.left<=data.mouseX&&rect.right>=data.mouseX&&rect.top<=data.mouseY&&rect.bottom>=data.mouseY)inside=true}var cursor=inside?data.value:"";if(cm.display.lineDiv.style.cursor!=cursor)cm.display.lineDiv.style.cursor=cursor}}));(function(mod){if(typeof exports=="object"&&typeof module=="object")mod(require("../../lib/codemirror"));else if(typeof define=="function"&&define.amd)define(["../../lib/codemirror"],mod);else mod(CodeMirror)})((function(CodeMirror){var ie_lt8=/MSIE \d/.test(navigator.userAgent)&&(document.documentMode==null||document.documentMode<8);var Pos=CodeMirror.Pos;var matching={"(":")>",")":"(<","[":"]>","]":"[<","{":"}>","}":"{<","<":">>",">":"<<"};function bracketRegex(config){return config&&config.bracketRegex||/[(){}[\]]/}function findMatchingBracket(cm,where,config){var line=cm.getLineHandle(where.line),pos=where.ch-1;var afterCursor=config&&config.afterCursor;if(afterCursor==null)afterCursor=/(^| )cm-fat-cursor($| )/.test(cm.getWrapperElement().className);var re=bracketRegex(config);var match=!afterCursor&&pos>=0&&re.test(line.text.charAt(pos))&&matching[line.text.charAt(pos)]||re.test(line.text.charAt(pos+1))&&matching[line.text.charAt(++pos)];if(!match)return null;var dir=match.charAt(1)==">"?1:-1;if(config&&config.strict&&dir>0!=(pos==where.ch))return null;var style=cm.getTokenTypeAt(Pos(where.line,pos+1));var found=scanForBracket(cm,Pos(where.line,pos+(dir>0?1:0)),dir,style,config);if(found==null)return null;return{from:Pos(where.line,pos),to:found&&found.pos,match:found&&found.ch==match.charAt(0),forward:dir>0}}function scanForBracket(cm,where,dir,style,config){var maxScanLen=config&&config.maxScanLineLength||1e4;var maxScanLines=config&&config.maxScanLines||1e3;var stack=[];var re=bracketRegex(config);var lineEnd=dir>0?Math.min(where.line+maxScanLines,cm.lastLine()+1):Math.max(cm.firstLine()-1,where.line-maxScanLines);for(var lineNo=where.line;lineNo!=lineEnd;lineNo+=dir){var line=cm.getLine(lineNo);if(!line)continue;var pos=dir>0?0:line.length-1,end=dir>0?line.length:-1;if(line.length>maxScanLen)continue;if(lineNo==where.line)pos=where.ch-(dir<0?1:0);for(;pos!=end;pos+=dir){var ch=line.charAt(pos);if(re.test(ch)&&(style===undefined||(cm.getTokenTypeAt(Pos(lineNo,pos+1))||"")==(style||""))){var match=matching[ch];if(match&&match.charAt(1)==">"==dir>0)stack.push(ch);else if(!stack.length)return{pos:Pos(lineNo,pos),ch:ch};else stack.pop()}}}return lineNo-dir==(dir>0?cm.lastLine():cm.firstLine())?false:null}function matchBrackets(cm,autoclear,config){var maxHighlightLen=cm.state.matchBrackets.maxHighlightLineLength||1e3,highlightNonMatching=config&&config.highlightNonMatching;var marks=[],ranges=cm.listSelections();for(var i=0;i<ranges.length;i++){var match=ranges[i].empty()&&findMatchingBracket(cm,ranges[i].head,config);if(match&&(match.match||highlightNonMatching!==false)&&cm.getLine(match.from.line).length<=maxHighlightLen){var style=match.match?"CodeMirror-matchingbracket":"CodeMirror-nonmatchingbracket";marks.push(cm.markText(match.from,Pos(match.from.line,match.from.ch+1),{className:style}));if(match.to&&cm.getLine(match.to.line).length<=maxHighlightLen)marks.push(cm.markText(match.to,Pos(match.to.line,match.to.ch+1),{className:style}))}}if(marks.length){if(ie_lt8&&cm.state.focused)cm.focus();var clear=function(){cm.operation((function(){for(var i=0;i<marks.length;i++)marks[i].clear()}))};if(autoclear)setTimeout(clear,800);else return clear}}function doMatchBrackets(cm){cm.operation((function(){if(cm.state.matchBrackets.currentlyHighlighted){cm.state.matchBrackets.currentlyHighlighted();cm.state.matchBrackets.currentlyHighlighted=null}cm.state.matchBrackets.currentlyHighlighted=matchBrackets(cm,false,cm.state.matchBrackets)}))}function clearHighlighted(cm){if(cm.state.matchBrackets&&cm.state.matchBrackets.currentlyHighlighted){cm.state.matchBrackets.currentlyHighlighted();cm.state.matchBrackets.currentlyHighlighted=null}}CodeMirror.defineOption("matchBrackets",false,(function(cm,val,old){if(old&&old!=CodeMirror.Init){cm.off("cursorActivity",doMatchBrackets);cm.off("focus",doMatchBrackets);cm.off("blur",clearHighlighted);clearHighlighted(cm)}if(val){cm.state.matchBrackets=typeof val=="object"?val:{};cm.on("cursorActivity",doMatchBrackets);cm.on("focus",doMatchBrackets);cm.on("blur",clearHighlighted)}}));CodeMirror.defineExtension("matchBrackets",(function(){matchBrackets(this,true)}));CodeMirror.defineExtension("findMatchingBracket",(function(pos,config,oldConfig){if(oldConfig||typeof config=="boolean"){if(!oldConfig){config=config?{strict:true}:null}else{oldConfig.strict=config;config=oldConfig}}return findMatchingBracket(this,pos,config)}));CodeMirror.defineExtension("scanForBracket",(function(pos,dir,style,config){return scanForBracket(this,pos,dir,style,config)}))}));
</script>

        <script>
// for playing about and testing: http://jsfiddle.net/TcqAf/529/

// newer version: http://jsbin.com/filalidobe/1/edit?html,output
// problem is, even if I do work out this: https://stackoverflow.com/questions/52160551/way-to-overlay-multiple-tokens-rules-with-codemirror-simple-mode
//   i'll still have to sort out this [a = [], "hello"] - probably need to write a proper mode (using same logic that breaks up square blocks)

// CodeMirror.defineSimpleMode("simplemode", {
//   // The start state contains the rules that are intially used
//   start: [
//       // You can embed other modes with the mode property. This rule
//     // causes all code between << and >> to be highlighted with the XML
//     // mode.
// //    {regex: /(?:^|[^\\])(?:\\\\)*(\[)/, token: "variable-3", mode: {spec: "javascript", end: /(?:^|[^\\])(?:\\\\)*(\])/}},
//     // The regex matches the token, the token property contains the type
//     //{regex: /"(?:[^\\]|\\.)*?(?:"|$)/, token: "string"},
//     // You can match multiple tokens at once. Note that the captured
//     // groups must span the whole string in this case
//     {regex: /([a-zA-Z][a-zA-Z0-9$_]+)(\s*)(\()([^)]*)(\))(\s*)(=>)/,
//      token: ["variable-2", null, "keyword", null, "keyword", null, "keyword"]},

//     // curly
//     {regex: /\{[a-zA-Z]-[a-zA-Z]\}/, token: "syntax-style1"},
//     {regex: /\{[0-9]+-[0-9]+\}/, token: "syntax-style1"},
//     {regex: /\{/, token: "syntax-style1"},
//     {regex: /\}/, token: "syntax-style1"},

//     // square
//     //{regex: /\[[^\]]+\]/, token: "variable-3"},
//     {regex: /\[/, token: "syntax-style2"},
//     {regex: /\]/, token: "syntax-style2"},

//     // equals
//     {regex: /=/, token: "keyword"},

//     // not sure
//     {regex: /\$output\b/, token: "variable-2"},
//     {regex: /\$preprocess\b/, token: "variable-2"},
    
//     //{regex: /true|false|null|undefined/, token: "atom"},
//     //{regex: /0x[a-f\d]+|[-+]?(?:\.\d+|\d+\.?\d*)(?:e[-+]?\d+)?/i,
//      //token: "number"},
//     {regex: /[\s](\/\/.*)/, token: "syntax-style3-comment"},
//     {regex: /(\/\/.*)/, token: "syntax-style3-comment", sol:true},
//     //{regex: /\/(?:[^\\]|\\.)*?\//, token: "variable-3"},
//     //{regex: /[-+\/*=<>!]+/, token: "operator"},
//     // indent and dedent properties guide autoindentation
//     //{regex: /=>/, indent: true},
//     //{regex: /[\}\]\)]/, dedent: true},
//     //{regex: /[a-z$][\w$]*/, token: "variable"},
//   ],
//   // The meta property contains global information about the mode. It
//   // can contain properties like lineComment, which are supported by
//   // all modes, and also directives like dontIndentStates, which are
//   // specific to simple modes.
//   meta: {
//     dontIndentStates: ["comment"],
//     lineComment: "//",
//     fold: "indent",
//   }
// });


// CodeMirror.defineMode("mustache", function(config, parserConfig) {
//   var mustacheOverlay = {
//     token: function(stream, state) {
//       var ch;
//       if (stream.match("{")) {
//         while ((ch = stream.next()) != null)
//           if (stream.next() == "}") {
//             stream.eat("}");
//             return "variable-2";
//           }
//       }
//       while (stream.next() != null && !stream.match("{", false)) {}
//       return null;
//     }
//   };
//   return CodeMirror.overlayMode(CodeMirror.getMode(config, parserConfig.backdrop || "text/html"), mustacheOverlay);
// });

try {

  CodeMirror.defineMode("perchancelists", function(config) {

    var jsMode = CodeMirror.getMode(config, "javascript");
  
    // this, in a sense, `trimStart`s the stream and then gets the next two characters
    function skipSpacesAndPeekTwo(stream) {
      let count = 0;
      let result = '';
      for (let i = stream.pos; i < stream.string.length; i++) {
        let char = stream.string.charAt(i);
        if (char !== ' ' && char !== '\t') {
          result += char;
          count++;
          if (count === 2) {
            return result;
          }
        }
      }
      return null;
    }
    
    function token(stream, state) {    
      if(state.inSquareBlock && state.inFunction) console.error("invalid state - cannot be both in function and square block at same time");
      if(stream.string.length > 50000) { // Consume the entire line if it's too long
        stream.skipToEnd();
        return null;  // No styling applied
      }
  
      if(stream.sol() && state.inSquareBlock) { // square blocks cannot span multiple lines
        state.bracketDepth = 0;
        state.inSquareBlock = false;
        state.localState = null;
        return null;
      }
  
      if(stream.sol() && state.inFunction && stream.indentation() <= state.functionIndent && skipSpacesAndPeekTwo(stream) !== "//") {
        state.inFunction = false;
        state.localState = null;
        stream.backUp(stream.current().length); // rewind to the beginning of the line (important)
        return null;
      }
    
      if(state.inSquareBlock || state.inFunction) {
        let style = jsMode.token(stream, state.localState);
        let current = stream.current();
    
        if(state.inFunction) {
          if(state.inSquareBlock) console.error("inSquareBlock while also inFunction");
          // note: we already early-exited in case of indentation-based function end, above, so we know we're still in the function here
          return style;
        } else if(state.inSquareBlock) {
          if(state.inFunction) console.error("inFunction while also inSquareBlock");
  
          // don't count square brackets that are in strings, regex, or comments:
          if(style !== "string" && style !== "string-2" && style !== "comment") {
            if(current === "]") {
              state.bracketDepth--;
              if (state.bracketDepth <= 0) {
                state.inSquareBlock = false;
                state.localState = null;
                return "square-bracket";
              }
            }
            if(current === "[") {
              state.bracketDepth++;
            }
            if(state.bracketDepth <= 0) {
              state.inSquareBlock = false;
              state.localState = null;
            }
          }
          
          return style;
        }
      } else {
        if(stream.sol() && stream.match(/\/\/.*/)) {
          return "comment";
        } else if (stream.match(/\s\/\/.*/)) {
          return "comment";
        }
        if(stream.peek() === "[") {
          state.bracketDepth = 1;
          state.inSquareBlock = true;
          state.localState = CodeMirror.startState(jsMode);
          stream.next();
          return "square-bracket";
        }
    
        // if(stream.match(/^\w*(?=\()/)) {
        //   return "def";
        // }
    
        if(stream.match(/^(async |)[a-zA-Z0-9$_]+ ?\([^\)]*\) *=> */)) {
          state.localState = CodeMirror.startState(jsMode);
          state.inFunction = true;
          state.functionIndent = stream.indentation();
          return "def";
        }
    
        if(stream.match('\\[') || stream.match('\\]')) {
          return "escaped-char";
        }
        if(stream.match('{') || stream.match('}')) {
          return "curly-bracket";
        }
        if(stream.match(/\$output\b/) || stream.match(/\$preprocess\b/)) {
          return "special-list-name";
        }
        stream.next();
        return null;
      }
    }
    
    return {
      startState: function() {
        return {
          inSquareBlock: false,
          localState: null,
          bracketDepth: 0,
          inFunction: false,
          functionIndent: 0,
        };
      },
      token: token,
      lineComment: "//",
      fold: "indent",
    };
  });

  // let systemIsInDarkMode = !!(window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches);
  // window.codeMirrorModelTextEditor = CodeMirror.fromTextArea(document.body.querySelector("#input"), {
  //   lineNumbers: true,
  //   foldGutter: true,
  //   extraKeys: {
  //     //"Ctrl-Q": cm => cm.foldCode(cm.getCursor()),
  //     //"Ctrl-Y": cm => CodeMirror.commands.foldAll(cm),
  //     //"Ctrl-I": cm => CodeMirror.commands.unfoldAll(cm),
  //   },
  //   gutters: ["CodeMirror-linenumbers", "CodeMirror-foldgutter"],
  //   tabSize: 2,
  //   indentUnit: 2,
  //   indentWithTabs: false,
  //   matchBrackets: true,
  //   mode: "perchancelists",
  //   styleActiveLine: true,
  //   // mode: "text",
  //   lineWrapping:false,
  //   theme: systemIsInDarkMode ? "one-dark" : "one-light",
  //   keyMap: "sublime",
  // });
  // window.codeMirrorModelTextEditor.setOption("mode", "perchancelists");





  // OLD:
  // CodeMirror.defineMode("perchancelists", function(config) {

  //   var jsMode = CodeMirror.getMode(config, "javascript");

  //   function token(stream, state) {    
  //     if(state.inSquareBlock && state.inFunction) console.error("invalid state - cannot be both in function and square block at same time");
  //     if(stream.string.length > 50000) { // Consume the entire line if it's too long
  //       stream.skipToEnd();
  //       return null;  // No styling applied
  //     }

  //     if(state.inSquareBlock || state.inFunction) {
  //       var style = jsMode.token(stream, state.localState);
  //       if (style === "string" || style === "string-2" || style === "comment") {
  //         return style;
  //       }
  //       var current = stream.current();

  //       if(state.inFunction) {
  //         if(state.inSquareBlock) console.error("inSquareBlock while also inFunction");
          
  //         if(stream.indentation() <= state.functionIndent) {
  //           state.localState = null;
  //           state.inFunction = false;
  //           stream.backUp(stream.current().length); // Rewind to the beginning of the line (important)
  //           return null;
  //         }
  //       } else if(state.inSquareBlock) {
  //         if(state.inFunction) console.error("inFunction while also inSquareBlock");
    
  //         if (current === "]") { // note: this square bracket is not inside a string/regex, since we early-returned above in those cases
  //           state.bracketDepth--;
  //           if (state.bracketDepth <= 0) {
  //             state.inSquareBlock = false;
  //             state.localState = null;
  //             return "square-bracket";
  //           }
  //         }
    
  //         if(current === "[") {
  //           state.bracketDepth++;
  //         }

  //         if(state.bracketDepth <= 0) {
  //           state.inSquareBlock = false;
  //           state.localState = null;
  //         }
  //       }

  //       return style;
  //     } else {
  //       if(stream.match(/\$output\b/) || stream.match(/\$preprocess\b/)) {
  //         return "special-list-name";
  //       }
  //       if(stream.sol() && stream.match(/\/\/.*/)) {
  //         return "comment";
  //       } else if (stream.match(/\s\/\/.*/)) {
  //         return "comment";
  //       }
  //       if(stream.peek() === "[") {
  //         state.bracketDepth = 1;
  //         state.inSquareBlock = true;
  //         state.localState = CodeMirror.startState(jsMode);
  //         stream.next();
  //         return "square-bracket";
  //       }

  //       if(stream.match(/^[a-zA-Z0-9$_]\w*(?=\()/)) {
  //         return "def";
  //       }

  //       if(stream.match(/\([^\)]*\) =>/)) {
  //         state.localState = CodeMirror.startState(jsMode);
  //         state.inFunction = true;
  //         state.functionIndent = stream.indentation();
  //         return "javascript";
  //       }

  //       if(stream.match('\\[') || stream.match('\\]')) {
  //         return "escaped-char";
  //       }
  //       if(stream.match('{') || stream.match('}')) {
  //         return "curly-bracket";
  //       }
  //       stream.next();
  //       return null;
  //     }
  //   }

  //   return {
  //     startState: function() {
  //       return {
  //         inSquareBlock: false,
  //         localState: null,
  //         bracketDepth: 0,
  //         inFunction: false,
  //         functionIndent: 0,
  //       };
  //     },
  //     token: token,
  //     lineComment: "//",
  //     fold: "indent",
  //   };
  // });

} catch(e) { console.error(e); }
</script>

        <!-- LIBS -->
        <script>
/*! Split.js - v1.6.5 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).Split=t()}(this,(function(){"use strict";var e="undefined"!=typeof window?window:null,t=null===e,n=t?void 0:e.document,i=function(){return!1},r=t?"calc":["","-webkit-","-moz-","-o-"].filter((function(e){var t=n.createElement("div");return t.style.cssText="width:"+e+"calc(9px)",!!t.style.length})).shift()+"calc",s=function(e){return"string"==typeof e||e instanceof String},o=function(e){if(s(e)){var t=n.querySelector(e);if(!t)throw new Error("Selector "+e+" did not match a DOM element");return t}return e},a=function(e,t,n){var i=e[t];return void 0!==i?i:n},u=function(e,t,n,i){if(t){if("end"===i)return 0;if("center"===i)return e/2}else if(n){if("start"===i)return 0;if("center"===i)return e/2}return e},l=function(e,t){var i=n.createElement("div");return i.className="gutter gutter-"+t,i},c=function(e,t,n){var i={};return s(t)?i[e]=t:i[e]=r+"("+t+"% - "+n+"px)",i},h=function(e,t){var n;return(n={})[e]=t+"px",n};return function(r,s){if(void 0===s&&(s={}),t)return{};var f,d,v,m,g,p,y=r;Array.from&&(y=Array.from(y));var z=o(y[0]).parentNode,S=getComputedStyle?getComputedStyle(z):null,b=S?S.flexDirection:null,E=a(s,"sizes")||y.map((function(){return 100/y.length})),_=a(s,"minSize",100),L=Array.isArray(_)?_:y.map((function(){return _})),w=a(s,"maxSize",1/0),x=Array.isArray(w)?w:y.map((function(){return w})),O=a(s,"expandToMin",!1),A=a(s,"gutterSize",10),k=a(s,"gutterAlign","center"),C=a(s,"snapOffset",30),M=Array.isArray(C)?C:y.map((function(){return C})),U=a(s,"dragInterval",1),D=a(s,"direction","horizontal"),B=a(s,"cursor","horizontal"===D?"col-resize":"row-resize"),T=a(s,"gutter",l),j=a(s,"elementStyle",c),F=a(s,"gutterStyle",h);function R(e,t,n,i){var r=j(f,t,n,i);Object.keys(r).forEach((function(t){e.style[t]=r[t]}))}function N(){return p.map((function(e){return e.size}))}function q(e){return"touches"in e?e.touches[0][d]:e[d]}function H(e){var t=p[this.a],n=p[this.b],i=t.size+n.size;t.size=e/this.size*i,n.size=i-e/this.size*i,R(t.element,t.size,this._b,t.i),R(n.element,n.size,this._c,n.i)}function I(e){var t,n=p[this.a],r=p[this.b];this.dragging&&(t=q(e)-this.start+(this._b-this.dragOffset),U>1&&(t=Math.round(t/U)*U),t<=n.minSize+n.snapOffset+this._b?t=n.minSize+this._b:t>=this.size-(r.minSize+r.snapOffset+this._c)&&(t=this.size-(r.minSize+this._c)),t>=n.maxSize-n.snapOffset+this._b?t=n.maxSize+this._b:t<=this.size-(r.maxSize-r.snapOffset+this._c)&&(t=this.size-(r.maxSize+this._c)),H.call(this,t),a(s,"onDrag",i)(N()))}function W(){var e=p[this.a].element,t=p[this.b].element,n=e.getBoundingClientRect(),i=t.getBoundingClientRect();this.size=n[f]+i[f]+this._b+this._c,this.start=n[v],this.end=n[m]}function X(e){var t=function(e){if(!getComputedStyle)return null;var t=getComputedStyle(e);if(!t)return null;var n=e[g];return 0===n?null:n-="horizontal"===D?parseFloat(t.paddingLeft)+parseFloat(t.paddingRight):parseFloat(t.paddingTop)+parseFloat(t.paddingBottom)}(z);if(null===t)return e;if(L.reduce((function(e,t){return e+t}),0)>t)return e;var n=0,i=[],r=e.map((function(r,s){var o=t*r/100,a=u(A,0===s,s===e.length-1,k),l=L[s]+a;return o<l?(n+=l-o,i.push(0),l):(i.push(o-l),o)}));return 0===n?e:r.map((function(e,r){var s=e;if(n>0&&i[r]-n>0){var o=Math.min(n,i[r]-n);n-=o,s=e-o}return s/t*100}))}function Y(){var t=p[this.a].element,r=p[this.b].element;this.dragging&&a(s,"onDragEnd",i)(N()),this.dragging=!1,e.removeEventListener("mouseup",this.stop),e.removeEventListener("touchend",this.stop),e.removeEventListener("touchcancel",this.stop),e.removeEventListener("mousemove",this.move),e.removeEventListener("touchmove",this.move),this.stop=null,this.move=null,t.removeEventListener("selectstart",i),t.removeEventListener("dragstart",i),r.removeEventListener("selectstart",i),r.removeEventListener("dragstart",i),t.style.userSelect="",t.style.webkitUserSelect="",t.style.MozUserSelect="",t.style.pointerEvents="",r.style.userSelect="",r.style.webkitUserSelect="",r.style.MozUserSelect="",r.style.pointerEvents="",this.gutter.style.cursor="",this.parent.style.cursor="",n.body.style.cursor=""}function G(t){if(!("button"in t)||0===t.button){var r=p[this.a].element,o=p[this.b].element;this.dragging||a(s,"onDragStart",i)(N()),t.preventDefault(),this.dragging=!0,this.move=I.bind(this),this.stop=Y.bind(this),e.addEventListener("mouseup",this.stop),e.addEventListener("touchend",this.stop),e.addEventListener("touchcancel",this.stop),e.addEventListener("mousemove",this.move),e.addEventListener("touchmove",this.move),r.addEventListener("selectstart",i),r.addEventListener("dragstart",i),o.addEventListener("selectstart",i),o.addEventListener("dragstart",i),r.style.userSelect="none",r.style.webkitUserSelect="none",r.style.MozUserSelect="none",r.style.pointerEvents="none",o.style.userSelect="none",o.style.webkitUserSelect="none",o.style.MozUserSelect="none",o.style.pointerEvents="none",this.gutter.style.cursor=B,this.parent.style.cursor=B,n.body.style.cursor=B,W.call(this),this.dragOffset=q(t)-this.end}}"horizontal"===D?(f="width",d="clientX",v="left",m="right",g="clientWidth"):"vertical"===D&&(f="height",d="clientY",v="top",m="bottom",g="clientHeight"),E=X(E);var J=[];function K(e){var t=e.i===J.length,n=t?J[e.i-1]:J[e.i];W.call(n);var i=t?n.size-e.minSize-n._c:e.minSize+n._b;H.call(n,i)}return(p=y.map((function(e,t){var n,i={element:o(e),size:E[t],minSize:L[t],maxSize:x[t],snapOffset:M[t],i:t};if(t>0&&((n={a:t-1,b:t,dragging:!1,direction:D,parent:z})._b=u(A,t-1==0,!1,k),n._c=u(A,!1,t===y.length-1,k),"row-reverse"===b||"column-reverse"===b)){var r=n.a;n.a=n.b,n.b=r}if(t>0){var s=T(t,D,i.element);!function(e,t,n){var i=F(f,t,n);Object.keys(i).forEach((function(t){e.style[t]=i[t]}))}(s,A,t),n._a=G.bind(n),s.addEventListener("mousedown",n._a),s.addEventListener("touchstart",n._a),z.insertBefore(s,i.element),n.gutter=s}return R(i.element,i.size,u(A,0===t,t===y.length-1,k),t),t>0&&J.push(n),i}))).forEach((function(e){var t=e.element.getBoundingClientRect()[f];t<e.minSize&&(O?K(e):e.minSize=t)})),{setSizes:function(e){var t=X(e);t.forEach((function(e,n){if(n>0){var i=J[n-1],r=p[i.a],s=p[i.b];r.size=t[n-1],s.size=e,R(r.element,r.size,i._b,r.i),R(s.element,s.size,i._c,s.i)}}))},getSizes:N,collapse:function(e){K(p[e])},destroy:function(e,t){J.forEach((function(n){if(!0!==t?n.parent.removeChild(n.gutter):(n.gutter.removeEventListener("mousedown",n._a),n.gutter.removeEventListener("touchstart",n._a)),!0!==e){var i=j(f,n.a.size,n._b);Object.keys(i).forEach((function(e){p[n.a].element.style[e]="",p[n.b].element.style[e]=""}))}}))},parent:z,pairs:J}}}));
//# sourceMappingURL=split.min.js.map
</script>
        <script>
function Store(name) {
  this.name = name;
  try {
    this.data = JSON.parse( localStorage.getItem(this.name+"-storage") ) || {};
  } catch(e) {
    console.error("Couldn't parse local storage data:", e);
    this.data = {};
  }
  //this.data = JSON.parse( LZString.decompress(localStorage.getItem(this.name+"-storage")) ) || {};

  this.save = function(key, value) {
    try {
      localStorage.setItem(this.name+"-storage", JSON.stringify(this.data) );
    } catch(e) {
      console.error("Failed to save data to local storage:", e);
    }
    //localStorage.setItem(this.name+"-storage", LZString.compress(JSON.stringify(this.data)) );
  }
  return this;
}

</script>
        <script>
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.DOMPurify=t()}(this,function(){"use strict";function e(e,t){for(var n=t.length;n--;)"string"==typeof t[n]&&(t[n]=t[n].toLowerCase()),e[t[n]]=!0;return e}function t(e){var t={},n=void 0;for(n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}function n(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function o(){var x=arguments.length>0&&void 0!==arguments[0]?arguments[0]:A(),S=function(e){return o(e)};if(S.version="1.0.2",S.removed=[],!x||!x.document||9!==x.document.nodeType)return S.isSupported=!1,S;var k=x.document,E=!1,w=!1,O=x.document,L=x.DocumentFragment,M=x.HTMLTemplateElement,N=x.Node,_=x.NodeFilter,D=x.NamedNodeMap,R=void 0===D?x.NamedNodeMap||x.MozNamedAttrMap:D,C=x.Text,F=x.Comment,z=x.DOMParser,H=x.XMLHttpRequest,I=void 0===H?x.XMLHttpRequest:H,j=x.encodeURI,U=void 0===j?x.encodeURI:j;if("function"==typeof M){var W=O.createElement("template");W.content&&W.content.ownerDocument&&(O=W.content.ownerDocument)}var q=O,G=q.implementation,P=q.createNodeIterator,B=q.getElementsByTagName,X=q.createDocumentFragment,V=k.importNode,Y={};S.isSupported=G&&void 0!==G.createHTMLDocument&&9!==O.documentMode;var K=p,$=f,J=h,Q=g,Z=v,ee=b,te=y,ne=null,oe=e({},[].concat(n(r),n(i),n(a),n(l),n(s))),re=null,ie=e({},[].concat(n(c),n(d),n(u),n(m))),ae=null,le=null,se=!0,ce=!0,de=!1,ue=!1,me=!1,pe=!1,fe=!1,he=!1,ge=!1,ye=!1,ve=!1,be=!0,Te=!0,Ae={},xe=e({},["audio","head","math","script","style","template","svg","video"]),Se=e({},["audio","video","img","source","image"]),ke=e({},["alt","class","for","id","label","name","pattern","placeholder","summary","title","value","style","xmlns"]),Ee=null,we=O.createElement("form"),Oe=function(o){"object"!==(void 0===o?"undefined":T(o))&&(o={}),ne="ALLOWED_TAGS"in o?e({},o.ALLOWED_TAGS):oe,re="ALLOWED_ATTR"in o?e({},o.ALLOWED_ATTR):ie,ae="FORBID_TAGS"in o?e({},o.FORBID_TAGS):{},le="FORBID_ATTR"in o?e({},o.FORBID_ATTR):{},Ae="USE_PROFILES"in o&&o.USE_PROFILES,se=!1!==o.ALLOW_ARIA_ATTR,ce=!1!==o.ALLOW_DATA_ATTR,de=o.ALLOW_UNKNOWN_PROTOCOLS||!1,ue=o.SAFE_FOR_JQUERY||!1,me=o.SAFE_FOR_TEMPLATES||!1,pe=o.WHOLE_DOCUMENT||!1,ge=o.RETURN_DOM||!1,ye=o.RETURN_DOM_FRAGMENT||!1,ve=o.RETURN_DOM_IMPORT||!1,he=o.FORCE_BODY||!1,be=!1!==o.SANITIZE_DOM,Te=!1!==o.KEEP_CONTENT,te=o.ALLOWED_URI_REGEXP||te,me&&(ce=!1),ye&&(ge=!0),Ae&&(ne=e({},[].concat(n(s))),re=[],!0===Ae.html&&(e(ne,r),e(re,c)),!0===Ae.svg&&(e(ne,i),e(re,d),e(re,m)),!0===Ae.svgFilters&&(e(ne,a),e(re,d),e(re,m)),!0===Ae.mathMl&&(e(ne,l),e(re,u),e(re,m))),o.ADD_TAGS&&(ne===oe&&(ne=t(ne)),e(ne,o.ADD_TAGS)),o.ADD_ATTR&&(re===ie&&(re=t(re)),e(re,o.ADD_ATTR)),o.ADD_URI_SAFE_ATTR&&e(ke,o.ADD_URI_SAFE_ATTR),Te&&(ne["#text"]=!0),Object&&"freeze"in Object&&Object.freeze(o),Ee=o},Le=function(e){S.removed.push({element:e});try{e.parentNode.removeChild(e)}catch(t){e.outerHTML=""}},Me=function(e,t){S.removed.push({attribute:t.getAttributeNode(e),from:t}),t.removeAttribute(e)},Ne=function(e){var t=void 0,n=void 0;if(he&&(e="<remove></remove>"+e),w){try{e=U(e)}catch(e){}var o=new I;o.responseType="document",o.open("GET","data:text/html;charset=utf-8,"+e,!1),o.send(null),t=o.response}if(E)try{t=(new z).parseFromString(e,"text/html")}catch(e){}return t&&t.documentElement||((n=(t=G.createHTMLDocument("")).body).parentNode.removeChild(n.parentNode.firstElementChild),n.outerHTML=e),B.call(t,pe?"html":"body")[0]};S.isSupported&&function(){var e=Ne('<svg><g onload="this.parentNode.remove()"></g></svg>');e.querySelector("svg")||(w=!0);try{(e=Ne('<svg><p><style><img src="</style><img src=x onerror=alert(1)//">')).querySelector("svg img")&&(E=!0)}catch(e){}}();var _e=function(e){return P.call(e.ownerDocument||e,e,_.SHOW_ELEMENT|_.SHOW_COMMENT|_.SHOW_TEXT,function(){return _.FILTER_ACCEPT},!1)},De=function(e){return!(e instanceof C||e instanceof F)&&!("string"==typeof e.nodeName&&"string"==typeof e.textContent&&"function"==typeof e.removeChild&&e.attributes instanceof R&&"function"==typeof e.removeAttribute&&"function"==typeof e.setAttribute)},Re=function(e){return"object"===(void 0===N?"undefined":T(N))?e instanceof N:e&&"object"===(void 0===e?"undefined":T(e))&&"number"==typeof e.nodeType&&"string"==typeof e.nodeName},Ce=function(e,t,n){Y[e]&&Y[e].forEach(function(e){e.call(S,t,n,Ee)})},Fe=function(e){var t=void 0;if(Ce("beforeSanitizeElements",e,null),De(e))return Le(e),!0;var n=e.nodeName.toLowerCase();if(Ce("uponSanitizeElement",e,{tagName:n,allowedTags:ne}),!ne[n]||ae[n]){if(Te&&!xe[n]&&"function"==typeof e.insertAdjacentHTML)try{e.insertAdjacentHTML("AfterEnd",e.innerHTML)}catch(e){}return Le(e),!0}return!ue||e.firstElementChild||e.content&&e.content.firstElementChild||!/</g.test(e.textContent)||(S.removed.push({element:e.cloneNode()}),e.innerHTML=e.textContent.replace(/</g,"&lt;")),me&&3===e.nodeType&&(t=(t=(t=e.textContent).replace(K," ")).replace($," "),e.textContent!==t&&(S.removed.push({element:e.cloneNode()}),e.textContent=t)),Ce("afterSanitizeElements",e,null),!1},ze=function(e){var t=void 0,n=void 0,o=void 0,r=void 0,i=void 0,a=void 0,l=void 0;if(Ce("beforeSanitizeAttributes",e,null),a=e.attributes){var s={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:re};for(l=a.length;l--;){if(t=a[l],n=t.name,o=t.value.trim(),r=n.toLowerCase(),s.attrName=r,s.attrValue=o,s.keepAttr=!0,Ce("uponSanitizeAttribute",e,s),o=s.attrValue,"name"===r&&"IMG"===e.nodeName&&a.id)i=a.id,a=Array.prototype.slice.apply(a),Me("id",e),Me(n,e),a.indexOf(i)>l&&e.setAttribute("id",i.value);else{if("INPUT"===e.nodeName&&"type"===r&&"file"===o&&(re[r]||!le[r]))continue;"id"===n&&e.setAttribute(n,""),Me(n,e)}if(s.keepAttr&&(!be||"id"!==r&&"name"!==r||!(o in x||o in O||o in we))){if(me&&(o=(o=o.replace(K," ")).replace($," ")),ce&&J.test(r));else if(se&&Q.test(r));else{if(!re[r]||le[r])continue;if(ke[r]);else if(te.test(o.replace(ee,"")));else if("src"!==r&&"xlink:href"!==r||0!==o.indexOf("data:")||!Se[e.nodeName.toLowerCase()]){if(de&&!Z.test(o.replace(ee,"")));else if(o)continue}else;}try{e.setAttribute(n,o),S.removed.pop()}catch(e){}}}Ce("afterSanitizeAttributes",e,null)}},He=function e(t){var n=void 0,o=_e(t);for(Ce("beforeSanitizeShadowDOM",t,null);n=o.nextNode();)Ce("uponSanitizeShadowNode",n,null),Fe(n)||(n.content instanceof L&&e(n.content),ze(n));Ce("afterSanitizeShadowDOM",t,null)};return S.sanitize=function(e,t){var n=void 0,o=void 0,r=void 0,i=void 0,a=void 0;if(e||(e="\x3c!--\x3e"),"string"!=typeof e&&!Re(e)){if("function"!=typeof e.toString)throw new TypeError("toString is not a function");e=e.toString()}if(!S.isSupported){if("object"===T(x.toStaticHTML)||"function"==typeof x.toStaticHTML){if("string"==typeof e)return x.toStaticHTML(e);if(Re(e))return x.toStaticHTML(e.outerHTML)}return e}if(fe||Oe(t),S.removed=[],e instanceof N)1===(o=(n=Ne("\x3c!--\x3e")).ownerDocument.importNode(e,!0)).nodeType&&"BODY"===o.nodeName?n=o:n.appendChild(o);else{if(!ge&&!pe&&-1===e.indexOf("<"))return e;if(!(n=Ne(e)))return ge?null:""}he&&Le(n.firstChild);for(var l=_e(n);r=l.nextNode();)3===r.nodeType&&r===i||Fe(r)||(r.content instanceof L&&He(r.content),ze(r),i=r);if(ge){if(ye)for(a=X.call(n.ownerDocument);n.firstChild;)a.appendChild(n.firstChild);else a=n;return ve&&(a=V.call(k,a,!0)),a}return pe?n.outerHTML:n.innerHTML},S.setConfig=function(e){Oe(e),fe=!0},S.clearConfig=function(){Ee=null,fe=!1},S.addHook=function(e,t){"function"==typeof t&&(Y[e]=Y[e]||[],Y[e].push(t))},S.removeHook=function(e){Y[e]&&Y[e].pop()},S.removeHooks=function(e){Y[e]&&(Y[e]=[])},S.removeAllHooks=function(){Y={}},S}var r=["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"],i=["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","audio","canvas","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","video","view","vkern"],a=["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feMerge","feMergeNode","feMorphology","feOffset","feSpecularLighting","feTile","feTurbulence"],l=["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmuliscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mpspace","msqrt","mystyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"],s=["#text"],c=["accept","action","align","alt","autocomplete","background","bgcolor","border","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","coords","datetime","default","dir","disabled","download","enctype","face","for","headers","height","hidden","high","href","hreflang","id","ismap","label","lang","list","loop","low","max","maxlength","media","method","min","multiple","name","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","type","usemap","valign","value","width","xmlns"],d=["accent-height","accumulate","additivive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","tabindex","targetx","targety","transform","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"],u=["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"],m=["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"],p=/\{\{[\s\S]*|[\s\S]*\}\}/gm,f=/<%[\s\S]*|[\s\S]*%>/gm,h=/^data-[\-\w.\u00B7-\uFFFF]/,g=/^aria-[\-\w]+$/,y=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,v=/^(?:\w+script|data):/i,b=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},A=function(){return"undefined"==typeof window?null:window};return o()});

</script>


        <!-- CSS LOADING SPINNER -->
        <style>
          .ldspmzjfhueifssge-ring {
            display: inline-block;
            position: relative;
            width: 64px;
            height: 64px;
          }
          .ldspmzjfhueifssge-ring div {
            box-sizing: border-box;
            display: block;
            position: absolute;
            width: 51px;
            height: 51px;
            margin: 6px;
            border: 6px solid #444;
            border-radius: 50%;
            animation: lds-ring 1.2s cubic-bezier(0.5, 0, 0.5, 1) infinite;
            border-color: #444 transparent transparent transparent;
          }
          .ldspmzjfhueifssge-ring div:nth-child(1) {
            animation-delay: -0.45s;
          }
          .ldspmzjfhueifssge-ring div:nth-child(2) {
            animation-delay: -0.3s;
          }
          .ldspmzjfhueifssge-ring div:nth-child(3) {
            animation-delay: -0.15s;
          }
          @keyframes lds-ring {
            0% {
              transform: rotate(0deg);
            }
            100% {
              transform: rotate(360deg);
            }
          }
          @media (prefers-color-scheme: dark) {
            #outputLoadSpinner {
              filter: invert(1);
            }
          }
        </style>

        <script>
          let thisIsNotAnOldCachedPageResolver;
          window.thisIsNotAnOldCachedPagePromise = new Promise(r => thisIsNotAnOldCachedPageResolver=r);
          // CloudFlare sometimes has cache purging delays, and these can really mess things up (e.g. make it look like you've lost hours of work).
          // We check the `age` header of this document, and if it's older than the last save time of this generator, then we load a cache-busted URL
          // and then remove the added cacheBust string with history.replaceState
          (async function() {
            if(navigator.webdriver) return; // just in case this is what's confusing the Google crawler - RE the title bug
            if(window.location.href.includes("__cacheBust")) {
              thisIsNotAnOldCachedPageResolver(true);
              return; // no need to run this check if cache is already busted
            }

            let imports = window.js0nparse(decodeURI(document.querySelector("#imported-generator-names").textContent));
            let clientHtmlServerRenderTime = Number(document.querySelector("#this-html-server-render-time").textContent);
            
            await new Promise(r => setTimeout(r, 10)); // give the page a chance to load a bit before checking transferSize
            let transferSize = 1;
            try { transferSize = performance.getEntriesByType("navigation")[0].transferSize; } catch(e) {}
            console.debug("transferSize (likely partial):", transferSize);
            if(isNaN(transferSize)) transferSize = 1;
            // transferSize will be zero if it was loaded from browser cache, assuming the user's browser supports the API

            let checkStartTime = Date.now();
            let weHaveAnOldVersionOfThisGen = await fetch(`https://perchance.org/api/clearCacheIfGeneratorOrImportsHaveBeenUpdated?generatorName=${window.location.pathname.slice(1)}&importedGeneratorNames=${imports.join(",")}&clientHtmlServerRenderTime=${clientHtmlServerRenderTime}&transferSize=${transferSize}&queryParamString=${encodeURIComponent(window.location.search)}&__cacheBust=${Math.random()}`).then(r => r.json()).catch(e => { console.error(e); return "network-error"; });
            if(weHaveAnOldVersionOfThisGen === "network-error") {
              if(window.userOwnsThisGenerator) {
                alert("There was a network error while trying to determine whether the latest generator data has been loaded. You may be viewing/editing an older copy of the data. Try refreshing the page.");
              }
            } else if(weHaveAnOldVersionOfThisGen) {
              console.debug("This is an old version of this generator.");
              if(Date.now()-checkStartTime < 10000) {
                console.debug("Doing cache bust reload now...");
                let url = new URL(window.location.href);
                url.searchParams.set("__cacheBust", Math.random());
                window.location.href = url.href.replace(/(\?|&)%24csp=(&|$)/, "$1$csp$2");
              } else if(window.userOwnsThisGenerator) { 
                // don't want to disrupt them in case they're editing, but still need to let them know:
                alert("This is an old version of this generator. Please refresh the page to get the latest version.");
              }
            } else {
              thisIsNotAnOldCachedPageResolver(true);
            }
          })();
          if(location.href.includes("__cacheBust")) {
            window.needToBustCacheOfIframeOnInitialLoad = true;
            let url = new URL(window.location.href);
            url.searchParams.delete("__cacheBust");
            let newPath = url.href.replace(/^https:\/\/perchance\.org/, "").replace(/(\?|&)%24csp=(&|$)/, "$1$csp$2");
            history.replaceState({}, "", newPath);
          }
        </script>

        <div id="editorLoadSpinnerEl" style="z-index:10; display:none; pointer-events:none; position:fixed; top:0; right:0; bottom:0; left:0; justify-content:center; align-items:center;"><div class="ldspmzjfhueifssge-ring"><div></div><div></div><div></div><div></div></div></div>


        <style>
/* NOTE: Changes marked with "CHANGE" */

/*! normalize.css v3.0.3 | MIT License | github.com/necolas/normalize.css */

/**
 * 1. Set default font family to sans-serif.
 * 2. Prevent iOS and IE text size adjust after device orientation change,
 *    without disabling user zoom.
 */

html {
  font-family: sans-serif; /* 1 */
  -ms-text-size-adjust: 100%; /* 2 */
  -webkit-text-size-adjust: 100%; /* 2 */
}

/**
 * Remove default margin.
 */

body {
  margin: 0;
}

/* HTML5 display definitions
   ========================================================================== */

/**
 * Correct `block` display not defined for any HTML5 element in IE 8/9.
 * Correct `block` display not defined for `details` or `summary` in IE 10/11
 * and Firefox.
 * Correct `block` display not defined for `main` in IE 11.
 */

article,
aside,
details,
figcaption,
figure,
footer,
header,
hgroup,
main,
menu,
nav,
/* summary, CHANGE */
section {
  display: block;
}

/**
 * 1. Correct `inline-block` display not defined in IE 8/9.
 * 2. Normalize vertical alignment of `progress` in Chrome, Firefox, and Opera.
 */

audio,
canvas,
progress,
video {
  display: inline-block; /* 1 */
  vertical-align: baseline; /* 2 */
}

/**
 * Prevent modern browsers from displaying `audio` without controls.
 * Remove excess height in iOS 5 devices.
 */

audio:not([controls]) {
  display: none;
  height: 0;
}

/**
 * Address `[hidden]` styling not present in IE 8/9/10.
 * Hide the `template` element in IE 8/9/10/11, Safari, and Firefox < 22.
 */

[hidden] {
  display: none !important; /* EDIT: added `!important` so you can e.g. have inline display:flex, and yet still toggle hidden/unhidden with `el.hidden = trueOrFalse` */
}
template {
  display: none;
}

/* Links
   ========================================================================== */

/**
 * Remove the gray background color from active links in IE 10.
 */

a {
  background-color: transparent;
}

/**
 * Improve readability of focused elements when they are also in an
 * active/hover state.
 */

a:active,
a:hover {
  outline: 0;
}

/* Text-level semantics
   ========================================================================== */

/**
 * Address styling not present in IE 8/9/10/11, Safari, and Chrome.
 */

abbr[title] {
  border-bottom: 1px dotted;
}

/**
 * Address style set to `bolder` in Firefox 4+, Safari, and Chrome.
 */

b,
strong {
  font-weight: bold;
}

/**
 * Address styling not present in Safari and Chrome.
 */

dfn {
  font-style: italic;
}

/**
 * Address variable `h1` font-size and margin within `section` and `article`
 * contexts in Firefox 4+, Safari, and Chrome.
 */

h1 {
  font-size: 2em;
  margin: 0.67em 0;
}

/**
 * Address styling not present in IE 8/9.
 */

mark {
  background: #ff0;
  color: #000;
}

/**
 * Address inconsistent and variable font size in all browsers.
 */

small {
  font-size: 80%;
}

/**
 * Prevent `sub` and `sup` affecting `line-height` in all browsers.
 */

sub,
sup {
  font-size: 75%;
  line-height: 0;
  position: relative;
  vertical-align: baseline;
}

sup {
  top: -0.5em;
}

sub {
  bottom: -0.25em;
}

/* Embedded content
   ========================================================================== */

/**
 * Remove border when inside `a` element in IE 8/9/10.
 */

img {
  border: 0;
}

/**
 * Correct overflow not hidden in IE 9/10/11.
 */

svg:not(:root) {
  overflow: hidden;
}

/* Grouping content
   ========================================================================== */

/**
 * Address margin not present in IE 8/9 and Safari.
 */

figure {
  margin: 1em 40px;
}

/**
 * Address differences between Firefox and other browsers.
 */

hr {
  box-sizing: content-box;
  height: 0;
}

/**
 * Contain overflow in all browsers.
 */

pre {
  overflow: auto;
}

/**
 * Address odd `em`-unit font size rendering in all browsers.
 */

code,
kbd,
pre,
samp {
  font-family: monospace, monospace;
  font-size: 1em;
}

/* Forms
   ========================================================================== */

/**
 * Known limitation: by default, Chrome and Safari on OS X allow very limited
 * styling of `select`, unless a `border` property is set.
 */

/**
 * 1. Correct color not being inherited.
 * 2. Correct font properties not being inherited.
 * 3. Address margins set differently in Firefox 4+, Safari, and Chrome.
 */

button:not([disabled]), input:not([disabled]), optgroup:not([disabled]), select:not([disabled]), textarea:not([disabled]) {
  color: inherit;
}



button,
input,
optgroup,
select,
textarea {
  font: inherit; /* 2 */
  margin: 0; /* 3 */
}

/**
 * Address `overflow` set to `hidden` in IE 8/9/10/11.
 */

button {
  overflow: visible;
}

/**
 * Address inconsistent `text-transform` inheritance for `button` and `select`.
 * All other form control elements do not inherit `text-transform` values.
 * Correct `button` style inheritance in Firefox, IE 8/9/10/11, and Opera.
 * Correct `select` style inheritance in Firefox.
 */

button,
select {
  text-transform: none;
}

/**
 * 1. Avoid the WebKit bug in Android 4.0.* where (2) destroys native `audio`
 *    and `video` controls.
 * 2. Correct inability to style clickable `input` types in iOS.
 * 3. Improve usability and consistency of cursor style between image-type
 *    `input` and others.
 */

button,
html input[type="button"], /* 1 */
input[type="reset"],
input[type="submit"] {
  -webkit-appearance: button; /* 2 */
  cursor: pointer; /* 3 */
}

/**
 * Re-set default cursor for disabled elements.
 */

button[disabled],
html input[disabled] {
  cursor: default;
}

/**
 * Remove inner padding and border in Firefox 4+.
 */

button::-moz-focus-inner,
input::-moz-focus-inner {
  border: 0;
  padding: 0;
}

/**
 * Address Firefox 4+ setting `line-height` on `input` using `!important` in
 * the UA stylesheet.
 */

input {
  line-height: normal;
}

/**
 * It's recommended that you don't attempt to style these elements.
 * Firefox's implementation doesn't respect box-sizing, padding, or width.
 *
 * 1. Address box sizing set to `content-box` in IE 8/9/10.
 * 2. Remove excess padding in IE 8/9/10.
 */

input[type="checkbox"],
input[type="radio"] {
  box-sizing: border-box; /* 1 */
  padding: 0; /* 2 */
}

/**
 * Fix the cursor style for Chrome's increment/decrement buttons. For certain
 * `font-size` values of the `input`, it causes the cursor style of the
 * decrement button to change from `default` to `text`.
 */

input[type="number"]::-webkit-inner-spin-button,
input[type="number"]::-webkit-outer-spin-button {
  height: auto;
}

/**
 * 1. Address `appearance` set to `searchfield` in Safari and Chrome.
 * 2. Address `box-sizing` set to `border-box` in Safari and Chrome.
 */

input[type="search"] {
  -webkit-appearance: textfield; /* 1 */
  box-sizing: content-box; /* 2 */
}

/**
 * Remove inner padding and search cancel button in Safari and Chrome on OS X.
 * Safari (but not Chrome) clips the cancel button when the search input has
 * padding (and `textfield` appearance).
 */

input[type="search"]::-webkit-search-cancel-button,
input[type="search"]::-webkit-search-decoration {
  -webkit-appearance: none;
}

/**
 * Define consistent border, margin, and padding.
 */

fieldset {
  border: 1px solid #c0c0c0;
  margin: 0 2px;
  padding: 0.35em 0.625em 0.75em;
}

/**
 * 1. Correct `color` not being inherited in IE 8/9/10/11.
 * 2. Remove padding so people aren't caught out if they zero out fieldsets.
 */

legend {
  border: 0; /* 1 */
  padding: 0; /* 2 */
}

/**
 * Remove default vertical scrollbar in IE 8/9/10/11.
 */

textarea {
  overflow: auto;
}

/**
 * Don't inherit the `font-weight` (applied by a rule above).
 * NOTE: the default cannot safely be changed in Chrome and Safari on OS X.
 */

optgroup {
  font-weight: bold;
}

/* Tables
   ========================================================================== */

/**
 * Remove most spacing between table cells.
 */

table {
  border-collapse: collapse;
  border-spacing: 0;
}

td,
th {
  padding: 0;
}

</style><style>
html { 
    color: #222;
    font-size: 1em;
    line-height: 1.4;
}

/*
 * A better looking default horizontal rule
 */
hr {
    display: block;
    height: 1px;
    border: 0;
    border-top: 1px solid #ccc;
    margin: 1em 0;
    padding: 0;
}

/*
 * Remove the gap between audio, canvas, iframes,
 * images, videos and the bottom of their containers:
 * https://github.com/h5bp/html5-boilerplate/issues/440
 */

audio,
canvas,
iframe,
img,
svg,
video {
    vertical-align: middle;
}

/*
 * Remove default fieldset styles.
 */

fieldset {
    border: 0;
    margin: 0;
    padding: 0;
}

/*
 * Allow only vertical resizing of textareas.
 */

textarea {
    resize: vertical;
}


/* ==========================================================================
   Author's custom styles
   ========================================================================== */


html, body {
  height: 100%;
  overflow: hidden;
}

body {
  background-color: #f6f6f6;
  box-sizing: border-box;
  font-family: 'Cousine', monospace;
  line-height: 1.05rem;
  font-size: 0.75rem;
  color: #050505;
}

*, *::before, *::after {
  box-sizing: border-box;
}

[hidden] {
  display: none !important;
}


/* =================================================== */
/* ================= DARK MODE STUFF ================= */
/* =================================================== */



/* button {
  padding: 0.135em 0.5em;
  border: 1px solid #afafaf;
  background: linear-gradient(to bottom, rgb(245, 245, 245) 0%, rgb(236, 236, 236) 47%, rgb(223, 223, 223) 100%);
  border-radius: 1px;
}
button:hover {
  border-color: #909090;
} */

</style><style type="text/css">@font-face {font-family:Cousine;font-style:normal;font-weight:400;src:url(/cf-fonts/s/cousine/5.0.18/cyrillic/400/normal.woff2);unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116;font-display:swap;}@font-face {font-family:Cousine;font-style:normal;font-weight:400;src:url(/cf-fonts/s/cousine/5.0.18/greek/400/normal.woff2);unicode-range:U+0370-03FF;font-display:swap;}@font-face {font-family:Cousine;font-style:normal;font-weight:400;src:url(/cf-fonts/s/cousine/5.0.18/greek-ext/400/normal.woff2);unicode-range:U+1F00-1FFF;font-display:swap;}@font-face {font-family:Cousine;font-style:normal;font-weight:400;src:url(/cf-fonts/s/cousine/5.0.18/latin/400/normal.woff2);unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD;font-display:swap;}@font-face {font-family:Cousine;font-style:normal;font-weight:400;src:url(/cf-fonts/s/cousine/5.0.18/vietnamese/400/normal.woff2);unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB;font-display:swap;}@font-face {font-family:Cousine;font-style:normal;font-weight:400;src:url(/cf-fonts/s/cousine/5.0.18/cyrillic-ext/400/normal.woff2);unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F;font-display:swap;}@font-face {font-family:Cousine;font-style:normal;font-weight:400;src:url(/cf-fonts/s/cousine/5.0.18/hebrew/400/normal.woff2);unicode-range:U+0590-05FF,U+200C-2010,U+20AA,U+25CC,U+FB1D-FB4F;font-display:swap;}@font-face {font-family:Cousine;font-style:normal;font-weight:400;src:url(/cf-fonts/s/cousine/5.0.18/latin-ext/400/normal.woff2);unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF;font-display:swap;}</style>
        <style>
          #menuBarEl { background:#f6f6f6; }
          #editorEl { background:#f6f6f6; }
          @media (prefers-color-scheme: dark) { 
            #menuBarEl { background:#282c33; }
            #editorEl { background:#282c33; }
          }

          #menuBarEl {
            border-bottom: 1px solid #cbcbcb;
          }
          @media (prefers-color-scheme: dark) { 
            #menuBarEl {
              border-bottom: 1px solid #3d3d3d;
            }
          }
          :root {
            --menu-bar-item-backdrop-filter: brightness(0.9);
            --menu-bar-item-backdrop-filter-hover: brightness(0.84);
            --menu-bar-item-backdrop-filter-dark: brightness(0.75);
            --menu-bar-item-backdrop-filter-hover-dark: brightness(0.6);
          }
          #menuBarEl .menu-item {
            backdrop-filter: var(--menu-bar-item-backdrop-filter);
            display: inline-flex;
            border-radius: 3px;
            align-items: center;
            justify-content: center;
            gap: 0.125rem;
            height: 100%;
            font-size: 80%;
            opacity: 0.9;
            min-width: max-content;
          }
          #menuBarEl .menu-item:hover {
            cursor:pointer;
            backdrop-filter: var(--menu-bar-item-backdrop-filter-hover);
            opacity: 1;
          }
          @media (prefers-color-scheme: dark) { 
            #menuBarEl .menu-item {
              backdrop-filter: var(--menu-bar-item-backdrop-filter-dark);
              color:#e3e3e3;
            }
            #menuBarEl .menu-item:hover {
              backdrop-filter: var(--menu-bar-item-backdrop-filter-hover-dark);
            }
          }
          #menuBarEl .menu-item-icon {
            padding-left: 0.25rem;
          }
          #menuBarEl .menu-item-label { 
            padding-right: 0.25rem;
          }
          /* @media screen and (max-width: 690px) { #menuBarEl .menu-item.new { display:none; } }
          @media screen and (max-width: 640px) { #menuBarEl .menu-item.community { display:none; } }
          @media screen and (max-width: 590px) { #menuBarEl .menu-item.resources { display:none; } }
          @media screen and (max-width: 540px) { #menuBarEl .menu-item.hub { display:none; } }
          @media screen and (max-width: 490px) { #menuBarEl .menu-item.tutorial { display:none; } }
          @media screen and (max-width: 440px) { #menuBarEl .menu-item.generators { display:none; } } */

          @media screen and (max-width: 540px) {
            #menuBarEl .menu-item.tutorial { display:none; }
            #menuBarEl .menu-item.hub { display:none; }
          }
          @media screen and (max-width: 440px) {
            #menuBarEl .menu-item.community { display:none; }
          }
        </style>
        <style>
          #editorEl .warningsModal .warning-item {
            padding: 1rem;
            padding-bottom: 0;
          }
          #editorEl .warningsModal code {
            background: #ececec;
            font-size: 90%;
            padding: 0.07rem 0.2rem;
            border-radius: 2px;
          }
          /* WARNINGS MODAL */
          #editorEl .warningsModal .outer-wrapper {
            position:fixed;
            top:0;
            left:0;
            width:100%;
            z-index:2;
            padding: 1em;
            box-sizing: border-box;
          }
          #editorEl .warningsModal .background {
            position:fixed;
            top:0;
            left:0;
            width:100%;
            height:100%;
            opacity:0.2;
            background:#000;
            transition: opacity .15s linear;
          }
          #editorEl .warningsModal .content-wrapper {
            overflow:hidden;
            background:#fff;
            max-width:700px;
            width:100%;
            border-radius:3px;
            margin:0 auto;
          }
          #editorEl .warningsModal button,
          #editorEl .warningsModal input {
            height:3em;
          }
          #editorEl .warningsModal button {
            background:#4c4c4c;
            color:#fff;
            width:50%;
            border:none;
            outline:none;
            font-size: 90%;
          }
          #editorEl .warningsModal button:hover {
            background:#323232;
          }

          #editorEl .warningsModal .modal-header {
            padding:1em;
          }
          #editorEl .warningsModal .modal-header p {
            color:#444;
            margin:0;
            font-size: 90%
          }
          #editorEl .warningsModal button.main {
            background:#444;
            color:white;
          }
          #editorEl .warningsModal button.main:hover {
            background:#333;
          }
          #editorEl .warningsModal span.link {
            cursor:pointer;
            text-decoration:underline;
            color:#1212ff;
          }
          @media screen and (max-width: 590px) { 
            #editorEl #output-buttons-ctn {
              display: flex;
              flex-direction: column;
            }
            #editorEl #output-buttons-ctn > * {
              margin: 3px !important;
              white-space: nowrap;
              overflow: hidden;
            }
          }

          #editorEl #output { border: 1px solid #C0C0C0; border-bottom:none; }
          @media (prefers-color-scheme: dark) { #editorEl #output { border: 1px solid #575757; border-bottom:none; } }

          #editorEl #output-buttons-ctn { border-top: 1px solid #C0C0C0; }
          @media (prefers-color-scheme: dark) { #editorEl #output-buttons-ctn { border-top: 1px solid #575757; } }

          #adCtn { border-top: 1px solid #C0C0C0; }
          @media (prefers-color-scheme: dark) { #adCtn { border-top: 1px solid #575757; } }

          #editorEl .toggle-wrap-button-html {
            border: solid 1px #737373;
            color: #737373;
            padding: 0 0.3em;
            border-radius: 1px;
            cursor: pointer;
            background:white;
            text-align: center;
            position: absolute;
            top: 5px;
            right: 5px;
            z-index: 10;
          }
          #editorEl .toggle-wrap-button-html:hover {
            border: solid 1px black;
            color:black;
          }

          #editorEl .toggle-wrap-button {
            border: solid 1px #737373;
            color: #737373;
            padding: 0 0.3em;
            border-radius: 1px;
            cursor: pointer;
            background:white;
            text-align: center;
            display: inline-block;
          }
          #editorEl .toggle-wrap-button:hover {
            border: solid 1px black;
            color:black;
          }
          #editorEl .toggle-fold-button {
            border: solid 1px #737373;
            color: #737373;
            padding: 0 0.3em;
            border-radius: 1px;
            cursor: pointer;
            background:white;
            text-align: center;
            display: inline-block;
          }
          #editorEl .toggle-fold-button:hover {
            border: solid 1px black;
            color:black;
          }

          #editorEl .code-editor-buttons-ctn {
            position: absolute;
            top: 5px;
            right: 5px;
            z-index: 10;
          }

          #editorEl #output {
            /* position:absolute; */
            height: 100%;
            width: 100%;
            flex-grow:10;
            padding:0;
            margin:0;
            z-index: 20;
            -webkit-box-sizing: border-box;
            -moz-box-sizing: border-box;
            box-sizing: border-box;
            text-align:center;
            border-left: none;
            border-right: none;
          }

          #editorEl #output iframe {
            height:100%;
            width:100%;
            border:none;
          }
          @media (prefers-color-scheme: dark) {
            #editorEl #output iframe {
              background: #121212; /* this is chrome's default dark mode background color. Note: must only do this in dark mode due to this: https://lemmy.world/post/7512043 */
            }
          }

          #editorEl #main {
            
          }

          #editorEl .CodeMirror {
            height: 100%;
            width: 100%;
            background:#fbfbfb;
          }


          #editorEl .split {
            -webkit-box-sizing: border-box;
            -moz-box-sizing: border-box;
            box-sizing: border-box;

            overflow-y: auto;
            overflow-x: hidden;
          }

          #editorEl .content {
            border: 1px solid #C0C0C0;
            box-shadow: inset 0 1px 2px #e4e4e4;
            background-color: #fff;
          }

          #editorEl .gutter {
            background-color: transparent;

            background-repeat: no-repeat;
            background-position: 50%;
          }

          #editorEl .gutter.gutter-horizontal {
            cursor: col-resize;
            background-image: url('lib/splitjs/vertical.png');
            height: 100%;
            min-width: 8px;
            max-width: 8px;
          }

          #editorEl .gutter.gutter-vertical {
            cursor: row-resize;
            background-image: url('lib/splitjs/horizontal.png');
            width: 100%;
            min-height: 8px;
            max-height: 8px;
          }

          #editorEl .split.split-horizontal {
            height: 100%;
          }

          #revisionsModalEl ul li span.clickable {
            color:blue;
            text-decoration:underline;
            cursor: pointer;
          }
          #revisionsModalEl .content-wrapper {
            width:750px;
          }

          @media (prefers-color-scheme: dark) {
            body {
              color-scheme: dark;
              background-color: #282c33;
              color: #cdcdcd;
            }
            #editorEl .gutter.gutter-horizontal {
              opacity: 0.6 !important;
            }
            #editorEl .gutter.gutter-vertical {
              opacity: 0.6 !important;
            }
            #editorEl .content {
              border: 1px solid #575757;
              background-color: #282c34;
              box-shadow: none;
            }
            #editorEl .toggle-fold-button,
            #editorEl .toggle-wrap-button,
            #editorEl .toggle-wrap-button-html {
              background: #1f2024;
              color: #aaaaaa;
              border: 1px solid #575757;
            }
            #editorEl .toggle-fold-button:hover,
            #editorEl .toggle-wrap-button:hover,
            #editorEl .toggle-wrap-button-html:hover {
              color: #d8d8d8;
              border: solid 1px #bfbfbf;
            }

            #accountModalEl .content-wrapper,
            #settingsModalEl .content-wrapper,
            #revisionsModalEl .content-wrapper,
            #loginModalEl .content-wrapper {
              background: #2e3034;
            }
            #accountModalEl .modal-header p,
            #settingsModalEl .modal-header p,
            #revisionsModalEl .modal-header p,
            #loginModalEl .modal-header p {
              color: #8f8f8f;
            }
            #accountModalEl button,
            #settingsModalEl button,
            #revisionsModalEl button,
            #loginModalEl button {
              background: #474747;
            }
            #accountModalEl button:hover,
            #settingsModalEl button:hover,
            #revisionsModalEl button:hover,
            #loginModalEl button:hover {
              background: #565656;
            }
            #accountModalEl span.link,
            #settingsModalEl span.link,
            #revisionsModalEl span.link,
            #loginModalEl span.link,
            #revisionsModalEl ul li span.clickable {
              color: #5387e1;
            }

            #perchanceConsoleEl #console-input {
              background: initial !important;
            }

            #output-buttons-ctn {
              background: #282c33 !important;
            }
            #output-buttons-ctn button:not([data-ref='warningsModalOpenButton']) {
              /* border: 1px solid #585858 !important;
              background: linear-gradient(to bottom, rgb(44 44 44) 0%, rgb(37 37 37) 47%, rgb(38 38 38) 100%) !important; */
            }
            #output-buttons-ctn > span { /* auto reload checkbox container */
              background-color: #404040 !important;
            }

            .CodeMirror-scrollbar-filler, .CodeMirror-gutter-filler {
              background-color: #282c33 !important;
            }

            #menuBarEl .menu-item.edit-generator-button {
              color: #00d300 !important;
            }
            #menuBarEl .menu-item.account-modal-open-button {
              color: #00d300 !important;
            }

            .warningsModal .modal-body > div {
              background-color: #282c33 !important;
            }
            .warningsModal .modal-body code {
              background-color: #4c4c4c !important;
            }
          }

          /* .cm-searching {
            background-color: rgba(255, 255, 0, .4) !important;
          } */

          /* .cm-square-bracket { color: #05a; }
          .cm-special-list-name { color: #05a; }
          .cm-curly-bracket { color: #f18c16; } */

          /* .cm-s-one-dark .cm-square-bracket { color: #61afef; }
          .cm-s-one-dark .cm-special-list-name { color: #61afef; }
          .cm-s-one-dark .cm-curly-bracket { color: #f18c16; }
          .CodeMirror.cm-s-one-dark { background-color: #282c34 !important; }
          .cm-s-one-dark .cm-string-2 { color: #98c379 !important; }
          .cm-s-one-dark .cm-matchhighlight { background-color: #ffde631c; }
          .cm-s-one-dark .CodeMirror-selection-highlight-scrollbar { background-color: #ffdd6333; } */

          /*
          .cm-s-one-light .cm-square-bracket { color: #05a; }
          .cm-s-one-light .cm-special-list-name { color: #05a; }
          .cm-s-one-light .cm-curly-bracket { color: #f18c16; }
          .cm-s-one-light .cm-string { color: #419c00 !important; }
          .cm-s-one-light .cm-string-2 { color: #419c00 !important; }
          .cm-s-one-light .cm-def { color: #05a !important; }
          .cm-s-one-light .cm-variable { color: #05a !important; }
          */

          /* .CodeMirror.cm-s-one-light { background-color: #fafafa !important; }
          .cm-s-one-light .cm-string-2 { color: #50a14f !important; }
          .cm-s-one-light .cm-matchhighlight { background-color: #ffe06d52; }
          .cm-s-one-light .CodeMirror-selection-highlight-scrollbar { background-color: #c0ab5d52; } */

          /*
          .cm-s-one-dark .cm-comment { color: #636a78 !important; }
          .cm-s-one-dark .cm-variable { color: #61afef !important; }
          .cm-s-one-dark .cm-variable-2 { color: #61afef !important; }
          */
          /*
          .cm-comment { color: #A0A1A7 !important; }
          .cm-variable { color: #05a !important; }
          .cm-def { color: #05a !important; }
          */
        </style>
        <!-- SHARED MODAL STYLES -->
        <style>
          /* WRAPPER/OUTER STYLES */
          .app-modal .outer-wrapper {
            position:fixed;
            top:0;
            left:0;
            width:100%;
            z-index:2;
            padding: 1em;
            box-sizing: border-box;
          }
          .app-modal .background {
            position:fixed;
            top:0;
            left:0;
            width:100%;
            height:100%;
            opacity:0.2;
            background:#000;
            transition: opacity .15s linear;
          }
          .app-modal .content-wrapper {
            overflow:hidden;
            background:#fff;
            max-width:95%;
            width:500px;
            border-radius:3px;
            margin:0 auto;
          }


          /* DEFAULT CONTENT STYLES */
          .app-modal button, .app-modal input {
            height:3em;
          }
          .app-modal input[type="text"],
          .app-modal input[type="password"],
          .app-modal input[type="email"] {
            margin: 0;
            padding:0;
            box-sizing:border-box;
            display:block;
            width:100%;
            border:none;
            border-top:1px solid #eee;
            border-top:1px solid light-dark(#eee, #323232);
            outline:none;
            padding-left: 0.6em;
          }
          .app-modal input.error {
            background-color: #ffcccc;
          }
          .app-modal button {
            background:#eee;
            color: inherit;
            width:50%;
            border:none;
            outline:none;
            font-size: 90%;
          }
          .app-modal button:hover {
            background:#e1e1e1;
          }

          .app-modal .modal-header {
            padding:1em;
          }
          .app-modal .modal-header p {
            color:#444;
            margin:0;
            font-size: 90%
          }
          .app-modal button.main {
            background:#444;
            color:white;
          }
          .app-modal button.main:hover {
            background:#333;
          }
          .app-modal span.link {
            cursor:pointer;
            text-decoration:underline;
            color:#1212ff;
          }
          #minimalModeMenuBtn {
            background: rgb(226 226 226);
            border: 1px solid rgb(162 162 162);
          }
          @media (prefers-color-scheme: dark) {
            #minimalModeMenuBtn {
              background: #303030;
              border: 1px solid #474747;
            }
          }
        </style>
        <div id="appEl" style="display:flex; flex-direction:column; height:100%;">  
          <div id="minimalModeMenuBtn" onclick="this.style.display='none'; menuBarEl.style.display='flex'; backToMinimalModeBtn.style.display='';" style="display:none; position: fixed; top: 0.21rem; right: 0.21rem; z-index: 1000; border-radius: 3px; cursor: pointer; font-size: 0.6rem; line-height: 0.96rem; aspect-ratio: 1 / 1; height: calc(var(--menu-bar-height) - 0.42rem - 2px); align-items: center; justify-content: center;">🛠️</div>
          <div id="menuBarEl" style="position:relative; height:var(--menu-bar-height); min-height:var(--menu-bar-height); width:100%; overflow:hidden; display:flex; align-items: center; justify-content: center;">
            <script>
              if(window.generatorStaticMetaData.header?.mode === "minimal") { 
                menuBarEl.style.display = "none";
                minimalModeMenuBtn.style.display = "flex"; 
              }  
              function enableRobustBackdropFilter() { // this is more robust to e.g. background images, light backgrounds in dark mode, etc. - only enabling if background is actually set because IIRC some browsers currently have significant performance issues with backdrop-filter blur
                document.querySelector(':root').style.setProperty('--menu-bar-item-backdrop-filter', "brightness(0.9) blur(4px)");
                document.querySelector(':root').style.setProperty('--menu-bar-item-backdrop-filter-hover', "brightness(0.84) blur(4px)");
                document.querySelector(':root').style.setProperty('--menu-bar-item-backdrop-filter-dark', "brightness(0.75) blur(4px)");
                document.querySelector(':root').style.setProperty('--menu-bar-item-backdrop-filter-hover-dark', "brightness(0.6) blur(4px)");
              }  
              function colorIsDark(bgColorStr) {
                let a = document.createElement('div');
                a.style.color = bgColorStr;
                let rgb = window.getComputedStyle( document.body.appendChild(a) ).color.match(/\d+/g).map(function(a){ return parseInt(a,10); });
                document.body.removeChild(a);
                let r = rgb[0];
                let g = rgb[1];
                let b = rgb[2];
                let uicolors = [r / 255, g / 255, b / 255];
                let c = uicolors.map((col) => {
                  if (col <= 0.03928) {
                    return col / 12.92;
                  }
                  return Math.pow((col + 0.055) / 1.055, 2.4);
                });
                let L = (0.2126 * c[0]) + (0.7152 * c[1]) + (0.0722 * c[2]);
                return L < 0.179;
              }
              if(typeof window.generatorStaticMetaData.header?.background === "string") {
                if(CSS.supports("background", window.generatorStaticMetaData.header.background)) {
                  menuBarEl.style.background = window.generatorStaticMetaData.header.background;
                  enableRobustBackdropFilter();
                  if(CSS.supports("color", window.generatorStaticMetaData.header.background)) {
                    menuBarEl.style.color = colorIsDark(window.generatorStaticMetaData.header.background) ? "#e3e3e3" : "#050505";
                  }
                }
              }

              {
                let isTouchDevice = window.matchMedia("(pointer: coarse)").matches;
                let maxSeenViewportHeight = window.visualViewport.height;
                window.visualViewport.addEventListener('resize', () => {
                  if(!isTouchDevice) return;
                  if(window.visualViewport.height > maxSeenViewportHeight) maxSeenViewportHeight = window.visualViewport.height;
                  menuBarEl.style.display = window.visualViewport.height < 0.8*maxSeenViewportHeight ? "none" : "flex";
                });
              }
            </script>
            <div class="container" style="height: calc(100% - 0.42rem); width: calc(100% - 0.42rem); display: flex;">
              <div style="display:flex; height:100%; gap:0.21rem; overflow:hidden; flex-wrap:wrap;">
                <div class="menu-item" style="aspect-ratio: 1 / 1;" onclick="window.open('/')" onmousedown="if(event.which===2) { this.click() }">
                  <span class="menu-item-icon" style="padding:0; font-size:0.9rem;">⚄︎</span>
                </div>
                <div data-ref="communityButton" class="menu-item community" onclick="window.open('https://lemmy.world/c/perchance')" onmousedown="if(event.which===2) { this.click() }" title="• &quot;Sizes of Things in an Image&quot; (11h ago)
• &quot;Persistent 'undefined' errors ([title], [output], [goto.output]) even with working code copy&quot; (1d ago)
• &quot;Bug with list page&quot; (2d ago)
• &quot;[Bug] gallery comment conflict&quot; (2d ago)
• &quot;[Bug] Submit Button in Chat Acting Buggy?&quot; (3d ago)
• &quot;Slicing a Consumable List&quot; (4d ago)
• &quot;[Suggestion(ish)] Start new generators private instead of public&quot; (4d ago)
• &quot;[suggestion] gallery comment count&quot; (5d ago)
• &quot;[Feature Request] Proposal of changes for perchance.org&quot; (5d ago)">
                  <span class="menu-item-icon">👥︎</span>
                  <span class="menu-item-label" style="padding-right:0;">forum</span>
                  <span style="font-size:70%; display:inline-block; text-align:center; opacity:0.7; padding-right:0.25rem;" data-ref="communityNotifications"> (11h)</span>
                </div>
                <div class="menu-item hub" onclick="window.open('/hub')" onmousedown="if(event.which===2) { this.click() }">
                  <span class="menu-item-icon">🌈</span>
                  <span class="menu-item-label">hub</span>
                </div>
                <div class="menu-item tutorial" onclick="window.open('/tutorial')" onmousedown="if(event.which===2) { this.click() }">
                  <span class="menu-item-icon">📚</span>
                  <span class="menu-item-label">learn</span>
                </div>
                <!-- <div class="menu-item tutorial" onclick="window.open('/resources')" onmousedown="if(event.which===2) { this.click() }">
                  <span class="menu-item-icon">🧰</span>
                  <span class="menu-item-label">resources</span>
                </div> -->
                <div class="menu-item generators" onclick="window.open('/generators')" onmousedown="if(event.which===2) { this.click() }">
                  <span class="menu-item-inner"><span class="menu-item-icon">🎲︎</span>
                  <span class="menu-item-label">generators</span></span>
                </div>
                <div class="menu-item new" onclick="window.open('/minimal#edit')" onmousedown="if(event.which===2) { this.click() }">
                  <span class="menu-item-icon">➕</span>
                  <span class="menu-item-label">new</span>
                </div><div class="menu-item promo" onclick="window.open('/ai-chat')" onmousedown="if(event.which===2) { this.click() }" style="background-color: rgb(110, 53, 11);">
                  <span class="menu-item-icon">🆕</span>
                  <span class="menu-item-label">ai chat</span>
                </div>
              </div>
              <div style="display:flex; height:100%; flex-grow:1; justify-content:end; gap:0.21rem;">
                <div data-ref="statusMessage" style="min-width:max-content; color:green; padding:0 0.5em; font-size: 80%; display:none; align-items: center; justify-content: center; font-weight: bold;"></div>
                <div data-ref="revisionsButton" class="menu-item" onclick="app.openRevisionsModal()" style="display:none;">
                  <span class="menu-item-icon">🗄️</span>
                  <span class="menu-item-label">backups</span>
                </div>
                <div data-ref="saveButton" class="menu-item" onclick="app.saveGenerator();" style="display:none; ">
                  <span class="menu-item-icon">💾</span>
                  <span class="menu-item-label" data-ref="saveText">save</span>
                </div>
                <div data-ref="settingsButton" onclick="app.openSettingsModal()" class="menu-item" style="display:none;">
                  <span class="menu-item-icon">⚙️</span>
                  <span class="menu-item-label">settings</span>
                </div>
                <div data-ref="editButton" class="menu-item edit-generator-button" onclick="window.lastEditButtonClickTime=Date.now(); app.goToEditMode()" style="color: green; display: inline-flex;">
                  <span class="menu-item-icon">🛠️</span>
                  <span class="menu-item-label">edit</span>
                </div>
                <div data-ref="accountButton" onclick="app.openAccountModal()" class="menu-item account-modal-open-button" style="display:none; color:green;">
                  <span class="menu-item-icon">👤</span>
                  <span class="menu-item-label">account</span>
                </div>
                <div data-ref="loginButton" onclick="app.openLoginModal()" class="menu-item" style="display: inline-flex;">
                  <span class="menu-item-icon">🔑</span>
                  <span class="menu-item-label">login</span>
                </div>
                <div id="backToMinimalModeBtn" class="menu-item" onclick="menuBarEl.style.display='none'; minimalModeMenuBtn.style.display='flex';" style="display:none; aspect-ratio: 1/1;">
                  <span class="menu-item-icon" style="padding: 0; font-size: 0.5rem; line-height: 0.4rem;">❌</span>
                </div>
              </div>
            </div>
            <script> 
              window.menuBar = {
                root: document.querySelector("#menuBarEl"),
                refs: new Proxy({}, {
                  get(target, prop, receiver) {
                    return document.querySelector(`#menuBarEl [data-ref='${prop}']`);
                  },
                }),
                init: function() {

                  try {
                    this.refs.editButton.addEventListener("mouseover", () => {
                      if(window.TEST_NEW_EDITOR_1 && !window.editorBundleImportPromise) window.editorBundleImportPromise = import("/lib/editors.bundle.min.js?v=75");
                    });
                  } catch(e) { console.error(e); }

                  this.updateMenuButtonsDisplay = function() {
                    this.refs.accountButton.style.display = app.store.data.user.loggedIn ? "inline-flex" : "none";
                    this.refs.loginButton.style.display = app.store.data.user.loggedIn ? "none" : "inline-flex";
                    this.refs.settingsButton.style.display = app.store.data.user.loggedIn && window.userOwnsThisGenerator && app.appInteractionState === "edit" ? "inline-flex" : "none";
                    this.refs.saveButton.style.display = app.appInteractionState === "edit" ? "inline-flex" : "none";
                    this.refs.revisionsButton.style.display = app.store.data.user.loggedIn && window.userOwnsThisGenerator && app.appInteractionState === "edit" ? "inline-flex" : "none";
                    this.refs.editButton.style.display = app.appInteractionState === "view" ? "inline-flex" : "none";
                  };
                  app.on("LoginStateChange", () => {
                    this.updateMenuButtonsDisplay();
                  });
                  app.on("AppInteractionStateChange", () => {
                    this.updateMenuButtonsDisplay();
                    if(app.interactionStateChange === "edit") {
                      this.updateSaveButtonStyle();
                    }
                  });
                  app.on("GeneratorOwnershipChange", () => {
                    this.updateMenuButtonsDisplay();
                  });

                  // this will be changed to "saved" if they are the owner:
                  window.perchanceSaveState = "unsaved";
                  this.saveState = "unsaved";
                
                  this.setSaveState = (state) => {
                    window.perchanceSaveState = state;
                    this.saveState = state;
                    this.updateSaveButtonStyle();
                  };
                  window.setSaveState = this.setSaveState.bind(this);
                
                  this.updateSaveButtonStyle = () => {
                
                    let state = this.saveState;
                
                    this.refs.saveButton.style.color = "";
                    this.refs.saveButton.style.cursor = "";
                    this.refs.saveButton.style.opacity = 1;
                
                    if(state === "saving") {
                      this.refs.saveText.innerText = "saving…";
                      this.refs.saveButton.style.opacity = 0.5;
                    } else if(state === "saved") {
                      this.refs.saveText.innerText = "saved";
                      this.refs.saveButton.style.opacity = 0.5;
                    } else if(state === "unsaved") {
                      this.refs.saveText.innerText = "save";
                      this.refs.saveButton.style.cursor = "pointer";
                    } else if(state === "error") {
                      this.refs.saveText.innerText = "error";
                      this.refs.saveButton.style.color = "red";
                    } else {
                      console.error("Invalid save state.");
                      this.setSaveState("INVALID!");
                      alert("There was an error while saving :S Please report this at lemmy.world/c/perchance if the problem persists.");
                      //this.saveState = "INVALID!";
                    }
                  };
                
                  this.updateCommunityData = async () => {
                    try {
                      let communityData = await (await fetch("/api/getCommunityData")).json();
                      if(communityData.status !== "success") throw communityData;
                      let data = communityData.data;
                      let str = "";
                      let isMostRecentPost = true;
                      let mostRecentPostTimeAgoStr = "";
                      for(let post of data.posts) {
                        let minsAgo = Math.ceil(post.secondsAgo/60);
                        let timeAgoStr = minsAgo > 60*24 ? Math.round(minsAgo/(60*24))+"d" : minsAgo > 60 ? Math.ceil(minsAgo/60)+"h" : minsAgo+"m";
                        if(isMostRecentPost) mostRecentPostTimeAgoStr = timeAgoStr;
                        str += `• "${post.title}" (${timeAgoStr} ago)\n`;
                        isMostRecentPost = false;
                      }
                      if(data.posts[0]/60 > 60*24) {
                        this.refs.communityNotifications.textContent = "";
                        this.refs.communityNotifications.style.display = "none";
                      } else {
                        this.refs.communityNotifications.textContent = " ("+mostRecentPostTimeAgoStr+")";
                        this.refs.communityNotifications.style.display = "inline-block";
                      }
                      this.refs.communityButton.title = str.trim(); // XSS no possible with setting title but CAREFUL if you change this code
                    } catch(e) {
                      console.error("Failed to update community data.");
                    }
                  };
                
                  this.updateCommunityData();
                  setInterval(this.updateCommunityData, 2*60*1000);
                },
              };
            </script>
          </div>




          <style>
            .cm-editor { height:100%; }
            .cm-cursor { border-left: 2px solid #56b6c2 !important; margin-left:-1px !important; }
            .cm-editor .cm-foldPlaceholder {
              height: 0.5rem;
              padding: 0 0.2rem;
              display: inline-flex;
              align-items: center;
              justify-content: center;
              background: light-dark(#309eff, #0070d3);
              color: light-dark(#e5e5e5, #ddd);
            }
            .cm-editor .cm-button {
              border: revert !important;
              background-image: revert !important;
              border-radius: revert !important;
              background: revert !important;
            }
            .cm-editor .cm-search {
              font-size: 1rem;
            }
            .cm-editor .cm-panel.cm-search label {
              display: inline-flex;
              align-items: center;
              justify-content: center;
              cursor: pointer;
            }
            .cm-editor .cm-panel.cm-search input {
              background-color: revert;
              border: revert;
              padding: 4px;
            }
            .cm-editor .cm-searchMatch.cm-searchMatch-selected {
              background-color: #ff00ff8a;
            }
            .cm-editor .cm-gutter.cm-gutter-lint {
              overflow: visible;
              width: 0;
              position: relative;
              left: -0.85rem;
            }
            .cm-editor .cm-gutter.cm-gutter-lint .cm-activeLineGutter {
              background-color: transparent;
            }
            .cm-editor .cm-gutter.cm-gutter-lint .cm-lint-marker { 
              transform: scale(0.75);
            }
            
            .cm-editor .cm-tooltip-autocomplete li[aria-selected] {
              background-color: light-dark(#a4dbff, #005b98) !important;
              color: light-dark(black, white) !important;
            }
            .cm-editor .cm-tooltip-autocomplete li:not([aria-selected]) {
              opacity: 0.65;
            }
            .cm-editor .cm-gutters {
              user-select: none;
            }

            .cm-search.cm-panel {
              display: flex;
              flex-wrap: wrap;
              gap: 0.25rem;
              font-size:16px;
            }

            .cm-search.cm-panel input[type='checkbox'] { cursor: pointer; }

            /* note: this relies on some js (below) to set these data attr values */
            .cm-search.cm-panel input.cm-textfield[name='search'] { width: 60px !important; }
            .cm-search.cm-panel input.cm-textfield[name='search'][data-last-search-textfield-interacted='1'] { width: 140px !important; }
            .cm-search.cm-panel input.cm-textfield[name='replace'] { width: 60px !important; }
            .cm-search.cm-panel input.cm-textfield[name='replace'][data-last-search-textfield-interacted='1'] { width: 140px !important; }

            .cm-search .cm-button[name='select'] { display:none !important; }

            .cm-search .cm-button[name='next'] { font-size: 0 !important; }
            .cm-search .cm-button[name='next']::before {
              content: "↓";
              font-size: 11.2px;
              padding: 3px 8px;
              display: inline-block;
              font-weight: bold;
            }

            .cm-search .cm-button[name='prev'] { font-size: 0 !important; } 
            .cm-search .cm-button[name='prev']::before {
              content: "↑";
              font-size: 11.2px;
              padding: 3px 8px;
              display: inline-block;
              font-weight: bold;
            }

            .cm-search .cm-button[name='replace'] { font-size: 0 !important; }
            .cm-search .cm-button[name='replace']::before {
              content: '→';
              font-size: 11.2px;
              padding: 3px 8px;
              display: inline-block;
              font-weight: bold;
            }

            .cm-search .cm-button[name='replaceAll'] { font-size: 0 !important; }
            .cm-search .cm-button[name='replaceAll']::before {
              content: 'all';
              font-size: 11.2px;
              padding: 3px 6px;
              display: inline-block;
            }

            .cm-search label:has(input[name='case']) {
              font-size: 0 !important;
              padding: 0 4.5px !important;
              position: relative !important;
              top: 3px !important;
            }
            .cm-search label:has(input[name='case'])::after {
              content: 'case';
              font-size: 8px;
              position: absolute;
              top: -6px;
            }

            .cm-search label:has(input[name='re']) {
              font-size: 0 !important;
              padding: 0 4.5px !important;
              position: relative !important;
              top: 3px !important;
            }
            .cm-search label:has(input[name='re'])::after {
              content: 'regex';
              font-size: 8px;
              position: absolute;
              top: -6px;
            }

            .cm-search label:has(input[name='word']) { display: none !important; }
            /* .cm-search label:has(input[name='word']) { font-size: 0 !important; }
            .cm-search label:has(input[name='word'])::after {
              content: 'word';
              font-size: 11.2px;
              margin-left: 3px;
            } */

            .cm-search .cm-textfield,
            .cm-search label,
            .cm-search .cm-button {
              margin: 0 !important;
            }
          </style>
          <script>
            // check if click is in search field, and if so set data-last-search-textfield-interacted to 1 and set others to 0
            window.addEventListener("click", (e) => {
              if(e.target.className !== "cm-textfield") return;
              let searchPanel = document.querySelector(".cm-search.cm-panel");
              if(!searchPanel.contains(e.target)) return;
              let searchFields = searchPanel.querySelectorAll(".cm-search.cm-panel input.cm-textfield");
              for(let field of searchFields) {
                field.dataset.lastSearchTextfieldInteracted = field === e.target ? "1" : "0";
              }
            });
            // same for typing:
            window.addEventListener("keydown", (e) => {
              if(e.target.className !== "cm-textfield") return;
              let searchPanel = e.target.closest(".cm-search.cm-panel");
              if(!searchPanel) return;
              let searchFields = searchPanel.querySelectorAll(".cm-search.cm-panel input.cm-textfield");
              for(let field of searchFields) {
                field.dataset.lastSearchTextfieldInteracted = field === e.target ? "1" : "0";
              }
            });
            // and same for focusin:
            window.addEventListener("focusin", (e) => {
              if(e.target.className !== "cm-textfield") return;
              let searchPanel = e.target.closest(".cm-search.cm-panel");
              if(!searchPanel) return;
              let searchFields = searchPanel.querySelectorAll(".cm-search.cm-panel input.cm-textfield");
              for(let field of searchFields) {
                field.dataset.lastSearchTextfieldInteracted = field === e.target ? "1" : "0";
              }
            });
          </script>
          
          <!-- fake fields are a workaround for chrome autofill getting the wrong fields -->
          <input style="display: none" type="email" name="fakeusernameremembered">
          <input style="display: none" type="password" name="fakepasswordremembered"> 

          <div id="editorEl" style="width:100%; flex-grow:1; min-height:0;">
            <div id="main" style="height:100%; display:flex; ">
              <div id="a" style="display:none; flex-direction:column;" class="split split-horizontal">
                <!-- MODEL TEXT -->
                <div id="c" style="height:100%;overflow:hidden;position:relative; border-left:none; z-index:2; " class="split content">
                  <!--<div id="customListEditorEl" style="display:none; position:absolute;top:0;left:0;right:0;bottom:0;background:blue;z-index: 100;">
                    <iframe srcdoc="hello world" sandbox="allow-scripts" style="border: none; margin: 0; padding: 0; outline: none; width: 100%; height: 100%;"></iframe>
                  </div>-->
                  <div class="code-editor-buttons-ctn">
                    <div class="toggle-fold-button" data-ref="codeEditorFoldRefButton" onclick="editor.toggleCodeEditorFold()">fold</div>
                    <div class="toggle-wrap-button" data-ref="codeEditorWrapRefButton" onclick="editor.toggleCodeEditorWrap()">wrap</div>
                  </div>
                  <textarea id="input"></textarea>
                  <!-- TODO***: fix the problem where the horizontal scoll bar doesn't show up sometimes -->
                </div>

                <!-- <div class="gutter-row gutter-row-1" style="display:none;"></div> -->

                <!-- CONSOLE -->
                <div id="perchanceConsoleEl" style="display:block; position:relative; overflow: hidden; border-bottom:none; border-left:none;" class="split content">
                  <div style="height:100%; width:100%; display:flex; flex-direction:column;">
                    <input style="position:fixed; opacity:0; pointer-events:none;" type="email" name="topreventchromesbadautofillalgorithm">
                    <input style="position:fixed; opacity:0; pointer-events:none;" type="password" name="topreventchromesbadautofillalgorithm">
                    <input class="console" id="console-input" placeholder="type some text here and press enter" type="text" autocomplete="one-time-code" style="min-height:1.2rem;">
                    <!-- <expanding-textarea style="background: #eee;display:block;" class="console" id="console-input" placeholder="type an expression and press enter" /> -->
                    <iframe class="console" id="console-output" sandbox=""></iframe>
                    <select id="consoleInterpreterOption" style="position:absolute; bottom:4px; right:4px;">
                      <option value="html" selected="">html</option>
                      <option value="plaintext">plain text</option>
                    </select>
                    <style>
                      #perchanceConsoleEl .console {
                        font-size:1em;
                        font-family:inherit;
                        /* position:absolute; */
                        border:none;
                        outline:none;
                        padding:0;
                        margin:0;
                        box-sizing:border-box;
                      }
                      #perchanceConsoleEl #console-input {
                        background: #eee;
                        width:100%;
                        height:20px;
                        padding-left: 0.3em;
                      }

                      #perchanceConsoleEl #console-output {
                        flex-grow: 1;
                        width:100%;
                        /* height:100%; */
                        /* position:absolute; */
                        /* bottom:0; */
                        /* left:0; */
                        /* right:0; */
                        /* top:20px; */
                        border:none;
                      }
                      #e {
                        border-right: none !important;
                        border-top: none !important;
                        height: 100%;
                      }
                      #b {
                        width: 100%;
                      }
                      #output {
                        background: white;
                      }
                      @media (prefers-color-scheme: dark) {
                        #output {
                          background: #121212;
                        }
                      }
                    </style>
                  </div>
                </div>
              </div>

              <!-- <div class="gutter-col gutter-col-1" style="display:none;"></div>  -->
          
              <div id="b" class="split split-horizontal" style="display:flex; flex-direction:column;">
                <!-- OUTPUT -->
                <div id="e" style="overflow:hidden; position:initial; display:flex; flex-direction:column; border:none;" class="split content">
                  <!-- WARNING: don't change the ID of this `output` element - there is code that relies on it (e.g. ad refresh focus bug fix stuff) -->
                  <div id="output" style="border-top:none; position:relative;">
                    
                    <div id="outputLoadSpinner" style="display:none; pointer-events:none; position:absolute; top:0; right:0; bottom:0; left:0; justify-content:center; align-items:center;"><div class="ldspmzjfhueifssge-ring"><div></div><div></div><div></div><div></div></div></div>
                    <script>
                      setTimeout(() => {
                        if(!window.perchanceOutputIframeFinishedFirstLoad) document.querySelector("#outputLoadSpinner").style.display = "flex";
                      }, 1500);
                      window.onNextOutputIframeReloadHandlers = [];
                      window.addEventListener("message", async (e) => {
                        let origin = e.origin || e.originalEvent.origin;
                        if(origin !== "https://null.perchance.org" && origin !== `https://${window.generatorPublicId}.perchance.org`) return;

                        if(e.data.type === "finishedLoading" || e.data.type === "failedToLoadDueToGeneratorErrors") {
                          window.perchanceOutputIframeFinishedFirstLoad = true;
                          document.querySelector("#outputLoadSpinner").style.display = "none";
                          for(let fn of window.onNextOutputIframeReloadHandlers) {
                            try { fn(); } catch(e) { console.error(e); }
                          }
                          window.onNextOutputIframeReloadHandlers = [];
                        }

                        if(e.data.type === "ensureEditorIsLoaded75383748") {
                          if(!/^#edit($|:)/.test(window.location.hash)) {
                            let tmp = window.hasBeenInEditModeAtLeastOnce;
                            await app.goToEditMode();
                            app.goToViewMode();
                            window.hasBeenInEditModeAtLeastOnce = tmp;
                          }
                          outputIframeEl.contentWindow.postMessage({type:"ensureEditorIsLoaded75383748_response"}, "*");
                        }
                      });
                    </script>
                    <iframe id="outputIframeEl" src="https://908f97c38727bb4c12a5ef1d46671625.perchance.org/zahid-aistudio?__generatorLastEditTime=1752514310282" fetchpriority="high" style="user-select:none;" allowfullscreen="" webkitallowfullscreen="" mozallowfullscreen="" allow="fullscreen; clipboard-write; display-capture; camera; microphone; bluetooth; ambient-light-sensor; accelerometer; encrypted-media; gamepad; geolocation; gyroscope; hid; idle-detection; magnetometer; midi; picture-in-picture; screen-wake-lock; serial; speaker-selection; usb; web-share; window-management; xr-spatial-tracking" sandbox="allow-popups allow-popups-to-escape-sandbox allow-forms allow-scripts allow-same-origin allow-top-navigation-by-user-activation allow-modals allow-downloads allow-pointer-lock allow-orientation-lock"></iframe>
                    <script>
                      // Must add query string to iframe if it has one, since generator code may rely on that:
                      {
                        let url = document.querySelector("#outputIframeEl").src;
                        let different = false;
                        if(window.location.search) {
                          if(url.includes("?")) url += "&"+window.location.search.slice(1);
                          else url += "?"+window.location.search.slice(1);
                          different = true;
                        }
                        if(window.location.hash) {
                          let hash = window.location.hash;
                          if(/^#edit($|:)/.test(hash)) hash = hash.split(":")[0]; // don't send e.g. collab key to iframe
                          url += hash;
                          different = true;
                        }
                        if(different) {
                          document.querySelector("#outputIframeEl").src = url;
                        }
                      }
                      {
                        const outputIframeEl = document.querySelector("#outputIframeEl");
                        
                        const originalLocationHash = window.location.hash;
                        window.addEventListener("hashchange", () => {
                          console.debug("hashchange event:", window.location.hash);
                          let hash = window.location.hash; 
                          if(/^#edit($|:)/.test(window.location.hash)) hash = "#edit"; // don't pass collab key and stuff to iframe
                          outputIframeEl.contentWindow.postMessage({type:"changeHash", hash}, "*");
                        });
                        
                        window.firstIframePageInteractionPromise = new Promise(r => window.firstIframePageInteractionResolver=r);
                        
                        window.addEventListener("message", async (e) => {
                          if(e.source !== outputIframeEl.contentWindow) return;
                          if(e.origin !== `https://${window.generatorPublicId}.perchance.org`) return;
                          
                          // If iframe hash changes, change the top-level hash too
                          if(e.data.type === "changeHash") { 
                            let newHash = e.data.hash;
                            if(typeof newHash !== "string") return;
                            if(/^#edit($|:)/.test(e.data.hash) && /^#edit($|:)/.test(window.location.hash)) return;
                            
                            // Restore original #edit hash if iframe tries to change it back to #edit hash:
                            if(/^#edit($|:)/.test(newHash)) newHash = /^#edit($|:)/.test(originalLocationHash) ? originalLocationHash : "#edit";
                            
                            console.debug("changeHash message:", `e.data.hash=${e.data.hash}  newHash=${newHash}  window.location.hash=${window.location.hash}`);
                            
                            if(window.location.hash !== newHash) { // to prevent possible infinite loops
                              window.location.hash = newHash;
                            }
                          }

                          // Respond to replaceState (*without* allowing path change):
                          if(e.data.type === "changeUrl") {
                            if(typeof e.data.search !== "string" || typeof e.data.hash !== "string") return;
                            history.replaceState({}, "", window.location.pathname+e.data.search+e.data.hash);
                          }

                          if(e.data.type === "changePageTitle") {
                            document.title = e.data.pageTitle;
                          }

                          if(e.data.type === "firstPageInteraction") {
                            window.firstIframePageInteractionResolver();
                          }
                          
                          if(e.data.type === "changeFavicon") {
                            if(typeof e.data.href !== "string") return;
                            if(navigator.webdriver) return;

                            await window.metaDataIsLoadedPromise;
                            if(window.forceDisableAds) await window.firstIframePageInteractionPromise; // require page interaction first

                            document.querySelectorAll("link[rel~='icon']").forEach(el => el.remove());
                            let link = document.createElement('link');
                            link.rel = 'icon';
                            document.head.appendChild(link);
                            link.href = e.data.href || "/favicon-32x32-white-bg.png";
                          }
                        });
                      }
                    </script> 
                  </div>
                  <div id="output-buttons-ctn" style="display:none; padding: 4px; box-sizing:border-box; background: #e9e9e9;">
                    <button onclick="app.goToViewMode()" style="float:left; height:100%;">⇱︎ fullscreen</button>
                    <button data-ref="warningsModalOpenButton" onclick="editor.openWarningsModal()" style="float:left; height:100%; background:#ffd97c; margin-left: 4px; color:black; border:1px solid rgb(255 175 21); display:none;">⚠︎ warnings</button>
                    <button onclick="editor.handleReloadButtonClick()" style="float:right; height:100%;" title="FULL reload (Ctrl+R / Cmd+R)">⟳︎ reload</button>
                    <span title="Toggle partial 'in-place' reloads on each edit. Variables will *not* be cleared. Use the reload button for a 'full' refresh." style="display:inline-block; float:right; background-color:#d5d5d5; padding:4px; margin-right:4px;height: 100%;box-sizing: border-box; cursor:pointer; display: flex; align-items: center; justify-content: center; user-select:none;" onclick="if(event.target !== autoReloadCheckboxEl) autoReloadCheckboxEl.checked=!autoReloadCheckboxEl.checked, updateToggleOutputAutoReloadOnEdits();"><input id="autoReloadCheckboxEl" data-ref="autoReloadCheckbox" style="" type="checkbox" onclick="updateToggleOutputAutoReloadOnEdits()">&nbsp;auto</span>
                  </div>
                </div>

                <!-- <div class="gutter-row gutter-row-2" style="display:none;"></div> -->

                <!-- OUTPUT TEXT/TEMPLATE -->
                <div id="f" style="height:100%;overflow:hidden;position:relative; display:none; border-right:none; border-bottom:none;" class="split content">
                  <button id="showAiHelperBtn" style="right: 5px; bottom: 5px; position: absolute; z-index: 10; font-size: 70%; padding: 0 0.1rem; line-height: 1.6;" onclick="this.hidden=true; aiHelperCtn.hidden=false; localStorage.aiHelperCtnHidden='';" hidden="">✨</button>
                  <div id="aiHelperCtn" style="display: flex; flex-direction: column; right: 5px; bottom: 5px; width: max-content; position:fixed; z-index: 100; gap: 0.125rem; padding: 0.25rem; border-radius: 3px; min-width: 200px; min-height: 80px;">
                    <div id="aiHelperFeedbackBtn" style="position:absolute;top:0;width:100%;left:0;right:0;height: 0;">
                      <button onclick="window.open('https://perchance.org/ai-coding-helper-feedback')" style="position:absolute; bottom:0.25rem; font-size:70%; right:0.25rem; margin:0; padding:0 0.125rem;">❓</button>
                    </div>
                    <div id="aiHelperCloseBtnCtn" style="position:absolute;top:0;left: 0;width:0;height:0;display:flex;align-items:center;justify-content:center; z-index:10;"><div onpointerdown="aiHelperCtn.hidden=true; showAiHelperBtn.hidden=false; localStorage.aiHelperCtnHidden=1" style="cursor:pointer; background:white; background:light-dark(white, black); color:black; color:light-dark(black, #bababa); border-radius:100%; border:1px solid light-dark(black, #bababa); min-width:1rem; min-height:1rem; display:flex; align-items:center; justify-content:center;"><svg width="10" height="10" viewBox="0 0 24 24"><path d="M6 6l12 12M6 18L18 6" stroke="currentColor" stroke-width="4" stroke-linecap="round"></path></svg></div></div>
                    <select id="aiHelpTypeSelect" onchange="aiHelperSubmitBtn.textContent=this.selectedOptions[0].dataset.submitText;" style="min-height: 1.5rem;">
                      <option value="edit" data-submit-text="🛠️ adjust">𝗲𝗱𝗶𝘁 the existing code</option>
                      <option value="new" data-submit-text="✨ create">write new code (𝘀𝘁𝗮𝗿𝘁 𝗳𝗿𝗲𝘀𝗵)</option>
                      <!-- <option value="question" data-submit-text="✨ ask">ask a question about the code</option> -->
                    </select>
                    <textarea id="aiHelperInputEl" placeholder="Create a simple snake game" style="font-size:85%;flex-grow:1;min-width: 200px;"></textarea>
                    <div style="display:flex; gap:0.25rem;">
                      <button hidden="" style="height:min-content;" id="aiHelperRedoBtn">⏩ redo</button>
                      <button hidden="" style="height:min-content;" id="aiHelperUndoBtn">🔙 undo</button>
                      <button style="height:min-content; flex-grow:1;" id="aiHelperSubmitBtn" onclick="executeAiHelper()">🛠️ adjust</button>
                    </div>
                  </div> 
                  <script>                    
                    (async function() {

                      async function compressText(str) {
                        const src = new Blob([str]).stream();
                        const gzStream = src.pipeThrough(new CompressionStream('gzip'));
                        const buf = await new Response(gzStream).arrayBuffer();
                        return btoa(String.fromCharCode(...new Uint8Array(buf)));
                      }
                      async function decompressText(b64) {
                        const bin = atob(b64);
                        const bytes = Uint8Array.from(bin, ch => ch.charCodeAt(0));
                        const src = new Blob([bytes]).stream();
                        const txt = await new Response(src.pipeThrough(new DecompressionStream('gzip'))).text();
                        return txt;
                      }
                      
                      let debounceTimeout;
                      aiHelperInputEl.addEventListener("input", function() {
                        clearTimeout(debounceTimeout);
                        debounceTimeout = setTimeout(async () => {
                          if(aiHelperInputEl.value.trim()) {
                            let instruction = await compressText(aiHelperInputEl.value.slice(0, 50000));
                            await kv.aiHelperInstructions.set(window.generatorName, {time:Date.now(), instruction});
                          } else {
                            await kv.aiHelperInstructions.delete(window.generatorName);
                          }
                        }, 1000);
                      });

                      // Clear very old instructions:
                      setTimeout(async () => {
                        const cutoffTime = Date.now() - 2*365*24*60*60*1000;
                        let entries = await kv.aiHelperInstructions.entries();
                        for(let [generatorName, data] of entries) {
                          try {
                            if(data.time < cutoffTime) await kv.aiHelperInstructions.delete(generatorName);
                          } catch {
                            await kv.aiHelperInstructions.delete(generatorName);
                          }
                        }
                      }, 1000*60*5);

                      let data = await kv.aiHelperInstructions.get(window.generatorName)
                      if(data) {
                        aiHelperInputEl.value = await decompressText(data.instruction);
                      }
                    })();
                  </script>
                  <style>
                    #aiHelperCtn {
                      background: #e0e0e0;
                    }
                    @media (prefers-color-scheme: dark) { 
                      #aiHelperCtn {
                        background: rgb(32, 32, 32);
                      }
                    }
                    @keyframes rotate {
                      to { transform: rotate(360deg); }
                    }

                    .cm-editor .cm-highlight-change {
                      background: #d3ed8b;
                    }
                    @media (prefers-color-scheme: dark) { 
                      .cm-editor .cm-highlight-change {
                        background: #495232;
                      }
                    }
                    .cm-panel.cm-panel-lint ul {
                      background-color: transparent !important;
                    }
                    
                    .CodeMirror .cm-highlight-change {
                      background: #d3ed8b;
                    }
                    @media (prefers-color-scheme: dark) { 
                      .CodeMirror .cm-highlight-change {
                        background: #495232;
                      }
                    }
                  </style>
                  <script>
                    if(localStorage.aiHelperCtnHidden) {
                      aiHelperCtn.hidden = true;
                      showAiHelperBtn.hidden = false;
                    } else {
                      aiHelperCtn.hidden = false;
                      showAiHelperBtn.hidden = true;
                    }

                    function getChangeHighlightMarks(original, updated) {
                      const diff = Diff.diffLines(original, updated);
                      const markers = [];
                      let lineNumber = 0;
                      diff.forEach((part) => {
                        const lines = part.value.split('\n');
                        if (part.added) {
                          lines.forEach((line, index) => {
                            if(line.length > 0 || index < lines.length - 1) {
                              markers.push({
                                from: { line: lineNumber, ch: 0 },
                                to: { line: lineNumber, ch: line.length },
                                className: 'cm-highlight-change'
                              });
                              lineNumber++;
                            }
                          });
                        } else if(!part.removed) {
                          lineNumber += lines.length - 1;
                          if (lines[lines.length - 1].length > 0) lineNumber++; 
                        }
                      });
                      return markers;
                    }
                    function clearChangeHighlightMarks() {
                      if(window.outputTemplateEditor._clearMarks) { 
                        window.outputTemplateEditor._clearMarks();
                      } else {
                        window.outputTemplateEditor.getAllMarks().forEach(mark => {
                          if(mark.className === 'cm-highlight-add' || mark.className === 'cm-highlight-change') {
                            mark.clear();
                          }
                        });
                      }
                    }
                    
                    async function executeAiHelper() {
                      let type = aiHelpTypeSelect.value;
                      let instruction = aiHelperInputEl.value; 
                      if(!instruction) return;

                      if(autoReloadCheckboxEl.checked) {
                        autoReloadCheckboxEl.checked = false;
                        updateToggleOutputAutoReloadOnEdits();
                      }

                      const submitButtonOriginalText = aiHelperSubmitBtn.textContent;
                      aiHelperSubmitBtn.innerHTML = `⏳ thinking…`;
                      let patienceLabelTimeout = setTimeout(() => {
                        aiHelperSubmitBtn.innerHTML = `⏳ (may take 10+ mins)`;
                      }, 2*60*1000);

                      aiHelperSubmitBtn.disabled = true;
                      aiHelpTypeSelect.disabled = true;

                      aiHelperUndoBtn.hidden = true;
                      aiHelperRedoBtn.hidden = true; 
                      
                      let requestId = Math.random().toString()+Math.random().toString() + "-" + (window.aiHelperRequestIdSuffix || ""); 
                      let data;
                      for(let i = 0; i < 12; i++) {
                        data = await fetch(`/api/aiHelper`, {
                          signal: window.AbortSignal?.timeout?.(5*60*1000),
                          method: "POST",
                          headers: { "Content-Type": "application/json" },
                          body: JSON.stringify({requestId, type, generatorName:window.generatorName, instruction, modelText:window.modelTextEditor.getValue(), outputTemplateText:window.outputTemplateEditor.getValue()}),
                        }).then(r => r.json()).catch(e => ({error:true, status:e.message}));
                        if(!data.error) break;
                      }

                      clearTimeout(patienceLabelTimeout);
                      aiHelperSubmitBtn.disabled = false;
                      aiHelpTypeSelect.disabled = false;
                      aiHelperSubmitBtn.textContent = submitButtonOriginalText;

                      if(data.status !== "success") {
                        alert(`Sorry, there was an error with the AI helper: ${data.status}${data.status === "too-many-requests" ? " (could be caused by VPN)" : ""}`);
                        return;
                      }

                      window.outputTemplateEditorBeforeAiHelper = window.outputTemplateEditor.getValue();
                      window.modelTextEditorBeforeAiHelper = window.modelTextEditor.getValue();

                      if(type === "new" || type === "edit") {
                        window.outputTemplateEditor.setValue(data.outputTemplateText); 

                        if(data.outputTemplateText.includes("commentsPlugin(") && !/commentsPlugin *= *\{import:comments-plugin\}/.test(window.modelTextEditor.getValue())) window.modelTextEditor.setValue(`commentsPlugin = {import:comments-plugin}\n${window.modelTextEditor.getValue()}`);
                        if(data.outputTemplateText.includes("generateImage(") && !/generateImage *= *\{import:text-to-image-plugin\}/.test(window.modelTextEditor.getValue())) window.modelTextEditor.setValue(`generateImage = {import:text-to-image-plugin}\n${window.modelTextEditor.getValue()}`);
                        if(data.outputTemplateText.includes("generateText(") && !/generateText *= *\{import:ai-text-plugin\}/.test(window.modelTextEditor.getValue())) window.modelTextEditor.setValue(`generateText = {import:ai-text-plugin}\n${window.modelTextEditor.getValue()}`);
                        if(data.outputTemplateText.includes("superFetch(") && !/superFetch *= *\{import:super-fetch-plugin\}/.test(window.modelTextEditor.getValue())) window.modelTextEditor.setValue(`superFetch = {import:super-fetch-plugin}\n${window.modelTextEditor.getValue()}`);
                        if(data.outputTemplateText.includes("uploadPlugin(") && !/uploadPlugin *= *\{import:upload-plugin\}/.test(window.modelTextEditor.getValue())) window.modelTextEditor.setValue(`uploadPlugin = {import:upload-plugin}\n${window.modelTextEditor.getValue()}`);
                        if(data.outputTemplateText.includes("secretPlugin(") && !/secretPlugin *= *\{import:secret-plugin\}/.test(window.modelTextEditor.getValue())) window.modelTextEditor.setValue(`secretPlugin = {import:secret-plugin}\n${window.modelTextEditor.getValue()}`);
                        if(/(\b|root\.)kv\./.test(data.outputTemplateText) && !/kv *= *\{import:kv-plugin\}/.test(window.modelTextEditor.getValue())) window.modelTextEditor.setValue(`kv = {import:kv-plugin}\n${window.modelTextEditor.getValue()}`);
                        
                        // check if we can remove generateImage and/or generateText imports:
                        let currentOutputTemplateText = window.outputTemplateEditor.getValue();
                        if(!currentOutputTemplateText.includes("generateImage(") && !window.modelTextEditor.getValue().replace(/generateImage *= *\{import:text-to-image-plugin\}/g, "").includes("generateImage(")) {
                          window.modelTextEditor.setValue(window.modelTextEditor.getValue().replace(/generateImage *= *\{import:text-to-image-plugin\}/g, ""));
                        }
                        if(!currentOutputTemplateText.includes("generateText(") && !window.modelTextEditor.getValue().replace(/generateText *= *\{import:ai-text-plugin\}/g, "").includes("generateText(")) {
                          window.modelTextEditor.setValue(window.modelTextEditor.getValue().replace(/generateText *= *\{import:ai-text-plugin\}/g, ""));
                        }

                        window.outputTemplateEditorAfterAiHelper = window.outputTemplateEditor.getValue();
                        window.modelTextEditorAfterAiHelper = window.modelTextEditor.getValue();

                        if(type === "edit") {
                          if(!window.Diff) {
                            let script = document.createElement('script');
                            script.src = "https://cdn.jsdelivr.net/npm/diff@7.0.0/dist/diff.min.js";
                            document.body.appendChild(script);
                            while(!window.Diff) await new Promise(r => setTimeout(r, 200));
                          }
                          if(!window.addedHighlightChangeStuff84783) {
                            window.addedHighlightChangeStuff84783 = true;
                            window.outputTemplateEditor.on('change', (instance, changeObj) => {
                              clearChangeHighlightMarks();
                            });
                          }
                          clearChangeHighlightMarks(); 
                          let markers = getChangeHighlightMarks(window.outputTemplateEditorBeforeAiHelper, window.outputTemplateEditorAfterAiHelper);
                          markers.forEach(marker => {
                            window.outputTemplateEditor._markText(marker.from, marker.to, { className: marker.className });
                          });
                        }

                        editor.handleReloadButtonClick();
                        aiHelperUndoBtn.hidden = false;
                        aiHelperUndoBtn.onclick = function() {
                          clearChangeHighlightMarks();

                          let originalOutputTemplateScrollPos = window.outputTemplateEditor.scrollDOM.scrollTop;
                          let originalModelTextScrollPos = window.modelTextEditor.scrollDOM.scrollTop;

                          window.outputTemplateEditor.setValue(window.outputTemplateEditorBeforeAiHelper);
                          window.modelTextEditor.setValue(window.modelTextEditorBeforeAiHelper);

                          setTimeout(() => {
                            window.outputTemplateEditor.scrollDOM.scrollTop = originalOutputTemplateScrollPos;
                            window.modelTextEditor.scrollDOM.scrollTop = originalModelTextScrollPos;
                          }, 0);

                          editor.handleReloadButtonClick();
                          aiHelperUndoBtn.hidden = true;
                          aiHelperRedoBtn.hidden = false;
                        };
                        aiHelperRedoBtn.onclick = function() {

                          let originalOutputTemplateScrollPos = window.outputTemplateEditor.scrollDOM.scrollTop;
                          let originalModelTextScrollPos = window.modelTextEditor.scrollDOM.scrollTop;

                          window.outputTemplateEditor.setValue(window.outputTemplateEditorAfterAiHelper);
                          window.modelTextEditor.setValue(window.modelTextEditorAfterAiHelper);

                          setTimeout(() => {
                            window.outputTemplateEditor.scrollDOM.scrollTop = originalOutputTemplateScrollPos;
                            window.modelTextEditor.scrollDOM.scrollTop = originalModelTextScrollPos;
                          }, 0);

                          editor.handleReloadButtonClick();
                          aiHelperUndoBtn.hidden = false;
                          aiHelperRedoBtn.hidden = true;
                          if(type === "edit") {
                            clearChangeHighlightMarks();
                            let markers = getChangeHighlightMarks(window.outputTemplateEditorBeforeAiHelper, window.outputTemplateEditorAfterAiHelper);
                            markers.forEach(marker => {
                              window.outputTemplateEditor._markText(marker.from, marker.to, { className: marker.className });
                            });
                          }
                        };
                      } else if(type === "question") {
                        // TODO
                      }
                    }
                    window.addEventListener("pointerdown", (e) => {
                      if(e.target.closest("#aiHelpTypeSelect") || e.target.closest("#aiHelperCloseBtnCtn")) return;
                      if(e.target.closest("#aiHelperUndoBtn") || e.target.closest("#aiHelperRedoBtn")) return;
                      if(e.target.closest("#aiHelperFeedbackBtn")) return;
                      if(e.target.closest("#aiHelperCtn")) { aiHelperCtn.style.minWidth='300px'; aiHelperCtn.style.minHeight='200px'; }
                      else { aiHelperCtn.style.minWidth='200px'; aiHelperCtn.style.minHeight='80px'; }
                    });
                    {
                      let aiHelpTypeToExamples = {
                        new: ["Create a simple snake game", "Create a cute profile page with 3 tabs. One for 'about me', one for 'links' and one for 'feedback' with a comments box. Add some kaomojis and pastel colors. Actually also add a 4th tab with a grid of toggleable checkboxes.", "Make an infinite scroller of AI generated images, with the old ones at the top being deleted as you scroll down far enough.", "create a simple centered template with a button which increments a counter", "make a wizard themed geocities homepage for me", "make a space invaders game using emojis"],
                        edit: ["it says there is a 'invalid array length' error. pls fix. here's the full error message: [...]", "make it look nicer", "make it look better on smaller screens (like mobile phones)", "the button isn't centered properly. fix pls", "Make the button bigger and add a blue gradient background", "Make all the text on the page wobble around", "Add more code comments so I can understand everything better", "Add a loading thing to show when the images are loading", "make it more interesting and complex", "make it more silly", "if it's june, make it rain transparent rainbow emojis on the page (and also add a little button to trigger it even if it's not june)", "Use this image as the background but blur it slightly: https://example.com/image.jpg", "reduce the number of lines of code", "add an optional dark mode"],
                        question: ["How does the code in the getPosition function work?", "What does display:flex do? How does it work?", "How can I make the background gradient change depending on the mouse position?"],
                      };
                      let i = 0;
                      setInterval(() => {
                        if(document.querySelector("#aiHelperInputEl").offsetHeight === 0) return;
                        let examples = aiHelpTypeToExamples[document.querySelector("#aiHelpTypeSelect").value];
                        i++;
                        if(i > examples.length-1) i = 0;
                        aiHelperInputEl.placeholder = examples[i];
                      }, 3000);
                    }
                  </script>
                  <div class="toggle-wrap-button-html" data-ref="outputEditorWrapRefButton" onclick="editor.toggleOutputEditorWrap()">wrap</div>
                  <textarea id="template"></textarea>
                </div>
              </div>
            </div>
          
            <div class="warningsModal" data-ref="warningsModal" style="display:none;">
              <div style="z-index:50;" class="background" onclick="editor.closeWarningsModal()"></div>
              <div style="z-index:51;" class="outer-wrapper" onclick="editor.handleWarningsModalOuterWrapperClick(event)">
                <div data-ref="warningsModalContentWrapper" class="content-wrapper">
                  <div class="view">
                    <div class="modal-body" style="max-height: 500px; overflow-y: auto;">
                      <div style="padding: 1rem; background: #eaeaea;"><span style="opacity:0.5;">The items listed below aren't errors - they're just "warnings". Perchance generates "warnings" when it detects code in your editor panel that looks like it may be a mistake, but which is technically not "erroneous" - that is, it's valid Perchance syntax, but it's "unusual" code and so might have been an accident on your part. Feel free to ignore these warnings if you know what you're doing! ꒰•ᴗ•꒱</span></div>
                      <div data-ref="warningsWrapper" style="padding-bottom: 1rem;"></div>
                    </div>
                    <div class="modal-footer">
                      <button style="width:100%;" onclick="editor.closeWarningsModal()">close</button>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <script>
              window.editor = {
                root: document.querySelector("#editorEl"),
                refs: new Proxy({}, {
                  get(target, prop, receiver) {
                    return document.querySelector(`#editorEl [data-ref='${prop}']`);
                  },
                }),
                init: async function({startInEditMode}={}) {
                  if(this.alreadyInited) return;
                  this.alreadyInited = true;

                  document.querySelector("#editorEl #input").value = app.data.generator.modelText;
                  document.querySelector("#editorEl #template").value = app.data.generator.outputTemplate;

                  this.updateOutputDelayTimeout = null;
                  this.evaluateTextResolveMap = {};
                  this.outputIframe = null;

                  this.autoReload = JSON.parse( localStorage.getItem("editor-auto-reload") );
                  if(this.autoReload === null) {
                    this.autoReload = true; // defaults to true
                    localStorage.setItem("editor-auto-reload", this.autoReload);
                  }

                  window.updateToggleOutputAutoReloadOnEdits = () => {
                    if(autoReloadCheckboxEl.checked) {
                      this.autoReload = true;
                      this.updateOutput({fullRefresh:false, removeUnfoundDeps:true});
                    } else {
                      this.autoReload = false;
                    }
                    localStorage.setItem("editor-auto-reload", this.autoReload);
                  }

                  document.addEventListener('keydown', function(event) {
                    if(event.ctrlKey || event.metaKey) {
                      if(event.key === 'r') {
                        if(window.currentInterfaceMode === "edit") {
                          event.preventDefault();
                          editor.handleReloadButtonClick();
                        }
                      }
                    }
                  });

                  let lastReloadButtonClickTime = 0;
                  this.handleReloadButtonClick = (e) => {
                    outputLoadSpinner.style.backgroundColor = "rgba(255,255,255,0.3)";
                    if(Date.now()-lastReloadButtonClickTime > 500) {
                      lastReloadButtonClickTime = Date.now();
                      window.onNextOutputIframeReloadHandlers.push(function() {
                        outputIframeEl.contentWindow.postMessage({type:"__triggerPageFocus8573946292"}, "*"); // for cases where e.g. the iframe requires focus for keyboard events (like arrow keys in a game)
                      });
                      window.triggerFocusOnNextIframeLoad = true; // for cases where e.g. the iframe requires focus for keyboard events (like arrow keys in a game)
                      this.updateOutput({fullRefresh:true, removeUnfoundDeps:true});
                    }

                    // NOTE: The below if/else is no longer needed due to the `__initWithDataFromParentWindow=1` stuff I'm now doing - i.e. the reload button tells the iframe to not use the data that is send along with the html file, and instead request the data from the parent during init.
                    // if(window.perchanceSaveState === "saved" || !window.editsHaveBeenMadeSincePageLoad) {
                    //   this.updateOutput({fullRefresh:true, removeUnfoundDeps:true});
                    // } else {
                    //   alert("To initiate a \"hard-reload\" you need to first save your generator. Please click save and then try again. Alternatively, you can reload the whole browser page using your browser's reload button, but this will discard your changes.");
                    // }
                  }

                  // function getScrollBarWidth() {
                  //   let el = document.createElement("div");
                  //   el.innerHTML = "\n".repeat(50)
                  //   el.style.cssText = "position:absolute; overflow:scroll; width:30px; height:30px;";
                  //   document.body.appendChild(el);
                  //   let scrollBarWidth = el.offsetWidth - el.clientWidth;
                  //   el.remove();
                  //   return scrollBarWidth;
                  // }
                  
                  // let scrollBarWidth = getScrollBarWidth();
                  // document.querySelectorAll(".toggle-wrap-button").forEach(el => {
                  //   el.style.
                  // });

                  let eSplitLastHeight = null;
                  this.switchToViewMode = () => {

                    document.querySelectorAll(".function-popup").forEach(el => el.style.display = "none"); // hide any open function popups

                    window.currentInterfaceMode = "view";
                    this.root.querySelector("#e").style.position = "initial";
                    this.root.querySelector("#e").style.border = "none";

                    // so we can recover it if they open the editor again:
                    eSplitLastHeight = this.root.querySelector("#e").style.maxHeight; 
                    this.root.querySelector("#e").style.minHeight = "";
                    this.root.querySelector("#e").style.maxHeight = "";

                    this.root.querySelector("#output-buttons-ctn").style.display = "none";
                    let output = this.root.querySelector("#output");
                    let systemIsInDarkMode = !!(window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches);
                    
                    // output.style.position = "absolute";

                    menuBarEl.style.borderBottom = "";
                    output.style.borderTop = "none";

                    if(systemIsInDarkMode) {
                      
                    } else {
                      output.querySelector("iframe").style.background = "white";
                      output.style.background = "white";
                    }
                    // output.style.height = "initial";
                    // output.style.borderLeft = "";
                    // output.style.borderRight = "";
                    // output.style.borderBottom = "none";

                    // if(window.shouldAddOutputBorderBottomInViewMode) {
                    //   document.querySelector("#editorEl #output").style.borderBottom = "";
                    // }

                    // need these because otherwise for some reason there's some weird `overscroll-behaviour` stuff near the edges of the screen (even with touch-action:none overlay workaround).
                    this.root.querySelectorAll("#main .gutter").forEach(el => el.style.display="none");
                    this.root.querySelector("#a").style.display = "none";
                    this.root.querySelector("#f").style.display = "none";
                  }
                  
                  this.alreadyInited = false; 
                  this.switchToEditMode = () => {

                    document.querySelectorAll(".function-popup").forEach(el => el.style.display = ""); // show any open function popups

                    window.hasBeenInEditModeAtLeastOnce = true; 
                    window.currentInterfaceMode = "edit";
                    let systemIsInDarkMode = !!(window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches);

                    this.root.querySelector("#e").style.position = "relative";
                    this.root.querySelector("#e").style.border = "";

                    // recover last height/width:
                    if(eSplitLastHeight) {
                      this.root.querySelector("#e").style.minHeight = eSplitLastHeight;
                      this.root.querySelector("#e").style.maxHeight = eSplitLastHeight;
                    }

                    this.root.querySelector("#output-buttons-ctn").style.display = "";
                    let output = this.root.querySelector("#output");
                    output.style.position = "relative";

                    menuBarEl.style.display = "flex";
                    minimalModeMenuBtn.style.display = "none";

                    menuBarEl.style.borderBottom = "none";
                    output.style.borderTop = "";

                    if(systemIsInDarkMode) {
                      // output.style.borderTop = "1px solid #575757";
                    } else {
                      // output.style.borderTop = "1px solid #C0C0C0";
                    }
                    // output.style.top = "0px";
                    // output.style.bottom = "35px";
                    // output.style.border = "none";
                    //output.style.height = "100%";
                    // output.style.borderLeft = "none";
                    // output.style.borderRight = "none";
                    // output.style.borderBottom = "";

                    // need these because otherwise for some reason there's some weird `overscroll-behaviour` stuff near the edges of the screen (even with touch-action:none overlay workaround).
                    this.root.querySelectorAll("#main .gutter").forEach(el => el.style.display="");
                    this.root.querySelector("#a").style.display = "flex";
                    this.root.querySelector("#f").style.display = "flex";

                    if(!window.TEST_NEW_EDITOR_1) {
                      setTimeout(() => {
                        this.modelTextEditor.refresh();
                        this.outputTemplateEditor.refresh();
                      }, 10); 
                    }
                  }

                  this.openWarningsModal = function() {
                    this.refs.warningsModal.style.display = "block";
                  }
                  this.handleWarningsModalOuterWrapperClick = function(e) {
                    if(!this.refs.warningsModalContentWrapper.contains(e.target)) {
                      this.closeWarningsModal();
                    }
                  }
                  this.closeWarningsModal = function() {
                    this.refs.warningsModal.style.display = "none";
                  }

                  window.receivedIframeSelfReloadingResponses = {};

                  window.outputIframeHardReloadFinishedResolvers = [];
                  window.currentlyReloadingOutputIframePromise = null;
                  window.hardReloadOutputIframe = async () => { // must use arrow function for correct `this`
                    await window.currentlyReloadingOutputIframePromise; // wait for existing reload to finish if there is one

                    window.currentlyReloadingOutputIframePromise = new Promise(r => window.outputIframeHardReloadFinishedResolvers.push(r)); // (EDIT: the comment that follows this parenthetical is i think patched by just waiting for the previous promise, as I'm now doing above) this isn't actually ideal because if there are multiple concurrent calls then the first one that loads will resolve all of them, even if that "load" is actually "stale" (i.e. using older code). But it shouldn't be a problem "in practice". It'll hopefully do for now.
                    this.updateOutput({fullRefresh:true, removeUnfoundDeps:true});
                    await window.currentlyReloadingOutputIframePromise;
                  };

                  window.mostRecentFullRefreshUpdateDependenciesPromise = Promise.resolve();
                  this.updateOutput = async ({fullRefresh, removeUnfoundDeps, checkForNewDeps=true}={}) => {
                    let iframe = this.root.querySelector("#output iframe");
                    this.outputIframe = iframe;

                    if(removeUnfoundDeps) {
                      app.data.dependencies = app.data.dependencies.filter(d => d.found !== false);
                    }

                    if(fullRefresh) {
                      outputLoadSpinner.style.display = "flex";

                      // Note that we check *all dependencies*, not just direct imports/children of this generator, since any descendent may have been updated.
                      let depNames = app.data.dependencies.map(d => d.name);

                      // we await this in the `requestOutputUpdate` event (from iframe) handling so it can load in parallel with iframe reload for __initWithDataFromParentWindow stuff.
                      if(checkForNewDeps) {
                        window.mostRecentFullRefreshUpdateDependenciesPromise = this.updateDependencies(depNames, {checkForUpdatesToDepsWeAlreadyHave:true});
                      } else {
                        // leave it set to the last promise rather than e.g. Promise.resolve() because that allows other code to wait for last check to finish
                      }

                      iframe.onload = () => {
                        // previously thought we didn't need this request anymore because we embed the data in the loaded iframe,
                        // BUT WE STILL NEED IT for when they click the reload button but they haven't saved their changes to the server.
                        // the server can only render the the document with the data that it has.
                        // EDIT: I've commented this out because now I just tell them that they need to save before doing a "hard" reload. The
                        //       previous approach was causing script tags to be doubly-executed which caused all sorts of troubles (e.g. p5.js creating 2 "setup" canvases).
                        //this.updateOutputRequest();
                      }
                      if(false && window.location.hostname === "app.dev") { // "false &&" to disable this for now
                        iframe.src = "http://null.app.dev:3001/"+app.data.generator.name;
                      } else {
                        // iframe.src = "https://null.perchance.org/" + app.data.generator.name + "?__cacheBuster=" + Math.random().toString().slice(2); 
                        // iframe.src = `https://${window.generatorPublicId}.perchance.org/` + app.data.generator.name + "?__cacheBuster=" + Math.random().toString().slice(2);

                        let url = new URL(window.location.href);
                        url.hostname = `${window.generatorPublicId}.perchance.org`;

                        // EDIT: we no longer need to bust cache since we're using modelText and outputTemplate from parent window (and we do updateDependencies above in case they've edited an import)
                        // url.searchParams.set("__cacheBust", Math.random().toString()+Math.random().toString());
                        
                        let v = 1; // window.lastInitDataFromParentWindowValue==1 ? 2 : 1; // Toggle between 1 and 2 because if URL is same as it current src, then `iframe.src=url` won't cause iframe to reload.
                        // WARNING: I'm currently using this '__initWithDataFromParentWindow' query param on the server to know whether I should turn on Origin-Agent-Cluster stuff, since it's useful for devs (stops infinite loop freezes), but causes virtual keyboard bugs for users: https://issues.chromium.org/issues/339927578
                        url.searchParams.set("__initWithDataFromParentWindow", v);
                        window.lastInitDataFromParentWindowValue = v;

                        // Note that unlike in case of initial page load, we don't need __generatorLastEditTime stuff here because we're loading data from parent window, which has latest data.

                        if(iframe.src.split("#")[0] === url.toString().split("#")[0]) {
                          // this is faster, because it doesn't bust the cdn cache, and also prevents devtools source/context changing:
                          let requestId = Math.random().toString()+Math.random().toString();
                          iframe.contentWindow.postMessage({type:"__triggerPageReload857392947", requestId}, "*");
                          
                          // force reload (by removing and re-adding iframe to dom) e.g. to deal with case where it's frozen or paused in debugger
                          setTimeout(function() {
                            if(!window.receivedIframeSelfReloadingResponses[requestId]) {
                              console.debug("Forced hard-reload of iframe due to infinite loop or debugger paused.");
                              iframe.parentNode.insertBefore(iframe, iframe.nextSibling);
                            }
                          }, 300);

                        } else {
                          iframe.src = url.toString();
                        }

                      }
                    } else {
                      this.updateOutputRequest();
                    }
                  };

                  this.evaluateText = async (text) => {
                    let callerId = "id-" + Math.random() + "-" + Math.random();
                    this.outputIframe.contentWindow.postMessage({text, callerId, command:"evaluateText"}, '*');

                    return new Promise((resolve) => {
                      this.evaluateTextResolveMap[callerId] = resolve;
                    });
                  };

                  let existingDepsCheckAbortController = null;
                  this.updateDependencies = async (requiredDeps, opts={}) => {

                    // EDIT: We *cannot* do this (and we don't need to anyway), because, confusingly, requiredDeps *may* be a subset of deps - most notably only *direct* children of the generator.
                    // app.data.dependencies = app.data.dependencies.filter(d => requiredDeps.includes(d.name));

                    let currentDeps = app.data.dependencies.map(d => d.name);
                    
                    // see which new imports we need to do based on currentDeps and requiredDeps:
                    let depNamesToDownload;
                    if(opts.checkForUpdatesToDepsWeAlreadyHave) {
                      depNamesToDownload = requiredDeps; // check for updates to ALL required deps, in case they've since been edited
                    } else {
                      depNamesToDownload = requiredDeps.filter(d => !currentDeps.includes(d)); // only download data for generators we don't already have
                    }

                    if(depNamesToDownload.length === 0) return false;

                    // If another dependency request trails right behind this one then it'll override `this.latestDependencyRequestTime` and thus this request will be ignored (see the line below the fetch request)
                    let thisDependencyRequestStartTime = Date.now();
                    this.latestDependencyRequestStartTime = thisDependencyRequestStartTime;

                    // tell server about the data we've already got, and if it all matches latest data, then it'll send back `dataAlreadyUpToDate:true`, indicating that no updates are needed
                    let generatorNameToLastKnownEditTime = {};
                    for(let dep of app.data.dependencies) {
                      generatorNameToLastKnownEditTime[dep.name] = dep.lastEditTime;
                    } 
                    
                    if(existingDepsCheckAbortController) existingDepsCheckAbortController.abort("newer_request_obsoletes_this_one");
                    existingDepsCheckAbortController = new AbortController();
                    
                    let result;
                    for(let i = 0; i < 3; i++) {
                      result = await fetch("/api/getGeneratorsAndDependencies", {
                        signal: existingDepsCheckAbortController.signal,
                        method: 'POST',
                        body: JSON.stringify({generatorNames:depNamesToDownload, generatorNameToLastKnownEditTime}),
                        headers: { 'Content-Type': 'application/json' },
                      }).then(r => r.json()).catch(e => {
                        if(e === "newer_request_obsoletes_this_one") return e;
                        else console.error("Error while trying to get generator dependencies:", e);
                      });
                      existingDepsCheckAbortController = null;

                      if(result === "newer_request_obsoletes_this_one") return false;
                      if(result) break;
                    }
                    if(!result) {
                      if(/^#edit($|:)/.test(window.location.hash)) {
                        alert("Error while trying to get generator dependencies. This is likely a server bug. Please report on lemmy.world/c/perchance if this is happening often.");
                      }
                      throw new Error("Couldn't get generator dependencies.");
                    }
                    
                    /*just for debugging:*/if(thisDependencyRequestStartTime > this.latestDependencyRequestTime) throw new Error("this shouldn't be possible");
                    if(thisDependencyRequestStartTime !== this.latestDependencyRequestStartTime) return false;

                    if(result.status === "success") {

                      if(result.dataAlreadyUpToDate) {
                        console.debug("Dependencies were already up to date.");
                        return false; // false means "no new/updated dependencies"
                      }

                      for(let g of result.generators) {
                        if(g.found === false) {
                          console.warn("Couldn't find module named '"+g.name+"'.");
                        }
                      }

                      // Update dependencies with new data:
                      let generatorNameData = {};
                      for(let data of result.generators) {
                        generatorNameData[data.name] = data;
                      }
                      for(let data of app.data.dependencies) {
                        if(!generatorNameData[data.name]) generatorNameData[data.name] = data;
                      }
                      app.data.dependencies = Object.values(generatorNameData);

                      return true;

                    } else {
                      console.error("Error while trying to download dependencies:", newDeps);
                    }
                  }

                  this.updateOutputRequest = () => {
                    this.outputIframe.contentWindow.postMessage({
                      command:"updateOutput",
                      generator:{modelText:this.modelTextEditor.getValue(), outputTemplate:this.outputTemplateEditor.getValue(), name:app.data.generator.name},
                      dependencies: app.data.dependencies,
                    }, '*');
                  };

                  const warnings = {

                    "unescaped-equals-sign": `<div class="warning-item"><b style="color:#d58700">Warning:</b> Is the text on line number <b>###lineNumber###</b> (in ###generatorNameText### generator's code) meant to be a "property" of its parent (i.e. <code>property=value</code>), or it is just meant to be a regular item that happens to have an equals character (<code>=</code>) in it? If it's meant to be a regular item, then you'll want to put a "backslash" character (<code>\\</code>) before the equals sign like this: <code>\\=</code>. That's because the equals sign is a special character in Perchance that is used for creating "properties". You can read more about this in the <a target="_blank" href="/tutorial">tutorial</a>.</div>`,

                    "single-equals-in-dynamic-odds": `<div class="warning-item"><b style="color:#d58700">Warning:</b> The dynamic odds notation on line number <b>###lineNumber###</b> (in ###generatorNameText### generator's code) has a single equals sign instead of a double-equals sign. A single equals sign is used to put a value into a variable - for example <code>age = 10</code> means "put the value <code>10</code> into the <code>age</code> variable" whereas <code>age == 10</code> means "is <code>age</code> equal to <code>10</code>?".</div>`,
                    
                    "single-equals-in-if-else-condition": `<div class="warning-item"><b style="color:#d58700">Warning:</b> The if/else condition on line number <b>###lineNumber###</b> (in ###generatorNameText### generator's code) has a single equals sign instead of a double-equals sign. A single equals sign is used to put a value into a variable - for example <code>age = 10</code> means "put the value <code>10</code> into the <code>age</code> variable" whereas <code>age == 10</code> means "is <code>age</code> equal to <code>10</code>?".</div>`,
                    
                    "square-brackets-wrapping-variable-name-within-square-block": `<div class="warning-item"><b style="color:#d58700">Warning:</b> On line number <b>###lineNumber###</b> (in ###generatorNameText### generator's code), you've got a square block - i.e. some square brackets with some stuff inside. Nothing wrong with that. But inside that square block it looks like you've got another square block? Whenever you're writing stuff inside a square block, you can refer to variable and list name <u>directly</u> - no need to put them inside square blocks. So instead of <code style="white-space:nowrap">[[noun].pluralForm]</code>, you'd just write <code style="white-space:nowrap">[noun.pluralForm]</code>, and instead of <code style="white-space:nowrap">[[characterAge] + 3]</code>, you'd just write <code style="white-space:nowrap">[characterAge + 3]</code>, and instead of <code style="white-space:nowrap">^[[age] < 10]</code>, you'd just write <code style="white-space:nowrap">^[age < 10]</code>, and instead of <code style="white-space:nowrap">[[age] > 60 ? [oldDescription] : [youngDescription]]</code>, you'd just write <code style="white-space:nowrap">[age > 60 ? oldDescription : youngDescription]</code>. You should <b>use normal parentheses to group</b> calculations and conditions, like this: <code style="white-space:nowrap">[(age + 1) * height]</code> and this: <code style="white-space:nowrap">[isMammal || (isReptile && isBrown)]</code>. In fact, if you wrap list/variable names in square brackets when you're <i>already inside a square block</i> then this can sometimes cause all sorts of sneaky errors that are hard to "debug". Square brackets <u>can</u> "legally" be used within square brackets in <i>some</i> circumstances, but they have a special meaning (learn more about this on the <a href="https://perchance.org/examples" target="_blank">examples</a> page - especially the "Dynamic Sub-list Referencing" section). One final note: It's okay to use square brackets within square brackets if the <i>inner</i> square brackets are themselves within double-quotes, like so: <code style="white-space:nowrap">[n == 1 ? "[prefix]er" : "[prefix]ers"]</code>.</div>`,

                    "top-level-list-name-same-as-html-element-id": `<div class="warning-item"><b style="color:#d58700">Warning:</b> It looks like you have a list name on line number <b>###lineNumber###</b> that has the same name as an element's <code>id="..."</code> attribute? If so, note that these will conflict with one another and potentially cause errors. For example if you had a list called <code>animal</code>, then you shouldn't have an element like this: <code>&lt;p id="animal"&gt;...&lt;/p&gt;</code></div>`,

                    "duplicate-top-level-list-name": `<div class="warning-item"><b style="color:#d58700">Warning:</b> It looks like you have a list name on line number <b>###lineNumber###</b> (in ###generatorNameText### generator's code) that has the same name as an earlier list/import/variable?</div>`,

                  };

                  this.generatorMetaData = undefined;
                  
                  this.toggleOutputEditorWrap = function() {
                    let btn = this.refs.outputEditorWrapRefButton;
                    let state = this.outputTemplateEditor.getOption('lineWrapping');
                    if(state) {
                      btn.innerText = "wrap";
                    } else {
                      btn.innerText = "unwrap";
                    }
                    // record cursor position:
                    let cursorLine = this.outputTemplateEditor.getCursor().line;
                    let cursorTop = this.outputTemplateEditor.cursorCoords().top - this.outputTemplateEditor.display.wrapper.getBoundingClientRect().top;

                    this.outputTemplateEditor.setOption('lineWrapping', !state);
                    localStorage[`outputEditorWrap_${window.generatorName}`] = !state ? "1" : "";

                    // recover scroll to cursor position:
                    this.outputTemplateEditor.scrollIntoView({line:cursorLine, char:0}, cursorTop);
                  };
                  this.toggleCodeEditorWrap = function() {
                    let btn = this.refs.codeEditorWrapRefButton;
                    let state = this.modelTextEditor.getOption('lineWrapping');
                    if(state) {
                      btn.innerText = "wrap";
                    } else {
                      btn.innerText = "unwrap";
                    }
                    // record cursor position:
                    let cursorLine = this.modelTextEditor.getCursor().line;
                    let cursorTop = this.modelTextEditor.cursorCoords().top - this.modelTextEditor.display.wrapper.getBoundingClientRect().top;
                    
                    this.modelTextEditor.setOption('lineWrapping', !state);
                    localStorage[`codeEditorWrap_${window.generatorName}`] = !state ? "1" : "";

                    // recover scroll to cursor position:
                    this.modelTextEditor.scrollIntoView({line:cursorLine, char:0}, cursorTop);
                  };

                  this.allListsFolded = false;
                  this.toggleCodeEditorFold = function() {
                    let btn = this.refs.codeEditorFoldRefButton;
                    this.allListsFolded ? CodeMirror.commands.unfoldAll(this.modelTextEditor) : CodeMirror.commands.foldAll(this.modelTextEditor);
                    this.allListsFolded = !this.allListsFolded;
                    btn.innerText =  this.allListsFolded ? "unfold" : "fold";
                  };


                  this.outputIframe = this.root.querySelector("#output iframe");

                  this.refs.autoReloadCheckbox.checked = this.autoReload;

                  window.addEventListener("message", async (e) => {
                    let origin = e.origin || e.originalEvent.origin;
                    if(origin !== "https://null.perchance.org" && origin !== `https://${window.generatorPublicId}.perchance.org`) return;

                    if(e.data.type === "evaluateTextResponse" && typeof e.data.text === "string" && typeof e.data.callerId === "string") {
                      let resolveMap = this.evaluateTextResolveMap;
                      if(resolveMap[e.data.callerId]) {
                        resolveMap[e.data.callerId](e.data.text);
                        delete resolveMap[e.data.callerId]; 
                      } 
                    } 

                    if(e.data.type === "requestOutputUpdate") { // for 'hard reload' without having to first save data to server
                      // user clicks reload button which triggers a fullRefresh, but it adds __initWithDataFromParentWindow=1 to the URL, which causes the outputIframeContent.html code to not use the data embedded in the HTML, and instead request this parent frame for the 'fresh' data
                      if(window.shouldWaitForNewDepsBeforeRequestOutputUpdate) {
                        // this is a bit hacky. basically if the optimistic update failed (see below) then we set shouldWaitForNewDepsBeforeRequestOutputUpdate to true and do another hard reload, which will trigger this if condition
                        window.shouldWaitForNewDepsBeforeRequestOutputUpdate = false;
                        await window.mostRecentFullRefreshUpdateDependenciesPromise; // wait until we've got all dep data
                        this.updateOutputRequest();
                      } else {
                        this.updateOutputRequest(); // <-- optimistically assume no dep updates (which will be true most of the time), and we just reload again below if there were
                        let thereWereDepUpdates = await window.mostRecentFullRefreshUpdateDependenciesPromise; // so dependency stuff can load in parrallel with iframe for __initWithDataFromParentWindow fullRefresh
                        if(thereWereDepUpdates) {
                          window.shouldWaitForNewDepsBeforeRequestOutputUpdate = true;
                          this.updateOutput({fullRefresh:true}); // must hard-reload because otherwise script tags execute twice
                        }
                      }
                    }

                    if(e.data.type === "saveKeyboardShortcut") {
                      app.handleIframeSaveRequest();
                    }

                    if(e.data.type === "__triggerPageReloadResponse5792947") {
                      window.receivedIframeSelfReloadingResponses[e.data.requestId] = true;
                    }

                    // if(e.data.type === "finishedLoading") {
                    //   window.perchanceOutputIframeFinishedFirstLoad = true;
                    //   // initialPageLoadSpinner.style.display = "none";
                    //   outputLoadSpinner.style.display = "none";
                    // }

                    if(e.data.type === "finishedLoadingIncludingMetaData" || e.data.type === "failedToLoadDueToGeneratorErrors") {
                      
                      if(e.data.imports) { // <-- need to check because failedToLoadDueToGeneratorErrors doesn't give us imports
                        // we need to check if there are new imports before resolving the hard reload stuff because the saveGenerator function uses a hard reload before saving (which triggers these messages and resolves below), and we want to make sure we save the generator with all its up-to-date dependencies included.
                        let wereNewDeps = await window.lastImportsUpdateDependencyCheckPromise;
                        if(wereNewDeps) return; // don't want to resolve yet - the importsUpdate handler will trigger a second hard reload
                      }

                      for(let resolver of window.outputIframeHardReloadFinishedResolvers) {
                        resolver();
                      }
                      window.outputIframeHardReloadFinishedResolvers = [];
                    }

                    if(e.data.type === "importsUpdate" && Array.isArray(e.data.imports) && e.data.imports.filter(i => typeof i !== 'string').length === 0) {
                      await window.thisIsNotAnOldCachedPagePromise; // <-- wait until we've confirmed that this is the latest version of this generator. this prevents a weird race condition where an import update will happen fast during page load and beat the cache bust, which cause an auto-save (importsUpdates can do this), and overwrites the new code with old code.
                      // (note that the above promise won't resolve unless it's true)

                      window.lastImportsUpdateDependencyCheckPromise = this.updateDependencies(e.data.imports); // i think we only want to check for NEW deps here, not updates to existing deps, becuase a full iframe reload will do the latter anyway.

                      let wereNewDeps = await window.lastImportsUpdateDependencyCheckPromise; // <-- this actually downloads new dependencies (**if needed**, else returns false)
                      if(wereNewDeps) {
                        // we only update if there were new dependencies otherwise we will get into infinite loops
                        // (due to the way I've handled removing dependencies (I keep them cached still))
                        // TODO: this whole imports-update part is terrible and needs re-writing to make it simple and understandable.
                        // Wouldn't take toooo much work.
                        this.updateOutput({fullRefresh:true}); // <-- this triggers iframe updateOutput function. `true` => fullRefresh, i.e. fully reload the iframe with __initWithDataFromParentWindow
                      }
                      
                      if(wereNewDeps || app.data.dependencies.length > e.data.imports.length) {
                        // if dependency was *dropped*, no need to update the output - just need to update the data:
                        app.generatorEditedCallback({imports:e.data.imports});
                      }
                      
                    }

                    if(e.data.type === "metaUpdate") {
                      if(e.data._validation.generatorName !== app.data.generator.name) return; // <-- trying to stop weird Google crawler page title bug

                      // @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
                      // WARNING WARNING WARNING WARNING WARNING WARNING WARNING: If you change this at all, make sure to do a thorough check for XSS bugs. Saved meta info must be sanitised ON THE SERVER during rendering.
                      // @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
                      let title = undefined;
                      let description = undefined;
                      let image = undefined;
                      let tags = undefined;
                      let header = undefined;
                      let dynamic = undefined;

                      // if(typeof e.data.html === "string") {
                      //   if(e.data.html.length < 100_000 && window.shouldLiftGeneratorHtmlFromEmbed) {
                      //     window.document.querySelector("#generator-description").innerHTML = DOMPurify.sanitize(e.data.html, {ALLOWED_TAGS: ['h1', 'h2', 'h3', 'h4', 'p', 'div', 'pre', 'button', 'i', 'b', 'a', 'ul', 'li', 'br', 'ol', 'hr'], ALLOWED_ATTR: ['href']});
                      //     if(!window.generatorCanLinkWithRelFollow) window.document.querySelectorAll("#generator-description a").forEach(a => a.rel="nofollow");
                      //   }
                      // }

                      if(typeof e.data.title === "string") {
                        title = e.data.title.slice(0, 500); // MUST be sanitised on the server during rendering
                      }
                      if(typeof e.data.description === "string") {
                        description = e.data.description.slice(0, 3000); // MUST be sanitised on the server during rendering
                      }
                      if(typeof e.data.image === "string") {
                        image = e.data.image.slice(0, 500); // MUST be sanitised on the server during rendering
                      }
                      if(typeof e.data.dynamic === "string") {
                        dynamic = e.data.dynamic.slice(0, 40000);
                      }
                      if(typeof e.data.tags === "string") {
                        tags = e.data.tags.slice(0, 1000).split(",").map(t => t.trim()).filter(t => t.length > 0);
                      }
                      if(e.data.header && typeof e.data.header === "object") {
                        header = {};
                        if(typeof e.data.header.background === "string") {
                          if(CSS.supports("background", e.data.header.background)) {
                            header.background = e.data.header.background.slice(0, 2000);
                            menuBarEl.style.background = header.background;
                            enableRobustBackdropFilter();
                            if(CSS.supports("color", header.background)) {
                              menuBarEl.style.color = colorIsDark(header.background) ? "#e3e3e3" : "#050505";
                            }
                          }
                        }
                        if(typeof e.data.header.mode === "string") {
                          header.mode = e.data.header.mode.slice(0, 100);
                        }
                      }
                      this.generatorMetaData = {title, image, description, dynamic, tags, header};
                    }

                    if(e.data.type === "codeWarningsUpdate") {

                      let validWarningsCount = 0;
                      this.refs.warningsModalOpenButton.style.display = "none";
                      this.refs.warningsWrapper.innerHTML = "";
                      let warningsHTML = "";
                      for(let warning of e.data.warnings) {
                        if(typeof warning.lineNumber !== "number" || typeof warning.warningId !== "string" || /[^a-z0-9\-]/.test(warning.generatorName)) return;
                        let warningTemplate = warnings[warning.warningId];
                        if(!warningTemplate) {
                          console.error("invalid warning id?");
                          continue;
                        }
                        warningTemplate = warningTemplate.replace(/###lineNumber###/g, warning.lineNumber);
                        let generatorNameText;
                        if(warning.generatorName === window.location.pathname.slice(1)) generatorNameText = "<b>this</b>";
                        else generatorNameText = "the <b>"+warning.generatorName+"</b>";
                        warningTemplate = warningTemplate.replace(/###generatorNameText###/g, generatorNameText);
                        warningTemplate = warningTemplate.replace(/ \(in <b>this<\/b> generator's code\)/g, ""); // hackily remove this, since it actually makes it more confusing for newbies I think.
                        warningsHTML += warningTemplate;
                        validWarningsCount++;
                        if(validWarningsCount > 10) break;
                      }
                      if(validWarningsCount > 0) {
                        this.refs.warningsModalOpenButton.style.display = "inline-block";
                        this.refs.warningsWrapper.innerHTML = warningsHTML;
                        this.refs.warningsModal.querySelector(".modal-body").scrollTop = 0;
                      }
                    }

                    // if(e.data.type === "requestFullscreen") {
                    //   if(this.outputIframe.requestFullscreen) this.outputIframe.requestFullscreen();
                    //   else if(this.outputIframe.webkitRequestFullscreen) this.outputIframe.webkitRequestFullscreen();
                    //   else if(this.outputIframe.mozRequestFullscreen) this.outputIframe.mozRequestFullscreen();
                    //   else if(this.outputIframe.msRequestFullscreen) this.outputIframe.msRequestFullscreen();
                    // }
                    //
                    // if(e.data.type === "exitFullscreen") {
                    //   if(this.outputIframe.exitFullscreen) this.outputIframe.exitFullscreen();
                    //   else if(this.outputIframe.webkitExitFullscreen) this.outputIframe.webkitExitFullscreen();
                    //   else if(this.outputIframe.mozCancelFullscreen) this.outputIframe.mozCancelFullscreen();
                    //   else if(this.outputIframe.msExitFullscreen) this.outputIframe.msExitFullscreen();
                    // }
                  });



                  // Initialise Split.js panels
                  let sizesStore = new Store('editor-split-sizes');

                  let sizes;
                  let defaultSizes = {
                    ab: [60,40],
                    cd: [90,10],
                    ef: [75,25],
                  };
                  if(sizesStore.data[app.data.generator.name]) {
                    sizes = sizesStore.data[app.data.generator.name];
                  } else {
                    // default sizes
                    sizes = JSON.parse(JSON.stringify(defaultSizes));
                    sizesStore.data[app.data.generator.name] = sizes;
                    sizesStore.save();
                  }
                  if(localStorage["editor-split-sizes-storage"] && localStorage["editor-split-sizes-storage"].length > 20000) {
                    localStorage["editor-split-sizes-storage"] = "{}";
                  }

                  function trimSplitSizes(arr) {
                    // for some reason split sizes sometimes add to over 100% and the editor breaks.
                    // this trims it to 100%
                    arr = arr.slice(0);
                    let sum = arr[0] + arr[1];
                    if(sum <= 100) return arr;
                    else {
                      arr[0] = Math.round(arr[0]);
                      arr[1] = Math.round(arr[1]);
                      while(arr[0] + arr[1] > 100) {
                        if(Math.random() < 0.5) {
                          arr[0]--;
                        } else {
                          arr[1]--;
                        }
                      }
                      return arr;
                    }
                  }
                  
                  let gutterSize = 8;

                  let split_ab = Split([this.root.querySelector('#a'), this.root.querySelector('#b')], {
                    gutterSize,
                    sizes: sizes.ab,
                    cursor: 'col-resize',
                    minSize: 30,
                    expandToMin: true,
                    onDragEnd: function() {
                      let data = sizesStore.data[app.data.generator.name];
                      if(!data) { data = JSON.parse(JSON.stringify(defaultSizes)); } // they could have changed generator's name
                      data.ab = split_ab.getSizes();
                      data.ab = trimSplitSizes(data.ab);
                      sizesStore.save();
                    },
                    elementStyle: (dimension, elementSize, gutterSize, index) => {
                      if(index === 0) return { "min-width": `calc(${elementSize}% - ${gutterSize}px)`, "max-width": `calc(${elementSize}% - ${gutterSize}px)` }
                      else return { "flex-grow":1 }; // let the right side fill in the rest of the space (parent has display:flex)
                    },
                  });
                  this.root.querySelector('#a').style.minWidth = `calc(${sizes.ab[0]}% - ${gutterSize}px)`;
                  this.root.querySelector('#a').style.maxWidth = `calc(${sizes.ab[0]}% - ${gutterSize}px)`;


                  let split_cd = Split([this.root.querySelector('#c'), this.root.querySelector('#perchanceConsoleEl')], {
                    direction: 'vertical',
                    sizes: sizes.cd,
                    gutterSize,
                    cursor: 'row-resize',
                    minSize: 30,
                    expandToMin: true,
                    onDragEnd: function() {
                      let data = sizesStore.data[app.data.generator.name];
                      if(!data) { data = JSON.parse(JSON.stringify(defaultSizes)); } // they could have changed generator's name
                      data.cd = split_cd.getSizes();
                      data.cd = trimSplitSizes(data.cd);
                      sizesStore.save();
                    },
                    elementStyle: (dimension, elementSize, gutterSize, index) => {
                      if(index === 0) return { "min-height": `calc(${elementSize}% - ${gutterSize}px)`, "max-height": `calc(${elementSize}% - ${gutterSize}px)` }
                      else return { "flex-grow":1 }; // let the bottom fill in the rest of the space (parent has display:flex)
                    },
                  });
                  this.root.querySelector('#c').style.minHeight = `calc(${sizes.cd[0]}% - ${gutterSize}px)`;
                  this.root.querySelector('#c').style.maxHeight = `calc(${sizes.cd[0]}% - ${gutterSize}px)`;

                  let split_ef = Split([this.root.querySelector('#e'), this.root.querySelector('#f')], {
                    direction: 'vertical',
                    sizes: sizes.ef,
                    gutterSize,
                    cursor: 'row-resize',
                    minSize: 30,
                    expandToMin: true,
                    onDragEnd: function() {
                      let data = sizesStore.data[app.data.generator.name];
                      if(!data) { data = JSON.parse(JSON.stringify(defaultSizes)); } // they could have changed generator's name
                      data.ef = split_ef.getSizes();
                      data.ef = trimSplitSizes(data.ef);
                      sizesStore.save();
                    },
                    elementStyle: (dimension, elementSize, gutterSize, index) => {
                      if(index === 0) return { "min-height": `calc(${elementSize}% - ${gutterSize}px)`, "max-height": `calc(${elementSize}% - ${gutterSize}px)` }
                      else return { "flex-grow":1 }; // let the bottom fill in the rest of the space (parent has display:flex)
                    },
                  });
                  this.root.querySelector('#e').style.minHeight = `calc(${sizes.ef[0]}% - ${gutterSize}px)`;
                  this.root.querySelector('#e').style.maxHeight = `calc(${sizes.ef[0]}% - ${gutterSize}px)`;

                  // need this because otherwise for some reason there's some weird `overscroll-behaviour` stuff near the edges of the screen (even with touch-action:none overlay workaround).
                  if(/^#edit($|:)/.test(window.location.hash)) this.root.querySelectorAll("#main .gutter").forEach(el => el.style.display="none");

                  if(window.TEST_NEW_EDITOR_1) {
                    if(startInEditMode) this.switchToEditMode();

                    this.root.querySelector("#input").style.display = "none";
                    this.root.querySelector("#template").style.display = "none";
                    let modelTextInitialContent = this.root.querySelector("#input").value;
                    let outputTemplateInitialContent = this.root.querySelector("#template").value;

                    this.root.querySelector("#input").outerHTML = `<div id="mainModelTextEditorCtn" style="height:100%;width:100%;"></div>`;
                    this.root.querySelector("#template").outerHTML = `<div id="mainOutputTemplateEditorCtn" style="height:100%;width:100%;"></div>`;

                    // Set these to upgrade/edit eslint version and config stuff: 
                    // window.esLintImportUrl = "https://perchance.org/lib/eslint-linter-browserify-v9.14.0-bundle.mjs";
                    // window.htmlparser2ImportUrl = "https://perchance.org/lib/htmlparser2-v9.1.0-bundle.mjs";
                    // window.defaultEsLintConfig = {};

                    if(!window.editorBundleImportPromise) window.editorBundleImportPromise = import("/lib/editors.bundle.min.js?v=75");
                    editorLoadSpinnerEl.style.display = "flex";
                    let { init } = await window.editorBundleImportPromise;
                    editorLoadSpinnerEl.style.display = "none";

                    let { mainModelTextEditorView, mainOutputTemplateEditorView } = await init({
                      modelTextInitialContent,
                      outputTemplateInitialContent,
                      mainModelTextEditorCtn,
                      mainOutputTemplateEditorCtn
                    });
                    this.modelTextEditor  = mainModelTextEditorView;
                    this.outputTemplateEditor  = mainOutputTemplateEditorView;

                    this.modelTextEditor._onChangeHandlers = [];
                    this.outputTemplateEditor._onChangeHandlers = [];
                    
                    // add back-compat methods:
                    for(let view of [this.modelTextEditor, this.outputTemplateEditor]) { 
                      view._onChange = (update) => {
                        for(let cb of view._onChangeHandlers) {
                          try { cb(update); } catch(e) { console.error(e); } 
                        }
                      };
                      view.on = (event, cb) => {
                        if(event === "change" || event === "changes") view._onChangeHandlers.push(cb);
                      };

                      view.getValue = () => view.state.doc.toString();
                      view.setValue = (newValue) => {
                        view.dispatch({changes:{ from:0, to:view.state.doc.length, insert:newValue }});
                      };
                      
                      // note: doesn't handle undo and stuff:
                      let clean = true;
                      view.markClean = () => clean=true;
                      view.isClean = () => clean;
                      view.on("change", function() {
                        clean = false;
                      });
                    }

                    if(localStorage[`codeEditorWrap_${window.generatorName}`] && !this.modelTextEditor._linesAreWrapped) {
                      this.modelTextEditor._toggleLineWrapping();
                    }
                    this.modelTextEditor._afterToggleLineWrapping = () => localStorage[`codeEditorWrap_${window.generatorName}`] = this.modelTextEditor._linesAreWrapped ? "1" : "";

                    if(localStorage[`outputEditorWrap_${window.generatorName}`] && !this.outputTemplateEditor._linesAreWrapped) {
                      this.outputTemplateEditor._toggleLineWrapping();
                    }
                    this.outputTemplateEditor._afterToggleLineWrapping = () => localStorage[`outputEditorWrap_${window.generatorName}`] = this.outputTemplateEditor._linesAreWrapped ? "1" : "";

                    // Add Alt+Z shortcut to toggle wrapping:
                    document.addEventListener('keydown', (event) => { 
                      if (event.altKey && event.key === 'z') {
                        event.preventDefault();
                        if(this.modelTextEditor.hasFocus) this.modelTextEditor._toggleLineWrapping();
                        if(this.outputTemplateEditor.hasFocus) this.outputTemplateEditor._toggleLineWrapping();
                      }
                    }); 

                    document.querySelector(".toggle-wrap-button-html").style.display = "none";
                    document.querySelector(".code-editor-buttons-ctn").style.display = "none";

                  } else {

                    // codemirror settings
                    CodeMirror.keyMap.default["Shift-Tab"] = "indentLess";
                    CodeMirror.keyMap.default["Tab"] = "indentMore";

                    // Add some VSCode shortcuts (using sublime.js functions, just different shortcuts):
                    CodeMirror.keyMap.default["Alt-Up"] = "swapLineUp";
                    CodeMirror.keyMap.default["Alt-Down"] = "swapLineDown";
                    CodeMirror.keyMap.default["Ctrl-Shift-Up"] = "addCursorToPrevLine";
                    CodeMirror.keyMap.default["Ctrl-Shift-Down"] = "addCursorToNextLine";
                    // TODO: make both alt+click and ctrl+click work for multi-cursor

                    this.root.querySelector("#input").value = this.root.querySelector("#input").value.replace(/\n[\t ]+/g, (match) => match.replace(/\\t/g, "  "));
                    // I'm reluctant to mess with tabs in the HTML editor because they are significant in e.g. <pre>, and I'm not sure if replacing with entity (&#9;) would actually work in all cases. Should be solved for all future generators anyway (via pasting intercept code below).

                    let isTouchDevice = window.matchMedia("(pointer: coarse)").matches;

                    let systemIsInDarkMode = !!(window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches);
                    this.modelTextEditor = CodeMirror.fromTextArea(this.root.querySelector("#input"), {
                      lineNumbers: true,
                      foldGutter: true,
                      extraKeys: {
                        //"Ctrl-Q": cm => cm.foldCode(cm.getCursor()),
                        //"Ctrl-Y": cm => CodeMirror.commands.foldAll(cm),
                        //"Ctrl-I": cm => CodeMirror.commands.unfoldAll(cm),
                      },
                      gutters: ["CodeMirror-linenumbers", "CodeMirror-foldgutter"],
                      tabSize: 2,
                      indentUnit: 2,
                      indentWithTabs: false,
                      matchBrackets: true,
                      mode: "perchancelists",
                      styleActiveLine: true,
                      lineWrapping:false,
                      theme: systemIsInDarkMode ? "one-dark" : "one-light",
                      keyMap: "sublime",
                      highlightSelectionMatches: isTouchDevice ? undefined : {showToken: /\w/, annotateScrollbar: true}, // this apparently messes up caret movement stuff on touch devices
                    });

                    // hacky fix for a bug where if you type two consecutive backticks, the `perchancelists` mode's JS state gets messed up for some reason.
                    // we just retokenize when backtick is typed.
                    let backtickHighlightRetokenizeTimeout = null;
                    this.modelTextEditor.on("beforeChange", function(cm, changeObj) {
                      if(changeObj.text.some(line => line.includes('`'))) {
                        clearTimeout(backtickHighlightRetokenizeTimeout);
                        backtickHighlightRetokenizeTimeout = setTimeout(() => cm.setOption("mode", "perchancelists"), 200);
                      }
                    }); 

                    this.outputTemplateEditor = CodeMirror.fromTextArea(this.root.querySelector("#template"), {
                      // lineNumbers: true,
                      // foldGutter: true,
                      // gutters: ["CodeMirror-linenumbers", "CodeMirror-foldgutter"],
                      mode: {name: "htmlmixed"},
                      selectionPointer: true,
                      tabSize: 2,
                      indentUnit: 2,
                      indentWithTabs: false,
                      lineWrapping:false,
                      styleActiveLine: true,
                      theme: systemIsInDarkMode ? "one-dark" : "one-light",
                      keyMap: "sublime",
                      highlightSelectionMatches: isTouchDevice ? undefined : {showToken: /\w/, annotateScrollbar: true}, // this apparently messes up caret movement stuff on touch devices
                    });  

                    if(localStorage[`codeEditorWrap_${window.generatorName}`]) {
                      this.refs.codeEditorWrapRefButton.innerHTML = "unwrap";
                      this.modelTextEditor.setOption('lineWrapping', true);
                    }
                    if(localStorage[`outputEditorWrap_${window.generatorName}`]) {
                      this.refs.outputEditorWrapRefButton.innerHTML = "unwrap";
                      this.outputTemplateEditor.setOption('lineWrapping', true);
                    }

                    // Add Alt+Z shortcut to toggle wrapping:
                    document.addEventListener('keydown', (event) => {
                      if (event.altKey && event.key === 'z') {
                        event.preventDefault();
                        if(this.modelTextEditor.hasFocus()) this.toggleCodeEditorWrap();
                        if(this.outputTemplateEditor.hasFocus()) this.toggleOutputEditorWrap();
                      }
                    });

                    window.editsHaveBeenMadeSincePageLoad = false;

                    // these are also called after the generator is saved, so long as window.lastEditorsChangeTime is the same as the instant that the save operation was initiated.
                    // codemirror will make editor.isClean() return true when it comes back to this state, **including via undo**
                    this.modelTextEditor.markClean();
                    this.outputTemplateEditor.markClean();

                    // hide wrap/fold buttons if cursor is near them, or on first line
                    async function updateToolbarVisibility(editor) {
                      await new Promise(r => setTimeout(r, 10));
                      let editorCtn = editor.getWrapperElement().parentElement;
                      const cursor = editorCtn.querySelector(".CodeMirror-cursor");
                      const hoverToolbar = editorCtn.querySelector('.code-editor-buttons-ctn') || editorCtn.querySelector('.toggle-wrap-button-html');
                      if(!cursor || !hoverToolbar) return;

                      const cursorRect = cursor.getBoundingClientRect();
                      const toolbarRect = hoverToolbar.getBoundingClientRect();
                      let isNear = cursorRect.top <= toolbarRect.bottom+20 && cursorRect.left >= toolbarRect.left-50 && cursorRect.left <= toolbarRect.right+50;

                      if(editor.getCursor().line === 0) isNear = true;
                      
                      hoverToolbar.style.pointerEvents = isNear ? 'none' : 'auto';
                      hoverToolbar.style.opacity = isNear ? '0' : '1';
                    }
                    this.modelTextEditor.on('keyHandled', updateToolbarVisibility);
                    this.outputTemplateEditor.on('keyHandled', updateToolbarVisibility);
                    this.modelTextEditor.getWrapperElement().addEventListener('mouseup', () => updateToolbarVisibility(this.modelTextEditor));
                    this.outputTemplateEditor.getWrapperElement().addEventListener('mouseup', () => updateToolbarVisibility(this.outputTemplateEditor));

                    // this is stupid but it's the only way I could get chrome to stop suggesting an email/password in codemirror's search dialogue
                    try {
                      function watchForChildWithClass(target, className, callback) {
                        new MutationObserver(mutations => {
                          mutations.forEach(mutation => {
                            Array.from(mutation.addedNodes).forEach(node => {
                              if(node.nodeType === 1 && node.classList.contains(className)) callback(node);
                            });
                          });
                        }).observe(target, { childList: true });
                      }
                      setTimeout(() => {
                        for(let container of Array.from(document.querySelectorAll(".CodeMirror"))) {
                          watchForChildWithClass(container, "CodeMirror-dialog", element => {
                            for(let inputEl of Array.from(element.querySelectorAll("input"))) {
                              let dummyEl = document.createElement("div");
                              dummyEl.innerHTML = `<input type="email"><input type="password">`;
                              dummyEl.style.cssText = "opacity:0; pointer-events:none; position:absolute;";
                              inputEl.parentElement.insertBefore(dummyEl, inputEl);
                            }
                          });
                        }
                      }, 400);
                    } catch(e) { console.error(e); }



                    // there was some funky business happening with tabs when people *pasted* them.
                    // This replaces all tabs with two spaces (users need to write \t if they want a tab in their text).
                    // EDIT: also just added non-breaking space replacement with normal space, since it was messing with indenting stuff.
                    this.modelTextEditor.on("beforeChange", (cm, change) => {
                      if(change.origin === "paste") {
                        change.update(null, null, change.text.map(line => line.replace(/\t/g, "  ").replaceAll(`\u00A0`, " ")));
                      }
                    });
                    // I took this out because in HTML, some text with to consecutive spaces is different to &nbsp;&nbsp;, and I think the same is true of tabs. So I think this would turn code indents into a bunch of visible whitespace.
                    // this.outputTemplateEditor.on("beforeChange", (cm, change) => {
                    //   if(change.origin === "paste") {
                    //     change.update(null, null, change.text.map(line => line.replace(/\t/g, "&#9;")));
                    //   }
                    // });

                    // This is hacky, but it seems to work. It's from here: https://codemirror.net/demo/indentwrap.html
                    // It makes it so wrapped text is indented at the same indent level as the line itself.
                    let basePadding = 4;
                    // Only do the indentwrap stuff if there are no tabs (literal `\t` is fine), because otherwise it (for some reason) doesn't work - it messes things up: jsbin.com/tukuximome
                    if(!this.root.querySelector("#template").value.includes("\t")) {
                      let charWidthOutputTemplate = this.outputTemplateEditor.defaultCharWidth();
                      this.outputTemplateEditor.on("renderLine", function(cm, line, elt) {
                        let off = CodeMirror.countColumn(line.text, null, cm.getOption("tabSize")) * charWidthOutputTemplate;
                        elt.style.textIndent = "-" + off + "px";
                        elt.style.paddingLeft = (basePadding + off) + "px";
                      });
                    }
                    if(!this.root.querySelector("#input").value.includes("\t")) {
                      let charWidthModelText = this.modelTextEditor.defaultCharWidth();
                      this.modelTextEditor.on("renderLine", function(cm, line, elt) {
                        let off = CodeMirror.countColumn(line.text, null, cm.getOption("tabSize")) * charWidthModelText;
                        elt.style.textIndent = "-" + off + "px";
                        elt.style.paddingLeft = (basePadding + off) + "px";
                      });
                    }

                    // disable overwrite insert mode:
                    this.outputTemplateEditor.on("keyup", () => { this.outputTemplateEditor.toggleOverwrite(false); });
                    this.modelTextEditor.on("keyup", () => { this.modelTextEditor.toggleOverwrite(false); });

                    // whenever the codemirror scrollbar appears or dissapears, update the buttons positioning so they sit beside the scrollbar:
                    const updateCodeEditorButtonsPos = () => {
                      document.querySelector(".code-editor-buttons-ctn").style.right = (document.querySelector(".CodeMirror-vscrollbar").offsetWidth+5)+"px";
                    };
                    new MutationObserver(updateCodeEditorButtonsPos).observe(document.querySelector(".CodeMirror-vscrollbar"), {attributes: true});
                    setTimeout(updateCodeEditorButtonsPos, 2000); // <-- call it once at the start for init

                    // same for html area:
                    const updateHtmlEditorButtonsPos = () => { 
                      document.querySelector(".toggle-wrap-button-html").style.right = (document.querySelectorAll(".CodeMirror-vscrollbar")[1].offsetWidth+5)+"px";
                    };
                    new MutationObserver(updateHtmlEditorButtonsPos).observe(document.querySelectorAll(".CodeMirror-vscrollbar")[1], {attributes: true});
                    setTimeout(updateHtmlEditorButtonsPos, 2000); // <-- call it once at the start for init

                    setTimeout(() => {
                      this.modelTextEditor.refresh();
                      this.outputTemplateEditor.refresh();
                    }, 10);
                  }

                  window.modelTextEditor = this.modelTextEditor;
                  window.outputTemplateEditor = this.outputTemplateEditor;

                  // this is also set in the save handler. they're used as an extra check in doLocalGeneratorBackupIfNeeded to prevent backing up text that is already saved.
                  window.lastModelTextSaved = this.modelTextEditor.getValue();
                  window.lastOutputTemplateSaved = this.outputTemplateEditor.getValue();


                  if(localStorage.editorFontSize && !isNaN(Number(localStorage.editorFontSize))) {
                    let size = Number(localStorage.editorFontSize);
                    [...document.querySelectorAll(".custom-codemirror-editor-font-size")].forEach(el => el.remove());
                    let style = document.createElement("style");
                    style.className = "custom-codemirror-editor-font-size";
                    style.innerHTML = `.CodeMirror, .cm-editor { font-size: ${size}px !important; line-height: ${size*1.4}px !important; }`;
                    document.head.appendChild(style); 
                  }



                  //////////////////////////////////////
                  //       LOCAL STORAGE BACKUPS      //
                  //////////////////////////////////////
                  const maxLocalBackupInterval = localStorage.__speedUpLocalBackupStuffForTesting ? 1000*5 : 1000*60*5; // CAUTION: if you change this, change `doLocalBackupDebounce6MinTimeout` to be larger than it
                  const oldLocalBackupCleaningInterval = localStorage.__speedUpLocalBackupStuffForTesting ? 1000*60*2 : 1000*60*20;
                  const maxLocalBackupAge = localStorage.__speedUpLocalBackupStuffForTesting ? 1000*60*10 : 1000*60*60*24*30;
                  const maxLocalBackupsPerGenerator = localStorage.__speedUpLocalBackupStuffForTesting ? 10 : 30;
                  if(localStorage.__speedUpLocalBackupStuffForTesting) {
                    console.warn(`WARNING: local backups sped up due to truthy localStorage.__speedUpLocalBackupStuffForTesting value\n`.repeat(20));
                  }
                  let lastLocalBackupTime = Date.now();
                  const doLocalGeneratorBackupIfNeeded = async (modelText, outputTemplate) => {
                    if(!window.userOwnsThisGenerator) return; // they don't own this gen (i.e. are just playing around in editor for now)
                    if(Date.now()-window.generatorLastSaveTime < maxLocalBackupInterval) return; // hasn't been a few mins since last save
                    if(Date.now()-lastLocalBackupTime < maxLocalBackupInterval) return; // at most once every few mins
                    if(window.lastModelTextSaved === modelText && window.lastOutputTemplateSaved === outputTemplate) return; // since they may have made an edit, but then undone it
                    
                    lastLocalBackupTime = Date.now();
                    let backupsArray = await kv.localBackups.get(app.data.generator.name) || [];
                    backupsArray.unshift({modelText, outputTemplate, time:Date.now()});
                    // if there are more than `maxLocalBackupsPerGenerator` backups, delete every second one in the second half of the array:
                    if(backupsArray.length > maxLocalBackupsPerGenerator) {
                      backupsArray = backupsArray.filter((backup, i) => i < maxLocalBackupsPerGenerator/2 ? true : i%2===0);
                    }
                    await kv.localBackups.set(app.data.generator.name, backupsArray);
                    console.debug("Saved local backup. NEW backupsArray:", backupsArray);
                  };
                  setTimeout(async () => {
                    if(window.userOwnsThisGenerator) {
                      let persistent = await navigator.storage.persist();
                      if(!persistent) console.warn("Browser denied persistent local storage.");
                    }
                  }, 1000*60*20);
                  setInterval(async () => {
                    if(!kv) return;
                    let entries = await kv.localBackups.entries();
                    // for *every* backed-up generator (not just the one they're currently viewing/editing) stored in this user's browser:
                    for(let [generatorName, backupsArray] of entries) {
                      let originalLength = backupsArray.length;
                      // delete the backup array entries older than several weeks:
                      backupsArray = backupsArray.filter(backup => Date.now()-backup.time < maxLocalBackupAge);
                      if(originalLength === backupsArray.length) continue;
                      // save changes:
                      if(backupsArray.length === 0) {
                        await kv.localBackups.delete(generatorName);
                        await kv.localBackupsLastWarnTimes.delete(generatorName);
                      } else {
                        console.debug(`Cleared ${originalLength-backupsArray.length} old backups. NEW backupsArray:`, backupsArray);
                        await kv.localBackups.set(generatorName, backupsArray);
                      }
                    }
                  }, oldLocalBackupCleaningInterval);
                  // if the page loads, and user owns this generator, and the last backup time is more than a few mins forward in time from last save, then warn them to click header 'backups' button
                  setTimeout(async () => {
                    let startTime = Date.now();
                    while(window.userOwnsThisGenerator === undefined) await new Promise(r => setTimeout(r, 1000*10));
                    if(Date.now()-startTime > 1000*60) {
                      console.warn(`Took a ${Date.now()-startTime}ms (i.e. much longer than expected) to determine if this user owns this generator?`);
                      return;
                    }
                    if(!window.userOwnsThisGenerator) return;
                    let localBackupsArr = await kv.localBackups.get(app.data.generator.name);
                    let lastWarnTimeForThisGen = await kv.localBackupsLastWarnTimes.get(app.data.generator.name) || 0;
                    if(localBackupsArr) {
                      for(let data of localBackupsArr) {
                        if(data.time-window.generatorLastSaveTime > 1000*60*3 && data.time > lastWarnTimeForThisGen) {
                          try {
                            await app.goToEditMode();
                            document.querySelector(`#menuBarEl [data-ref="revisionsButton"]`).style.backgroundColor = "#7d5100";
                          } catch(e) { console.error(e); }
                          await kv.localBackupsLastWarnTimes.set(app.data.generator.name, Date.now());
                          alert(`Warning: There's a backup of this generator stored in your browser memory which is newer than the version of this generator you're currently viewing. This could have been caused by a problem where the server didn't properly save your generator, or if your browser previously crashed while you were editing, or it could just be that you made a little edit but then decided not to save it. If you lost some work, click the 'backups' button in the header to download the code for a backed-up version.`);
                          return;
                        }
                      }
                    }
                  }, 1000*3);

                  let editorContentAlreadySavedDebounceTimeout;
                  function checkIfEditorContentAlreadySavedWithDebounce(modelText, outputTemplate) {
                    clearTimeout(editorContentAlreadySavedDebounceTimeout);
                    editorContentAlreadySavedDebounceTimeout = setTimeout(() => {
                      if(window.lastModelTextSaved === modelText && window.lastOutputTemplateSaved === outputTemplate) {
                        if(window.userOwnsThisGenerator) {
                          window.setSaveState("saved");
                        }
                      }
                    }, 300);
                  } 

                  let doLocalBackupDebounce6MinTimeout;
                  window.lastEditorsChangeTime = Date.now();
                  this.outputTemplateEditor.on("changes", () => {
                    window.lastEditorsChangeTime = Date.now();
                    window.editsHaveBeenMadeSincePageLoad = true;
                    let modelText = this.modelTextEditor.getValue();
                    let outputTemplate = this.outputTemplateEditor.getValue();
                    app.generatorEditedCallback({modelText, outputTemplate});
                    if(this.outputTemplateEditor.isClean() && this.modelTextEditor.isClean()) { // in case they undo and go back to a saved state
                      if(window.userOwnsThisGenerator) {
                        window.setSaveState("saved"); // must come after generatorEditedCallback, above, since that sets the save state to "unsaved"
                      }
                    } else {
                      checkIfEditorContentAlreadySavedWithDebounce(modelText, outputTemplate);
                    }
                    try {
                      doLocalGeneratorBackupIfNeeded(modelText, outputTemplate);
                      clearTimeout(doLocalBackupDebounce6MinTimeout);
                      doLocalBackupDebounce6MinTimeout = setTimeout(() => { // without this, we can still lose up to 5 minutes of work, which is annoying
                        doLocalGeneratorBackupIfNeeded(modelText, outputTemplate);
                      }, 1000*60*6);
                    } catch(e) { console.error(e); }
                  });
                  this.modelTextEditor.on("changes", () => {
                    window.lastEditorsChangeTime = Date.now();
                    window.editsHaveBeenMadeSincePageLoad = true;
                    let modelText = this.modelTextEditor.getValue();
                    let outputTemplate = this.outputTemplateEditor.getValue();
                    app.generatorEditedCallback({modelText, outputTemplate});
                    if(this.outputTemplateEditor.isClean() && this.modelTextEditor.isClean()) { // in case they undo and go back to a saved state
                      if(window.userOwnsThisGenerator) {
                        window.setSaveState("saved"); // must come after generatorEditedCallback, above, since that sets the save state to "unsaved"
                      }
                    } else {
                      checkIfEditorContentAlreadySavedWithDebounce(modelText, outputTemplate);
                    }
                    try {
                      doLocalGeneratorBackupIfNeeded(modelText, outputTemplate);
                      clearTimeout(doLocalBackupDebounce6MinTimeout);
                      doLocalBackupDebounce6MinTimeout = setTimeout(() => { // without this, we can still lose up to 5 minutes of work, which is annoying
                        doLocalGeneratorBackupIfNeeded(modelText, outputTemplate);
                      }, 1000*60*6);
                    } catch(e) { console.error(e); }
                  });

                  this.outputTemplateEditor.on("changes", () => {
                    clearTimeout(this.updateOutputDelayTimeout);
                    if(this.autoReload) {
                      this.updateOutputDelayTimeout = setTimeout(() => {
                        this.updateOutput({fullRefresh:false, removeUnfoundDeps:true});
                      }, 800);
                    }
                  });
                  this.modelTextEditor.on("changes", () => {
                    clearTimeout(this.updateOutputDelayTimeout);
                    if(this.autoReload) {
                      this.updateOutputDelayTimeout = setTimeout(() => {
                        this.updateOutput({fullRefresh:false, removeUnfoundDeps:true});

                        // EDIT: this is commented out because it doesn't make sense - if they haven't reloaded, then the computed meta data is obviously going to be using the old code.
                        // TODO: Make it so that when they send the save request, that's when we send updateMetadataIfNeeded, and we send the updated modelText which is executed with createPerchanceTree or whatever, but is then discarded, rather than replacing the "real" tree and updating everything.
                        // this.outputIframe.contentWindow.postMessage({command:"updateMetadataIfNeeded"}, '*'); // needed because they may not have 'auto' checked, and so they make some changes to their $meta props, then hit save, but the updated $meta stuff isn't sent along with the save request.
                      }, 800);
                    }
                  });

                  // if(window.DEBUG_FREEZE_MODE) {
                  //   this.refs.autoReloadCheckbox.checked = false;
                  //   //this.root.querySelector("#output iframe").src = "https://null.perchance.org/debug-freeze";
                  // } else {
                  //   // let url = "https://null.perchance.org/" + app.data.generator.name + "?v=1";
                  //   // let url = `https://${window.generatorPublicId}.perchance.org/` + app.data.generator.name + "?v=2";
                  //   // if(window.needToBustCacheOfIframeOnInitialLoad) url += `?__cacheBuster=${Math.random()}`;
                  //   let url = new URL(window.location.href);
                  //   url.hostname = `${window.generatorPublicId}.perchance.org`;
                  //   if(window.needToBustCacheOfIframeOnInitialLoad) {
                  //     url.searchParams.set("__cacheBust", Math.random().toString()+Math.random().toString());
                  //   }
                  //   // This is to ensure cache is busted even if they have URL params added to the URL.
                  //   // Cloudflare has limits to the number of cache clears, so this is a hacky but full-proof workaround.
                  //   // The top-level frame has the `window.thisIsNotAnOldCachedPagePromise` stuff to handle this, but we still
                  //   // need to make sure the iframe is also busted.
                  //   // We only need this during initial page load - not when reload button / save button is pressed, since in those
                  //   // cases the __initWithDataFromParentWindow query param is added to the URL, which means the iframe gets fresh
                  //   // data from the parent, regardless of the html that the server sends (i.e. the data that's embedded in the HTML
                  //   // is ignored)
                  //   url.searchParams.set("__generatorLastEditTime", window.generatorLastSaveTime);
                  //   this.root.querySelector("#output iframe").src = url;
                  // }

                  if(window.DEBUG_FREEZE_MODE) {
                    this.refs.autoReloadCheckbox.checked = false;
                    this.root.querySelector("#output iframe").src = "https://null.perchance.org/debug-freeze";
                  } else {
                    // Edit: not needed now that we load the iframe separately from loading the editor.
                    // if(window.needToBustCacheOfIframeOnInitialLoad) {
                    //   let url = new URL(window.location.href);
                    //   url.hostname = `${window.generatorPublicId}.perchance.org`;
                    //   url.searchParams.set("__cacheBust", Math.random().toString()+Math.random().toString());
                    //   this.root.querySelector("#output iframe").src = url;
                    // }
                  }


                  //////////////////////
                  //     CONSOLE      //
                  //////////////////////
                  function escapeHtml(html) {
                    return html.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#039;");
                  }

                  let consoleOutputStyle = "<style>html { color-scheme: light dark; } body { margin:0; padding:0.3em; color:#068e06; font-family:monospace; } @media (prefers-color-scheme: dark) { body { color-scheme: dark; background-color: #1f2024; } }</style>";

                  let consoleCommandStore = new Store("console-commands");
                  if(!consoleCommandStore.data.generators) { consoleCommandStore.data.generators = {}; }

                  let consoleOutputEl = document.querySelector("#console-output");
                  let consoleInputEl = document.querySelector("#console-input");
                  consoleOutputEl.addEventListener("click", function() {
                    consoleInputEl.focus();
                  });
                  consoleOutputEl.srcdoc = consoleOutputStyle + `<span style='font-family:monospace; color:#6e6d6d; position:absolute;top:8px;left:8px;'>e.g. try typing <b>I rolled a \{1-6\}!</b> or <b>[yourListName]</b> (including the brackets) above, and then press enter.</span>`;

                  let previousCommands = consoleCommandStore.data.generators[app.data.generator.name] || [""];
                  let currCommandIndex = 0; // NOT previousCommands array index!! 0 represents most recent element, 1 is second most recent, etc.
                  consoleInputEl.addEventListener("keydown", async (e) => {
                    // e.preventDefault();
                    let command = consoleInputEl.value;
                    if(e.which === 13) { // enter
                      let optEl = document.querySelector("#consoleInterpreterOption");
                      let interpreter = optEl.options[optEl.selectedIndex].value;

                      if(interpreter === "plaintext") { consoleOutputEl.srcdoc = consoleOutputStyle.replace("font-family:monospace;", "font-family:monospace; white-space:pre-wrap;")+(escapeHtml(await this.evaluateText(command))); }
                      else if(interpreter === "html") { consoleOutputEl.srcdoc = consoleOutputStyle+(await this.evaluateText(command)); }

                      // this.root.style.background = "#f1f1f1";
                      // setTimeout(() => { this.root.style.background = "white"; },100)

                      if(command !== previousCommands[previousCommands.length-1] && command !== previousCommands[previousCommands.length-2]) {
                        previousCommands.pop();
                        previousCommands.push(command);
                        previousCommands.push(""); // put the empty one back on the end
                      }
                      if(previousCommands.length > 300) {
                        previousCommands = [...new Set(previousCommands)];
                        previousCommands.shift();
                      }
                      currCommandIndex = 1; // <-- set index to that of the command that was just submitted
                      consoleCommandStore.data.generators[app.data.generator.name] = previousCommands; // (not necessary because it keeps reference??)
                      consoleCommandStore.save();
                      return;
                    }
                    if(e.which === 38) { // up arrow
                      currCommandIndex++; // move towards start of array (counter-intuitive)
                      currCommandIndex = Math.min(previousCommands.length-1, currCommandIndex); // must stay below or at length of command stack
                      consoleInputEl.value = previousCommands[previousCommands.length-1-currCommandIndex];
                      setTimeout(function() { consoleInputEl.selectionStart = consoleInputEl.selectionEnd = 100000; }, 1);
                      return;
                    }
                    if(e.which === 40) { // down arrow
                      currCommandIndex--; // move towards end off array (counter-intuitive)
                      currCommandIndex = Math.max(0, currCommandIndex); // must stay above or at zero
                      consoleInputEl.value = previousCommands[previousCommands.length-1-currCommandIndex];
                      setTimeout(function() { consoleInputEl.selectionStart = consoleInputEl.selectionEnd = 100000; }, 1);
                      return;
                    }
                  });
                },
              };
            </script>
          </div>

          <script>
            async function getCaptchaToken(widgetCtn) {

              let createdWidgetCtn;
              if(!widgetCtn) {
                // No widget container provided, so we create one.
                // Centered on screen with darkened background:
                createdWidgetCtn = document.createElement("div");
                createdWidgetCtn.className = "created-captcha-widget-ctn"; // <-- don't change this without changing references to it
                createdWidgetCtn.style.cssText = "text-align:center; position:fixed; top:50%; left:50%; transform:translate(-50%,-50%); z-index:1000; background-color:#111; padding:1em; border-radius:0.5em; box-shadow:0 0 10px rgba(0,0,0,0.5);";
                createdWidgetCtn.innerHTML = `<div style="margin-bottom:0.5rem;">⏳ Just a sec...</div>`;
                document.body.appendChild(createdWidgetCtn);
              }

              // load captcha lib if needed:
              let attempts = 0;
              while(!window.turnstile) {
                window.onloadTurnstilePromise = new Promise(r => window.onloadTurnstileCallback=r);
                let script = document.createElement("script");
                script.src = "https://challenges.cloudflare.com/turnstile/v0/api.js?onload=onloadTurnstileCallback";
                script.defer = true;
                script.onerror = (e) => {
                  console.error("Cloudflare Turnstile is being blocked?", e)
                };
                document.body.appendChild(script);
                await window.onloadTurnstilePromise;
                if(!window.turnstile) await new Promise(r => setTimeout(r, 10*1000));
                attempts++;
                if(attempts > 3) {
                  console.error("Failed to load Cloudflare Turnstile after 3 attempts.");
                  break;
                }
              }
              // render captcha and get token:
              let captchaWidgetId;
              let token = await new Promise((resolve, reject) => {
                captchaWidgetId = window.turnstile.render(widgetCtn || createdWidgetCtn, {
                  sitekey: '0x4AAAAAAAi3LdM-EVMMMFCv',
                  callback: function(token) {
                    console.debug("✅ Got turnstile token:", token);
                    resolve(token);
                  },
                  "error-callback": function(...args) {
                    console.error("❌ Turnstile error callback fired:", ...args);
                    reject(null);
                  },
                });
              });
              try { window.turnstile.remove(captchaWidgetId); } catch(e) { console.error("turnstile.remove() failed:", e); }
              if(createdWidgetCtn) createdWidgetCtn.remove();
              return token;
            }
          </script>
        
          <div id="loginModalEl" class="app-modal" style="display:none;">
            <div style="z-index:50;" class="background" onmousedown="loginModal.closeModal()"></div>
            <div style="z-index:51;" class="outer-wrapper" onmousedown="loginModal.handleOuterWrapperClick(event)">
              <div data-ref="contentWrapper" class="content-wrapper">
                <!-- LOGIN FORM -->
                <div class="view" data-ref="loginView" style="display: initial;">
                  <div class="modal-header">
                    <p>sign up or login to create your own generators ᕕ(ᐛ)ᕗ we <b>only</b> email you at your request (e.g. for <span class="link" onclick="loginModal.goto('passwordReset1View')">password reset</span>) 👍︎</p>
                    <p data-ref="loginError_request" style="display:none; color:red; margin-top:1em;">there was a problem connecting to the server ¯\_(⊙_ʖ⊙)_/¯ check your internet connection?</p>
                    <p data-ref="loginError_password" style="display:none; color:red; margin-top:1em;">that password is not correct (⊙.☉)7 <span class="link" onclick="loginModal.goto('passwordReset1View')">forgot it?</span></p>
                    <p data-ref="loginError_passwordLength" style="display:none; color:red; margin-top:1em;">that password is too short (⌐■_■) &gt;6 chars plz</p>
                    <p data-ref="loginError_emailInvalid" style="display:none; color:red; margin-top:1em;">something seems wrong about that email address (⊙︿⊙)</p>
                    <p data-ref="loginError_tooManyRequests" style="display:none; color:red; margin-top:1em;">too many requests (this can sometimes be caused by VPN browser extensions)</p>
                    <p data-ref="loginError_server" style="display:none; color:red; margin-top:1em;">something went wrong on the server (✖╭╮✖) <a href="https://lemmy.world/c/perchance" target="_blank">plz post to forum</a> if problem persists</p>
                  </div>
                  <div class="modal-body">
                    <input name="username" data-ref="email" placeholder="email" type="email">
                    <input name="password" data-ref="password" placeholder="password" type="password">
                  </div>
                  <div class="modal-footer">
                    <button onclick="loginModal.closeModal()">cancel</button><button onclick="loginModal.login()" class="main">signup / login</button>
                  </div>
                </div>
                <!-- LOADING -->
                <div class="view" data-ref="loadingView" style="display: none;">
                  <!-- <emoji-ajax-spinner style="display:block; margin:5em 0;" verb="loading"/> -->
                  <div style="margin:5em 0; text-align:center;">⏳ loading...</div>
                  <div data-ref="cfCaptchaOuterEl" style="display:none; text-align:center;">
                    <div data-ref="cfCaptchaCtn"></div>
                  </div>
                </div>
                <!-- VERIFICATION -->
                <div class="view" data-ref="verificationView" style="display: none;">
                  <div class="modal-header">
                    <p>we just sent a verification code to <span class="verificationEmailDisplay" style="font-style:italic;"></span> (check spam folder too)</p>
                    <p data-ref="extraNotice" style="margin-top: 0.25rem;" hidden=""></p>
                    <p data-ref="verifyError_request" style="display:none; color:red; margin-top:1em;">hmm. there was a problem connecting to the server. check your internet connection?</p>
                    <p data-ref="verifyError_code" style="display:none; color:red; margin-top:1em;">that code is not correct (⊙.☉)7 pls ensure you copied it exactly 👌︎</p>
                    <p data-ref="verifyError_server" style="display:none; color:red; margin-top:1em;">something went wrong on the server (✖╭╮✖) <a href="https://lemmy.world/c/perchance" target="_blank">pls post to forum</a> if problem persists</p>
                  </div>
                  <div class="modal-body">
                    <input data-ref="verificationCode" placeholder="verification code" type="text">
                  </div>
                  <div class="modal-footer">
                    <button onclick="loginModal.goto('loginView')">back</button><button id="verify-account-button" class="main" onclick="loginModal.verify()">verify</button>
                  </div>
                </div>
                <!-- SUCCESSFUL LOGIN -->
                <div class="view" data-ref="successView" style="display: none;">
                  <div class="modal-header">
                    <p>you're logged in! s(^‿^)-b</p>
                  </div>
                  <button onclick="loginModal.closeModal_success()" style="width:100%;">close</button>
                </div>
                <!-- PASSWORD RESET REQUEST -->
                <div class="view" data-ref="passwordReset1View" style="display: none;">
                  <div class="modal-header">
                    <p>forgot your password? o(╥﹏╥)o that's all right! just enter the email you used to sign up and you'll be sent a reset code</p>
                    <p data-ref="requestPasswordResetCodeError_request" style="display:none; color:red; margin-top:1em;">there was a problem connecting to the server ¯\_(⊙_ʖ⊙)_/¯ check your internet connection?</p>
                    <p data-ref="requestPasswordResetCodeError_account" style="display:none; color:red; margin-top:1em;">very spooky: that account was not found (⊙.☉)7 are you sure you put in the correct email? 👻︎</p>
                    <p data-ref="requestPasswordResetCodeError_server" style="display:none; color:red; margin-top:1em;">something went wrong on the server (✖╭╮✖) <a href="https://lemmy.world/c/perchance" target="_blank">pls post to forum</a> if problem persists</p>
                  </div>
                  <div class="modal-body">
                    <input data-ref="emailForPasswordReset" placeholder="email" type="text">
                  </div>
                  <div class="modal-footer">
                    <button onclick="loginModal.goto('loginView')">back</button><button class="main" onclick="loginModal.requestPasswordResetCode()">request reset code</button>
                  </div>
                </div>
                <!-- PASSWORD RESET -->
                <div class="view" data-ref="passwordReset2View" style="display: none;">
                  <div class="modal-header">
                    <p>we just sent a password reset code to <span style="font-style:italic;" class="emailForPasswordResetDisplay"></span> 💌 when you recieve it (check your spam folder too) enter it below and then enter a new password of your choosing</p>
                    <p data-ref="resetPasswordError_request" style="display:none; color:red; margin-top:1em;">there was a problem connecting to the server ¯\_(⊙_ʖ⊙)_/¯ check your internet connection?</p>
                    <p data-ref="resetPasswordError_code" style="display:none; color:red; margin-top:1em;">that code is not correct (⊙.☉)7 pls ensure you copied it exactly 👌︎</p>
                    <p data-ref="resetPasswordError_passwordLength" style="display:none; color:red; margin-top:1em;">that password is too short (⌐■_■) &gt;6 chars plz</p>
                    <p data-ref="resetPasswordError_server" style="display:none; color:red; margin-top:1em;">something went wrong on the server (✖╭╮✖) <a href="https://lemmy.world/c/perchance" target="_blank">pls post to forum</a> if problem persists</p>
                  </div>
                  <div class="modal-body">
                    <input data-ref="passwordResetCode" placeholder="reset code" type="text">
                    <input data-ref="newPassword" placeholder="new password" type="password">
                  </div>
                  <div class="modal-footer">
                    <button onclick="loginModal.goto('passwordReset1View')">back</button><button class="main" onclick="loginModal.resetPassword()">set password</button>
                  </div>
                </div>
              </div>
            </div>
            <script>
              window.loginModal = {
                root: document.querySelector("#loginModalEl"),
                refs: new Proxy({}, {
                  get(target, prop, receiver) {
                    return document.querySelector(`#loginModalEl [data-ref='${prop}']`);
                  },
                }),
                init: function() {
                  this.closeModal = function() {
                    this.root.style.display = "none";
                  };
                  this.closeModal_success = function() {
                    this.closeModal();
                    this.goto("loginView");
                  };

                  this.openModal = function() {
                    this.root.style.display = "block";
                  };
                  this.handleOuterWrapperClick = function(e) {
                    if(!this.refs.contentWrapper.contains(e.target)) {
                      this.closeModal();
                    }
                  };
                  this.goto = function(name) {
                    this.hideAllViews();
                    let el = this.refs[name];
                    el.style.display = "initial";
                    loginModalEl.querySelectorAll(".emailForPasswordResetDisplay").forEach(el => el.textContent=this.refs.emailForPasswordReset.value);
                    loginModalEl.querySelectorAll(".verificationEmailDisplay").forEach(el => el.textContent=this.refs.email.value);
                    if(el.querySelector("input")) {
                      // TODO: move caret to end of text if there is text in the input
                      setTimeout(() => { el.querySelector("input").focus(); },200);
                    }
                  };
                  this.hideAllViews = function() {
                    let views = this.root.querySelectorAll(".content-wrapper .view");
                    for(let el of Array.from(views)) {
                      el.style.display = "none";
                    }
                  };
                  this.getCurrentView = function() {
                    let views = this.root.querySelectorAll(".content-wrapper .view");
                    for(let el of Array.from(views)) {
                      if( el.style.display !== "none" ) return el.attributes.ref.value;
                    }
                  };

                  let extraNoticeDisplayTimeout = null;
                  this.login = async function() {

                    if(this.refs.password.value.length < 6) {
                      this.setLoginError("passwordLength");
                      return;
                    }
                    if(!/.+@.+/.test(this.refs.email.value)) {
                      this.setLoginError("emailInvalid");
                      return;
                    }

                    this.goto("loadingView");

                    try {

                      let bodyData = {email: this.refs.email.value, password: this.refs.password.value};

                      let data = await fetch('/api/login', {
                        method: 'POST',
                        body: JSON.stringify(bodyData),
                        signal: AbortSignal.timeout?.(20*1000),
                        headers: { 'Content-Type': 'application/json'},
                      }).then(r => r.json());

                      if(data.status === "captcha-needed") {
                        console.debug("captcha-needed:", data);
                        // get captcha token:
                        this.refs.cfCaptchaOuterEl.style.display = "";
                        this.refs.cfCaptchaCtn.innerHTML = "";
                        let captchaToken = await getCaptchaToken(this.refs.cfCaptchaCtn);
                        this.refs.cfCaptchaOuterEl.style.display = "none";
                        // add the token to the request and try again:
                        bodyData.captchaToken = captchaToken;
                        data = await fetch('/api/login', {
                          method: 'POST',
                          body: JSON.stringify(bodyData),
                          signal: AbortSignal.timeout?.(20*1000),
                          headers: { 'Content-Type': 'application/json'},
                        }).then(r => r.json());
                      }

                      console.debug("login finished:", data);

                      if(data.status === "verification-needed") {
                        this.goto("verificationView");

                        if(bodyData.email.trim().endsWith("@gmail.com")) {
                          extraNoticeDisplayTimeout = setTimeout(() => {
                            this.refs.extraNotice.hidden = false;
                            let aaaaa = "@";
                            this.refs.extraNotice.innerHTML = `<b style="color:red;">note</b>: gmail addresses seem to be having signup issues recently. sometimes the verification email doesn't even make it to the spam folder. if you're not getting an email (even in your spam folder) after a couple of minutes, try <b>sending an email</b> to supp${""}ort${aaaaa}per${"chan"}ce.org (content doesn't matter), and then click 'back' and try again. if it's still not working, you can use something like temp-ma${""}il.org until the issue is resolved, then change your email in account settings.`;
                          }, 1000*40);
                        }

                      } else if(data.status === "success") {
                        app.loginSuccessCallback({sessionToken:data.sessionToken, email:this.refs.email.value});
                        localStorage.sessionTokenLastChangeTime = Date.now();
                        // TODO: make sure modal is visible (they could have (accidentally) closed it! (disable closing while loading?))
                        this.goto("successView");
                        this.refs.email.value = "";
                        this.refs.password.value = "";
                        this.setLoginError("none");
                      } else if(data.status === "incorrect-password") {
                        this.goto("loginView");
                        this.setLoginError("password");
                      } else if(data.status === "invalid-email") {
                        this.goto("loginView");
                        this.setLoginError("emailInvalid");
                      } else if(data.status === "too-many-requests") {
                        this.goto("loginView");
                        this.setLoginError("tooManyRequests");
                      } else if(data.status === "captcha-failed") {
                        this.goto("loginView");
                        this.refs.cfCaptchaCtn.innerHTML = `<b style="color:red;">Failed to solve captcha.</b>`;
                      } else {
                        this.goto("loginView");
                        this.setLoginError("server");
                      }

                    } catch(e) {
                      console.debug(e);
                      this.goto("loginView");
                      this.setLoginError("request");
                    }
                  }
                  this.setLoginError = (name) => {
                    this.refs.loginError_password.style.display = "none";
                    this.refs.loginError_passwordLength.style.display = "none";
                    this.refs.loginError_emailInvalid.style.display = "none";
                    this.refs.loginError_tooManyRequests.style.display = "none";
                    this.refs.loginError_request.style.display = "none";
                    this.refs.loginError_server.style.display = "none";
                    if(name === "none") {
                      return;
                    } else {
                      this.refs["loginError_"+name].style.display = "block";
                    }
                  }

                  this.verify = async function() {
                    this.goto("loadingView");
                    try {
                      let data = await fetch('/api/verify', {
                        method: 'POST',
                        body: JSON.stringify({code: this.refs.verificationCode.value, email:this.refs.email.value}),
                        signal: AbortSignal.timeout?.(20*1000),
                        headers: { 'Content-Type': 'application/json'},
                      }).then(r => r.json());

                      console.debug("verify finished:", data);

                      if(data.status === "success") {
                        clearTimeout(extraNoticeDisplayTimeout);
                        this.refs.extraNotice.hidden = true;
                        this.setVerifyError("none");
                        this.login();
                        this.refs.verificationCode.value = "";
                        //this.refs.email.value = ""; If we set it to an empty string we won't be able to read it after login!!
                      } else if(data.status === "incorrect-code") {
                        this.setVerifyError("code");
                        this.goto("verificationView");
                      } else {
                        this.setVerifyError("server");
                        this.goto("verificationView");
                      }
                    } catch(e) {
                      console.debug(e);
                      this.goto("verificationView");
                      this.setVerifyError("request");
                    }
                  }
                  this.setVerifyError = (name) => {
                    this.refs.verifyError_code.style.display = "none";
                    this.refs.verifyError_request.style.display = "none";
                    this.refs.verifyError_server.style.display = "none";
                    if(name === "none") {
                      return;
                    } else {
                      this.refs["verifyError_"+name].style.display = "block";
                    }
                  }

                  this.requestPasswordResetCode = async function() {

                    this.goto("loadingView");
                    try {

                      let bodyData = {email:this.refs.emailForPasswordReset.value};

                      let data = await fetch('/api/requestPasswordResetCode', {
                        method: 'POST',
                        body: JSON.stringify(bodyData),
                        signal: AbortSignal.timeout?.(20*1000),
                        headers: { 'Content-Type': 'application/json'},
                      }).then(r => r.json());

                      if(data.status === "captcha-needed") {
                        console.debug("captcha-needed:", data);
                        // get captcha token:
                        this.refs.cfCaptchaOuterEl.style.display = "";
                        this.refs.cfCaptchaCtn.innerHTML = "";
                        let captchaToken = await getCaptchaToken(this.refs.cfCaptchaCtn);
                        this.refs.cfCaptchaOuterEl.style.display = "none";
                        // add the token to the request and try again:
                        bodyData.captchaToken = captchaToken;
                        data = await fetch('/api/requestPasswordResetCode', {
                          method: 'POST',
                          body: JSON.stringify(bodyData),
                          signal: AbortSignal.timeout?.(20*1000),
                          headers: { 'Content-Type': 'application/json'},
                        }).then(r => r.json());
                      }

                      console.debug(data);

                      if(data.status === "success") {
                        this.setRequestPasswordResetCodeError("none");
                        this.goto("passwordReset2View");
                      } else if(data.status === "account-not-found") {
                        this.setRequestPasswordResetCodeError("account");
                        this.goto("passwordReset1View");
                      } else if(data.status === "captcha-failed") {
                        alert(`Failed to solve captcha. Please try again.`);
                        this.goto("passwordReset1View");
                      } else {
                        this.setRequestPasswordResetCodeError("server");
                        this.goto("passwordReset1View");
                      }

                    } catch(e) {
                      console.debug(e);
                      this.goto("passwordReset1View");
                      this.setRequestPasswordResetCodeError("request");
                    }
                  }
                  this.setRequestPasswordResetCodeError = function(name) {
                    this.refs.requestPasswordResetCodeError_account.style.display = "none";
                    this.refs.requestPasswordResetCodeError_request.style.display = "none";
                    this.refs.requestPasswordResetCodeError_server.style.display = "none";
                    if(name === "none") {
                      return;
                    } else {
                      this.refs["requestPasswordResetCodeError_"+name].style.display = "block";
                    }
                  }

                  this.resetPassword = async function() {

                    if(this.refs.newPassword.length < 6) {
                      this.setResetPasswordError("passwordLength");
                      this.goto("passwordReset2View");
                      return;
                    }

                    this.goto("loadingView");
                    try {

                      let data = await fetch('/api/resetPassword', {
                        method: 'POST',
                        body: JSON.stringify({email:this.refs.emailForPasswordReset.value, code:this.refs.passwordResetCode.value, newPassword:this.refs.newPassword.value}),
                        signal: AbortSignal.timeout?.(20*1000),
                        headers: { 'Content-Type': 'application/json'},
                      }).then(r => r.json());

                      console.debug(data);

                      if(data.status === "success") {
                        this.setResetPasswordError("none");
                        this.refs.email.value = this.refs.emailForPasswordReset.value;
                        this.refs.password.value = this.refs.newPassword.value;
                        this.login();
                        this.refs.emailForPasswordReset.value = "";
                        this.refs.passwordResetCode.value = "";
                        this.refs.newPassword.value = "";
                      } else if(data.status === "incorrect-code") {
                        this.setResetPasswordError("code");
                        this.goto("passwordReset2View");
                      } else {
                        this.setResetPasswordError("server");
                        this.goto("passwordReset2View");
                      }

                    } catch(e) {
                      console.debug(e);
                      this.goto("passwordReset2View");
                      this.setResetPasswordError("request");
                    }
                  }
                  this.setResetPasswordError = (name) => {
                    this.refs.resetPasswordError_passwordLength.style.display = "none";
                    this.refs.resetPasswordError_code.style.display = "none";
                    this.refs.resetPasswordError_request.style.display = "none";
                    this.refs.resetPasswordError_server.style.display = "none";
                    if(name === "none") {
                      return;
                    } else {
                      this.refs["resetPasswordError_"+name].style.display = "block";
                    }
                  }

                  this.hideAllViews();
                  this.goto("loginView");
                  this.refs.email.addEventListener("keyup", (e) => { if(e.which === 13) { this.login(); } })
                  this.refs.password.addEventListener("keyup", (e) => { if(e.which === 13) { this.login(); } })
                },
              };
            </script>
          </div>
        
          <div id="accountModalEl" class="app-modal" style="display:none;">
            <style>
              #accountModalEl .add-to-folder-btn {
                opacity:0.5;
                cursor:pointer;
              }
              #accountModalEl .add-to-folder-btn:hover {
                opacity:1;
              }
              #accountModalEl .folder-header {
                cursor:pointer;
                padding-left: 0.5rem;
              }
              #accountModalEl .folder-header:hover {
                background: #eee;
              }
              @media (prefers-color-scheme: dark) {
                #accountModalEl .folder-header:hover {
                  background: #484848;
                }
              }
              
              #accountModalEl .folder-ctn[data-fold-state='closed'] .folder-emoji {
                filter: saturate(0);
              }
            </style>
            <div style="z-index:50;" class="background" onmousedown="accountModal.closeModal()"></div>
            <div style="z-index:51;" class="outer-wrapper" onmousedown="accountModal.handleOuterWrapperClick(event)">
              <div data-ref="contentWrapper" class="content-wrapper">
                <!-- ACCOUNT MENU -->
                <div class="view" data-ref="accountMenuView" style="display: initial;">
                  <div class="modal-header">
                    <p>you're logged in as <i class="currentEmailDisplay"></i> - you can:</p>
                    <ul>
                      <li><span class="link" onclick="accountModal.loadGeneratorList()">view your generators</span></li>
                      <li style="margin-top:0.5rem;"><span class="link" onclick="accountModal.goto('passwordChangeView')">change your password</span></li>
                      <li style="margin-top:0.5rem;"><span class="link" onclick="accountModal.goto('emailChangeView')">change your email</span></li>
                      <li style="margin-top:0.5rem;"><span class="link" onclick="app.logout()">logout</span></li>
                    </ul>
                  </div>
                  <div class="modal-body"></div>
                  <div class="modal-footer">
                    <button style="width:100%;" onclick="accountModal.closeModal()">close</button>
                  </div>
                </div>
                <!-- PASSWORD CHANGE -->
                <div class="view" data-ref="passwordChangeView" style="display: none;">
                  <div class="modal-header">
                    <p>changing your password is easy, just enter your current password and your new password:</p>
                    <p data-ref="passwordChangeError_request" style="display:none; color:red; margin-top:1em;">there was a problem connecting to the server ¯\_(⊙_ʖ⊙)_/¯ check your internet connection?</p>
                    <p data-ref="passwordChangeError_password" style="display:none; color:red; margin-top:1em;">the current password is not correct (⊙.☉)7</p>
                    <p data-ref="passwordChangeError_passwordLength" style="display:none; color:red; margin-top:1em;">that password is too short (⌐■_■) &gt;7 chars pls</p>
                    <p data-ref="passwordChangeError_server" style="display:none; color:red; margin-top:1em;">something went wrong on the server (✖╭╮✖) <a href="https://lemmy.world/c/perchance" target="_blank">pls post to forum</a> if problem persists</p>
                  </div>
                  <div class="modal-body">
                    <input data-ref="passwordChange_currentPassword" placeholder="current password" type="password">
                    <input data-ref="passwordChange_newPassword" placeholder="new password" type="password">
                  </div>
                  <div class="modal-footer">
                    <button onclick="accountModal.goto('accountMenuView')">back</button><button class="main" onclick="accountModal.changePassword()">set new password</button>
                  </div>
                </div>
                <!-- PASSWORD CHANGE SUCCESS -->
                <div class="view" data-ref="passwordChangeSuccessView" style="display: none;">
                  <div class="modal-header">
                    <p>your password has been changed!</p>
                  </div>
                  <div class="modal-body">
                  </div>
                  <div class="modal-footer">
                    <button style="width:100%;" onclick="accountModal.closeModal()">close</button>
                  </div>
                </div>
                <!-- EMAIL CHANGE -->
                <div class="view" data-ref="emailChangeView" style="display: none;">
                  <div class="modal-header">
                    <p>your current email is <i class="currentEmailDisplay"></i> to change your email, just enter your password and your new email below</p>
                    <p data-ref="emailChangeError_request" style="display:none; color:red; margin-top:1em;">there was a problem connecting to the server ¯\_(⊙_ʖ⊙)_/¯ check your internet connection?</p>
                    <p data-ref="emailChangeError_password" style="display:none; color:red; margin-top:1em;">that password is not correct (⊙.☉)7</p>
                    <p data-ref="emailChangeError_emailInvalid" style="display:none; color:red; margin-top:1em;">that new email address looks weird (⌐■_■)</p>
                    <p data-ref="emailChangeError_server" style="display:none; color:red; margin-top:1em;">something went wrong on the server (✖╭╮✖) <a href="https://lemmy.world/c/perchance" target="_blank">plz post to forum</a> if problem persists</p>
                  </div>
                  <div class="modal-body">
                    <input data-ref="emailChange_newEmail" placeholder="new email" type="email">
                    <input data-ref="emailChange_password" placeholder="your password" type="password">
                  </div>
                  <div class="modal-footer">
                    <button onclick="accountModal.goto('accountMenuView')">back</button><button class="main" onclick="accountModal.changeEmail()">set new email</button>
                  </div>
                </div> 
                <!-- EMAIL CHANGE SUCCESS -->
                <div class="view" data-ref="emailChangeSuccessView" style="display: none;">
                  <div class="modal-header">
                    <p>your email hand been changed!</p>
                  </div>
                  <div class="modal-body">
                  </div>
                  <div class="modal-footer">
                    <button style="width:100%;" onclick="accountModal.closeModal()">close</button>
                  </div>
                </div>
                <!-- GENERATOR LIST -->
                <div class="view" data-ref="generatorListView" style="display: none;">
                  <div class="modal-header">
                    <input oninput="this.parentNode.parentNode.querySelectorAll('ul li a').forEach(el => el.parentNode.style.display=el.textContent.includes(this.value) ? '' : 'none')" placeholder="search..." style="height: 1rem;">
                    <span title="sort alphabetically" style="cursor:pointer;" onclick="window.accountModal.sortGeneratorListButtonClickHandler(this)">🔤</span>
                    <p data-ref="generatorListError" style="display:none; color:red; margin-top:1em;">there was a problem loading your generators ¯\_(⊙_ʖ⊙)_/¯ check your internet connection? if the problem persists, please <a href="https://lemmy.world/c/perchance">post to forum</a></p>
                  </div>
                  <div class="modal-body" style="max-height: 400px; overflow-y: auto;">
                    <!-- <generator-list style="display:block; margin-bottom:1.3em;"/> -->
                    <div data-ref="generatorFoldersCtn" style="display:block; margin-bottom:1.3em;"></div>
                  </div>
                  <div class="modal-footer">
                    <button style="width:100%;" onclick="accountModal.goto('accountMenuView')">back</button>
                  </div>
                </div>
                <!-- LOADING -->
                <div class="view" data-ref="loadingView" style="display: none;">
                  <!-- <emoji-ajax-spinner style="display:block; margin:5em 0;" verb="loading"/> -->
                  <div style="margin:5em 0; text-align:center;">⏳ loading...</div>
                </div>
              </div>
            </div>
            <script>
              window.accountModal = {
                root: document.querySelector("#accountModalEl"),
                refs: new Proxy({}, {
                  get(target, prop, receiver) {
                    return document.querySelector(`#accountModalEl [data-ref='${prop}']`);
                  },
                }),
                init: function() {

                  this.sortGeneratorListButtonClickHandler = function(el) {
                    let lists = el.parentNode.parentNode.querySelectorAll('ul');
                    let t = Number(el.dataset.sortTypeIndex || 1);
                    for(let list of lists) {
                      if(t == 0) {
                        [...list.children].sort((a,b)=> Number(a.dataset.defaultSortValue)-Number(b.dataset.defaultSortValue)).forEach(n => list.appendChild(n));
                      } else if(t == 1 || t == 2) {
                        let m;
                        if(t == 1) m = 1;
                        if(t == 2) m = -1;
                        [...list.children].sort((a,b)=> a.textContent > b.textContent ? 1*m : -1*m).forEach(n => list.appendChild(n));
                      }
                    }
                    el.dataset.sortTypeIndex = t+1 === 3 ? 0 : t+1;
                  };

                  this.closeModal = function() {
                    this.root.style.display = "none";
                  }
                  this.openModal = function() {
                    this.goto("accountMenuView");
                    this.root.style.display = "block";
                  }
                  this.handleOuterWrapperClick = function(e) {
                    if(!this.refs.contentWrapper.contains(e.target)) {
                      this.closeModal();
                    }
                  }
                  this.goto = function(name) {
                    this.hideAllViews();
                    let el = this.refs[name];
                    el.style.display = "initial";
                    accountModalEl.querySelectorAll(".currentEmailDisplay").forEach(el => el.textContent=app.store.data.user.email);
                    if(el.querySelector("input")) {
                      // TODO: move caret to end of text if there is text in the input
                      setTimeout(() => { el.querySelector("input").focus(); },200);
                    }
                  }
                  this.hideAllViews = function() {
                    let views = this.root.querySelectorAll(".content-wrapper .view");
                    for(let el of Array.from(views)) {
                      el.style.display = "none";
                    }
                  }
                  this.getCurrentView = function() {
                    let views = this.root.querySelectorAll(".content-wrapper .view");
                    for(let el of Array.from(views)) {
                      if( el.style.display !== "none" ) return el.attributes.ref.value;
                    }
                  };

                  try {
                    window.__userGeneratorListFolderFoldStates = JSON.parse(localStorage.userGeneratorListFolderFoldStates || `{"uncategorized":1}`);
                    if(typeof window.__userGeneratorListFolderFoldStates !== "object") throw new Error("Should be a POJO.");
                  } catch(e) {
                    console.error(e);
                    window.__userGeneratorListFolderFoldStates = {uncategorized:1}; // <-- important - otherwise a bug with writing to localStorage.userGeneratorListFolderFoldStates could break the whole web app for the user
                  }

                  this.generatorFolderMap = null;
                  this.lastChosenFolderName = "";
                  this.handleGeneratorFolderMapButtonClick = async (btn) => {
                    let folderName = prompt('Enter a folder name:', this.lastChosenFolderName || undefined);
                    if(folderName !== null) {
                      this.lastChosenFolderName = folderName; // just for convenience if adding a bunch of generators to a new folder
                      if(folderName === "") {
                        folderName = "uncategorized";
                      }
                      let existingFolderName = this.generatorFolderMap[btn.dataset.generatorName];

                      // update local data and view:
                      this.generatorFolderMap[btn.dataset.generatorName] = folderName;
                      let folderEl = this.refs.generatorFoldersCtn.querySelector(`[data-folder-name='${folderName}']`);
                      if(!folderEl) { // create the folder if it doesn't yet exist
                        folderEl = this.createFolderHtml([], folderName, "open");
                        this.refs.generatorFoldersCtn.prepend(folderEl);
                      }
                      folderEl.querySelector("ul").prepend(btn.closest("li"));
                      
                      let itemCountEl = folderEl.querySelector(".folder-item-count");
                      itemCountEl.innerText = Number(itemCountEl.innerText) + 1;

                      // if the generator was previously in a folder, and that folder is now empty, remove that empty folder:
                      if(existingFolderName) {
                        let existingFolderEl = this.refs.generatorFoldersCtn.querySelector(`[data-folder-name='${existingFolderName}']`);
                        let itemCountEl = existingFolderEl.querySelector(".folder-item-count");
                        itemCountEl.innerText = Number(itemCountEl.innerText) - 1;
                        if(existingFolderEl.querySelectorAll("ul li").length === 0) {
                          existingFolderEl.remove();
                        }
                      }
                      
                      // update server data:
                      let data = await fetch('/api/saveUserGeneratorFolderMap', {
                        method: 'POST',
                        body: JSON.stringify({
                          email: app.store.data.user.email,
                          sessionToken: app.store.data.user.sessionToken,
                          generatorFolderMap: JSON.stringify(this.generatorFolderMap),
                        }),
                        signal: AbortSignal.timeout?.(20*1000),
                        headers: { 'Content-Type': 'application/json'},
                      }).then(r => r.json());

                      if(data.status !== "success") {
                        alert("Encountered error while trying to save folder data. Please check your internet connection and perhaps try refreshing the page. If the problem persists, please submit a post on lemmy.world/c/perchance");
                      }
                    }
                  };

                  this.loadGeneratorList = async () => {

                    this.goto("loadingView");
                    this.refs.generatorListError.style.display = "none";
                    this.refs.generatorFoldersCtn.innerHTML = "";

                    try {

                      let data = await fetch('/api/getGeneratorsByUser', {
                        method: 'POST',
                        body: JSON.stringify({
                          email: app.store.data.user.email,
                          sessionToken: app.store.data.user.sessionToken,
                        }),
                        signal: AbortSignal.timeout?.(20*1000),
                        headers: { 'Content-Type': 'application/json'},
                      }).then(r => r.json());

                      this.goto("generatorListView");

                      if(data.status === "success") {
                        this.generatorFolderMap = data.generatorFolderMap;

                        // clean the generatorFolderMap in case they've deleted generators:
                        let generatorNameSet = new Set(data.generators.map(g => g.name));
                        for(let n of Object.keys(this.generatorFolderMap)) {
                          if(!generatorNameSet.has(n)) delete this.generatorFolderMap[n];
                        }

                        let folders = {}; // <-- maps folder name to generator array
                        for(let g of data.generators) {
                          if(!g.views) g.views = 0;
                          g.views = g.views > 999 ? (g.views/1000).toFixed(1) + 'k' : g.views;
                          let folderName = this.generatorFolderMap[g.name] || "uncategorized";
                          if(!folders[folderName]) folders[folderName] = [];
                          folders[folderName].push(g);
                        }
                        
                        let foldersSorted = Object.entries(folders).sort((a,b) => a[0].localeCompare(b[0]));
                        let uncategorizedFolderEntry = foldersSorted.find(e => e[0] === "uncategorized");
                        if(uncategorizedFolderEntry) {
                          foldersSorted = [...foldersSorted.filter(e => e[0] !== "uncategorized"), uncategorizedFolderEntry]; // move 'uncategorized' folder to the end
                        }
                        for(let [folderName, generators] of foldersSorted) {
                          let foldState = window.__userGeneratorListFolderFoldStates[folderName] ? "open" : "closed";
                          let folderEl = this.createFolderHtml(generators, folderName, foldState);
                          this.refs.generatorFoldersCtn.appendChild(folderEl);
                        }
                        // this.tags["generator-list"].generators = data.generators;
                        // this.tags["generator-list"].update();
                      } else {
                        this.refs.generatorListError.style.display = "block";
                      }

                    } catch(e) {
                      console.error("Problem loading generator list");
                      console.debug(e);
                      this.goto("generatorListView");
                      this.refs.generatorListError.style.display = "block";
                    }

                  };

                  this.createFolderHtml = (generators, folderName, foldState) => {
                    let div = document.createElement("div");
                    
                    let folderNameHtml = folderName.replace(/</g, "&lt;").replace(/>/g, "&gt;");
                    let folderNameAttr = folderName.replace(/"/g, "&quot;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/&/g, "&amp;");
                    let generatorListItemsHtml = generators.map((g, i) => `<li data-default-sort-value="${i}"><a href="/${g.name}#edit">${g.name}</a> (${g.views} views) <b style="color:#ff6800; ${g.isPrivate ? "" : "display:none;"}">(priv)</b> <span class="add-to-folder-btn" style="display:inline-block;" data-generator-name="${g.name}" onclick="accountModal.handleGeneratorFolderMapButtonClick(this);">📁</span></li>`).join("");
                    let folderEmoji = foldState === "open" ? "📂" : "📁";
                    
                    div.innerHTML = `<div class="folder-ctn" data-folder-name="${folderNameAttr}" data-fold-state="${foldState}">
                      <div class="folder-header" onclick="this.parentNode.dataset.foldState = (this.parentNode.dataset.foldState=='closed' ? 'open' : 'closed'); this.parentNode.querySelector('ul').style.height = (this.parentNode.dataset.foldState=='closed' ? '0px' : 'auto'); this.parentNode.querySelector('.folder-emoji').textContent = (this.parentNode.dataset.foldState=='open' ? '📂' : '📁'); window.__userGeneratorListFolderFoldStates[this.parentNode.dataset.folderName] = (this.parentNode.dataset.foldState=='open' ? 1 : 0); localStorage.userGeneratorListFolderFoldStates = JSON.stringify(window.__userGeneratorListFolderFoldStates);">
                        <span class="folder-emoji">${folderEmoji}</span>
                        <span style="font-weight:bold;">${folderNameHtml}</span>
                        (<span class="folder-item-count">${generators.length}</span>)
                      </div>
                      <ul style="margin:0; overflow:hidden; ${foldState === "open" ? "height:auto" : "height:0"}; padding-left:2rem;">
                        ${generatorListItemsHtml}
                      </ul>
                    </div>`;
                    return div.firstElementChild;
                  };


                  this.changePassword = async () => {

                    this.goto("loadingView");
                    this.setChangePasswordError("none");

                    if(this.refs.passwordChange_newPassword.value.length < 6) {
                      this.goto("passwordChangeView");
                      this.setChangePasswordError("passwordLength");
                      return;
                    }

                    try {

                      let data = await fetch('/api/changePassword', {
                        method: 'POST',
                        body: JSON.stringify({email:app.store.data.user.email, sessionToken:app.store.data.user.sessionToken, currentPassword:this.refs.passwordChange_currentPassword.value, newPassword:this.refs.passwordChange_newPassword.value}),
                        signal: AbortSignal.timeout?.(20*1000),
                        headers: { 'Content-Type': 'application/json'},
                      }).then(r => r.json());

                      if(data.status === "success") {
                        this.setChangePasswordError("none");
                        this.goto("passwordChangeSuccessView");
                        this.refs.passwordChange_currentPassword.value = "";
                        this.refs.passwordChange_newPassword.value = "";
                      } else if(data.status === "session-token-error") {
                        // TODO: test this
                        this.closeModal();
                        app.logout();
                        app.openLoginModal();
                      } else if(data.status === "incorrect-password") {
                        this.goto("passwordChangeView");
                        this.setChangePasswordError("password");
                      } else {
                        console.debug(data);
                        this.goto("passwordChangeView");
                        this.setChangePasswordError("server");
                      }

                    } catch(e) {
                      console.error("Problem loading generator list");
                      console.debug(e);
                      this.goto("passwordChangeView");
                      this.setChangePasswordError("request");
                    }

                  };
                  this.setChangePasswordError = (name) => {
                    this.refs.passwordChangeError_password.style.display = "none";
                    this.refs.passwordChangeError_passwordLength.style.display = "none";
                    this.refs.passwordChangeError_request.style.display = "none";
                    this.refs.passwordChangeError_server.style.display = "none";
                    if(name === "none") {
                      return;
                    } else {
                      this.refs["passwordChangeError_"+name].style.display = "block";
                    }
                  }

                  this.changeEmail = async () => {
                    return alert("Currently changing your account's email is disabled until I get around to fixing a bug. One (annoying) workaround is to create a new account with your new email, and copy your generators across. Please complain on the forum if you want me to move this bug-fix task higher on my todo list.");
                    
                    this.goto("loadingView");
                    this.setChangeEmailError("none");

                    if(!/.+@.+/.test(this.refs.emailChange_newEmail.value)) {
                      this.setChangeEmailError("emailInvalid");
                      return;
                    }
                    try {

                      let data = await fetch('/api/changeEmail', {
                        method: 'POST',
                        body: JSON.stringify({email:app.store.data.user.email, newEmail:this.refs.emailChange_newEmail.value, sessionToken:app.store.data.user.sessionToken, password:this.refs.emailChange_password.value}),
                        signal: AbortSignal.timeout?.(20*1000),
                        headers: { 'Content-Type': 'application/json'},
                      }).then(r => r.json());

                      if(data.status === "success") {
                        this.setChangeEmailError("none");
                        this.goto("emailChangeSuccessView");
                        app.emailChangeCallback(this.refs.emailChange_newEmail.value);
                        // this.update();
                        this.refs.emailChange_newEmail.value = "";
                        this.refs.emailChange_password.value = "";
                      } else if(data.status === "session-token-error") {
                        // TODO: test this
                        this.closeModal();
                        app.logout();
                        app.openLoginModal();
                      } else if(data.status === "incorrect-password") {
                        this.goto("emailChangeView");
                        this.setChangeEmailError("password");
                      } else {
                        console.debug(data);
                        this.goto("emailChangeView");
                        this.setChangeEmailError("server");
                      }

                    } catch(e) {
                      console.error("Problem loading generator list");
                      console.debug(e);
                      this.goto("emailChangeView");
                      this.setChangeEmailError("request");
                    }

                  };
                  this.setChangeEmailError = (name) => {
                    this.refs.emailChangeError_emailInvalid.style.display = "none";
                    this.refs.emailChangeError_password.style.display = "none";
                    this.refs.emailChangeError_request.style.display = "none";
                    this.refs.emailChangeError_server.style.display = "none";
                    if(name === "none") {
                      return;
                    } else {
                      this.refs["emailChangeError_"+name].style.display = "block";
                    }
                  }

                  this.hideAllViews();
                  this.goto("accountMenuView");
                  this.refs.emailChange_password.addEventListener("keyup", (e) => { if(e.which === 13) { this.changeEmail(); } });
                  this.refs.passwordChange_newPassword.addEventListener("keyup", (e) => { if(e.which === 13) { this.changePassword(); } });
                },
              };
            </script>
          </div>
        
          <div id="settingsModalEl" class="app-modal" style="display:none;">
            <div style="z-index:50;" class="background" onmousedown="settingsModal.closeModal()"></div>
            <div style="z-index:51;" class="outer-wrapper" onmousedown="settingsModal.handleOuterWrapperClick(event)">
              <div data-ref="contentWrapper" class="content-wrapper" style="width:800px;">
                <!-- SETTINGS MENU -->
                <div class="view" data-ref="settingsMenuView" style="display: initial;">
                  <div class="modal-header">
                    <p>you're viewing your generator with the url <b class="currentGeneratorNameDisplay">zahid-aistudio</b> - you can:</p>
                    <ul>
                      <li><span class="link" onclick="settingsModal.goto('nameChangeView')">change its url</span></li>
                      <li style="margin-top:0.5rem;"><span class="link" onclick="settingsModal.duplicateGenerator()">duplicate it</span><span data-ref="duplicateGeneratorStatus"></span></li>
                      <li style="margin-top:0.5rem;"><span data-ref="changeGeneratorPrivacyButton" class="link" onclick="settingsModal.changeGeneratorPrivacy()">make public</span></li>
                      <li style="margin-top:0.5rem;"><span class="link" onclick="window.open(`/api/downloadGenerator?generatorName=${app.data.generator.name}`, 'Downloading generator...')">download it</span></li>
                      <li style="margin-top:1em;"><span class="link" onclick="settingsModal.deleteGenerator()" style="color:#e70000;">delete it</span></li>
                    </ul>
                    <div id="privateNotesCtn"></div>
                  </div>
                  <div class="modal-body">
                  </div>
                  <div class="modal-footer">
                    <button style="width:100%;" onclick="settingsModal.closeModal()">close</button>
                  </div>
                </div>
                <!-- NAME CHANGE -->
                <div class="view" data-ref="nameChangeView" style="display: none;">
                  <div class="modal-header">
                    <p>this generator's current url is: <b class="currentGeneratorNameDisplay">zahid-aistudio</b></p>
                    <p style="margin-top:0.4em;">to change it, just enter a new one below. remember: you can only use lower-case letters, numbers and hyphens in your url</p>
                    <p style="margin-top:0.4em;"><b style="color:#f60000;">caution:</b> if you change it, the old url will no longer work! if your generator is popular, and others have imported it into their own, you will <b>break their generators!</b> (they will get import errors). because of this, if your generator is popular, it's better to make a copy of this generator rather than change this one's name</p>
                    <p data-ref="nameChangeError_length" style="display:none; color:red; margin-top:1em;">sorry, the new url must be at least 4 characters long</p>
                    <p data-ref="nameChangeError_request" style="display:none; color:red; margin-top:1em;">there was a problem connecting to the server ¯\_(⊙_ʖ⊙)_/¯ check your internet connection?</p>
                    <p data-ref="nameChangeError_alreadyExists" style="display:none; color:red; margin-top:1em;">sorry, a generator with that name already exists (⌐■_■)</p>
                    <p data-ref="nameChangeError_server" style="display:none; color:red; margin-top:1em;">something went wrong on the server (✖╭╮✖) <a href="https://lemmy.world/c/perchance" target="_blank">plz post to forum</a> if problem persists</p>
                  </div>
                  <div class="modal-body">
                    <input data-ref="newGeneratorName" oninput="settingsModal.handleNewGeneratorNameInput(event)" onpaste="settingsModal.handleNewGeneratorNamePaste(event)" placeholder="new url" type="text">
                  </div>
                  <div class="modal-footer">
                    <button onclick="settingsModal.goto('settingsMenuView')">back</button><button class="main" onclick="settingsModal.changeGeneratorName()">set new url</button>
                  </div>
                </div>
                <!-- NAME CHANGE SUCCESS -->
                <div class="view" data-ref="nameChangeSuccessView" style="display: none;">
                  <div class="modal-header">
                    <p>your generator's url has been changed ヾ(⌐■_■)ノ♪♬</p>
                  </div>
                  <div class="modal-body">
                  </div>
                  <div class="modal-footer">
                    <button style="width:100%;" onclick="settingsModal.closeModal()">close</button>
                  </div>
                </div>
                <!-- LOADING -->
                <div class="view" data-ref="loadingView" style="display: none;">
                  <!-- <emoji-ajax-spinner style="display:block; margin:5em 0;" verb="loading"/> -->
                  <div style="margin:5em 0; text-align:center;">⏳ loading...</div>
                </div>
              </div>
            </div>
            <script>
              window.settingsModal = {
                root: document.querySelector("#settingsModalEl"),
                refs: new Proxy({}, {
                  get(target, prop, receiver) {
                    return document.querySelector(`#settingsModalEl [data-ref='${prop}']`);
                  },
                }),
                init: function() {
                  this.closeModal = function() {
                    // privateNotesCtn.innerHTML = ""; // commented out because it could still be saving when they close it.
                    this.root.style.display = "none";
                  }
                  this.openModal = function() {
                    privateNotesCtn.innerHTML = ""; // already done in loadPrivateNotes, but just for extra safety
                    this.loadPrivateNotes();
                    this.goto("settingsMenuView");
                    this.root.style.display = "block";
                  }
                  this.handleOuterWrapperClick = function(e) {
                    if(!this.refs.contentWrapper.contains(e.target)) {
                      this.closeModal();
                    }
                  }
                  this.goto = function(name) {
                    this.hideAllViews();
                    let el = this.refs[name];
                    el.style.display = "initial";
                    settingsModalEl.querySelectorAll(".currentGeneratorNameDisplay").forEach(el => el.textContent=app.data.generator.name);
                    if(el.querySelector("input")) {
                      // TODO: move caret to end of text if there is text in the input
                      setTimeout(() => { el.querySelector("input").focus(); },200);
                    }
                  }
                  this.hideAllViews = function() {
                    let views = this.root.querySelectorAll(".content-wrapper .view");
                    for(let el of Array.from(views)) {
                      el.style.display = "none";
                    }
                  }
                  this.getCurrentView = function() {
                    let views = this.root.querySelectorAll(".content-wrapper .view");
                    for(let el of Array.from(views)) {
                      if( el.style.display !== "none" ) return el.attributes.ref.value;
                    }
                  };
                  this.handleNewGeneratorNamePaste = (e) => {
                    // let original = e.target.value;
                    // setTimeout(() => { e.target.value = original; },100);
                  };
                  this.handleNewGeneratorNameInput = (e) => {
                    let caretPos = e.target.selectionStart;
                    let text = e.target.value;
                    if(text === "") { return; }
                    let output = "";
                    for(let c of text) {
                      if(/[A-Z]/.test(c)) {
                        output += c.toLowerCase();
                      } else if(/[ \-]/.test(c)) {
                        output += "-";
                      } else if(/[0-9a-z]/.test(c)) {
                        output += c;
                      } else {
                        output += "-";
                      }
                    }
                    e.target.value = output;
                    setCaretPosition(e.target, caretPos);
                  };
                  function setCaretPosition(elem, caretPos) {
                    let range;
                    if (elem.createTextRange) {
                      range = elem.createTextRange();
                      range.move('character', caretPos);
                      range.select();
                    } else {
                      elem.focus();
                      if (elem.selectionStart !== undefined) {
                        elem.setSelectionRange(caretPos, caretPos);
                      }
                    }
                  }

                  var allowedNamesWithLessThan4Chars = ["hub"];
                  this.changeGeneratorName = async () => {

                    this.goto("loadingView");
                    this.setNameChangeError("none");

                    if(this.refs.newGeneratorName.value.length < 4 && !allowedNamesWithLessThan4Chars.includes(this.refs.newGeneratorName.value)) {
                      this.setNameChangeError("length");
                      this.goto("nameChangeView");
                      return;
                    }

                    try {

                      let data = await fetch('/api/changeGeneratorName', {
                        method: 'POST',
                        body: JSON.stringify({email:app.store.data.user.email, sessionToken:app.store.data.user.sessionToken, currentName:app.data.generator.name, newName:this.refs.newGeneratorName.value}),
                        signal: AbortSignal.timeout?.(20*1000),
                        headers: { 'Content-Type': 'application/json'},
                      }).then(r => r.json());

                      if(data.status === "success") {
                        this.setNameChangeError("none");
                        this.goto("nameChangeSuccessView"); 
                        app.data.generator.name = this.refs.newGeneratorName.value;
                        window.generatorName = this.refs.newGeneratorName.value;
                        app.data.generator.publicId = data.publicId;
                        window.generatorPublicId = data.publicId;
                        window.history.replaceState(null, null, "/"+this.refs.newGeneratorName.value+window.location.hash);
                        // this.update();
                        this.refs.newGeneratorName.value = "";
                        window.hardReloadOutputIframe(); // needed to ensure e.g. comments-plugin, text-to-image-plugin gallery, etc. have correct URL
                      } else if(data.status === "session-token-error") {
                        // TODO: test this
                        this.closeModal();
                        app.logout();
                        app.openLoginModal();
                      } else if(data.status === "already-exists") {
                        this.goto("nameChangeView");
                        this.setNameChangeError("alreadyExists");
                      } else {
                        console.debug(data);
                        this.goto("nameChangeView");
                        this.setNameChangeError("server");
                      }

                    } catch(e) {
                      console.error("Problem while requesting generator name change");
                      console.debug(e);
                      this.goto("nameChangeView");
                      this.setNameChangeError("request");
                    }

                  };
                  this.setNameChangeError = (name) => {
                    this.refs.nameChangeError_alreadyExists.style.display = "none";
                    this.refs.nameChangeError_request.style.display = "none";
                    this.refs.nameChangeError_server.style.display = "none";
                    this.refs.nameChangeError_length.style.display = "none";
                    if(name === "none") {
                      return;
                    } else {
                      this.refs["nameChangeError_"+name].style.display = "block";
                    }
                  }


                  this.deleteGenerator = async () => {

                    let confirm = prompt("Are you sure you want to delete this generator? You cannot undo this action. Type \"yes\" to confirm that you want to delete this generator:");

                    if(confirm !== "yes") {
                      return;
                    }

                    this.goto("loadingView");

                    try {

                      let data = await fetch('/api/deleteGenerator', {
                        method: 'POST',
                        body: JSON.stringify({email:app.store.data.user.email, sessionToken:app.store.data.user.sessionToken, generatorName:app.data.generator.name}),
                        signal: AbortSignal.timeout?.(20*1000),
                        headers: { 'Content-Type': 'application/json'},
                      }).then(r => r.json());

                      if(data.status === "success") {
                        alert("This generator has been successfully deleted. You'll now be redirected to the homepage.");
                        window.userDeletedGenerator = true;
                        window.location.href = "https://perchance.org";
                      } else if(data.status === "session-token-error") {
                        this.closeModal();
                        app.logout();
                        app.openLoginModal();
                      } else {
                        alert("Something went wrong. If this error persists, please report it to lemmy.world/c/perchance - thanks!");
                        console.debug(data);
                        this.goto("settingsMenuView");
                      }

                    } catch(e) {
                      alert("Something went wrong. If this error persists, please report it to lemmy.world/c/perchance - thanks!");
                      console.error("Problem with request to delete generator");
                      console.debug(e);
                      this.goto("settingsMenuView");
                    }

                  };


                  this.changeGeneratorPrivacy = async () => {

                    if(!app.data.generator.isPrivate) {
                      let okay = window.confirm("Note that this action will de-list your generator from all publicly accessible Perchance generator lists. Anyone who has your generator's link will still be able to access it. You can easily undo this action.");
                      if(!okay) {
                        return;
                      }
                    }

                    this.goto("loadingView");

                    try {

                      let data = await fetch('/api/changeGeneratorPrivacy', {
                        method: 'POST',
                        body: JSON.stringify({email:app.store.data.user.email, sessionToken:app.store.data.user.sessionToken, generatorName:app.data.generator.name, isPrivate:app.data.generator.isPrivate ? false : true}),
                        signal: AbortSignal.timeout?.(20*1000),
                        headers: { 'Content-Type': 'application/json'},
                      }).then(r => r.json());

                      if(data.status === "success") {
                        app.data.generator.isPrivate = !app.data.generator.isPrivate;
                        this.refs.changeGeneratorPrivacyButton.innerHTML = `make ${app.data.generator.isPrivate ? "public" : "private"}`;
                        this.goto("settingsMenuView");
                      } else if(data.status === "session-token-error") {
                        this.closeModal();
                        app.logout();
                        app.openLoginModal();
                      } else {
                        alert("Something went wrong. If this error persists, please report it to lemmy.world/c/perchance - thanks!");
                        console.debug(data);
                        this.goto("settingsMenuView");
                      }

                    } catch(e) {
                      alert("Something went wrong. If this error persists, please report it to lemmy.world/c/perchance - thanks!");
                      console.error("Problem with request to delete generator");
                      console.debug(e);
                      this.goto("settingsMenuView");
                    }

                  };


                  this.duplicateGenerator = async () => {

                    this.goto("loadingView");

                    try {

                      let data = await fetch('/api/duplicateGenerator', {
                        method: 'POST',
                        body: JSON.stringify({
                          email: app.store.data.user.email,
                          sessionToken: app.store.data.user.sessionToken,
                          generatorName: app.data.generator.name,
                          // overrides are only needed if the user owns this gen, since otherwise they'd just use the save button:
                          outputTemplateOverride: window.userOwnsThisGenerator ? window.outputTemplateEditor?.getValue() : null,
                          modelTextOverride: window.userOwnsThisGenerator ? window.modelTextEditor?.getValue() : null,
                        }),
                        signal: AbortSignal.timeout?.(20*1000),
                        headers: { 'Content-Type': 'application/json'},
                      }).then(r => r.json());

                      if(data.status === "success") {
                        this.refs.duplicateGeneratorStatus.innerHTML = `<span style="color:green;"> Success!</span> → <a target="_blank" href="/${data.newGeneratorName}#edit">${data.newGeneratorName}</a>`;
                        this.goto("settingsMenuView");
                      } else if(data.status === "session-token-error") {
                        this.closeModal();
                        app.logout();
                        app.openLoginModal();
                      } else {
                        alert("Something went wrong. If this error persists, please report it to lemmy.world/c/perchance - thanks!");
                        console.debug(data);
                        this.goto("settingsMenuView");
                      }

                    } catch(e) { 
                      alert("Something went wrong. If this error persists, please report it to lemmy.world/c/perchance - thanks!");
                      console.error("Problem with request to duplicate generator");
                      console.debug(e);
                      this.goto("settingsMenuView");
                    }

                  };

                  function indentTextareaModule() {
                    // https://esm.sh/indent-textarea@4.0.0?bundle
                    function a(t,e){let n=t.ownerDocument,o=n.activeElement;o!==t&&t.focus(),e===""?n.execCommand("delete"):n.execCommand("insertText",!1,e),o===n.body?t.blur():o instanceof HTMLElement&&o!==t&&o.focus()}function p(t){let{selectionStart:e,selectionEnd:n,value:o}=t,c=o.slice(e,n);if(/\n/g.exec(c)?.length>0){let i=o.lastIndexOf(`\n`,e-1)+1,s=t.value.slice(i,n-1),r=s.replaceAll(/^|\n/g,"$&    "),l=r.length-s.length;t.setSelectionRange(i,n-1),a(t,r),t.setSelectionRange(e+1,n+l)}else a(t,"    ")}function g(t,e){let n=t.lastIndexOf(`\n`,e-1)+1;return t.charAt(n)!=="    "?e:n+1}function f(t){let{selectionStart:e,selectionEnd:n,value:o}=t,c=o.lastIndexOf(`\n`,e-1)+1,u=g(o,n),i=t.value.slice(c,u),s=i.replaceAll(/(^|\n)(\t| {1,2})/g,"$1"),r=i.length-s.length;t.setSelectionRange(c,u),a(t,s);let l=/\t| {1,2}/.exec(o.slice(c,e)),x=l?l[0].length:0,S=e-x;t.setSelectionRange(e-x,Math.max(S,n-r))}function d(t){if(t.defaultPrevented||t.metaKey||t.altKey||t.ctrlKey)return;let e=t.target;t.key==="Tab"?(t.shiftKey?f(e):p(e),t.preventDefault(),t.stopImmediatePropagation()):t.key==="Escape"&&!t.shiftKey&&(e.blur(),t.preventDefault(),t.stopImmediatePropagation())}function h(t,e){typeof t=="string"?t=document.querySelectorAll(t):t instanceof HTMLTextAreaElement&&(t=[t]);for(let n of t)n.addEventListener("keydown",d,{signal:e})}var m=p,y=f,I=d,L=h;
                    return {enableTabToIndent:h,eventHandler:I,indent:m,indentSelection:p,tabToIndentListener:d,unindent:y,unindentSelection:f,watch:L};
                  }

                  this.loadPrivateNotes = async () => {
                    privateNotesCtn.innerHTML = "";
                    privateNotesCtn.innerHTML = `<div style="position:relative; margin-top:1.1rem;">
                      <div>Private Notes:</div>
                      <textarea id="privateNotesEl" disabled style="padding:0.1rem 0.35rem; width:100%; height:130px; resize:vertical; min-height:50px; display:block; box-sizing:border-box; white-space:pre; tab-size:2;" placeholder="⏳ Loading..."></textarea>
                      <div id="privateNotesSaveIndicatorEl" style="display:none; position:absolute; bottom:0.5rem; right:0.5rem; pointer-events:none; border:1px solid gray; border-radius:3px; padding:0.08rem 0.2rem; font-family:sans-serif; box-sizing:border-box; background:light-dark(white, #343434);">saving...</div>
                    </div>`;

                    indentTextareaModule().enableTabToIndent(privateNotesEl);

                    let data = await fetch('/api/getPrivateNotes', {
                      method: 'POST',
                      body: JSON.stringify({email:app.store.data.user.email, sessionToken:app.store.data.user.sessionToken, generatorName:app.data.generator.name}),
                      signal: AbortSignal.timeout?.(20*1000),
                      headers: { 'Content-Type': 'application/json'},
                    }).then(r => r.json());

                    if(data.status !== "success") {
                      privateNotesEl.placeholder = `Error loading private notes (error: ${data.status}). Trying again in a few seconds...`;
                      await new Promise(r => setTimeout(r, 2000));
                      return this.loadPrivateNotes();
                    }

                    privateNotesEl.value = data.privateNotes;
                    privateNotesEl.placeholder = "Use this box for notes about this generator that you don't want to be publicly viewable.";
                    privateNotesEl.disabled = false;
                    privateNotesSaveIndicatorEl.textContent = "✅ saved";
                    
                    let currentSaveIndex = -1;
                    let saveTimeout;
                    privateNotesEl.addEventListener("input", () => {
                      currentSaveIndex++;
                      let thisSaveIndex = currentSaveIndex;
                      privateNotesSaveIndicatorEl.style.display = "block";
                      privateNotesSaveIndicatorEl.textContent = "unsaved";
                      clearTimeout(saveTimeout);
                      saveTimeout = setTimeout(async () => {
                        if(thisSaveIndex !== currentSaveIndex || !document.querySelector("#privateNotesEl")) return;
                        privateNotesSaveIndicatorEl.textContent = "⏳ saving...";
                        try {
                          await this.savePrivateNotes();
                          if(thisSaveIndex === currentSaveIndex && document.querySelector("#privateNotesEl")) privateNotesSaveIndicatorEl.textContent = "✅ saved";
                          setTimeout(() => {
                            if(thisSaveIndex === currentSaveIndex && document.querySelector("#privateNotesEl")) privateNotesSaveIndicatorEl.style.display = "none";
                          }, 2000);
                        } catch(e) {
                          console.error("Problem saving private notes", e);
                          if(thisSaveIndex === currentSaveIndex && document.querySelector("#privateNotesEl")) privateNotesSaveIndicatorEl.textContent = "⚠️ error";
                        }
                      }, 1000);
                    });
                  };

                  this.savePrivateNotes = async () => {
                    let data = await fetch('/api/setPrivateNotes', {
                      method: 'POST',
                      body: JSON.stringify({email:app.store.data.user.email, sessionToken:app.store.data.user.sessionToken, generatorName:app.data.generator.name, privateNotes:privateNotesEl.value}),
                      signal: AbortSignal.timeout?.(20*1000),
                      headers: { 'Content-Type': 'application/json'},
                    }).then(r => r.json());
                    if(data.status !== "success") {
                      throw new Error("Server error");
                    }
                  };

                  this.hideAllViews();
                  this.goto("settingsMenuView");
                  this.refs.newGeneratorName.addEventListener("keyup", (e) => { if(e.which === 13) { this.changeGeneratorName(); } });
                  this.refs.changeGeneratorPrivacyButton.innerHTML = `make ${app.data.generator.isPrivate ? "public" : "private"}`;
                },
              };
            </script>
          </div>
        
          <div id="revisionsModalEl" class="app-modal" style="display:none;">
            <div style="z-index:50;" class="background" onclick="revisionsModal.closeModal()"></div>
            <div style="z-index:51;" class="outer-wrapper" onclick="revisionsModal.handleOuterWrapperClick(event)">
              <div data-ref="contentWrapper" class="content-wrapper">
                <div class="view" data-ref="revisionsView">
                  <div class="modal-header">
                    <p>if you click the button below, it will load a list of older versions of your generator so you can download them in case you accidentally deleted your code, or there was a system error. copies of your generator code are also backed-up to your local browser storage, so if your computer ever crashes and you hadn't saved in a while, you'll be able to come here to recover your data.</p>
                    <p style="text-align:center;"><button style="margin-top:1em;" onclick="revisionsModal.loadRevisionsList()" data-ref="revisionsButton">load backup/revision history</button></p>
                    <div data-ref="revisionsList" style="display:none; max-height:400px; overflow-y:auto; margin-top:1em;">
                      <ul style="margin:0;"></ul>
                    </div>
                    <div data-ref="loadingSpinner" style="display:none">
                      <!-- <emoji-ajax-spinner style="display:none; margin:5em 0;" verb="loading"/> -->
                      <div style="margin:5em 0; text-align:center;">⏳ loading...</div>
                    </div>
                    <p data-ref="revisionsError" style="color:red; display:none;">hmm (⊙_☉) there was some sort of server error while trying to get your revision history. sorry! this doesn't happen very often. if it keeps happening (and you've checked your internet connection), could you please make a post on the <a href="https://lemmy.world/c/perchance" target="_blank">forum</a>?</p>
                  </div>
                  <div class="modal-body"></div>
                  <div class="modal-footer">
                    <button style="width:100%;" onclick="revisionsModal.closeModal()">close</button>
                  </div>
                </div>
              </div>
            </div>
            <script>
              window.revisionsModal = {
                root: document.querySelector("#revisionsModalEl"),
                refs: new Proxy({}, {
                  get(target, prop, receiver) {
                    return document.querySelector(`#revisionsModalEl [data-ref='${prop}']`);
                  },
                }),
                init: function() {
                  this.closeModal = function() {
                    this.root.style.display = "none";
                  }
                  this.openModal = function() {
                    this.root.style.display = "block";
                    this.refs.revisionsError.style.display = "none";
                    this.refs.revisionsList.style.display = "none";
                    this.refs.revisionsButton.style.display = "";
                  }
                  this.handleOuterWrapperClick = function(e) {
                    if(!this.refs.contentWrapper.contains(e.target)) {
                      this.closeModal();
                    }
                  }

                  this.loadRevisionsList = async () => {

                    this.refs.loadingSpinner.style.display = "";
                    this.refs.revisionsError.style.display = "none";
                    this.refs.revisionsButton.style.display = "none";
                    this.refs.revisionsList.style.display = "none";

                    try {

                      let userData = JSON.parse(localStorage["app-storage"]).user;
                      
                      window.diffStuff.patches = await fetch("https://perchance.org/api/getGeneratorDiffPatches", {
                        method:"POST",
                        headers: {"Content-Type": "application/json; charset=utf-8"},
                        body:JSON.stringify({
                          generatorName: app.data.generator.name,
                          email: userData.email,
                          sessionToken: userData.sessionToken,
                        }),
                      }).then(r => r.json());

                      window.diffStuff.patches.sort((a, b) => a.creationTime-b.creationTime);
                      window.diffStuff.modelTextPatches = window.diffStuff.patches.map(o => o.modelTextPatch);
                      window.diffStuff.outputTemplatePatches = window.diffStuff.patches.map(o => o.outputTemplatePatch);

                      window.diffStuff.patches.sort((a, b) => b.creationTime-a.creationTime);
                      listHTML = window.diffStuff.patches.map((p, i, arr) => `<li style="margin-top:0.25rem;" onclick="window.diffStuff.openNewTabWithRevision(${arr.length-1-i}, '${app.data.generator.name}')"><span class="clickable">${new Date(p.creationTime).toString()}</span></li>`).join("");

                      let localBackupsArray = await kv.localBackups.get(app.data.generator.name) || [];
                      window.downloadLocalBackup = async (i) => {
                        let backup = localBackupsArray[i];
                        let intro = "<<<<< this file contains your perchance lists first, and your HTML code underneath it >>>>>\n\n\n\n";
                        window.downloadTextFile(intro+backup.modelText+("\n".repeat(20))+backup.outputTemplate+("\n".repeat(20)), `${app.data.generator.name}-revision-${new Date(backup.time).toString().toLowerCase().split(" ").slice(0, 5).join("-").replace(/:/g, "-")}.txt`);
                      };
                      let localBackupsHTML = "";
                      if(localBackupsArray.length > 0) {
                        localBackupsHTML = localBackupsArray.map((d, i) => `<li style="margin-top:0.25rem;" onclick="window.downloadLocalBackup(${i})"><span class="clickable" style="color:#e8690b;">(<b>browser storage</b>) ${new Date(d.time).toString()}</span></li>`).join("");
                        localBackupsHTML += "<hr>";
                      }
                      
                      listHTML = localBackupsHTML + listHTML;

                      this.refs.revisionsList.querySelector("ul").innerHTML = listHTML.trim() === "" ? "<li style='color:black; text-decoration:none;'>no revisions/backups yet! try making an edit to your generator and then save</li>" : listHTML;

                      this.refs.revisionsList.style.display = "";
                      this.refs.revisionsError.style.display = "none";
                      this.refs.loadingSpinner.style.display = "none";

                    } catch(e) {
                      console.error("Problem loading revision list");
                      console.debug(e);
                      this.refs.revisionsError.style.display = "";
                      this.refs.revisionsButton.style.display = "";
                      this.refs.revisionsList.style.display = "none";
                      this.refs.loadingSpinner.style.display = "none";
                    }
                  };
                },
              };
            </script>
          </div>
        <div id="adCtn" style="padding: 4px 0px; text-align: center; display: flex; align-items: center; justify-content: center; position: relative; min-height: 50px !important; max-height: 50px !important; height: 50px !important; overflow: hidden !important;"></div></div>

        <script>
          window.app = {
            root: document.querySelector("#appEl"),
            refs: new Proxy({}, {
              get(target, prop, receiver) {
                return document.querySelector(`#appEl [data-ref='${prop}']`);
              },
            }),
            data: {},
            exitWarningAttached: false,
            init: async function({generator, dependencies}) {
              
              this.initializeEditorPromise = null;

              const originalLocationHash = window.location.hash;
              
              this.goToEditMode = async () => {
                
                // To prevent accidental second click in the position of the edit button, resulting in a save, since the save button appears in its place.
                // We switch back to normal values after switchToEditMode() has executed.
                let saveBtn = document.querySelector(`#menuBarEl [data-ref='saveButton']`);
                saveBtn.style.pointerEvents = 'none';

                if(!this.initializeEditorPromise) {
                  this.initializeEditorPromise = window.editor.init({startInEditMode:true});
                }
                await this.initializeEditorPromise;
                this.appInteractionState = "edit";
                this.trigger("AppInteractionStateChange");
                editor.switchToEditMode();

                setTimeout(() => {
                  saveBtn.style.pointerEvents = '';
                }, 700);
                
                if(location.hash === "") { // if there's already a hash, we don't edit it, since we now transfer the hash to the iframe so people can use it for stuff in generators, and the #edit part of the URL isn't "ground truth" - it's just a handy way of sharing a gen that goes straight to edit mode
                  let url = new URL(location.href);
                  url.hash = /^#edit($|:)/.test(originalLocationHash) ? originalLocationHash : "#edit"; // must ensure we e.g. add collab key back if there was one
                  history.replaceState({}, "", url.href); // we do this rather than setting the hash with location.hash because otherwise it essentially does a pushState behind the scenes
                }
                
                // initialPageLoadSpinner.style.display = "none"; // otherwise when the generator is frozen and they click edit, the loading spinner doesn't go away
            
                // this.update();
              };
              
              this.goToViewMode = () => {

                this.appInteractionState = "view";
                this.trigger("AppInteractionStateChange");
                
                if(this.initializeEditorPromise) editor.switchToViewMode(); // page load in 'view mode' by default, so only needed if we've inited editor

                if(/^#edit($|:)/.test(window.location.hash)) {
                  this.removeURLHash();
                  let metaData = editor.generatorMetaData;
                  if(!metaData) metaData = window.generatorStaticMetaData;
                  if(metaData && metaData.header?.mode === "minimal") { 
                    menuBarEl.style.display = "none";
                    minimalModeMenuBtn.style.display = "flex"; 
                  }
                }
                // this.update();
              };
            
              this.removeURLHash = () => {
                history.replaceState(null, document.title, window.location.pathname + window.location.search);
              };

              let generatorEditedMostRecentCallbackCallIndex = 0;
              this.generatorEditedCallback = async (data, opts={}) => {
                generatorEditedMostRecentCallbackCallIndex++;
                let thisCallbackCallIndex = generatorEditedMostRecentCallbackCallIndex;
                let changed = false;
                let importsChanged = false;
                if(data.modelText !== undefined) {
                  this.data.generator.modelText = data.modelText;
                  changed = true;
                }
                if(data.outputTemplate !== undefined) {
                  this.data.generator.outputTemplate = data.outputTemplate;
                  changed = true
                }
                if(data.imports !== undefined) {
                  let currentImportsSet = new Set(this.data.generator.imports);
                  if(data.imports.sort().toString() !== this.data.generator.imports.sort().toString()) { // if sets are not equal
                    this.data.generator.imports = data.imports;
                    changed = true;
                    importsChanged = true;
                  }
                }
                // if it's changed, we set save state to unsaved, but only if the actual save request has been sent (which is why we check savingNowButStillWaitingForIframeReload here). if it's waiting for the iframe, then we've snuck in the changed data before it was sent to the server, so we're good.
                if(changed && !window.savingNowButStillWaitingForIframeReload) {
                  // save request has been sent to server, so we wait for it to finish, and then set save state to 'unsaved'
                  while(menuBar.saveState === "saving") {
                    if(thisCallbackCallIndex !== generatorEditedMostRecentCallbackCallIndex) return; // there's a newer one, so this one is not needed anymore (important to prevent "traffic jam" for autoSave stuff below)
                    await new Promise(r => setTimeout(r, 50));
                  }
            
                  menuBar.setSaveState("unsaved");
                  if(await window.thisIsNotAnOldCachedPagePromise) { // <-- we don't want an importUpdate message to block a cache-busting page reload
                    this.attachExitWarning(); // this actually only needs to be called once, but meh (it *replaces* the last one anyway)
                  }
                }
              };
              this.attachExitWarning = () => {
                if(!this.exitWarningAttached) {
                  // if there are unsaved changes and the user tries to navigate away from the page, warn them
                  window.onbeforeunload = (e) => {
                    if(menuBar.saveState === "unsaved" && !window.userDeletedGenerator && window.hasBeenInEditModeAtLeastOnce) { // window.hasBeenInEditModeAtLeastOnce is due to importsUpdate 'bug' where user can save gen without correct imports, causing visitors to have to download them on the fly, but that triggers a gen data change, which will trigger this handler if not for the window.hasBeenInEditModeAtLeastOnce check. hacky.
                      var dialogText = "You've got unsaved changes! Are you sure you want to exit?";
                      e.returnValue = dialogText;
                      return dialogText;
                    }
                  };
                  this.exitWarningAttached = true;
                }
              };
              this.openLoginModal = () => {
                loginModal.openModal();
              };
              this.openAccountModal = () => {
                accountModal.openModal();
              };
              this.openSettingsModal = () => {
                settingsModal.openModal();
              };
              this.openRevisionsModal = () => {
                revisionsModal.openModal();
              };
              this.loginSuccessCallback = (details) => {
                this.store.data.user = {email:details.email, sessionToken:details.sessionToken, loggedIn:true};
                this.store.save();
                // this.update();
                this.checkIfOwner();
                this.trigger("LoginStateChange");
              };
              this.emailChangeCallback = (newEmail) => {
                this.store.data.user.email = newEmail;
              };
              this.saveSuccessCallback = (name, publicId) => {
                if(name !== undefined) { // for when the save creates a new generator
                  this.data.generator.name = name;
                  this.data.generator.publicId = publicId; 
                }
                // this.update();
              };
              this.logout = () => {
                settingsModal.closeModal();
                accountModal.closeModal();
                // menuBar.isOwner = false;
                this.store.data.user = {loggedIn:false};
                localStorage.sessionTokenLastChangeTime = Date.now();
                this.store.save();
                // this.update();
                this.trigger("LoginStateChange");
              };
              this.handleIframeSaveRequest = () => {
                let collabEditKey = /^#edit($|:)/.test(window.location.hash) ? window.location.hash.replace("#edit:", "").split(";").filter(kv => kv.startsWith("collab=")).map(kv => kv.split("=")[1])[0] : undefined;
                if((window.userOwnsThisGenerator && this.store.data.user.loggedIn) || collabEditKey || localStorage[`perchance_generatorEditKey_${this.data.generator.name}`]) {
                  this.saveGenerator();
                }
              };
              this.attachKeyboardShortcuts = () => { 
                // CTRL/CMD + S
                document.addEventListener("keydown", (e) => {
                  if(e.keyCode == 83 && (navigator.platform.match("Mac") ? e.metaKey : e.ctrlKey)) {
                    e.preventDefault();
                    this.saveGenerator();
                  }
                }, false);
              };

              this.eventListeners = {
                "appinteractionstatechange": [],
                "generatorownershipchange": [],
                "loginstatechange": [],
              }
              this.on = function(name, handler) {
                this.eventListeners[name.toLowerCase()].push(handler);
              };
              this.trigger = function(name, data={}) {
                for(let fn of this.eventListeners[name.toLowerCase()]) {
                  fn(data);
                }
              };

              this.checkIfOwner = async () => {
                try {
                  let data = await fetch('/api/checkGeneratorOwnership', {
                    method: 'POST',
                    body: JSON.stringify({email:this.store.data.user.email, sessionToken:this.store.data.user.sessionToken, generatorName:this.data.generator.name}),
                    signal: AbortSignal.timeout?.(20*1000),
                    headers: { 'Content-Type': 'application/json'},
                  }).then(r => r.json());
            
                  if(data.status === "is-owner") {
                    if(!localStorage.generatorsLikelyOwned || !localStorage.generatorsLikelyOwned.includes(`,${this.data.generator.name},`)) localStorage.generatorsLikelyOwned = (localStorage.generatorsLikelyOwned || "") + `,${this.data.generator.name},`; // this is for quick synchonous stuff at page load where correctness isn't super important
                    window.userOwnsThisGenerator = true;
                    this.trigger("GeneratorOwnershipChange");
                    if(!window.editsHaveBeenMadeSincePageLoad) menuBar.setSaveState("saved");
                    return true; 
                  } else if(data.status === "is-not-owner") {
                    window.userOwnsThisGenerator = false;
                    this.trigger("GeneratorOwnershipChange");
                    menuBar.setSaveState("unsaved"); // <-- it's not saved if they're not the owner
                  } else if(data.status === "session-token-error") {
                    this.logout();
                    // this.openLoginModal();
                    // alert("Sorry! Your session has expired, please login again.")
                  } else {
                    console.error("server error / unhandled response from checkGeneratorOwnership:");
                    console.debug(data);
                  }
                } catch(e) {
                  console.error("Problem with request to /api/checkGeneratorOwnership");
                  console.debug(e);
                  alert("There was a problem while loading this generator. If your internet connection is slow or intermittent, this could be the cause. Please try reloading the page.");
                }
              };



              // NOTE: THIS IS DEFINITELY NOT FULL-PROOF because browsers seem to pause tabs that haven't been active in a while (probably to converse memory/cpu).
              // So I should really switch to an approach like this: https://stackoverflow.com/a/69924841/11950764 (BroadcastChannel)
              // keep track of open generator tabs so we can warn if they are owner and have the same generator open twice and are editing:
              const tabTrackerUpdateInterval = 70000; // milliseconds - it needs to be higher than 1 min since chrome suspends tabs and wakes them only once per minute, and we send the "i'm still alive" pings during those wakes.
              function clearOldTabRecords(tabsOpen) {
                for(let [genName, tabIdDict] of Object.entries(tabsOpen)) {
                  for(let [tId, lastSeenTime] of Object.entries(tabIdDict)) {
                    if(Date.now()-lastSeenTime > tabTrackerUpdateInterval*2) {
                      console.debug(`Tab has not been seen in a while, assuming closed: ${genName} ${tId}`);
                      delete tabIdDict[tId];
                    }
                  }
                  if(Object.keys(tabIdDict).length === 0) {
                    console.debug(`No more tabs of this gen: ${genName}`);
                    delete tabsOpen[genName];
                  }
                }
              }
              let tabId = Math.random().toString().replace(".", "");
              setInterval(() => {
                let generatorName = app.data.generator.name;
                let tabsOpen;
                try {
                  tabsOpen = JSON.parse(localStorage.perchanceTabsOpen || "{}"); // {generatorName1: {tabId1:lastSeenTime}, generatorName2: {tabId2:lastSeenTime}, ...}
                } catch(e) { 
                  console.warn("Something went wrong with localStorage.perchanceTabsOpen?");
                  tabsOpen = {};
                }
                if(!tabsOpen[generatorName]) tabsOpen[generatorName] = {};
                tabsOpen[generatorName][tabId] = Date.now();
                clearOldTabRecords(tabsOpen);
                localStorage.perchanceTabsOpen = JSON.stringify(tabsOpen);
              }, tabTrackerUpdateInterval);
              // this beforeunload will work most of the time, but we need the above mess (based on time-since-last-seen tabId) in case of e.g. sudden computer shutdown.
              window.addEventListener("beforeunload", function() {
                let tabsOpen = JSON.parse(localStorage.perchanceTabsOpen || "{}");
                if(tabsOpen[app.data.generator.name]) delete tabsOpen[app.data.generator.name][tabId];
                localStorage.perchanceTabsOpen = JSON.stringify(tabsOpen);
                return null;
              }); 
              
              let collabEditKeyIsIncorrect = false;
              (async function() { 
                let collabEditKey = /^#edit($|:)/.test(window.location.hash) ? window.location.hash.replace("#edit:", "").split(";").filter(kv => kv.startsWith("collab=")).map(kv => kv.split("=")[1])[0] : undefined;
                if(!collabEditKey) return;
                while(1) {
                  await new Promise(r => setTimeout(r, 30*1000));
                  let collabEditKey = /^#edit($|:)/.test(window.location.hash) ? window.location.hash.replace("#edit:", "").split(";").filter(kv => kv.startsWith("collab=")).map(kv => kv.split("=")[1])[0] : undefined;
                  let invalid = await fetch(`/api/validateCollabEditKey?generatorName=${window.generatorName}&key=${collabEditKey}`, {signal:AbortSignal.timeout(10000)}).then(r => r.json()).then(o => o.status === "invalid").catch(console.error);
                  if(invalid) {
                    collabEditKeyIsIncorrect = true;
                    try { window.yjsProvider.disconnect(); } catch(e) { console.error(e); }
                    break;
                  }
                }
              })();

              let doNotAskToSaveEditPasswordFor = new Set();
              window.inMemoryGeneratorNameToEditKey = {};
              let exampleGeneratorsOrPluginsEtc = ["blank", "layout-maker-plugin","examples","generators","download-button-plugin","perchance-keyboard-shortcuts","quug0pp21x","simple-if-else-example","simple-if-else-example-3","simple-if-else-example-2","simple-if-else-example-4","simple-critical-hit-example","simple-critical-hit-example-with-function","textarea-example","user-input-list-example","multiple-drop-down-lists-example","dynamic-drop-down-list-example","simple-checkbox-example","checkbox-checklist-example","color-picker-example","hierarchy-example-2","critical-hit-if-condition-is-met","critical-hit-if-condition-is-met-multi-line","critical-hit-if-condition-is-met-with-function","function-with-2-inputs-example","executing-and-hiding-result-example","getparent-getname-example","create-instance-plugin","dynamic-sublist-referencing-example","matching-pronouns-with-genders-example","dynamic-sub-list-referencing-example","multiple-independent-outputs-example","multiple-independent-outputs-example-2","multiple-buttons-same-output","your-generators-name","tags-and-header-meta-data-example","selectmany-sumitems-example","roll-number-of-dice-based-on-previous-roll","draw-a-river-example","add-up-randomly-generated-numbers-example","choose-a-list-based-on-a-selected-number","append-items-when-click-example","output-history-example","hide-output-until-click-example","select-leaf-plugin-example","consumable-leaf-list-plugin-example","dice-game-example","passing-variables-to-lists-example","consumable-list-with-dynamic-odds-example","indented-html-in-your-lists-example","character-role-consumable-example","consumable-list-with-nested-properties","three-percentages-example","click-to-hide-show-text-example","custom-cursor-example","counting-item-selections-example","simple-random-images-example","simple-random-image-example-cropped","add-images-to-output","random-image-with-name-example","random-images-example","acronym-from-words-example","p5js-basic-example","permutations-counter-example","income-by-city-example","randomize-at-regular-intervals-example","future-presidents-example","if-else-in-dynamic-odds-example","generate-based-on-seed-keyword","multiple-outputs-random-number-of-items-example","lineage-of-kings-example","fuel-consumption-distance","commas-in-numbers-example","exclude-item-based-on-previous-selection","change-item-odds-based-on-selections-parent","change-output-based-on-screen-size-example","bingo-table-example","get-median-of-numbers-example","filter-exclude-item-from-list","seed-from-url-example","pass-variable-via-url-example","user-controls-how-many-outputs-example","remember-user-inputs-basic-example","click-counter","click-counter-2","increment-counter-when-specific-items-is-selected-example","increment-counter-caves-example","generate-colored-text-example","custom-image-button-example","custom-image-button-with-hover-example","simple-mouse-hover-image-change-example","metadata-example","different-result-on-first-load","different-items-depending-on-num-clicks","show-specific-text-on-first-load","persistent-consumable-list-example","add-items-to-list-example","map-example","multiple-output-results-option","tap-image-to-randomize","first-n-items-of-random-sub-list","consumable-list-that-stays-consumed-until-refresh","numbered-outputs-example-manual","numbered-outputs-with-html-ol","text-contains-text-example","add-user-inputs-to-list-example","user-input-list-append-example","update-dynamically-generated-elements-example","image-layer-combiner-thumbnail-generator-example","using-name-of-selected-sublist-example","changing-drop-down-without-user-click-example","multi-dropdown-user-provided-pattern","generate-drop-down-input-from-hierarchical-list","use-seeder-plugin-for-one-import-only-example","dynamically-creating-a-list-and-adding-items-to-it","filter-list-based-on-instance-properties-example","filter-a-list-of-generated-instances-example","damage-roll-function-example","randomize-on-tap-with-optional-subtap","combine-multiple-lists-into-one-consumable-list","list-method-with-createinstance-example","combining-list-that-contain-duplicates-without-selecting-duplicates","question-and-answer-example","select-the-highest-number","curly-brackets-within-square-brackets-alternatives-example","array-of-instances-within-instance-example","sequential-pages-example","randomize-image-color-example","curly-blocks-inside-square-blocks","prevent-randomization-of-list-except-at-page-reload","track-selections-display-other-properties-of-selected-items-later","spoiler-hidden-unfold-html-example","comments-plugin-goto-plugin-example","pure-css-html-plugin-template","select-item-from-same-index-position-in-two-lists","adjustable-vertical-split-example","custom-font-importer","power-generator-manager","raggedflights-generators","plugins-page","eathams-pluginhub","dicemonger-generators","nes-template","dark-typography-template","timeline-template","big-typography-template","newspaper-multiple-columns","newspaper-column-template","accordion-template","accordion-multiple-buttons-template","twitter-feed-template","tweet-template","interactive-terminal-template","computer-terminal-template","origin-of-species-template","long-form-template","collection-template","basic-template","little-story-template","minimal","centered-minimal","centered-with-background-template","stat-block-5e-template","emoji-paragraph-template","generator-list-with-stats-template","generator-list-with-stats-2-template","tucked-corners-template","dark-card-template","glitch-text-template","nauseating-retro-flicker","visual-novel-template","diaryexample","khaki-templates","pandan-templates","ro-templates","nicksdropdownmenu","danielm-overview","garlicdolphin-templates","ronin-generators","eathams-templates","rg4m14ri","tutorial","aqr03wn1","diy-perchance-api","perchance-discord-bot","useful-generators","privacy-policy","advanced-tutorial","project-codename","creature-description","geographic-location","paint-color","random-story","dream-description","3d174opr","conjugate-plugin","plural-plugin","be-plugin","templates","noun","abstract-noun","concrete-noun","common-noun","sci-fi-noun","uncountable-noun","pronoun","adjective","comparative-adjective","superlative-adjective","food-adjective","adjective-of-relation","verb","speech-verb","adverb","time-adverb","manner-adverb","frequency-adverb","intensifier","interjection","common-word","preposition","emotion","greeting","goodbye","swear-word","personal-title","personal-suffix","prefix","exclamation","compound-word","cliche","simile","sentence","part-of-speech","rare-word","archaic-word","long-word","3-letter-word","short-word","gre-high-freq-word","funny-word","walk-verb","woo-word","grammatical-case","-ism","latin-word","philia","obsession","nonsense-word","complex-word","person-adjective","honorific","animal","endangered-animal","unusual-animal","land-animal","dog-breed","pet-animal","horse-breed","mammal-species","dinosaur","reptile-species","lizard-species","snake-species","turtle-species","turtle-tortoise-species","fish-species","sea-creature","flower-species","plant-species","tree-species","herb","spider-species","bug-species","beetle-species","bird-species","north-american-bird-species","antarctic-bird-species","scientific-species-name","body-part","horse-color","cat-breed","body-of-water","vegetable","fruit","ingredient","vitamin","condiment","spice","dessert","fast-food","dinner","biological-diet","cocktail","tea-variety","book","stephen-king-book","james-patterson-book","type-of-art","color-palette","color","room-type","rhetorical-device","speech-type","proverb","quote","pokemon","pokemon-ability","futurama-character","lotr-character","fact","password","phobia","fabric-type","complex-form","object","knot-name","container-type","roman-city","ancient-greek-city","form-of-government","mass-surveillance-project-name","uk-political-party","us-federal-agency","us-military-operation","terrorist-group","month","moon-phase","part-of-day","day-of-week","time-zone","egyptian-god","greek-god","greek-titan","greek-monster","tarot-prediction","zodiac-sign","chinese-zodiac-sign","fortune-telling-technique","norse-deity","christian-saint","religion","wingding","emoji","bw-emoji","braille","ascii-face","css-color","hex-color","crayon-color","color-name","hobby","mood","occupation","us-president","us-vice-president","celebrity","pope","british-actor","famous-scientist","person-build","person-height","person-age","face-shape","startup-idea-generator","fortune-500-company","industry","nasdaq-corporation","us-newspaper","shop-or-service","animal-protection-group","common-first-name","common-last-name","norwegian-last-name","male-norwegian-name","female-norwegian-name","aesthetic-username","couple-name","chocobo-name","common-female-name","common-male-name","common-unisex-name","japanese-surname","feminine-name","masculine-name","surname","medical-diagnosis","fake-drug-name","drug-name","us-hospital","language","pokemon-sprite","imgur-image","instagram-image","biology-field","scientific-instrument","planet-name","exoplanet-name","moon-name","fibonacci-number","prime-number","trig-identity","unit-of-measurement","polygon-name","metal","chemical-element","toxic-chemical","material","building-material","packaging-material","sculpting-material","patent","phone-brand","programming-languge","mime-type","gtld","us-geographic-location","river-name","sea-name","type-of-rock","gemstone","terrain","nationality","country","country-or-territory","european-union-member","african-country","continent","us-city","japanese-city","german-town","us-state","canadian-municipality","english-town-name","english-city-name","venue","car-brand","nautical-term","anime-film","disney-film","marvel-film","pixar-film","netflix-category","jeopardy-question","star-trek-planet","monster-type","fantasy-language","website","youtube-thumbnail","youtube-video","social-network","instagram-user","instagram-username","musical-instrument","music-genre","traditional-dance-style","playing-card","playing-card-short","video-game","wrestling-move","wwe-wrestler","plugins","markdown-plugin","storing-selections-example-1","storing-selections-example-2","import-example","fav-book","multiline-example","multiline-pro-example","multiline-pro-simple-example","html-table-example","input-example","input-autoupdate-example","newspaper-column-creator","drop-down-list-example","hierarchy-example","output-keyword-example","battle-simulator-example","text-to-image-plugin","ai-text-plugin","comments-plugin","create-instances-plugin","image-layer-combiner-plugin","pattern-maker-plugin","tap-plugin","favicon-plugin","select-range-plugin","dice-plugin","wheel-plugin","upload-plugin","random-integer-plugin","random-decimal-plugin","seeder-plugin","url-params-plugin","remember-plugin","tooltip-plugin","generator-stats-plugin","tldraw-plugin","rpg-icon-plugin","font-plugin","google-sheets-plugin","sum-odds-plugin","background-image-plugin","background-audio-plugin","press-enter-plugin","tap-anywhere-plugin","select-until-plugin","select-leaf-plugin","select-leaves-plugin","select-all-leaves-plugin","random-select-plugin","consumable-leaf-list-plugin","typewriter-plugin","make-table-plugin","lockable-list-plugin","locker-plugin","fixed-until-reload-plugin","number-set-plugin","numerals-to-words-plugin","numerals-to-ordinal-words-plugin","numerals-to-ordinals-plugin","roman-numerals-plugin","text-to-speech-plugin","join-lists-plugin","exclude-items-plugin","filter-list-plugin","markov-chain-plugin","roll-table-plugin","goto-plugin","nested-plugin","navbar-plugin","literal-plugin","super-fetch-plugin","consumable-list-loop-plugin","dynamic-import-plugin","print-button-plugin","copy-text-plugin","fullscreen-button-plugin","tabs-plugin","title-case-plugin","random-image-plugin","image-plugin","pride-plugin","tornado-plugin","flat-avatar-plugin","a-an-plugin","date-plugin","preprocessors"];
              this.saveGenerator = async () => { 

                let collabEditKey = /^#edit($|:)/.test(window.location.hash) ? window.location.hash.replace("#edit:", "").split(";").filter(kv => kv.startsWith("collab=")).map(kv => kv.split("=")[1])[0] : undefined;
                if(collabEditKeyIsIncorrect) {
                  collabEditKey = null;
                  if(!confirm("It looks like the collaboration link you're using is incorrect or has been invalidated. Would you like to save your own copy of this generator?")) {
                    return;
                  }
                }

                let originalLastEditorsChangeTime = window.lastEditorsChangeTime;

                let editKey = null;
                if(!collabEditKey && !window.userOwnsThisGenerator && !exampleGeneratorsOrPluginsEtc.includes(this.data.generator.name)) {
                  editKey = localStorage[`perchance_generatorEditKey_${this.data.generator.name}`] || prompt("Click OK to 𝗰𝗿𝗲𝗮𝘁𝗲 a new generator based on this one. If you own this generator and would like to 𝗲𝗱𝗶𝘁 it, then first paste the edit password below.", inMemoryGeneratorNameToEditKey[this.data.generator.name] || "");
                  if(editKey === null) return; // they clicked cancel
                  editKey = editKey.trim();
                  if(!editKey) editKey = null;
                }
            
                // if(!this.store.data.user.loggedIn) {
                //   if(!confirm(`Since you're not logged in, saving will anonymously create a new generator with a unique password that is required to edit it. Continue?`)) {
                //     this.logout(); // ensure they're properly logged out
                //     this.openLoginModal();
                //     return;
                //   }
                // }
            
                console.debug("saveGenerator called. saveState:", menuBar.saveState);
                if(menuBar.saveState !== "unsaved") {
                  return;
                }
            
                if(window.userOwnsThisGenerator) {
                  let tabsOpen = JSON.parse(localStorage.perchanceTabsOpen || "{}");
                  clearOldTabRecords(tabsOpen);
                  if(tabsOpen[this.data.generator.name] && Object.keys(tabsOpen[this.data.generator.name]).length > 1) {
                    let continueSaving = confirm("Note: You have this generator open in another tab. Be careful that you're only editing your generator from a single tab, since you may accidentally overwrite previous edits. Continue saving?");
                    if(!continueSaving) return;
                  }
                }
            
                let saveId = Math.random().toString();
            
                menuBar.setSaveState("saving");
                console.debug("Waiting for reload before saving...", saveId);
                window.savingNowButStillWaitingForIframeReload = true;
                try {
                  await window.hardReloadOutputIframe(); // this updates the metadata and dependencies
                } catch(e) {
                  console.error(e);
                }
                window.savingNowButStillWaitingForIframeReload = false;
                console.debug("Finished waiting for save reload.", saveId);
            
                try {
            
                  // we use these below for lastModelTextSaved/lastOutputTemplateSaved - can't set them yet since we don't know if it will save successfully
                  let modelText = this.data.generator.modelText;
                  let outputTemplate = this.data.generator.outputTemplate;
            
                  let generatorMetaData = editor.generatorMetaData;
                  
                  let bodyData = {
                    email: this.store.data.user.email || "",
                    sessionToken: this.store.data.user.sessionToken || "",
                    generator: this.data.generator,
                    generatorMetaData,
                    lastKnownSaveTime: window.generatorLastSaveTime,
                  }; 
                  if(editKey !== null) {
                    bodyData.editKey = editKey;
                  }
                  
                  if(collabEditKey) {
                    bodyData.collabEditKey = collabEditKey;
                    // So we don't trigger a new generator creation/fork:
                    bodyData.email = "";
                    bodyData.sessionToken = "";
                  }

                  let data = await fetch("/api/save", { method:'POST', body:JSON.stringify(bodyData), signal:AbortSignal.timeout?.(20*1000), headers:{ 'Content-Type': 'application/json' }}).then(r => r.json());
                  if(data.status === "stale") {
                    if(!confirm("It looks like you're editing an old version of this generator. You may have been editing it in a different browser tab. Note that you can access all versions using the 𝗯𝗮𝗰𝗸𝘂𝗽𝘀 button. Are you sure you want to continue?")) {
                      menuBar.setSaveState("unsaved");
                      return;
                    }
                    bodyData.forceSaveDespiteStaleness = true;
                    data = await fetch("/api/save", { method:'POST', body:JSON.stringify(bodyData), signal:AbortSignal.timeout?.(20*1000), headers:{ 'Content-Type': 'application/json' }}).then(r => r.json());
                  }
                  if(data.status === "captcha-needed") { // for 'anon' saves
                    bodyData.captchaToken = await getCaptchaToken();
                    data = await fetch("/api/save", { method:'POST', body:JSON.stringify(bodyData), signal:AbortSignal.timeout?.(20*1000), headers:{ 'Content-Type': 'application/json' }}).then(r => r.json());
                  }
            
                  if(data.status === "saved") {
                    window.generatorLastSaveTime = data.time;
            
                    if(originalLastEditorsChangeTime === window.lastEditorsChangeTime) {
                      window.modelTextEditor.markClean();
                      window.outputTemplateEditor.markClean();
                      menuBar.setSaveState("saved");
                    } else {
                      menuBar.setSaveState("unsaved");
                    }
            
                    // these are used as an extra check in doLocalGeneratorBackupIfNeeded to prevent backing up text that is already saved
                    window.lastModelTextSaved = modelText;
                    window.lastOutputTemplateSaved = outputTemplate;
                    
                    this.saveSuccessCallback();

                    if(!collabEditKey && editKey && !localStorage[`perchance_generatorEditKey_${this.data.generator.name}`] && !doNotAskToSaveEditPasswordFor.has(this.data.generator.name)) {
                      inMemoryGeneratorNameToEditKey[this.data.generator.name] = editKey;
                      if(confirm(`Your changes have been saved. You can click OK to save this password to your temporary browser storage, so you don't have to enter the password every time you make an edit. You should 𝗰𝗹𝗶𝗰𝗸 𝗰𝗮𝗻𝗰𝗲𝗹 if you're using a shared computer (e.g. at library). Note: If your cookies/storage for this site are cleared, your saved passwords will be cleared.`)) {
                        localStorage[`perchance_generatorEditKey_${this.data.generator.name}`] = editKey;
                      } else {
                        doNotAskToSaveEditPasswordFor.add(this.data.generator.name);
                      }
                    }
            
                  } else if(data.status === "created") {
                    window.generatorLastSaveTime = data.time;
            
                    if(this.store.data.user.loggedIn) {
                      window.userOwnsThisGenerator = true;
                      this.trigger("GeneratorOwnershipChange");
                      menuBar.refs.settingsButton.style.display = "block";
                    }

                    window.history.replaceState(null, null, `/${data.name}${window.location.hash}`);
                    this.data.generator.name = data.name;
                    window.generatorName = data.name;
                    menuBar.setSaveState("saved");
                    window.generatorPublicId = data.publicId;
                    this.saveSuccessCallback(data.name, data.publicId);
                    window.hardReloadOutputIframe();
            
                    menuBar.refs.statusMessage.innerHTML = "<b>(new generator created)</b>";
                    menuBar.refs.statusMessage.style.display = "inline-flex";
                    setTimeout(() => {
                      menuBar.refs.statusMessage.innerHTML = "";
                      menuBar.refs.statusMessage.style.display = "none";
                    }, 4000);

                    if(!this.store.data.user.loggedIn) {
                      inMemoryGeneratorNameToEditKey[data.name] = data.editKey;
                      prompt("New generator created. If you'd like to edit it in the future, you'll need to use the following password. Please copy and paste it somewhere safe:", data.editKey);
                      if(confirm(`You can click OK to save this password to your temporary browser storage, so you don't have to enter the password every time you make an edit. You should 𝗰𝗹𝗶𝗰𝗸 𝗰𝗮𝗻𝗰𝗲𝗹 if you're using a shared computer (e.g. at library). Note: If your cookies/storage for this site are cleared, your saved passwords will be cleared.`)) {
                        localStorage[`perchance_generatorEditKey_${data.name}`] = data.editKey;
                      } else {
                        doNotAskToSaveEditPasswordFor.add(data.name);
                      }
                    }
            
                  } else if(data.status === "invalid-edit-key") {
                    delete localStorage[`perchance_generatorEditKey_${this.data.generator.name}`];
                    menuBar.setSaveState("error");
                    setTimeout(() => { menuBar.setSaveState("unsaved"); }, 1000);
                    alert("The edit password was incorrect. Please try again.");
                  } else if(data.status === "session-token-error") {
            
                    this.logout();
                    this.openLoginModal();
                    menuBar.setSaveState("error");
                    setTimeout(() => { menuBar.setSaveState("unsaved"); }, 1000);
            
                  } else if(data.status === "too-big") {
                    menuBar.setSaveState("error");
                    alert("Hmm. There's too much text in this generator to save it to Perchance's database. :| Can you perhaps break it into several smaller generators that you import into the main one? Note that perchance.org/upload can be used to upload large amounts of data.");
                    setTimeout(() => { menuBar.setSaveState("unsaved"); }, 1000);
                  } else if(data.status === "too-many-requests") {
                    menuBar.setSaveState("error");
                    alert(`You're saving too quickly!${this.store.data.user.loggedIn ? " Please try again in a few seconds." : " If you're not saving quickly, then this 𝗰𝗼𝘂𝗹𝗱 𝗯𝗲 𝗰𝗮𝘂𝘀𝗲𝗱 𝗯𝘆 𝗮 𝗩𝗣𝗡 browser extension - try disabling it, or logging in."}`);
                    setTimeout(() => { menuBar.setSaveState("unsaved"); }, 1000);
                  } else {
                    console.error("Server error while saving:", data);
                    menuBar.setSaveState("error");
                    alert("Seems like there was a problem while trying to save your generator. This could be to do with your internet connection, but it could also be a temporary problem with the server. Please copy and paste your generator data (lists and HTML) to a safe place before leaving or refreshing the page, or you could lose your work. If you keep getting errors even after waiting a couple of minutes, please make a post on lemmy.world/c/perchance to see if others are experiencing the same thing. Remember that you can click the \"backups\" button in the top-right of the screen to download past versions of your generator. Before doing anything though, make sure you copy and paste your data to a safe place! Sorry for the trouble - this stuff happens sometimes :|");
                    setTimeout(() => { menuBar.setSaveState("unsaved"); }, 1000);
                  }
            
                  // track generator save times so we can cache bust if cloudflare cache puring is delayed (see code at bottom of index.html template)
                  if(data.status === "saved" || data.status === "created") {
                    let generatorSavedTimes = JSON.parse(localStorage["generatorSavedTimes"] || "{}");
                    generatorSavedTimes[this.data.generator.name] = Date.now();
                    // clear old save times (older than 3 months, since the cache definitely shouldn't last any longer than that, even if a manual purge isn't initiated):
                    generatorSavedTimes = Object.fromEntries( Object.entries(generatorSavedTimes).filter(e => e[1] > Date.now()-1000*60*60*24*30) );
                    localStorage["generatorSavedTimes"] = JSON.stringify(generatorSavedTimes);

                    if(!localStorage.generatorsLikelyOwned || !localStorage.generatorsLikelyOwned.includes(`,${this.data.generator.name},`)) localStorage.generatorsLikelyOwned = (localStorage.generatorsLikelyOwned || "") + `,${this.data.generator.name},`;
                  }
                } catch(e) {
                  console.error("Request error while saving:");
                  console.error(e);
                  menuBar.setSaveState("error");
                  setTimeout(() => { menuBar.setSaveState("unsaved"); }, 1000);
                }
              };

              
              window.userOwnsThisGenerator = undefined; // IMPORTANT: this must be undefined while we don't know - there is code which relies on this.

              let originalSessionTokenLastChangeTime = Number(localStorage.sessionTokenLastChangeTime || 0);
              let initStore = () => {
                this.store = new Store("app");
                if(!this.store.data.user) {
                  this.store.data.user = {loggedIn:false};
                  this.store.save();
                }
              }
              initStore();

              setInterval(() => { // in case they logged out/in in another tab
                if(originalSessionTokenLastChangeTime !== Number(localStorage.sessionTokenLastChangeTime || 0)) {
                  originalSessionTokenLastChangeTime = Number(localStorage.sessionTokenLastChangeTime || 0);
                  let wasLoggedIn = this.store.data.user.loggedIn;
                  initStore();
                  if(this.store.data.user.loggedIn) this.checkIfOwner();
                  if(wasLoggedIn !== this.store.data.user.loggedIn) this.trigger("LoginStateChange");
                }
              }, 3000);
            
              this.data.generator = generator;
              this.data.dependencies = dependencies;
              // this.update();
          
              this.appInteractionState = "view";

              if(this.store.data.user.loggedIn) {
                (async () => { 
                  let isOwner = await this.checkIfOwner();
                  window.initialLoadIsOwnerResolver(isOwner);
                })();
              } else {
                window.initialLoadIsOwnerResolver(false);
              }

              // NOTE: This was originally in the editor, but that doesn't load until edit is clicked, so crawlers wouldn't see it, which is bad for gens with no $meta.title/description - google got very confused for a few weeks.
              let isFirstMetaUpdate = true;
              window.addEventListener("message", async (e) => {
                let origin = e.origin || e.originalEvent.origin;
                if(origin !== "https://null.perchance.org" && origin !== `https://${window.generatorPublicId}.perchance.org`) return;
                
                if(e.data.type === "metaUpdate") {
                  if(e.data._validation.generatorName !== app.data.generator.name) return; // <-- trying to stop weird Google crawler page title bug

                  // @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
                  // WARNING WARNING WARNING WARNING WARNING WARNING WARNING: If you change this at all, make sure to do a thorough check for XSS bugs.
                  // @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@

                  if(!e.data.hasLocalStorage) { // because only necessary for crawlers (which won't have any localStorage keys set)
                    if(typeof e.data.html === "string") {
                      if(e.data.html.length < 100_000 && window.shouldLiftGeneratorHtmlFromEmbed) {
                        window.document.querySelector("#generator-description").innerHTML = DOMPurify.sanitize(e.data.html, {ALLOWED_TAGS: ['h1', 'h2', 'h3', 'h4', 'p', 'div', 'pre', 'button', 'i', 'b', 'a', 'ul', 'li', 'br', 'ol', 'hr'], ALLOWED_ATTR: ['href']});
                        if(!window.generatorCanLinkWithRelFollow) window.document.querySelectorAll("#generator-description a").forEach(a => a.rel="nofollow ugc");
                      }
                    }
                  }
                  if(typeof e.data.title === "string") {
                    if(!isFirstMetaUpdate) { // correct title is hardcoded in HTML on page load (and if dynamic, then as of writing a `fetch` call updates it.)
                      window.document.title = e.data.title + " ― Perchance" + (/(gener|\bai\b)/i.test(e.data.title) ? "" : " Generator");
                    }
                  }
                  isFirstMetaUpdate = false;
                }
              });

              window.menuBar.init();
              window.loginModal.init();
              window.accountModal.init();
              window.settingsModal.init();
              window.revisionsModal.init();

              if(window.location.hash === "#debugFreeze") {
                window.DEBUG_FREEZE_MODE = true;
            
                // we do this rather than setting the hash with location.hash because otherwise it essentially does a pushState behind the scenes
                let url = new URL(location.href);
                url.hash = "#edit";
                history.replaceState({}, "", url.href);
            
                this.appInteractionState = "edit";
                this.trigger("AppInteractionStateChange");
              } else if(/^#edit($|:)/.test(window.location.hash)) {
                this.appInteractionState = "edit";
                this.trigger("AppInteractionStateChange");
              }

              if(this.appInteractionState === "edit") {
                await this.goToEditMode();
              } else if(this.appInteractionState === "view") {
                this.goToViewMode();
              }
              this.attachKeyboardShortcuts();
            }
          };
        </script>

        <script>window.remoteResourcesLoaded = true;</script>
        <script>
          window.empty883974329 = "";
          window.modalFn1Name = "alert";
          window.rlFn1Name = `reload`;
          window.ftcFn1Name = "fetch";
          window.ap1pend1ChildFn2Name = "appendChild";
          window.doc34828272947 = "document";

          try { // adding try/catch here in case of future instances of this: https://lemmy.world/post/4913660
            window.generatorDependenciesData = window.js0nparse( decodeURI( document.querySelector("#imported-generators").innerText ) );
          } catch(e) {
            if(!location.href.includes("__generatorDependenciesCacheBust")) { // try a cache bust if we haven't already.
              let url = new URL(window.location.href);
              url.searchParams.set("__generatorDependenciesCacheBust", Math.random());
              window.location.href = url.href; 
              throw new Error("exiting script tag for dependency cache bust"); // since we can't `return` at top level
            } else { // if we've already tried bust, don't do it again, else it'll be a refresh loop
              window.generatorDependenciesData = [];
              let errorCode = 1;
              if(document.querySelector("#imported-generators").innerText === "") {
                errorCode = 2;
              } else {
                errorCode = 3;
                try {
                  decodeURI(document.querySelector("#imported-generators").innerText);
                } catch(e) {
                  errorCode = 4;
                }
              }
              alert(`There was some sort of bug parsing the imports of this generator. Buggy ad blockers can sometimes cause this. Please report this at https://lemmy.world/c/perchance and mention this error code: ${errorCode}`);
            }
          }

          if(location.href.includes("__generatorDependenciesCacheBust")) {
            let url = new URL(window.location.href);
            url.searchParams.delete("__generatorDependenciesCacheBust");
            let newPath = url.href.replace(/^https:\/\/perchance\.org/, "");
            history.replaceState({}, "", newPath);
          }

          window.usesAiPlugins = window.generatorDependenciesData.filter(d => d.name === "ai-text-to-image-plugin" || d.name === "ai-text-plugin").length > 0;

          window.iudu843975 = "bbb";
          if(iudu843975.includes("a")) {
            uruf8ufd.jfurwe8j;
          }
          
          (async function() {
            await app.init({
              generator: window.generatorData,
              dependencies: window.generatorDependenciesData,
            });
            window.successfulPageLoad = true;
          })();
        </script>
        
        <!-- <script async src="https://www.googletagmanager.com/gtag/js?id=G-YJWJRNESS5"></script> -->
        <script>
          setTimeout(() => { // dynamically add after delay to reduce initial lag on low-end mobile devices
            if(window.forceDisableAds) return;
            
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            gtag('config', 'G-YJWJRNESS5');

            let script = document.createElement('script');
            script.async = true;
            script.src = "https://www.googletagmanager.com/gtag/js?id=G-YJWJRNESS5";
            document.body.appendChild(script);
          }, 1000*4);
          
          try {
            setTimeout( function() { // wait for init (we're not in any hurry)
              if(window.forceDisableAds) return;
              document.querySelector("#verify-account-button").addEventListener('click', function() {
                gtag("event", "signup", {});
              });
            }, 20*1000);
          } catch(e) { console.error(e); }
        </script>


        <script>
          window.downloadTextFile = (text, name) => {
            const a = document.createElement('a');
            const type = name.split(".").pop();
            a.href = URL.createObjectURL( new Blob([text], { type:`text/${type === "txt" ? "plain" : type}` }) );
            a.download = name;
            a.click();
          };
          window.diffStuff = {}; //patches, modelTextPatches and outputTemplatePatches get added to this object in revisions-modal.tag. It's hacky, but it'll do for now.
          window.diffStuff.openNewTabWithRevision = async function(revisionNumber, generatorName) {
            if(!window.diff_match_patch) {
              let script = document.createElement('script');
              script.src = "/lib/diff_match_patch.js";
              document.body.appendChild(script);

              while(!window.diff_match_patch) {
                await new Promise(r => setTimeout(r, 200));
              }
              window.dmp = new diff_match_patch();
              window.diffStuff._patchesToRevision = (patches, revisionNumber) => {
                if(revisionNumber > patches.length-1 || revisionNumber < 0) throw new Error(`revisionNumber ${revisionNumber} doesn't exist. max index of patches array = ${patches.length-1}`);
                let text = patches[0];
                if(revisionNumber === 0) return text;
                for(let n = 1; n < patches.length; n++) {
                  //text = JsDiff.applyPatch(text, patches[n]);
                  text = dmp.patch_apply(dmp.patch_fromText(patches[n]), text)[0];
                  if(text === false) throw new Error("JsDiff says that the patches aren't correct. some sort of corruption or incorrect formatting or mismatch");
                  if(n === revisionNumber) return text;
                }
              };
            }
            let modelText = this._patchesToRevision(this.modelTextPatches, revisionNumber);
            let outputTemplate = this._patchesToRevision(this.outputTemplatePatches, revisionNumber);

            // we used encodeURI to fix emojis problem with https://github.com/google/diff-match-patch, so we need to decode:
            modelText = decodeURI(modelText);
            outputTemplate = decodeURI(outputTemplate);

            let intro = "<<<<< this file contains your perchance lists first, and your HTML code underneath it >>>>>\n\n\n\n";
            window.downloadTextFile(intro+modelText+("\n".repeat(20))+outputTemplate+("\n".repeat(20)), `${generatorName}-revision-${revisionNumber}.txt`);
          };
        </script>


        <script>
          // a temporary hack to make sure search engines see links on generators page:
          if(document.location.pathname === "/generators") { 
            var req = new XMLHttpRequest();
            req.overrideMimeType("application/json");
            req.open('GET', "/api/getGeneratorList", true); 
            req.onload  = function() {
              var result = window.js0nparse(req.responseText);
              var div = document.createElement('div');
              if(window.canExecuteModernJavascript) {
                div.style.height = "0px";
                div.style.overflow = "hidden";
                div.style.position = "fixed";
              }
              div.innerHTML = "Here are the latest generators: "+result.generators.map(function(g){ return "<a href='/"+g.name+"'>"+g.name+"</a>"; }).join(", ")+".";
              document.body.appendChild(div);
            };
            req.send(null);
          }
        </script>
        
        <script>
          (async function() {
            await new Promise(r => setTimeout(r, 1000*20));
            if(!navigator["\u0077\u0065\u0062\u0064\u0072\u0069\u0076\u0065\u0072"]) {
              fetch(`https://perchance.org/api/cv?generatorName=${location.pathname.slice(1)}&isFromEmbed=0&__cacheBust=${Math.random()}`);
              document.addEventListener("visibilitychange", () => {
                if(document.visibilityState === "visible") {
                  fetch(`https://perchance.org/api/cv?generatorName=${location.pathname.slice(1)}&isFromEmbed=0&__cacheBust=${Math.random()}`);
                }
              });
            }
          })();
        </script>
        
        <script>
          (async function() {
            if(!/^#edit($|:)/.test(window.location.hash)) {
              while(!document.querySelector("div.menu-item.new")) await new Promise(r => setTimeout(r, 20));
              let btnHtml = document.querySelector("div.menu-item.new").outerHTML;
              btnHtml = btnHtml.replace(/\/minimal#edit/g, "/ai-chat"); // "https://discord.gg/43qAQEVV9a"
              btnHtml = btnHtml.replace(/>new</g, ">ai chat<");
              btnHtml = btnHtml.replace(/menu-item new/g, "menu-item promo");
              btnHtml = btnHtml.replace(/➕/g, "🆕");
              let ctn = document.createElement("div");
              ctn.innerHTML = btnHtml;
              let btn = ctn.firstElementChild;
              let systemIsInDarkMode = !!(window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches);
              if(systemIsInDarkMode) {
                btn.style.backgroundColor = "rgb(110 53 11)";
              } else {
                btn.style.backgroundColor = "#ffd4a4";
              }
              document.querySelector("div.menu-item.new").after(btn);
            }
          })();
        </script>

        <script>
          (async function() {

            async function sha256Text(text) {
              const msgUint8 = new TextEncoder().encode(text);                          
              const hashBuffer = await crypto.subtle.digest('SHA-256', msgUint8);          
              const hashArray = Array.from(new Uint8Array(hashBuffer));                    
              const hashHex = hashArray.map((b) => b.toString(16).padStart(2, '0')).join('');
              return hashHex;
            }

            async function sendNotification(data) {
              // safety code to prevent duplicate notifications (shouldn't be needed, but just in case):
              let hash = await sha256Text(JSON.stringify(data));
              if(!localStorage.alreadyRecentlySentNotificationHashes) localStorage.alreadyRecentlySentNotificationHashes = "";
              if(localStorage.alreadyRecentlySentNotificationHashes.includes(hash)) return;
              localStorage.alreadyRecentlySentNotificationHashes += ","+hash;
              if(localStorage.alreadyRecentlySentNotificationHashes.length > 2000) localStorage.alreadyRecentlySentNotificationHashes = localStorage.alreadyRecentlySentNotificationHashes.slice(-1000);
              
              let notification;
              if(Notification.permission === "granted") {
                notification = new Notification(data.title, {body:data.body});
              } else if(Notification.permission !== "denied") {
                const permission = await Notification.requestPermission();
                if(permission === "granted") {
                  notification = new Notification(title, options);
                }
              }
              return notification;
            }

            window.addEventListener("message", async function(e) {
              let origin = e.origin || e.originalEvent.origin; // For Chrome, the origin property is in the event.originalEvent object.
              if(origin !== "https://comments-plugin.perchance.org") {
                return;
              }
              if(e.data.type === "ensure-notification-permission") {
                if(Notification.permission !== "granted" && Notification.permission !== "denied") {
                  const permission = await Notification.requestPermission();
                  if(permission === "granted") {
                    console.debug("notification permission granted");
                  } else {
                    console.debug("notification permission denied");
                  }
                }
              } else if(e.data.type === "notification-request") {
                if(Notification.permission !== "denied") {
                  if(e.data.folderName.split("+")[0] === window.location.pathname.slice(1)) {
                    let notification = await sendNotification(e.data).catch(e => console.error(e));
                    if(notification) notification.onclick = function() { window.focus(); this.close(); };
                  } else {
                    console.debug("Pending notification:", e.data.title, e.data.body, e.data.folderName);
                    // we ideally want this notification to be triggered in an already-open tab of the relevant generator (because then the notification.onclick can focus that tab, rather than opening a duplicate of that tab), so we put the notification data in localStorage and wait a few seconds for the relevant tab to take it out, and if not, then we trigger it from this tab, and set onclick to open a new tab
                    if(!localStorage.pendingNotifications) localStorage.pendingNotifications = "[]";
                    let pendingNotifications;
                    try { pendingNotifications = window.js0nparse(localStorage.pendingNotifications); } catch(e) { console.error("failed to parse pending notifications", e); pendingNotifications = []; }
                    pendingNotifications.push(e.data);
                    localStorage.pendingNotifications = JSON.stringify(pendingNotifications);

                    // try to wake the target tab with a BroadcastChannel message (no idea if this helps, but can't hurt):
                    let broadcastChannel;
                    if(window.BroadcastChannel) {
                      broadcastChannel = new BroadcastChannel("generatorName:"+window.location.pathname.slice(1));
                      broadcastChannel.postMessage({type:"wake-up"});
                    }
                    
                    setTimeout(async function() {
                      if(broadcastChannel) broadcastChannel.close();
                      let pendingNotifications;
                      try { pendingNotifications = window.js0nparse(localStorage.pendingNotifications); } catch(e) { console.error("failed to parse pending notifications", e); pendingNotifications = []; }
                      let notificationData = pendingNotifications.find(d => d.time === e.data.time && d.folderName === e.data.folderName && d.title === e.data.title && d.body === e.data.body);
                      if(notificationData) {
                        let notification = await sendNotification(notificationData).catch(e => console.error(e));
                        if(notification) notification.onclick = function() { window.open(`/${notificationData.folderName.split("+")[0]}`, "_blank"); this.close(); };
                        pendingNotifications = pendingNotifications.filter(d => d !== notificationData);
                        localStorage.pendingNotifications = JSON.stringify(pendingNotifications);
                      }
                    }, 1000*7); // <-- 'pending notification' timeout length (before we give up and just sent the `Notification` from this tab)
                  }
                }
              }
            });

            (async function() {

              if(window.BroadcastChannel) {
                let channel = new BroadcastChannel("generatorName:"+window.location.pathname.slice(1));
                channel.onmessage = (event) => {
                  if(event.data.type === "wake-up") {
                    console.debug("received wake-up message at:", new Date().toString());
                  }
                };
              }

              while(1) {
                let generatorName = window.location.pathname.slice(1);
                try {
                  await new Promise(r => setTimeout(r, 1000*2)); // this wait time must be lower than the 'pending notification' timeout length above
                  // parse localStorage.pendingNotifications and trigger notification if generatorName matches folderName
                  if(!localStorage.pendingNotifications) localStorage.pendingNotifications = "[]";
                  let pendingNotifications;
                  try { pendingNotifications = window.js0nparse(localStorage.pendingNotifications); } catch(e) { console.error("failed to parse pending notifications", e); pendingNotifications = []; }
                  
                  let pendingNotificationsForThisGeneratorName = pendingNotifications.filter(n => n.folderName.split("+")[0] === generatorName);
                  for(let notificationData of pendingNotificationsForThisGeneratorName) {
                    let notification = await sendNotification(notificationData).catch(e => console.error(e));
                    if(notification) notification.onclick = function() { window.focus(); this.close(); };
                    pendingNotifications = pendingNotifications.filter(n => n !== notificationData);
                  }
                  localStorage.pendingNotifications = JSON.stringify(pendingNotifications);
                } catch(e) { console.error(e) }
              }
            })();

          })();
        </script>
        
        <script>
          window.pageWillDisplayAdsPromise = new Promise(r => window.pageWillDisplayAdsResolver=r);
          (function() {

            function chec3kRes1Load(url, type) {
              return new Promise(resolve => {
                let el = document.createElement(type);
                el.src = url;
                el.onload = function() { resolve(true); };
                el.onerror = function() { resolve(false); };
                document['head'].appendChild(el);
              });
            }

            async function hasVariables() {
              return window.freestar || window._snigelConfig || window.quantserve || window.google_image_requests || window.gaData || window.__tcfapi || window.Criteo || window.__halo_loaded__ || await chec3kRes1Load("https://static.criteo.net/images/pixel.gif?ch=1", "img");
            }

            window.adsAreShowing = async () =>  {   
              let adEl = document.querySelector(".ad-providers-ctn-el");
              if(!adEl) return false;
              let hasIframe = adEl.querySelector("iframe");
              let hasAnalytics = await hasVariables() || (await chec3kRes1Load(`https://secure.quantserve.com/quant.js`, `script`));
              if(adEl && adEl.innerHTML.length > 5 && adEl.offsetParent !== null && adEl.offsetHeight > 20 && (hasIframe || hasAnalytics)) return true;
              // if(adEl && adEl.innerHTML.length > 5 && adEl.offsetParent !== null && adEl.offsetHeight > 20 && adEl.querySelector("iframe")) return true;
              return false;
            };

            let already1AddedAd3vertIfNeeded = false;
            window.addEventListener("message", function(e) {
              let origin = e.origin || e.originalEvent.origin; // For Chrome, the origin property is in the event.originalEvent object.
              if(origin !== "https://null.perchance.org" && origin !== `https://${window.generatorPublicId}.perchance.org`) {
                return;
              }
              
              if(e.data.type === `usingAdPoweredPlugin` && window.location.pathname !== '/text-to-image-plugin' && window.location.pathname !== '/ai-text-plugin') {
                window.usesAiPlugins = true; // e.g. loaded iframe within iframe
                addAdvert();
              }
            });

            setTimeout(() => {
              if(window.usesAiPlugins || window.generatorData.imports.includes("ai-text-to-image-plugin") || window.generatorData.imports.includes("ai-text-plugin")) {
                addAdvert();
              }
            }, 10);

            let addAdvert = async function() {
              if(already1AddedAd3vertIfNeeded) return;
              already1AddedAd3vertIfNeeded = true;

              if(!/^#edit($|:)/.test(window.location.hash)) window.queuedStatCountKeys.add("uaine");

              if((window[`localStorage`]["app-storage"] && window[`localStorage`]["app-storage"].includes("sessionToken")) || navigator.webdriver) {
                return; // not for logged-in users and screenshot bot
              }

              while(!document.querySelector("#main")) await new Promise(r => setTimeout(r, 200));

              window.adCtn = createAdCtn();
              appEl.appendChild(window.adCtn);

              // to give loading priority to main page content, and allow dynamic metadata to load (which can change/set window.forceDisableAds):
              await new Promise(r => setTimeout(r, 7*1000)); 
              if(document.readyState !== 'complete') await new Promise(r => setTimeout(r, 5*1000)); 

              if(window.forceDisableAds) return; // note: it's correct for adCtn to be shown still in this case

              if(await fetch(`https://perchance.org/api/alc?__cacheBust=${Math.random()}`).then(r => r.text()).catch(console.error) !== "1") {
                return; 
              }

              window.pageWillDisplayAdsResolver(true);

              if(!/^#edit($|:)/.test(window.location.hash)) window.queuedStatCountKeys.add("uaineala");
              
              
              let adProviderName = "freestar"; 
              // if(Math.random() < 0.1) adProviderName = "nordvpn";
              if(window.location.hash.startsWith("#adProviderName=")) adProviderName = window.location.hash.slice("#adProviderName=".length);
              if(adProviderName !== `snigel` && adProviderName !== "freestar" && adProviderName !== "nordvpn") adProviderName = "freestar";
              // if(window.location.pathname === "/ai-rpg") adProviderName = "snigel";
              console.debug("ad:", adProviderName);

              if(!window.___alreadyInitializedAdRefreshFocusBugStuff) {
                window.___alreadyInitializedAdRefreshFocusBugStuff = true;

                let gotFirstOutputIframeFocusMessage = false;
                window.lastKnownOutputIframeFocusTime = Date.now();
                window.addEventListener("message", function(e) {
                  if(e.origin !== "https://null.perchance.org" && e.origin !== `https://${window.generatorPublicId}.perchance.org`) return;

                  if(e.data.type === "outputIframeCurrentlyHasFocus") {
                    gotFirstOutputIframeFocusMessage = true;
                    window.lastKnownOutputIframeFocusTime = e.data.time;
                  } 
                });
                
                // NEW FOCUS FIX:
                (async function() {
                  while(!gotFirstOutputIframeFocusMessage) await new Promise(r => setTimeout(r, 500));
                  document.querySelector("#appEl #output iframe").contentWindow.postMessage({type:"enableStrongFocusFix"}, "*");
                })();
                window.addEventListener("pointerdown", function(e) {
                  document.querySelector("#appEl #output iframe").contentWindow.postMessage({type:"pauseStrongFocusFix"}, "*");
                  setTimeout(() => e.target.focus(), 100); // wait a bit til focus fix is disabled, then grab focus back
                });

                // OLD FOCUS FIX (temporarily leaving for debugging/detection stuff):
                let lastUserCausedFocusActionTime = Date.now();
                window.addEventListener("pointerdown", function() {
                  lastUserCausedFocusActionTime = Date.now();
                });
                document.addEventListener("visibilitychange", () => {
                  if(document.visibilityState === "visible") {
                    lastUserCausedFocusActionTime = Date.now();
                  }
                });
                window.addEventListener("pageshow", () => {
                  lastUserCausedFocusActionTime = Date.now();
                });
                
                let iOSSafari = false;
                try {
                  let ua = window.navigator.userAgent;
                  let iOS = !!ua.match(/iPad/i) || !!ua.match(/iPhone/i);
                  let webkit = !!ua.match(/WebKit/i);
                  iOSSafari = iOS && webkit && !ua.match(/CriOS/i);
                  if(iOSSafari) window.queuedStatCountKeys.add("ios");
                  else window.queuedStatCountKeys.add("nonios");
                } catch(e) {
                  console.error("failed to detect iOS Safari", e);
                }

                if(window.innerWidth < 550) window.queuedStatCountKeys.add("mobile");
                else window.queuedStatCountKeys.add("desktop");

                window.addEventListener("focus", async function() {
                  if(!window.perchanceOutputIframeFinishedFirstLoad) return;
                  if(!gotFirstOutputIframeFocusMessage) return;
                  if(Date.now() - window.lastKnownOutputIframeFocusTime > 2000) return; // only if we know embed recenty had focus

                  await new Promise(r => setTimeout(r, 1));
                  if(Date.now()-lastUserCausedFocusActionTime > 1000) {
                    console.warn(`🚩🚩🚩 top-level frame got focus, but there was no pointerdown/pageshow event to have caused it. ${window.location.hash.startsWith("#disable_focus_fix") ? `𝗳𝗶𝘅 𝘄𝗮𝘀 𝗡𝗢𝗧 𝗮𝗽𝗽𝗹𝗶𝗲𝗱 𝗱𝘂𝗲 𝘁𝗼 #𝗱𝗶𝘀𝗮𝗯𝗹𝗲_𝗳𝗼𝗰𝘂𝘀_𝗳𝗶𝘅` : ""}`);
                    if(!window.queuedStatCountKeys.has("ffix")) {
                      window.queuedStatCountKeys.add("ffix");
                      if(iOSSafari) window.queuedStatCountKeys.add("ffixios");
                      
                      if(window.innerWidth < 550) window.queuedStatCountKeys.add("ffmobile");
                      else window.queuedStatCountKeys.add("ffdesktop");
                    }
                    if(!window.location.hash.startsWith("#disable_focus_fix")) {
                      
                      // EDIT: new 'strongFocusFix' approach doesn't need these lines - iframe can "pull" focus. See above.
                      // const iframe = document.querySelector("#appEl #output iframe");
                      // iframe.focus();
                      // iframe.contentWindow.focus();

                      // leaving this message for debugging even though it's not entirely accurate (see above EDIT):
                      console.warn("🚨🚨🚨🚨🚨 FOCUS FIX: RETURNED FOCUS TO IFRAME 🚨🚨🚨🚨🚨");
                    }
                  }
                });

                if(window.location.href.includes("ad-focus-bug-test")) { 
                  setInterval(async () => {
                    window.focus();  
                    console.debug("top hasFocus1", document.hasFocus(), document.activeElement);
                    await new Promise(r => setTimeout(r, 100));
                    console.debug("top hasFocus2", document.hasFocus(), document.activeElement);
                  }, 7000);
                }
              }
              
              // appEl.appendChild(adCtn); 

              // // CMP (inmobi choice):
              // let cmpScript = document.createElement("script");
              // cmpScript.src = `https://perchance.org/files/cmp/cmp.js`;
              // // if(localStorage.test983572935398) cmpScript.src = `https://app.termly.io/resource-blocker/055b710a-1475-4ef3-b014-01e162280a91?autoBlock=on`;
              // // <a href="#" class="termly-display-preferences">Consent Preferences</a>
              // document.head.appendChild(cmpScript);
              // {
              //   let waitMs = 0;
              //   while(!window.cmpScriptHasExecuted) {
              //     await new Promise(r => setTimeout(r, 100));
              //     waitMs += 100;
              //     if(window.TERMLY_RESOURCE_BLOCKER_LOADED) window.cmpScriptHasExecuted = true;
              //     if(waitMs > 20*1000) break;
              //   }
              // }

              let privacyManagerBtn = document.createElement("button");
              privacyManagerBtn.innerHTML = `Privacy Manager`;
              privacyManagerBtn.id = "pmLink";
              privacyManagerBtn.className = "cmp-privacy-manager";
              privacyManagerBtn.style = "visibility:hidden; text-decoration:none; cursor:pointer; background:transparent; border:none; position:fixed; bottom:0; right:0; width:max-content;";
              document.body.append(privacyManagerBtn);
              let styleEl = document.createElement("style");
              styleEl.textContent = `#pmLink:hover { visibility: visible; color: grey; }`;
              document.body.append(styleEl);

              function checkConsent() {
                __tcfapi("getTCData", 2, (tcData, success) => {
                  if(success) {
                    if(tcData.gdprApplies === false) {
                      window.gdprDoesNotApply = true;
                    } else {
                      let a = tcData.purpose.consents[1];
                      let b = tcData.purpose.consents[10];
                      let c = tcData.purpose.legitimateInterests[10];
                      let d = tcData.eventStatus

                      if((!a || !b || !c) & d !== "cmpuishown") {
                        window.__tcfapi("displayConsentUi", 2, function () {});
                      } else {
                        window.userGaveAdConsent = true;
                      }
                    }
                  }
                });
              }
              (async function che1ckTCF() {
                await new Promise(r => setTimeout(r, 100));
                if(window.__tcfapi == undefined) setTimeout(che1ckTCF, 1000);
                else checkConsent();
              })();
              
              if(adProviderName === "freestar") {
                adCtn.innerHTML = `<div class="ad-providers-ctn-el" align="center" data-freestar-ad="__320x100 __970x90" id="perchanceorg_footer"></div>`;
                
                window.freestar = window.freestar || {};
                window.freestar.queue = window.freestar.queue || [];
                window.freestar.config = window.freestar.config || {};
                window.freestar.config.enabled_slots = [];
                window.freestar.initCallback = function () { (window.freestar.config.enabled_slots.length === 0) ? window.freestar.initCallbackCalled = false : window.freestar[`newAdSlots`](window.freestar.config.enabled_slots) }

                let script = document.createElement("script");
                script.dataset.cfasync = "false";
                script.async = true;
                script.src = "https://a.pub.network/perchance-org/pubfig.min.js";
                document.head.appendChild(script);
                
                if(window.location.hash.includes("testAntiAdBlock")) {
                  // anti -ad block:
                  let script = document.createElement("script");
                  script.async = true;
                  script.src = `https://user.uploads.dev/file/01cea1291c0dbb7b775dc89a385d1d4a.js`;
                  document.head.appendChild(script);
                }
                
                window.freestar.config.enabled_slots.push({ placementName: "perchanceorg_footer", slotId: "perchanceorg_footer" });
                
              } else if(adProviderName == `snigel`) {
                
                window.snigelPubConf = {
                  adengine: {
                    sensitiveContent: false
                  },
                };

                // this code is needed to ensure that ad load immediately after accepting cmp 'reconsider'
                window.addEventListener('adnginLoaderReady', function() {
                  adngin.queue.push(function() { adngin.cmd.startAuction(["responsive_banner"]); });
                });
                adCtn.innerHTML = `<div class="ad-providers-ctn-el" id="adngin-responsive_banner-0"></div>`;

                let script = document.createElement("script");
                script.dataset.cfasync = "false";
                script.async = true;
                script.src = `https://cdn.snigelweb.com/adengine/perchance.org/loader.js`;
                document.head.appendChild(script);

                // setTimeout(async () => {
                //   if(await window.adsAreShowing()) return;
                //   let script = document.createElement("script");
                //   script.dataset.cfasync = "false";
                //   script.async = true;
                //   script.nonce = "SEahoBjLmnC565bNlPFeWA";
                //   script.src = "https://fundingchoicesmessages.google.com/i/pub-9885689965057708?ers=1";
                //   document.head.appendChild(script);
                //   (function() {function signalGooglefcPresent() {if (!window.frames['googlefcPresent']) {if (document.body) {const iframe = document.createElement('iframe'); iframe.style = 'width: 0; height: 0; border: none; z-index: -1000; left: -1000px; top: -1000px;'; iframe.style.display = 'none'; iframe.name = 'googlefcPresent'; document.body .appendChild(iframe);} else {setTimeout(signalGooglefcPresent, 0);}}}signalGooglefcPresent();})();
                // }, 30000);
              } else if(adProviderName === "nordvpn") {
                let items = [
                  {link:"https://go.nordvpn.net/aff_c?offer_id=15&aff_id=123094&url_id=902", image:"https://user.uploads.dev/file/fa4c71221bf11f8802b1720e4cabd703.png"},
                  {link:"https://go.nordvpn.net/aff_c?offer_id=15&aff_id=123094&url_id=902", image:"https://user.uploads.dev/file/bf5101624c93542ee6fe83f317f2d903.png"},
                ];
                let i = -1;
                function nextAd() {
                  i++;
                  if(i > items.length-1) i = 0;
                  let obj = items[i];
                  adCtn.innerHTML = `<a href="${obj.link}" target="_blank"><img src="${obj.image}" style="max-width:100%; max-height:100%;"></a>`;
                }
                nextAd();
                setInterval(() => {
                  nextAd();
                }, 1000*60);
              }

              setTimeout(() => {
                window.b8473892 = true;
                function adIframesExist() {
                  return [...document.querySelectorAll("iframe")].filter(el => el.src).map(el => new URL(el.src).hostname).find(n => n.endsWith(`doubleclick.net`) || n.endsWith("onetag-sys.com") || n.endsWith("openx.net") || n.endsWith(".google.com") || n.endsWith(`amazon-adsystem.com`) || n.endsWith("rubiconproject.com") || n.endsWith("criteo.com") || n.endsWith("3lift.com") || n.endsWith("googlesyndication.com") || n.endsWith("connectad.io"));
                }
                setTimeout(async () => {
                  if(window[`localStorage`]["app-storage"] && window.js0nparse(window[`localStorage`]["app-storage"]).user[`sess${``}ionToken`] || window.sdfh929if738ths) return; // not for logged-in users (already done above - just to defend against future edit mistakes)
                  window.queuedStatCountKeys.add("abt");
                  let aidjr3 = await window.adsAreShowing();
                  if(!aidjr3) {

                    let scri12pts = false;
                    let ifra2mes = false;
                    let coo1kies = false;

                    let clasi = false;
                    try {
                      if(await hasVariables() || await chec3kRes1Load(`https://secure.quantserve.com/quant.js`, "script")) {
                        window.queuedStatCountKeys.add("abprbclas");
                        scri12pts  = true;
                      }
                      if(adIframesExist()) {
                        window.queuedStatCountKeys.add("abprbclasi");
                        clasi = true;
                        ifra2mes = true;
                      }
                    } catch(e) {
                      console.error(e);
                    }

                    if(window.userGaveAdConsent || window.gdprDoesNotApply) {
                      coo1kies = true;
                    }

                    try {
                      if(window.js0nparse(window[`localStorage`].id5id_privacy || "{}").id5_consent === true) {
                        coo1kies = true;
                      }
                    } catch(e) {
                      console.error(e); 
                    }  

                    if(clasi && coo1kies) {
                      window.queuedStatCountKeys.add("abprbclasiadgc");
                    }

                    // if(scri12pts && ifra2mes && coo1kies) {
                    //   return; // maybe auction failed or whatever
                    // }

                    if(!ifra2mes) {
                      await new Promise(r => setTimeout(r, 30*1000));
                      if(adIframesExist()) {
                        ifra2mes = true;
                      }
                    }

                    if(scri12pts && ifra2mes) {
                      return;
                    }

                    window.queuedStatCountKeys.add("abpr");
                    if(window[`localStorage`].abpr === "1") {
                      window.queuedStatCountKeys.add("abpr2");
                    }
                    window[`localStorage`].abpr = ("1");

                    try {
                      if(scri12pts && ifra2mes && !coo1kies) {
                        // window[window.modalFn1Name](`Your browser seems to be blocking cookies, which is preventing ads from being shown. You may need to add an exception for 'perchance.org' to your cookie blocker or 'incognito browsing' feature. Sometimes VPN and antivirus software has cookie blocking as a bonus feature.\n\nWhy are ads necessary? Well, Perchance is free and doesn't have ads by default, but the creator of this generator has imported an ad-powered plugin (e.g. the text-to-image plugin). Plugins that use expensive server resources can only exist thanks to ads. This page will auto-refresh in 60 seconds (apologies).`);
                      } else {
                        // window[window.modalFn1Name](`Your browser seems to be blocking ads. Perchance is free and generally doesn't have ads, but the creator of this generator has imported an ad-powered plugin (e.g. the text-to-image plugin). Plugins that use expensive server resources can only exist thanks to ads.\n\nPlease help keep it free by turning off your ad blocker. This page will auto-refresh in 60 seconds (apologies).\n\n(NOTE: If ads still aren't loading for you even after turning off your ad blocker, then you may also need to turn off your 'cookie' blocker, and maybe add an exception for perchance.org on the built-in cookie-blocking of your antivirus/incognito/VPN/etc if it has that feature).`);
                      }
                    } catch(e) {

                    } 

                    startWarnProcess();
                  } else {
                    if(window[`localStorage`].abpr === "1") {
                      window.queuedStatCountKeys.add("utoab");
                    }
                  }
                }, 70001);
              }, 50);

              // setTimeout(async () => {
              //   if(!(await window.adsAreShowing())) {
              //     if(adProviderName == `snigel`) adngin.queue.push(function() { adngin.cmd.startAuction(["responsive_banner"]); });
              //   }
              // }, 30000);
              
              // adCtn.innerHTML = `<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAtgAAABaAQMAAAC4+rO8AAAAAXNSR0IB2cksfwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAANQTFRFXrP/I7IslgAAAB9JREFUeJztwYEAAAAAw6D5U1/gCFUBAAAAAAAAAHwDIFgAAVR0zeEAAAAASUVORK5CYII="/>`;
              
              if(window.innerWidth > 1400) {
                setTimeout(() => {
                  let div = document.createElement("div");
                  div.style.cssText = `position: absolute; right: 4px; top: 4px; font-family: sans-serif; background: #dedede; padding: 0.2rem 0.25rem; border-radius: 3px; cursor: pointer; color: #676767;`;
                  div.onclick = function() { window[window.modalFn1Name]('The creator of this generator has imported an ad-powered plugin (e.g. the text-to-image plugin). Plugins that use expensive server resources are funded via advertisements.'); };
                  div.id = `whyAdsButton1El`;
                  div.innerHTML = `why ads?`;
                  adCtn.appendChild(div);
                }, 2000);
              }
            }

          })();

          (async function() { 
            while(true) {
              try {
                let i = 0;
                while(true) {
                  await new Promise(r => setTimeout(r, 10000));
                  let deps = window.generatorDependenciesData.map(d => d.name);
                  if((window.adCtn && !getCElement(window.adCtn).src?.includes?.("perchance.org")) || window.js0nparse(window.localStorage["app-storage"] || "{}")?.user?.[`sess${``}ionToken`] || window.sdfh929if738ths) {
                    // 1;adngin.cmd.startAuction(["responsive_banner"]);
                    window.queuedStatCountKeys.add("abpsgp");
                    break;
                  }
                  i++;
                  if(i > 10) {
                    break;
                  }
                }
              } catch(e) {
                console.error(e);
              }
              await new Promise(r => setTimeout(r, 20*60*1000));
            }
          })();

          setTimeout(() => {
            `abp|cookie|browser|async|ads|alert|ads`;
            window.e7827462 = true;
          }, 100);
        </script>
        <script>
          function createAdCtn() {
            let adCtn = window[doc34828272947].createElement("div");
            adCtn.id = "adCtn";
            adCtn.style.cssText = `padding:4px 0; min-height:${window.advertHeight}px !important; max-height:${window.advertHeight}px !important; height:${window.advertHeight}px !important; overflow:hidden !important; text-align:center; display:flex; align-items:center; justify-content:center; position:relative;`;
            return adCtn;
          }

          globalThis.hu_8urej4 = true;
          function startWarnProcess() {
            let warnEl = window[doc34828272947].createElement("div");
            let helperNotice = "";
            if(window.innerWidth > 800) helperNotice = `<div><a href="https://user.uploads.perchance.dev/file/06b63cbc807acaf79bc25f114bb0dda1.webp" target="_blank">click here</a> if it's still not working or if you don't understand</div>`;
            warnEl.innerHTML += `<div style="max-width:900px; margin:0 auto;"><span style="font-weight:bold; color:#f60000; font-size:80%;">the author of this generator has imported an ad-powered plugin. pls turn off your ad/cookie blocker to help pay for the servers 🙏</span></div>`;
            if(!window.adCtn) {
              window.adCtn = createAdCtn();
              appEl.appendChild(window.adCtn);
            } else {
              window.adCtn.innerHTML = "";
            }
            window.adCtn.appendChild(warnEl);
            if(window[doc34828272947].querySelector(`#whyAdsButton1El`)) {
              window[doc34828272947].querySelector(`#whyAdsButton1El`).style.display = "none";
            }

            setTimeout(async () => {
              warnEl.remove();
              let aidjr3 = await window.adsAreShowing();
              if(!aidjr3 || !window.e7827462 || !window.b8473892) {
                window[`onbeforeunload`] = undefined;
                if(window.userGaveAdConsent === false && window.gdprDoesNotApply === false) {
                  localStorage.clear();
                }
                if(Number(localStorage.adPageReloadCount || 0) < 4) {
                  localStorage.adPageReloadCount = Number(localStorage.adPageReloadCount || 0)+1;
                  localStorage.lastAdPageReloadTime = Date.now();
                  // window[`location`][rlFn1Name]();
                }
              }
            }, 60001);
          }
        </script>
        <script>
          {
            async function handler() {
              window.u8398201 = true;
              if(!window.e7827462 || !window.b8473892) {
                let deps = window.generatorDependenciesData.map(d => d.name);
                if(!deps.includes("ai-text-to-image-plugin") && !deps.includes("ai-text-plugin")) return;
                if(window[`localStorage`]["app-storage"] && window[`localStorage`]["app-storage"].includes("sessionToken") && window.js0nparse(window[`localStorage`]["app-storage"]).user[`sess${``}ionToken`] || window.sdfh929if738ths) return;
                if(window.forceDisableAds) return;

                startWarnProcess();

                await new Promise(r => setTimeout(r, 1000*40));
                if(!window.adCtn || getCElement(window.adCtn).src?.includes?.("perchance.org")) {
                  // let ms1g = "AI-powered generators on Perchance are entirely funded by ads. Please disable your ad blocker and reload the page. This page will auto-reload in 60 seconds." .replace(/_/g, "");
                  // try { alert(ms1g); } catch(e) { window[doc34828272947].body.innerHTML = ms1g; };
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     window    [false ? '' : `z8473927`] = true;
                  setTimeout(() => {
                    window[`onbeforeunload`] = undefined;
                    if(Number(localStorage.adPageReloadCount || 0) < 4) {
                      localStorage.adPageReloadCount = Number(localStorage.adPageReloadCount || 0)+1;
                      localStorage.lastAdPageReloadTime = Date.now();
                      if(Number(localStorage.adPageReloadCount || 0) < 4) {
                        localStorage.adPageReloadCount = Number(localStorage.adPageReloadCount || 0)+1;
                        localStorage.lastAdPageReloadTime = Date.now();
                        // window[`location`][rlFn1Name]();
                      }
                    }
                  }, 60001);
                }
              }
            }
            setTimeout(handler, 30001);
          }
          function getCElement(el) {
            const rect = el.getBoundingClientRect();
            return document.elementFromPoint(rect.left + rect.width / 2, rect.top + rect.height / 2);
          }
        </script>
        <script>
          let cachedAccessCodeForAdPoweredStuff = null;
          setInterval(() => {
            cachedAccessCodeForAdPoweredStuff = null;
          }, 10*60*1000);

          window.addEventListener("message", async function(e) {
            let origin = e.origin || e.originalEvent.origin
            if(origin !== "https://text-generation.perchance.org" && origin !== `https://image-generation.perchance.org`) {
              return;
            }
            
            if(e.data.type == `plsGibAccessCodeForAdPoweredStuff`) {
              let code;
              if(cachedAccessCodeForAdPoweredStuff) {
                code = cachedAccessCodeForAdPoweredStuff;
              } else {
                code = await fetch(`/api/getAccessCodeForAdPoweredStuff?__cacheBust=${Math.round(Date.now()/(1000*60*10))}`).then(r => r.text());
                cachedAccessCodeForAdPoweredStuff = code;
              }

              let deps = window.generatorDependenciesData.map(d => d.name);
              if(!deps.includes("ai-text-to-image-plugin") && !deps.includes("ai-text-plugin")) {
                e.source.postMessage({type:"okayYouMayHaveCodeForAdPoweredStuff♡", code}, origin); 
                return;
              }
              if(window.adCtn && await window.adsAreShowing() && window.adCtn && !getCElement(window.adCtn).src?.includes?.("perchance.org")) {
                e.source.postMessage({type:"okayYouMayHaveCodeForAdPoweredStuff♡", code}, origin); 
                return;
              }
              if((window[`localStorage`]["app-storage"] && window[`localStorage`]["app-storage"].includes("sessionToken") && window.js0nparse(window[`localStorage`]["app-storage"]).user[`sess${``}ionToken`]) || window.sdfh929if738ths || window.forceDisableAds) {
                e.source.postMessage({type:"okayYouMayHaveCodeForAdPoweredStuff♡", code}, origin); 
                return;
              }
            }
          });
        </script>


        <style>
          .qc-cmp2-persistent-link {
            transform: scale(0.5);
            transform-origin: bottom right 60px;
          }
          .qc-cmp2-container a[href="https://perchance.org/privacy-policy"] {
            min-width: max-content;
            margin-top: 0.25rem;
          }
          .qc-cmp2-container *:has(> a[href="https://perchance.org/privacy-policy"]) {
            justify-content: center !important;
            flex-wrap: wrap !important;
          }
        </style>
        <script>
          (async function() {
            // Ensures that ads can't be displayed outside of their designated area, no matter what.

            if(window.location.hash.toLowerCase().includes("disable_misplaced_ad_removal")) return;

            await window.pageWillDisplayAdsPromise;

            // while(!window.perchanceOutputIframeFinishedFirstLoad) await new Promise(r => setTimeout(r, 1000));
            // if(!window.pageWillDisplayAds) await new Promise(r => setTimeout(r, 1000));
            // if(!window.pageWillDisplayAds) await new Promise(r => setTimeout(r, 3000));
            // if(!window.pageWillDisplayAds) await new Promise(r => setTimeout(r, 9000));
            // if(!window.pageWillDisplayAds) await new Promise(r => setTimeout(r, 30000));
            // if(!window.pageWillDisplayAds) return; 
            // while(!window.adCtn) await new Promise(r => setTimeout(r, 1000));

            setInterval(() => {
              let el = document.querySelector("#ogy-ad-slot");
              if(el && !window.adCtn.contains(el)) el.remove();
            }, 2000);


            {
              let attempts = 0;
              let cmpButtonCheckInterval = setInterval(() => {
                if(window.adCtn.offsetHeight < 10) {
                  document.querySelector(".qc-cmp2-container").style.cssText = "pointer-events:none; opacity:0;";
                  clearInterval(cmpButtonCheckInterval);
                }
                attempts++;
                if(attempts > 30) clearInterval(cmpButtonCheckInterval);
              }, 1000);
            }

            {
              setInterval(() => {
                // delete long cookies if over ~4kb
                if(document.cookie.length > 3900) {
                  let cookies = document.cookie.split(';').map(c => ({ name: c.split('=')[0].trim(), size: c.length }));
                  cookies.sort((a, b) => b.size - a.size);
                  for (let {name} of cookies) {
                    ['/', '/subdomain', ''].forEach(path => document.cookie = `${name}=;expires=Thu, 01 Jan 1970 00:00:00 GMT;path=${path};domain=${window.location.hostname}`);
                    if(document.cookie.length <= 3900) break;
                  }
                }
              }, 5*1000);
            }


            {
              // Ensure adCtn style can't be changed:
              let lastStyleChangeTime = 0;
              const originalStyle = window.adCtn.getAttribute('style');
              const observer = new MutationObserver((mutations) => {
                mutations.forEach((mutation) => {
                  if(mutation.type === 'attributes' && mutation.attributeName === 'style') {
                    if(window.adCtn.getAttribute('style') !== originalStyle) {
                      if(Date.now()-lastStyleChangeTime > 1000) { // prevent possible infinite loops (setInterval below is a backup)
                        window.adCtn.setAttribute('style', originalStyle);
                        lastStyleChangeTime = Date.now();
                      }
                    }
                  }
                });
              });
              const config = { attributes:true, attributeFilter:['style'] };
              observer.observe(window.adCtn, config);
              setInterval(() => {
                if(window.adCtn.getAttribute('style') !== originalStyle) {
                  window.adCtn.setAttribute('style', originalStyle);
                }
              }, 2000);
            }

            let deletionsInLastFewSeconds = 0;
            setInterval(() => {
              deletionsInLastFewSeconds = 0;
            }, 3000);
            function deleteMisplacedAdElements() {
              if(deletionsInLastFewSeconds > 100) {
                window.queuedStatCountKeys.add("misplaced-ad-loop");
                return; // in case of infinite loop that would freeze the page (e.g. "fighting" with a modal that self-heals or something weird like that)
              }
              let points = getElementKeyPointsInset(document.querySelector("#outputIframeEl"), {insetFactor:0.2});
              points.push(...getElementKeyPointsInset(document.querySelector("#outputIframeEl"), {insetFactor:0.03}));
              let appEl = document.querySelector("#appEl"); 
              for(let {x, y} of points) {
                let elements = document.elementsFromPoint(x, y);
                for(let el of elements) {
                  if(el === document.body || el === document.documentElement) continue;
                  if(!document.body.contains(el)) continue; // in case it was deleted by a previous iteration of this current loop
                  if(appEl.contains(el)) continue;
                  if(el.nodeName !== "IFRAME" || !el.src.includes(".perchance.org")) {
                    let ancestor = el;
                    while(ancestor.parentElement !== document.body) ancestor = ancestor.parentElement;
                    if(appEl.contains(ancestor)) {
                      console.error("Tried to remove a child of appEl?");
                      continue; 
                    }
                    const className = ancestor.className || "";
                    const id = ancestor.id || "";
                    if(className.startsWith("cmp") || className.includes("-cmp") || className.includes("cmp2") || id.includes("cmp") || id.includes("termly") || className.includes("termly") || className.startsWith("sp_") || id.startsWith("sp_")) { // gdpr consent modal
                      continue;
                    }
                    if(id.includes("confiant")) { // ad report button
                      continue;
                    }
                    if(className.includes("created-captcha-widget-ctn")) {
                      continue;
                    }
                    ancestor.remove();
                    deletionsInLastFewSeconds++;
                    console.warn("🧹🧹🧹 Deleted misplaced element ancestor:", {el, ancestor});
                    window.queuedStatCountKeys.add("misplaced-ad");
                  }
                }
              } 
            }

            function insetPointTowardCenter(x, y, centerX, centerY, insetFactor) {
              return { x: x + (centerX - x) * insetFactor, y: y + (centerY - y) * insetFactor };
            }
            function getElementKeyPointsInset(element, opts={}) {
              const rect = element.getBoundingClientRect();
              const centerX = rect.left + rect.width / 2;
              const centerY = rect.top + rect.height / 2;
              const insetFactor = opts.insetFactor ?? 0.2; // default to 20% inset

              const topLeft = insetPointTowardCenter(rect.left, rect.top, centerX, centerY, insetFactor);
              const topRight = insetPointTowardCenter(rect.right, rect.top, centerX, centerY, insetFactor);
              const bottomRight = insetPointTowardCenter(rect.right, rect.bottom, centerX, centerY, insetFactor);
              const bottomLeft = insetPointTowardCenter(rect.left, rect.bottom, centerX, centerY, insetFactor);

              return [ topLeft, topRight, bottomRight, bottomLeft, { x: centerX, y: centerY }];
            }

            const observer = new MutationObserver(function(mutationsList, observer) {
              for(let mutation of mutationsList) {
                if(mutation.type === 'childList') {
                  mutation.addedNodes.forEach(node => {
                    if(node.nodeType === Node.ELEMENT_NODE) {
                      // console.debug('Checking new potential ad element for misplacement:', node);
                      deleteMisplacedAdElements();
                      setTimeout(deleteMisplacedAdElements, 1000);
                      setTimeout(deleteMisplacedAdElements, 3000);
                      setTimeout(deleteMisplacedAdElements, 6000);

                      if(!window.__customizedCmpHeaderAlready) {
                        let headerEl = document.querySelector("body > .qc-cmp2-container .qc-cmp2-publisher-logo-container .span-heading");
                        if(headerEl && headerEl.innerHTML.toLowerCase() === "we value your privacy") {
                          headerEl.innerHTML = "Please allow ads to help keep Perchance free 🙏";
                          setTimeout(() => {
                            window.__customizedCmpHeaderAlready = true;
                          }, 5000); // for dynamic re-render delay, which CMP does (sometimes?)
                        }
                      }
                    }
                  });
                }
              }
            });
            observer.observe(document.body, { childList: true, subtree: true });
          })();
        </script>

        <style>
          /* .ad-providers-ctn-el .__fs-ancillary {
            display: none !important;
          } */
          .__fs-ancillary {
            display: none !important;
          }
          .fs-report-ad-button {
            display: none !important; /* disable for now - it's pushing ad up too high on mobile */
          }
        </style>

        <script>
          (async function() {
            if((window[`localStorage`]["app-storage"] && window[`localStorage`]["app-storage"].includes("sessionToken") && window.js0nparse(window[`localStorage`]["app-storage"]).user[`sess${``}ionToken`]) || window.sdfh929if738ths) return; // not for logged-in users
            if(window.forceDisableAds) return;

            window.userGaveAdConsent = null;
            window.gdprDoesNotApply = null;
            let i = 0;
            while(!window.__tcfapi) {
              await new Promise(r => setTimeout(r, 1000));
              i++;
              if(i > 20) return;
            }

            window.__tcfapi('addEventListener', 2, function(tcData, success) {
              if(success && (tcData.eventStatus === 'tcloaded' || tcData.eventStatus === 'useractioncomplete')) {
                if(tcData.gdprApplies) {
                  __tcfapi('getVendorList', 2, function(gvl, success) {
                    if(success) {
                      if(Object.values(tcData.vendor.consents).filter(v => v).length > Object.keys(gvl.vendors).length/2 && Object.values(tcData.purpose.consents).filter(v => v).length === Object.keys(gvl.purposes).length) {
                        window.userGaveAdConsent = true;
                      } else if(Object.values(tcData.vendor.consents).filter(v => v).length == 0 && Object.values(tcData.purpose.consents).filter(v => v).length === 0) {
                        window.userGaveAdConsent = false; // reject
                      } else {
                        window.userGaveAdConsent = false; // partial
                      }
                    }
                  });
                } else {
                  window.gdprDoesNotApply = true;
                }
              } else {
                console.debug("User consent not available yet", tcData);
                if(tcData.gdprApplies === true) {
                  window.gdprDoesNotApply = false;
                }
                if(tcData.eventStatus === 'cmpuishown') {
                  window.gdprDoesNotApply = false;
                }
              }
            });
          })();
        </script>

        <style>
          @media (prefers-color-scheme: dark) {
            #whyAdsButton1El {
              background-color: #333537 !important;
              color: #a79f94 !important;
            }
          }
        </style>

        <script>
          setTimeout(function() {
            // Make the screen "cleaner" for the screenshot bot:
            if(navigator.webdriver) {
              document.querySelector("#menuBarEl").style.display = "none";
              // document.querySelector("#editorEl #main").style.top = "8px";
            }
          }, 10);
        </script>
        
        <script>
          window.addEventListener('pageshow', (event) => {
            if (event.persisted) {
              // bfcache doesn't persist edits in the text editor for some reason (doesn't store JS state?), so we need to reload:
              // window.location.reload(); // edit: for some reason this doesn't seem to be needed anymore - seems to be persisting properly? Maybe due to adding this event handler???
              // console.debug('@@@ This page was restored from the bfcache.');
            } else {
              // console.debug('@@@ This page was loaded normally.');
            }
          });
        </script>

        <script>
          (async function() {
            let checkCount = 0;
            let interval;
            interval = setInterval(() => {
              let a = `s(uc)[],ce,s[s,f(u,lP,a,g,e],Lo),[ad`.replace(/[ ,\]()\[]/g, "");
              let plsp = `in i(ti al,Pa[g eLo adSpi n)ne, r`.replace(/[ ,\]()\[]/g, "");
              if(window.remoteResourcesLoaded && !window[a]) {
                let div = document.createElement("div");
                let isAdPoweredPage = false;
                div.innerHTML = `<p>TL;DR: <b>Try turning off your ad blocker</b>.</p>

                <p>If you see this message, this page failed to load properly. One potential cause is that (as of writing) some ad blockers break <a href="https://github.com/uBlockOrigin/uAssets/blob/9effb98d0ab3be8bc320909144758a326e575ad8/filters/quick-fixes.txt#L160" target="_blank" data-ref="nofollow">basic</a><sup>1</sup> functionality of Perchance pages. This <b>includes pages that don't have any ads</b> - i.e. even "normal" (non-AI-powered) generators.</p>

                <p>Try turning off your browser's ad blocker for this page, and if that doesn't work then please report this problem at <a href="https://lemmy.world/c/perchance" target="_blank">lemmy.world/c/perchance</a>, since there may be some other cause.</p>

                <p style="opacity:0.55;">Note: Perchance only has ads on generators which require GPU resources - a tiny fraction of all pages on Perchance. Perchance has always been <u>completely</u> free, and I've been paying for server resources out of my own pocket since I built Perchance in 2017, but I can't do that for the newly-added AI plugins because they require many GPU servers and they're way too expensive. As of writing (Jan 20th 2023) ads still aren't enough to cover the GPU costs, but they help a lot.</p>

                <p style="opacity:0.55;"><sup>1 </sup><span style="font-size:85%;">The linked code makes your ad blocker extension override some code on this page such that when I (or Perchance generator authors) want to check if some text contains a word (a very basic/common programming operation), it'll always say that the text <i>does</i> contain the word, even when it doesn't. That makes it hard to write code that works correctly, and to make changes to existing code without breaking things.</span></p>`;
                div.style.cssText = "padding:1rem; font-size:120%; z-index:100000000;";
                try { document.querySelector("#" + plsp).remove(); } catch(e) {}
                document.body.appendChild(div);

                clearInterval(interval);
              }
              checkCount++;
              if(checkCount > 20) clearInterval(interval);
            }, 1000*2);
          })();
        </script>

        <script>
          setInterval(() => { 
            if(performance.memory && performance.memory.usedJSHeapSize > 0.8*performance.memory.jsHeapSizeLimit) {
              window.queuedStatCountKeys.add("emem");
            }
            if(document.querySelectorAll("iframe").length > 100) {
              window.queuedStatCountKeys.add("eemb");
              document.querySelectorAll("iframe").forEach(el => {
                let isPerchanceUrl = (el.src||"").split("?")[0].includes("perchance");
                if(!isPerchanceUrl && !document.querySelector("#appEl").contains(el)) {
                  console.warn("❗❗❗ REMOVED EXCESSIVE IFRAMES");
                  el.remove();
                }
              });
            }
          }, 1000*60);
        </script>

        <script>
          setInterval(() => {
            if(window.queuedStatCountKeys.size > 0) {
              window[window.ftcFn1Name](`/api/count?keys=${[...window.queuedStatCountKeys].join(",")}`);
              window.queuedStatCountKeys = new Set();
            }
          }, 1000*20);
        </script>
        
        
        <!-- use invisible `touch-action:none` divs to prevent accidental "drag down to refresh" behavior when scrolling up iframe (dragging finger down) but finger lands on the edge (outside frame) -->
        <!-- <div style="width: 19px;height: 100%;position: fixed;right: -10px;top: 35px;bottom: 0px;/* background: blue; */touch-action: none; z-index:9999999;"></div> -->
        <!-- <div style="width: 19px;height: 100%;position: fixed;left: -10px;top: 35px;bottom: 0px;/* background: blue; */touch-action: none; z-index:9999999;"></div> -->

        <div style="display:none;"><a href="/ai-text-to-image-generator" target="_blank" style="position:absolute;top:-200px;">AI Image Generator</a> <a href="/ai-character-chat" target="_blank" style="position:absolute;top:-200px;">AI Character Chat</a> <a href="/ai-story-generator" target="_blank" style="position:absolute;top:-200px;">AI Story Generator</a></div>

    <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'95f6efe42b9bbc25',t:'MTc1MjU1ODE1Mi4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script><iframe height="1" width="1" style="position: absolute; top: 0px; left: 0px; border: medium; visibility: hidden;"></iframe><script defer="" src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon="{&quot;rayId&quot;:&quot;95f6efe42b9bbc25&quot;,&quot;serverTiming&quot;:{&quot;name&quot;:{&quot;cfExtPri&quot;:true,&quot;cfEdge&quot;:true,&quot;cfOrigin&quot;:true,&quot;cfL4&quot;:true,&quot;cfSpeedBrain&quot;:true,&quot;cfCacheStatus&quot;:true}},&quot;version&quot;:&quot;2025.6.2&quot;,&quot;token&quot;:&quot;fc685cb0ca0145b3acbca350b7d29943&quot;}" crossorigin="anonymous"></script>


</body></html>